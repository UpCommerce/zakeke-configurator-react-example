!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("babylonjs")):"function"==typeof define&&define.amd?define("babylonjs-loaders",["babylonjs"],t):"object"==typeof exports?exports["babylonjs-loaders"]=t(require("babylonjs")):e.LOADERS=t(e.BABYLON)}("undefined"!=typeof self?self:"undefined"!=typeof global?global:this,function(e){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./legacy/legacy.ts")}({"../../node_modules/tslib/tslib.es6.js":function(e,t,n){"use strict";n.r(t),n.d(t,"__extends",function(){return i}),n.d(t,"__assign",function(){return o}),n.d(t,"__rest",function(){return a}),n.d(t,"__decorate",function(){return s}),n.d(t,"__param",function(){return l}),n.d(t,"__metadata",function(){return c}),n.d(t,"__awaiter",function(){return u}),n.d(t,"__generator",function(){return _}),n.d(t,"__createBinding",function(){return h}),n.d(t,"__exportStar",function(){return f}),n.d(t,"__values",function(){return d}),n.d(t,"__read",function(){return p}),n.d(t,"__spread",function(){return m}),n.d(t,"__spreadArrays",function(){return g}),n.d(t,"__spreadArray",function(){return v}),n.d(t,"__await",function(){return b}),n.d(t,"__asyncGenerator",function(){return y}),n.d(t,"__asyncDelegator",function(){return x}),n.d(t,"__asyncValues",function(){return T}),n.d(t,"__makeTemplateObject",function(){return O}),n.d(t,"__importStar",function(){return C}),n.d(t,"__importDefault",function(){return S}),n.d(t,"__classPrivateFieldGet",function(){return M}),n.d(t,"__classPrivateFieldSet",function(){return E});var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function a(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function s(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function l(e,t){return function(n,r){t(n,r,e)}}function c(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function u(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}l((r=r.apply(e,t||[])).next())})}function _(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var h=Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]};function f(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||h(t,e,n)}function d(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function p(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function m(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(p(arguments[t]));return e}function g(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}function v(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function b(e){return this instanceof b?(this.v=e,this):new b(e)}function y(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(e){i[e]&&(r[e]=function(t){return new Promise(function(n,r){o.push([e,t,n,r])>1||s(e,t)})})}function s(e,t){try{(n=i[e](t)).value instanceof b?Promise.resolve(n.value.v).then(l,c):u(o[0][2],n)}catch(e){u(o[0][3],e)}var n}function l(e){s("next",e)}function c(e){s("throw",e)}function u(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}}function x(e){var t,n;return t={},r("next"),r("throw",function(e){throw e}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:b(e[r](t)),done:"return"===r}:i?i(t):t}:i}}function T(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=d(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,i){(function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)})(r,i,(t=e[n](t)).done,t.value)})}}}function O(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var P=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function C(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&h(t,e,n);return P(t,e),t}function S(e){return e&&e.__esModule?e:{default:e}}function M(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function E(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n}},"../../node_modules/webpack/buildin/global.js":function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},"./OBJ/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./OBJ/mtlFileLoader.ts");n.d(t,"MTLFileLoader",function(){return r.MTLFileLoader});n("./OBJ/objLoadingOptions.ts");var i=n("./OBJ/solidParser.ts");n.d(t,"SolidParser",function(){return i.SolidParser});var o=n("./OBJ/objFileLoader.ts");n.d(t,"OBJFileLoader",function(){return o.OBJFileLoader})},"./OBJ/mtlFileLoader.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"MTLFileLoader",function(){return i});var r=n("babylonjs/Misc/observable"),i=function(){function e(){this.materials=[]}return e.prototype.parseMTL=function(t,n,i,o){if(!(n instanceof ArrayBuffer)){for(var a,s=n.split("\n"),l=/\s+/,c=null,u=0;u<s.length;u++){var _=s[u].trim();if(0!==_.length&&"#"!==_.charAt(0)){var h=_.indexOf(" "),f=h>=0?_.substring(0,h):_;f=f.toLowerCase();var d=h>=0?_.substring(h+1).trim():"";"newmtl"===f?(c&&this.materials.push(c),t._blockEntityCollection=!!o,(c=new r.StandardMaterial(d,t))._parentContainer=o,t._blockEntityCollection=!1):"kd"===f&&c?(a=d.split(l,3).map(parseFloat),c.diffuseColor=r.Color3.FromArray(a)):"ka"===f&&c?(a=d.split(l,3).map(parseFloat),c.ambientColor=r.Color3.FromArray(a)):"ks"===f&&c?(a=d.split(l,3).map(parseFloat),c.specularColor=r.Color3.FromArray(a)):"ke"===f&&c?(a=d.split(l,3).map(parseFloat),c.emissiveColor=r.Color3.FromArray(a)):"ns"===f&&c?c.specularPower=parseFloat(d):"d"===f&&c?c.alpha=parseFloat(d):"map_ka"===f&&c?c.ambientTexture=e._getTexture(i,d,t):"map_kd"===f&&c?c.diffuseTexture=e._getTexture(i,d,t):"map_ks"===f&&c?c.specularTexture=e._getTexture(i,d,t):"map_ns"===f||("map_bump"===f&&c?c.bumpTexture=e._getTexture(i,d,t):"map_d"===f&&c&&(c.opacityTexture=e._getTexture(i,d,t)))}}c&&this.materials.push(c)}},e._getTexture=function(t,n,i){if(!n)return null;var o=t;if("file:"===t){var a=n.lastIndexOf("\\");-1===a&&(a=n.lastIndexOf("/")),o+=a>-1?n.substr(a+1):n}else o+=n;return new r.Texture(o,i,!1,e.INVERT_TEXTURE_Y)},e.INVERT_TEXTURE_Y=!0,e}()},"./OBJ/objFileLoader.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"OBJFileLoader",function(){return a});var r=n("babylonjs/Misc/observable"),i=n("./OBJ/mtlFileLoader.ts"),o=n("./OBJ/solidParser.ts"),a=function(){function e(t){this.name="obj",this.extensions=".obj",this._assetContainer=null,this._loadingOptions=t||e.DefaultLoadingOptions}return Object.defineProperty(e,"INVERT_TEXTURE_Y",{get:function(){return i.MTLFileLoader.INVERT_TEXTURE_Y},set:function(e){i.MTLFileLoader.INVERT_TEXTURE_Y=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"DefaultLoadingOptions",{get:function(){return{computeNormals:e.COMPUTE_NORMALS,optimizeNormals:e.OPTIMIZE_NORMALS,importVertexColors:e.IMPORT_VERTEX_COLORS,invertY:e.INVERT_Y,invertTextureY:e.INVERT_TEXTURE_Y,UVScaling:e.UV_SCALING,materialLoadingFailsSilently:e.MATERIAL_LOADING_FAILS_SILENTLY,optimizeWithUV:e.OPTIMIZE_WITH_UV,skipMaterials:e.SKIP_MATERIALS}},enumerable:!1,configurable:!0}),e.prototype._loadMTL=function(e,t,n,i){var o=t+e;r.Tools.LoadFile(o,n,void 0,void 0,!1,function(e,t){i(o,t)})},e.prototype.createPlugin=function(){return new e(e.DefaultLoadingOptions)},e.prototype.canDirectLoad=function(e){return!1},e.prototype.importMeshAsync=function(e,t,n,r,i,o){return this._parseSolid(e,t,n,r).then(function(e){return{meshes:e,particleSystems:[],skeletons:[],animationGroups:[],transformNodes:[],geometries:[],lights:[]}})},e.prototype.loadAsync=function(e,t,n,r,i){return this.importMeshAsync(null,e,t,n,r).then(function(){})},e.prototype.loadAssetContainerAsync=function(e,t,n,i,o){var a=this,s=new r.AssetContainer(e);return this._assetContainer=s,this.importMeshAsync(null,e,t,n).then(function(e){return e.meshes.forEach(function(e){return s.meshes.push(e)}),e.meshes.forEach(function(e){var t=e.material;t&&(-1==s.materials.indexOf(t)&&(s.materials.push(t),t.getActiveTextures().forEach(function(e){-1==s.textures.indexOf(e)&&s.textures.push(e)})))}),a._assetContainer=null,s}).catch(function(e){throw a._assetContainer=null,e})},e.prototype._parseSolid=function(e,t,n,a){var s=this,l="",c=new i.MTLFileLoader,u=new Array,_=[];new o.SolidParser(u,_,this._loadingOptions).parse(e,n,t,this._assetContainer,function(e){l=e});var h=[];return""===l||this._loadingOptions.skipMaterials||h.push(new Promise(function(e,n){s._loadMTL(l,a,function(i){try{c.parseMTL(t,i,a,s._assetContainer);for(var o=0;o<c.materials.length;o++){for(var h,f=0,d=[];(h=u.indexOf(c.materials[o].name,f))>-1;)d.push(h),f=h+1;if(-1===h&&0===d.length)c.materials[o].dispose();else for(var p=0;p<d.length;p++){var m=_[d[p]],g=c.materials[o];m.material=g,m.getTotalIndices()||(g.pointsCloud=!0)}}e()}catch(t){r.Tools.Warn("Error processing MTL file: '"+l+"'"),s._loadingOptions.materialLoadingFailsSilently?e():n(t)}},function(t,i){r.Tools.Warn("Error downloading MTL file: '"+l+"'"),s._loadingOptions.materialLoadingFailsSilently?e():n(i)})})),Promise.all(h).then(function(){return _})},e.OPTIMIZE_WITH_UV=!0,e.INVERT_Y=!1,e.IMPORT_VERTEX_COLORS=!1,e.COMPUTE_NORMALS=!1,e.OPTIMIZE_NORMALS=!1,e.UV_SCALING=new r.Vector2(1,1),e.SKIP_MATERIALS=!1,e.MATERIAL_LOADING_FAILS_SILENTLY=!0,e}();r.SceneLoader&&r.SceneLoader.RegisterPlugin(new a)},"./OBJ/objLoadingOptions.ts":function(e,t,n){"use strict";n.r(t)},"./OBJ/solidParser.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"SolidParser",function(){return i});var r=n("babylonjs/Misc/observable"),i=function(){function e(e,t,n){this._positions=[],this._normals=[],this._uvs=[],this._colors=[],this._meshesFromObj=[],this._indicesForBabylon=[],this._wrappedPositionForBabylon=[],this._wrappedUvsForBabylon=[],this._wrappedColorsForBabylon=[],this._wrappedNormalsForBabylon=[],this._tuplePosNorm=[],this._curPositionInIndices=0,this._hasMeshes=!1,this._unwrappedPositionsForBabylon=[],this._unwrappedColorsForBabylon=[],this._unwrappedNormalsForBabylon=[],this._unwrappedUVForBabylon=[],this._triangles=[],this._materialNameFromObj="",this._objMeshName="",this._increment=1,this._isFirstMaterial=!0,this._grayColor=new r.Color4(.5,.5,.5,1),this._materialToUse=e,this._babylonMeshesArray=t,this._loadingOptions=n}return e.prototype._isInArray=function(e,t){e[t[0]]||(e[t[0]]={normals:[],idx:[]});var n=e[t[0]].normals.indexOf(t[1]);return-1===n?-1:e[t[0]].idx[n]},e.prototype._isInArrayUV=function(e,t){e[t[0]]||(e[t[0]]={normals:[],idx:[],uv:[]});var n=e[t[0]].normals.indexOf(t[1]);return 1!=n&&t[2]===e[t[0]].uv[n]?e[t[0]].idx[n]:-1},e.prototype._setData=function(e,t,n,r,i,o,a){var s;-1===(s=this._loadingOptions.optimizeWithUV?this._isInArrayUV(this._tuplePosNorm,[e,n,t]):this._isInArray(this._tuplePosNorm,[e,n]))?(this._indicesForBabylon.push(this._wrappedPositionForBabylon.length),this._wrappedPositionForBabylon.push(r),this._wrappedUvsForBabylon.push(i),this._wrappedNormalsForBabylon.push(o),void 0!==a&&this._wrappedColorsForBabylon.push(a),this._tuplePosNorm[e].normals.push(n),this._tuplePosNorm[e].idx.push(this._curPositionInIndices++),this._loadingOptions.optimizeWithUV&&this._tuplePosNorm[e].uv.push(t)):this._indicesForBabylon.push(s)},e.prototype._unwrapData=function(){for(var e=0;e<this._wrappedPositionForBabylon.length;e++)this._unwrappedPositionsForBabylon.push(this._wrappedPositionForBabylon[e].x,this._wrappedPositionForBabylon[e].y,this._wrappedPositionForBabylon[e].z),this._unwrappedNormalsForBabylon.push(this._wrappedNormalsForBabylon[e].x,this._wrappedNormalsForBabylon[e].y,this._wrappedNormalsForBabylon[e].z),this._unwrappedUVForBabylon.push(this._wrappedUvsForBabylon[e].x,this._wrappedUvsForBabylon[e].y),this._loadingOptions.importVertexColors&&this._unwrappedColorsForBabylon.push(this._wrappedColorsForBabylon[e].r,this._wrappedColorsForBabylon[e].g,this._wrappedColorsForBabylon[e].b,this._wrappedColorsForBabylon[e].a);this._wrappedPositionForBabylon=[],this._wrappedNormalsForBabylon=[],this._wrappedUvsForBabylon=[],this._wrappedColorsForBabylon=[],this._tuplePosNorm=[],this._curPositionInIndices=0},e.prototype._getTriangles=function(e,t){for(var n=t;n<e.length-1;n++)this._triangles.push(e[0],e[n],e[n+1])},e.prototype._setDataForCurrentFaceWithPattern1=function(e,t){this._getTriangles(e,t);for(var n=0;n<this._triangles.length;n++){var i=parseInt(this._triangles[n])-1;this._setData(i,0,0,this._positions[i],r.Vector2.Zero(),r.Vector3.Up(),this._loadingOptions.importVertexColors?this._colors[i]:void 0)}this._triangles=[]},e.prototype._setDataForCurrentFaceWithPattern2=function(e,t){this._getTriangles(e,t);for(var n=0;n<this._triangles.length;n++){var i=this._triangles[n].split("/"),o=parseInt(i[0])-1,a=parseInt(i[1])-1;this._setData(o,a,0,this._positions[o],this._uvs[a],r.Vector3.Up(),this._loadingOptions.importVertexColors?this._colors[o]:void 0)}this._triangles=[]},e.prototype._setDataForCurrentFaceWithPattern3=function(e,t){this._getTriangles(e,t);for(var n=0;n<this._triangles.length;n++){var r=this._triangles[n].split("/"),i=parseInt(r[0])-1,o=parseInt(r[1])-1,a=parseInt(r[2])-1;this._setData(i,o,a,this._positions[i],this._uvs[o],this._normals[a])}this._triangles=[]},e.prototype._setDataForCurrentFaceWithPattern4=function(e,t){this._getTriangles(e,t);for(var n=0;n<this._triangles.length;n++){var i=this._triangles[n].split("//"),o=parseInt(i[0])-1,a=parseInt(i[1])-1;this._setData(o,1,a,this._positions[o],r.Vector2.Zero(),this._normals[a],this._loadingOptions.importVertexColors?this._colors[o]:void 0)}this._triangles=[]},e.prototype._setDataForCurrentFaceWithPattern5=function(e,t){this._getTriangles(e,t);for(var n=0;n<this._triangles.length;n++){var r=this._triangles[n].split("/"),i=this._positions.length+parseInt(r[0]),o=this._uvs.length+parseInt(r[1]),a=this._normals.length+parseInt(r[2]);this._setData(i,o,a,this._positions[i],this._uvs[o],this._normals[a],this._loadingOptions.importVertexColors?this._colors[i]:void 0)}this._triangles=[]},e.prototype._addPreviousObjMesh=function(){this._meshesFromObj.length>0&&(this._handledMesh=this._meshesFromObj[this._meshesFromObj.length-1],this._unwrapData(),this._indicesForBabylon.reverse(),this._handledMesh.indices=this._indicesForBabylon.slice(),this._handledMesh.positions=this._unwrappedPositionsForBabylon.slice(),this._handledMesh.normals=this._unwrappedNormalsForBabylon.slice(),this._handledMesh.uvs=this._unwrappedUVForBabylon.slice(),this._loadingOptions.importVertexColors&&(this._handledMesh.colors=this._unwrappedColorsForBabylon.slice()),this._indicesForBabylon=[],this._unwrappedPositionsForBabylon=[],this._unwrappedColorsForBabylon=[],this._unwrappedNormalsForBabylon=[],this._unwrappedUVForBabylon=[])},e.prototype._optimizeNormals=function(e){var t=e.getVerticesData(r.VertexBuffer.PositionKind),n=e.getVerticesData(r.VertexBuffer.NormalKind),i={};if(t&&n){for(var o=0;o<t.length/3;o++){(l=i[s=t[3*o+0]+"_"+t[3*o+1]+"_"+t[3*o+2]])||(l=[],i[s]=l),l.push(o)}var a=new r.Vector3;for(var s in i){var l;if(!((l=i[s]).length<2)){var c=l[0];for(o=1;o<l.length;++o){var u=l[o];n[3*c+0]+=n[3*u+0],n[3*c+1]+=n[3*u+1],n[3*c+2]+=n[3*u+2]}a.copyFromFloats(n[3*c+0],n[3*c+1],n[3*c+2]),a.normalize();for(o=0;o<l.length;++o){n[3*(u=l[o])+0]=a.x,n[3*u+1]=a.y,n[3*u+2]=a.z}}}e.setVerticesData(r.VertexBuffer.NormalKind,n)}},e.prototype.parse=function(t,n,i,o,a){for(var s,l=n.split("\n"),c=0;c<l.length;c++){var u,_=l[c].trim().replace(/\s\s/g," ");if(0!==_.length&&"#"!==_.charAt(0))if(e.VertexPattern.test(_)){if(u=_.match(/[^ ]+/g),this._positions.push(new r.Vector3(parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3]))),this._loadingOptions.importVertexColors)if(u.length>=7){var h=parseFloat(u[4]),f=parseFloat(u[5]),d=parseFloat(u[6]);this._colors.push(new r.Color4(h>1?h/255:h,f>1?f/255:f,d>1?d/255:d,7===u.length||void 0===u[7]?1:parseFloat(u[7])))}else this._colors.push(this._grayColor)}else if(null!==(u=e.NormalPattern.exec(_)))this._normals.push(new r.Vector3(parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3])));else if(null!==(u=e.UVPattern.exec(_)))this._uvs.push(new r.Vector2(parseFloat(u[1])*this._loadingOptions.UVScaling.x,parseFloat(u[2])*this._loadingOptions.UVScaling.y));else if(null!==(u=e.FacePattern3.exec(_)))this._setDataForCurrentFaceWithPattern3(u[1].trim().split(" "),1);else if(null!==(u=e.FacePattern4.exec(_)))this._setDataForCurrentFaceWithPattern4(u[1].trim().split(" "),1);else if(null!==(u=e.FacePattern5.exec(_)))this._setDataForCurrentFaceWithPattern5(u[1].trim().split(" "),1);else if(null!==(u=e.FacePattern2.exec(_)))this._setDataForCurrentFaceWithPattern2(u[1].trim().split(" "),1);else if(null!==(u=e.FacePattern1.exec(_)))this._setDataForCurrentFaceWithPattern1(u[1].trim().split(" "),1);else if(e.GroupDescriptor.test(_)||e.ObjectDescriptor.test(_)){var p={name:_.substring(2).trim(),indices:void 0,positions:void 0,normals:void 0,uvs:void 0,colors:void 0,materialName:""};this._addPreviousObjMesh(),this._meshesFromObj.push(p),this._hasMeshes=!0,this._isFirstMaterial=!0,this._increment=1}else if(e.UseMtlDescriptor.test(_)){if(this._materialNameFromObj=_.substring(7).trim(),!this._isFirstMaterial||!this._hasMeshes){this._addPreviousObjMesh();p={name:(this._objMeshName||"mesh")+"_mm"+this._increment.toString(),indices:void 0,positions:void 0,normals:void 0,uvs:void 0,colors:void 0,materialName:this._materialNameFromObj};this._increment++,this._meshesFromObj.push(p),this._hasMeshes=!0}this._hasMeshes&&this._isFirstMaterial&&(this._meshesFromObj[this._meshesFromObj.length-1].materialName=this._materialNameFromObj,this._isFirstMaterial=!1)}else e.MtlLibGroupDescriptor.test(_)?a(_.substring(7).trim()):e.SmoothDescriptor.test(_)||console.log("Unhandled expression at line : "+_)}if(this._hasMeshes&&(this._handledMesh=this._meshesFromObj[this._meshesFromObj.length-1],this._indicesForBabylon.reverse(),this._unwrapData(),this._handledMesh.indices=this._indicesForBabylon,this._handledMesh.positions=this._unwrappedPositionsForBabylon,this._handledMesh.normals=this._unwrappedNormalsForBabylon,this._handledMesh.uvs=this._unwrappedUVForBabylon,this._loadingOptions.importVertexColors&&(this._handledMesh.colors=this._unwrappedColorsForBabylon)),!this._hasMeshes){var m=null;if(this._indicesForBabylon.length)this._indicesForBabylon.reverse(),this._unwrapData();else{for(var g=0,v=this._positions;g<v.length;g++){var b=v[g];this._unwrappedPositionsForBabylon.push(b.x,b.y,b.z)}if(this._normals.length)for(var y=0,x=this._normals;y<x.length;y++){var T=x[y];this._unwrappedNormalsForBabylon.push(T.x,T.y,T.z)}if(this._uvs.length)for(var O=0,P=this._uvs;O<P.length;O++){var C=P[O];this._unwrappedUVForBabylon.push(C.x,C.y)}if(this._colors.length)for(var S=0,M=this._colors;S<M.length;S++){var E=M[S];this._unwrappedColorsForBabylon.push(E.r,E.g,E.b,E.a)}this._materialNameFromObj||((m=new r.StandardMaterial(r.Geometry.RandomId(),i)).pointsCloud=!0,this._materialNameFromObj=m.name,this._normals.length||(m.disableLighting=!0,m.emissiveColor=r.Color3.White()))}this._meshesFromObj.push({name:r.Geometry.RandomId(),indices:this._indicesForBabylon,positions:this._unwrappedPositionsForBabylon,colors:this._unwrappedColorsForBabylon,normals:this._unwrappedNormalsForBabylon,uvs:this._unwrappedUVForBabylon,materialName:this._materialNameFromObj,directMaterial:m})}for(var A=0;A<this._meshesFromObj.length;A++){if(t&&this._meshesFromObj[A].name)if(t instanceof Array){if(-1===t.indexOf(this._meshesFromObj[A].name))continue}else if(this._meshesFromObj[A].name!==t)continue;this._handledMesh=this._meshesFromObj[A],i._blockEntityCollection=!!o;var B=new r.Mesh(this._meshesFromObj[A].name,i);if(B._parentContainer=o,i._blockEntityCollection=!1,this._materialToUse.push(this._meshesFromObj[A].materialName),0!==(null===(s=this._handledMesh.positions)||void 0===s?void 0:s.length)){var F=new r.VertexData;if(F.uvs=this._handledMesh.uvs,F.indices=this._handledMesh.indices,F.positions=this._handledMesh.positions,this._loadingOptions.computeNormals){var R=new Array;r.VertexData.ComputeNormals(this._handledMesh.positions,this._handledMesh.indices,R),F.normals=R}else F.normals=this._handledMesh.normals;this._loadingOptions.importVertexColors&&(F.colors=this._handledMesh.colors),F.applyToMesh(B),this._loadingOptions.invertY&&(B.scaling.y*=-1),this._loadingOptions.optimizeNormals&&this._optimizeNormals(B),this._babylonMeshesArray.push(B),this._handledMesh.directMaterial&&(B.material=this._handledMesh.directMaterial)}else this._babylonMeshesArray.push(B)}},e.ObjectDescriptor=/^o/,e.GroupDescriptor=/^g/,e.MtlLibGroupDescriptor=/^mtllib /,e.UseMtlDescriptor=/^usemtl /,e.SmoothDescriptor=/^s /,e.VertexPattern=/v(\s+[\d|\.|\+|\-|e|E]+){3,7}/,e.NormalPattern=/vn(\s+[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,e.UVPattern=/vt(\s+[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,e.FacePattern1=/f\s+(([\d]{1,}[\s]?){3,})+/,e.FacePattern2=/f\s+((([\d]{1,}\/[\d]{1,}[\s]?){3,})+)/,e.FacePattern3=/f\s+((([\d]{1,}\/[\d]{1,}\/[\d]{1,}[\s]?){3,})+)/,e.FacePattern4=/f\s+((([\d]{1,}\/\/[\d]{1,}[\s]?){3,})+)/,e.FacePattern5=/f\s+(((-[\d]{1,}\/-[\d]{1,}\/-[\d]{1,}[\s]?){3,})+)/,e}()},"./STL/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./STL/stlFileLoader.ts");n.d(t,"STLFileLoader",function(){return r.STLFileLoader})},"./STL/stlFileLoader.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"STLFileLoader",function(){return i});var r=n("babylonjs/Misc/observable"),i=function(){function e(){this.solidPattern=/solid (\S*)([\S\s]*?)endsolid[ ]*(\S*)/g,this.facetsPattern=/facet([\s\S]*?)endfacet/g,this.normalPattern=/normal[\s]+([\-+]?[0-9]+\.?[0-9]*([eE][\-+]?[0-9]+)?)+[\s]+([\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?)+[\s]+([\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?)+/g,this.vertexPattern=/vertex[\s]+([\-+]?[0-9]+\.?[0-9]*([eE][\-+]?[0-9]+)?)+[\s]+([\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?)+[\s]+([\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?)+/g,this.name="stl",this.extensions={".stl":{isBinary:!0}}}return e.prototype.importMesh=function(e,t,n,i,o,a,s){var l;if("string"!=typeof n){if(this._isBinary(n)){var c=new r.Mesh("stlmesh",t);return this._parseBinary(c,n),o&&o.push(c),!0}for(var u=new Uint8Array(n),_="",h=0;h<n.byteLength;h++)_+=String.fromCharCode(u[h]);n=_}for(;l=this.solidPattern.exec(n);){var f=l[1];if(f!=l[3])return r.Tools.Error("Error in STL, solid name != endsolid name"),!1;if(e&&f)if(e instanceof Array){if(!e.indexOf(f))continue}else if(f!==e)continue;f=f||"stlmesh";c=new r.Mesh(f,t);this._parseASCII(c,l[2]),o&&o.push(c)}return!0},e.prototype.load=function(e,t,n){return this.importMesh(null,e,t,n,null,null,null)},e.prototype.loadAssetContainer=function(e,t,n,i){var o=new r.AssetContainer(e);return e._blockEntityCollection=!0,this.importMesh(null,e,t,n,o.meshes,null,null),e._blockEntityCollection=!1,o},e.prototype._isBinary=function(e){var t;if((t=new DataView(e)).byteLength<=80)return!1;if(50,84+50*t.getUint32(80,!0)===t.byteLength)return!0;for(var n=t.byteLength,r=0;r<n;r++)if(t.getUint8(r)>127)return!0;return!1},e.prototype._parseBinary=function(t,n){for(var i=new DataView(n),o=i.getUint32(80,!0),a=0,s=new Float32Array(3*o*3),l=new Float32Array(3*o*3),c=new Uint32Array(3*o),u=0,_=0;_<o;_++){for(var h=84+50*_,f=i.getFloat32(h,!0),d=i.getFloat32(h+4,!0),p=i.getFloat32(h+8,!0),m=1;m<=3;m++){var g=h+12*m;s[a]=i.getFloat32(g,!0),l[a]=f,e.DO_NOT_ALTER_FILE_COORDINATES?(s[a+1]=i.getFloat32(g+4,!0),s[a+2]=i.getFloat32(g+8,!0),l[a+1]=d,l[a+2]=p):(s[a+2]=i.getFloat32(g+4,!0),s[a+1]=i.getFloat32(g+8,!0),l[a+2]=d,l[a+1]=p),a+=3}c[u]=u++,c[u]=u++,c[u]=u++}t.setVerticesData(r.VertexBuffer.PositionKind,s),t.setVerticesData(r.VertexBuffer.NormalKind,l),t.setIndices(c),t.computeWorldMatrix(!0)},e.prototype._parseASCII=function(t,n){for(var i,o=[],a=[],s=[],l=0;i=this.facetsPattern.exec(n);){var c=i[1],u=this.normalPattern.exec(c);if(this.normalPattern.lastIndex=0,u){for(var _,h=[Number(u[1]),Number(u[5]),Number(u[3])];_=this.vertexPattern.exec(c);)e.DO_NOT_ALTER_FILE_COORDINATES?(o.push(Number(_[1]),Number(_[3]),Number(_[5])),a.push(h[0],h[2],h[1])):(o.push(Number(_[1]),Number(_[5]),Number(_[3])),a.push(h[0],h[1],h[2]));s.push(l++,l++,l++),this.vertexPattern.lastIndex=0}}this.facetsPattern.lastIndex=0,t.setVerticesData(r.VertexBuffer.PositionKind,o),t.setVerticesData(r.VertexBuffer.NormalKind,a),t.setIndices(s),t.computeWorldMatrix(!0)},e.DO_NOT_ALTER_FILE_COORDINATES=!1,e}();r.SceneLoader&&r.SceneLoader.RegisterPlugin(new i)},"./glTF/1.0/glTFBinaryExtension.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"GLTFBinaryExtension",function(){return s});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("./glTF/1.0/glTFLoader.ts"),o=n("./glTF/1.0/glTFLoaderUtils.ts"),a=n("./glTF/1.0/glTFLoaderInterfaces.ts"),s=function(e){function t(){return e.call(this,"KHR_binary_glTF")||this}return Object(r.__extends)(t,e),t.prototype.loadRuntimeAsync=function(e,t,n,r,o){var a=t.json.extensionsUsed;return!(!a||-1===a.indexOf(this.name)||!t.bin)&&(this._bin=t.bin,r(i.GLTFLoaderBase.CreateRuntime(t.json,e,n)),!0)},t.prototype.loadBufferAsync=function(e,t,n,r){return-1!==e.extensionsUsed.indexOf(this.name)&&("binary_glTF"===t&&(this._bin.readAsync(0,this._bin.byteLength).then(n,function(e){return r(e.message)}),!0))},t.prototype.loadTextureBufferAsync=function(e,t,n,r){var i=e.textures[t],s=e.images[i.source];if(!(s.extensions&&this.name in s.extensions))return!1;var l=s.extensions[this.name],c=e.bufferViews[l.bufferView];return n(o.GLTFUtils.GetBufferFromBufferView(e,c,0,c.byteLength,a.EComponentType.UNSIGNED_BYTE)),!0},t.prototype.loadShaderStringAsync=function(e,t,n,r){var i=e.shaders[t];if(!(i.extensions&&this.name in i.extensions))return!1;var s=i.extensions[this.name],l=e.bufferViews[s.bufferView],c=o.GLTFUtils.GetBufferFromBufferView(e,l,0,l.byteLength,a.EComponentType.UNSIGNED_BYTE);return setTimeout(function(){var e=o.GLTFUtils.DecodeBufferToText(c);n(e)}),!0},t}(i.GLTFLoaderExtension);i.GLTFLoader.RegisterExtension(new s)},"./glTF/1.0/glTFLoader.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"GLTFLoaderBase",function(){return B}),n.d(t,"GLTFLoader",function(){return F}),n.d(t,"GLTFLoaderExtension",function(){return R});var r,i=n("./glTF/1.0/glTFLoaderInterfaces.ts"),o=n("babylonjs/Misc/observable"),a=n("./glTF/1.0/glTFLoaderUtils.ts"),s=n("./glTF/glTFFileLoader.ts");!function(e){e[e.IDENTIFIER=1]="IDENTIFIER",e[e.UNKNOWN=2]="UNKNOWN",e[e.END_OF_INPUT=3]="END_OF_INPUT"}(r||(r={}));var l=function(){function e(e){this._pos=0,this.currentToken=r.UNKNOWN,this.currentIdentifier="",this.currentString="",this.isLetterOrDigitPattern=/^[a-zA-Z0-9]+$/,this._toParse=e,this._maxPos=e.length}return e.prototype.getNextToken=function(){if(this.isEnd())return r.END_OF_INPUT;if(this.currentString=this.read(),this.currentToken=r.UNKNOWN,"_"===this.currentString||this.isLetterOrDigitPattern.test(this.currentString))for(this.currentToken=r.IDENTIFIER,this.currentIdentifier=this.currentString;!this.isEnd()&&(this.isLetterOrDigitPattern.test(this.currentString=this.peek())||"_"===this.currentString);)this.currentIdentifier+=this.currentString,this.forward();return this.currentToken},e.prototype.peek=function(){return this._toParse[this._pos]},e.prototype.read=function(){return this._toParse[this._pos++]},e.prototype.forward=function(){this._pos++},e.prototype.isEnd=function(){return this._pos>=this._maxPos},e}(),c=["MODEL","VIEW","PROJECTION","MODELVIEW","MODELVIEWPROJECTION","JOINTMATRIX"],u=["world","view","projection","worldView","worldViewProjection","mBones"],_=["translation","rotation","scale"],h=["position","rotationQuaternion","scaling"],f=function(e,t,n){for(var r in e){var i=e[r];n[t][r]=i}},d=function(e){if(e)for(var t=0;t<e.length/2;t++)e[2*t+1]=1-e[2*t+1]},p=function(e){if("NORMAL"===e.semantic)return"normal";if("POSITION"===e.semantic)return"position";if("JOINT"===e.semantic)return"matricesIndices";if("WEIGHT"===e.semantic)return"matricesWeights";if("COLOR"===e.semantic)return"color";if(e.semantic&&-1!==e.semantic.indexOf("TEXCOORD_")){var t=Number(e.semantic.split("_")[1]);return"uv"+(0===t?"":t+1)}return null},m=function(e){var t=null;if(e.translation||e.rotation||e.scale){var n=o.Vector3.FromArray(e.scale||[1,1,1]),r=o.Quaternion.FromArray(e.rotation||[0,0,0,1]),i=o.Vector3.FromArray(e.translation||[0,0,0]);t=o.Matrix.Compose(n,r,i)}else t=o.Matrix.FromArray(e.matrix);return t},g=function(e,t,n,r){for(var i=0;i<r.bones.length;i++)if(r.bones[i].name===n)return r.bones[i];var a=e.nodes;for(var s in a){var l=a[s];if(l.jointName){var c=l.children;for(i=0;i<c.length;i++){var u=e.nodes[c[i]];if(u.jointName&&u.jointName===n){var _=m(l),h=new o.Bone(l.name||"",r,g(e,t,l.jointName,r),_);return h.id=s,h}}}}return null},v=function(e,t){for(var n=0;n<e.length;n++)for(var r=e[n],i=0;i<r.node.children.length;i++){if(r.node.children[i]===t)return r.bone}return null},b=function(e,t){var n=e.nodes,r=n[t];if(r)return{node:r,id:t};for(var i in n)if((r=n[i]).jointName===t)return{node:r,id:i};return null},y=function(e,t){for(var n=0;n<e.jointNames.length;n++)if(e.jointNames[n]===t)return!0;return!1},x=function(e,t,n,r,i){if(r||(r=new o.Skeleton(t.name||"","",e.scene)),!t.babylonSkeleton)return r;var a=[],s=[];!function(e,t,n,r){for(var i in e.nodes){var a=e.nodes[i],s=i;if(a.jointName&&!y(n,a.jointName)){var l=m(a),c=new o.Bone(a.name||"",t,null,l);c.id=s,r.push({bone:c,node:a,id:s})}}for(var u=0;u<r.length;u++)for(var _=r[u],h=_.node.children,f=0;f<h.length;f++){for(var d=null,p=0;p<r.length;p++)if(r[p].id===h[f]){d=r[p];break}d&&(d.bone._parent=_.bone,_.bone.children.push(d.bone))}}(e,r,t,a),r.bones=[];for(var l=0;l<t.jointNames.length;l++){if(C=b(e,t.jointNames[l])){var c=C.node;if(c){i=C.id;var u=e.scene.getBoneById(i);if(u)r.bones.push(u);else{for(var _=!1,h=null,f=0;f<l;f++){var d=b(e,t.jointNames[f]);if(d){var p=d.node;if(p){var x=p.children;if(x){_=!1;for(var T=0;T<x.length;T++)if(x[T]===i){h=g(e,t,t.jointNames[f],r),_=!0;break}if(_)break}}else o.Tools.Warn("Joint named "+t.jointNames[f]+" does not exist when looking for parent")}}var O=m(c);!h&&a.length>0&&(h=v(a,i))&&-1===s.indexOf(h)&&s.push(h),new o.Bone(c.jointName||"",r,h,O).id=i}}else o.Tools.Warn("Joint named "+t.jointNames[l]+" does not exist")}}var P=r.bones;r.bones=[];for(l=0;l<t.jointNames.length;l++){var C;if(C=b(e,t.jointNames[l]))for(f=0;f<P.length;f++)if(P[f].id===C.id){r.bones.push(P[f]);break}}r.prepare();for(l=0;l<s.length;l++)r.bones.push(s[l]);return r},T=function(e,t,n,r,i){if(i||(e.scene._blockEntityCollection=!!e.assetContainer,(i=new o.Mesh(t.name||"",e.scene))._parentContainer=e.assetContainer,e.scene._blockEntityCollection=!1,i.id=r),!t.babylonNode)return i;for(var l,c=[],u=null,_=new Array,h=new Array,f=new Array,p=new Array,m=0;m<n.length;m++){var g=n[m];if(R=e.meshes[g])for(var v=0;v<R.primitives.length;v++){var b=new o.VertexData,y=R.primitives[v];y.mode;var x=y.attributes,T=null,O=null;for(var P in x)if(T=e.accessors[x[P]],O=a.GLTFUtils.GetBufferFromAccessor(e,T),"NORMAL"===P)b.normals=new Float32Array(O.length),b.normals.set(O);else if("POSITION"===P){if(s.GLTFFileLoader.HomogeneousCoordinates){b.positions=new Float32Array(O.length-O.length/4);for(var C=0;C<O.length;C+=4)b.positions[C]=O[C],b.positions[C+1]=O[C+1],b.positions[C+2]=O[C+2]}else b.positions=new Float32Array(O.length),b.positions.set(O);h.push(b.positions.length)}else if(-1!==P.indexOf("TEXCOORD_")){var S=Number(P.split("_")[1]),M=o.VertexBuffer.UVKind+(0===S?"":S+1),E=new Float32Array(O.length);E.set(O),d(E),b.set(E,M)}else"JOINT"===P?(b.matricesIndices=new Float32Array(O.length),b.matricesIndices.set(O)):"WEIGHT"===P?(b.matricesWeights=new Float32Array(O.length),b.matricesWeights.set(O)):"COLOR"===P&&(b.colors=new Float32Array(O.length),b.colors.set(O));if(T=e.accessors[y.indices])O=a.GLTFUtils.GetBufferFromAccessor(e,T),b.indices=new Int32Array(O.length),b.indices.set(O),p.push(b.indices.length);else{var A=[];for(C=0;C<b.positions.length/3;C++)A.push(C);b.indices=new Int32Array(A),p.push(b.indices.length)}u?u.merge(b):u=b;var B=e.scene.getMaterialById(y.material);c.push(null===B?a.GLTFUtils.GetDefaultMaterial(e.scene):B),_.push(0===_.length?0:_[_.length-1]+h[h.length-2]),f.push(0===f.length?0:f[f.length-1]+p[p.length-2])}}e.scene._blockEntityCollection=!!e.assetContainer,c.length>1?(l=new o.MultiMaterial("multimat"+r,e.scene)).subMaterials=c:l=new o.StandardMaterial("multimat"+r,e.scene),1===c.length&&(l=c[0]),l._parentContainer=e.assetContainer,i.material||(i.material=l),new o.Geometry(r,e.scene,u,!1,i),i.computeWorldMatrix(!0),e.scene._blockEntityCollection=!1,i.subMeshes=[];var F=0;for(m=0;m<n.length;m++){var R;g=n[m];if(R=e.meshes[g])for(v=0;v<R.primitives.length;v++)R.primitives[v].mode,o.SubMesh.AddToMesh(F,_[F],h[F],f[F],p[F],i,i,!0),F++}return i},O=function(e,t,n,r){e.position&&(e.position=t),(e.rotationQuaternion||e.rotation)&&(e.rotationQuaternion=n),e.scaling&&(e.scaling=r)},P=function(e,t,n,r){var i=null;if(e.importOnlyMeshes&&(t.skin||t.meshes)&&e.importMeshesNames&&e.importMeshesNames.length>0&&-1===e.importMeshesNames.indexOf(t.name||""))return null;if(t.skin){if(t.meshes){var a=e.skins[t.skin];(s=T(e,t,t.meshes,n,t.babylonNode)).skeleton=e.scene.getLastSkeletonById(t.skin),null===s.skeleton&&(s.skeleton=x(e,a,0,a.babylonSkeleton,t.skin),a.babylonSkeleton||(a.babylonSkeleton=s.skeleton)),i=s}}else if(t.meshes){var s;i=s=T(e,t,t.mesh?[t.mesh]:t.meshes,n,t.babylonNode)}else if(!t.light||t.babylonNode||e.importOnlyMeshes){if(t.camera&&!t.babylonNode&&!e.importOnlyMeshes){var l=e.cameras[t.camera];if(l){if(e.scene._blockEntityCollection=!!e.assetContainer,"orthographic"===l.type){var c=new o.FreeCamera(t.camera,o.Vector3.Zero(),e.scene,!1);c.name=t.name||"",c.mode=o.Camera.ORTHOGRAPHIC_CAMERA,c.attachControl(),i=c,c._parentContainer=e.assetContainer}else if("perspective"===l.type){var u=l[l.type],_=new o.FreeCamera(t.camera,o.Vector3.Zero(),e.scene,!1);_.name=t.name||"",_.attachControl(),u.aspectRatio||(u.aspectRatio=e.scene.getEngine().getRenderWidth()/e.scene.getEngine().getRenderHeight()),u.znear&&u.zfar&&(_.maxZ=u.zfar,_.minZ=u.znear),i=_,_._parentContainer=e.assetContainer}e.scene._blockEntityCollection=!1}}}else{var h=e.lights[t.light];if(h)if("ambient"===h.type){var f=h[h.type],d=new o.HemisphericLight(t.light,o.Vector3.Zero(),e.scene);d.name=t.name||"",f.color&&(d.diffuse=o.Color3.FromArray(f.color)),i=d}else if("directional"===h.type){var p=h[h.type],m=new o.DirectionalLight(t.light,o.Vector3.Zero(),e.scene);m.name=t.name||"",p.color&&(m.diffuse=o.Color3.FromArray(p.color)),i=m}else if("point"===h.type){var g=h[h.type],v=new o.PointLight(t.light,o.Vector3.Zero(),e.scene);v.name=t.name||"",g.color&&(v.diffuse=o.Color3.FromArray(g.color)),i=v}else if("spot"===h.type){var b=h[h.type],y=new o.SpotLight(t.light,o.Vector3.Zero(),o.Vector3.Zero(),0,0,e.scene);y.name=t.name||"",b.color&&(y.diffuse=o.Color3.FromArray(b.color)),b.fallOfAngle&&(y.angle=b.fallOfAngle),b.fallOffExponent&&(y.exponent=b.fallOffExponent),i=y}}if(!t.jointName){if(t.babylonNode)return t.babylonNode;if(null===i){e.scene._blockEntityCollection=!!e.assetContainer;var P=new o.Mesh(t.name||"",e.scene);P._parentContainer=e.assetContainer,e.scene._blockEntityCollection=!1,t.babylonNode=P,i=P}}if(null!==i){if(t.matrix&&i instanceof o.Mesh)!function(e,t,n){if(t.matrix){var r=new o.Vector3(0,0,0),i=new o.Quaternion,a=new o.Vector3(0,0,0);o.Matrix.FromArray(t.matrix).decompose(a,i,r),O(e,r,i,a)}else t.translation&&t.rotation&&t.scale&&O(e,o.Vector3.FromArray(t.translation),o.Quaternion.FromArray(t.rotation),o.Vector3.FromArray(t.scale));e.computeWorldMatrix(!0)}(i,t);else{var C=t.translation||[0,0,0],S=t.rotation||[0,0,0,1],M=t.scale||[1,1,1];O(i,o.Vector3.FromArray(C),o.Quaternion.FromArray(S),o.Vector3.FromArray(M))}i.updateCache(!0),t.babylonNode=i}return i},C=function(e,t,n,r){void 0===r&&(r=!1);var i=e.nodes[t],o=null;if(r=!(e.importOnlyMeshes&&!r&&e.importMeshesNames)||(-1!==e.importMeshesNames.indexOf(i.name||"")||0===e.importMeshesNames.length),!i.jointName&&r&&null!==(o=P(e,i,t))&&(o.id=t,o.parent=n),i.children)for(var a=0;a<i.children.length;a++)C(e,i.children[a],o,r)},S=function(e){var t=e.currentScene;if(t)for(var n=0;n<t.nodes.length;n++)C(e,t.nodes[n],null);else for(var r in e.scenes){t=e.scenes[r];for(n=0;n<t.nodes.length;n++)C(e,t.nodes[n],null)}!function(e){for(var t in e.animations){var n=e.animations[t];if(n.channels&&n.samplers)for(var r=null,i=0;i<n.channels.length;i++){var s=n.channels[i],l=n.samplers[s.sampler];if(l){var c=null,u=null;n.parameters?(c=n.parameters[l.input],u=n.parameters[l.output]):(c=l.input,u=l.output);var f=a.GLTFUtils.GetBufferFromAccessor(e,e.accessors[c]),d=a.GLTFUtils.GetBufferFromAccessor(e,e.accessors[u]),p=s.target.id,m=e.scene.getNodeById(p);if(null===m&&(m=e.scene.getNodeByName(p)),null!==m){var g=m instanceof o.Bone,v=s.target.path,b=_.indexOf(v);-1!==b&&(v=h[b]);var y=o.Animation.ANIMATIONTYPE_MATRIX;g||("rotationQuaternion"===v?(y=o.Animation.ANIMATIONTYPE_QUATERNION,m.rotationQuaternion=new o.Quaternion):y=o.Animation.ANIMATIONTYPE_VECTOR3);var x=null,T=[],O=0,P=!1;g&&r&&r.getKeys().length===f.length&&(x=r,P=!0),P||(e.scene._blockEntityCollection=!!e.assetContainer,x=new o.Animation(t,g?"_matrix":v,1,y,o.Animation.ANIMATIONLOOPMODE_CYCLE),e.scene._blockEntityCollection=!1);for(var C=0;C<f.length;C++){var S=null;if("rotationQuaternion"===v?(S=o.Quaternion.FromArray([d[O],d[O+1],d[O+2],d[O+3]]),O+=4):(S=o.Vector3.FromArray([d[O],d[O+1],d[O+2]]),O+=3),g){var M=m,E=o.Vector3.Zero(),A=new o.Quaternion,B=o.Vector3.Zero(),F=M.getBaseMatrix();P&&r&&(F=r.getKeys()[C].value),F.decompose(B,A,E),"position"===v?E=S:"rotationQuaternion"===v?A=S:B=S,S=o.Matrix.Compose(B,A,E)}P?r&&(r.getKeys()[C].value=S):T.push({frame:f[C],value:S})}!P&&x&&(x.setKeys(T),m.animations.push(x)),r=x,e.scene.stopAnimation(m),e.scene.beginAnimation(m,0,f[f.length-1],!0,1)}else o.Tools.Warn("Creating animation named "+t+". But cannot find node named "+p+" to attach to")}}}}(e);for(n=0;n<e.scene.skeletons.length;n++){var i=e.scene.skeletons[n];e.scene.beginAnimation(i,0,Number.MAX_VALUE,!0,1)}},M=function(e,t,n,r,o,s){return function(l){!function(e,t,n,r,o){var s=r.values||n.parameters,l=n.uniforms;for(var c in o){var u=o[c],_=u.type,h=s[l[c]];if(void 0===h&&(h=u.value),h){var f=function(e){return function(n){u.value&&e&&(t.setTexture(e,n),delete o[e])}};_===i.EParameterType.SAMPLER_2D?R.LoadTextureAsync(e,r.values?h:u.value,f(c),function(){return f(null)}):u.value&&a.GLTFUtils.SetUniform(t,c,r.values?h:u.value,_)&&delete o[c]}}}(e,t,n,r,o),t.onBind=function(l){!function(e,t,n,r,o,s,l){var c=s.values||o.parameters;for(var u in n){var _=n[u],h=_.type;if(h===i.EParameterType.FLOAT_MAT2||h===i.EParameterType.FLOAT_MAT3||h===i.EParameterType.FLOAT_MAT4)if(!_.semantic||_.source||_.node){if(_.semantic&&(_.source||_.node)){var f=t.scene.getNodeByName(_.source||_.node||"");if(null===f&&(f=t.scene.getNodeById(_.source||_.node||"")),null===f)continue;a.GLTFUtils.SetMatrix(t.scene,f,_,u,r.getEffect())}}else a.GLTFUtils.SetMatrix(t.scene,e,_,u,r.getEffect());else{var d=c[o.uniforms[u]];if(!d)continue;if(h===i.EParameterType.SAMPLER_2D){var p=t.textures[s.values?d:_.value].babylonTexture;if(null==p)continue;r.getEffect().setTexture(u,p)}else a.GLTFUtils.SetUniform(r.getEffect(),u,d,h)}}l(r)}(l,e,o,t,n,r,s)}}},E=function(e,t,n){for(var r in t.uniforms){var i=t.uniforms[r],o=t.parameters[i];if(e.currentIdentifier===r&&o.semantic&&!o.source&&!o.node){var a=c.indexOf(o.semantic);if(-1!==a)return delete n[r],u[a]}}return e.currentIdentifier},A=function(e){for(var t in e.materials)R.LoadMaterialAsync(e,t,function(e){},function(){})},B=function(){function e(){}return e.CreateRuntime=function(e,t,n){var r={extensions:{},accessors:{},buffers:{},bufferViews:{},meshes:{},lights:{},cameras:{},nodes:{},images:{},textures:{},shaders:{},programs:{},samplers:{},techniques:{},materials:{},animations:{},skins:{},extensionsUsed:[],scenes:{},buffersCount:0,shaderscount:0,scene:t,rootUrl:n,loadedBufferCount:0,loadedBufferViews:{},loadedShaderCount:0,importOnlyMeshes:!1,dummyNodes:[],assetContainer:null};return e.extensions&&f(e.extensions,"extensions",r),e.extensionsUsed&&f(e.extensionsUsed,"extensionsUsed",r),e.buffers&&function(e,t){for(var n in e){var r=e[n];t.buffers[n]=r,t.buffersCount++}}(e.buffers,r),e.bufferViews&&f(e.bufferViews,"bufferViews",r),e.accessors&&f(e.accessors,"accessors",r),e.meshes&&f(e.meshes,"meshes",r),e.lights&&f(e.lights,"lights",r),e.cameras&&f(e.cameras,"cameras",r),e.nodes&&f(e.nodes,"nodes",r),e.images&&f(e.images,"images",r),e.textures&&f(e.textures,"textures",r),e.shaders&&function(e,t){for(var n in e){var r=e[n];t.shaders[n]=r,t.shaderscount++}}(e.shaders,r),e.programs&&f(e.programs,"programs",r),e.samplers&&f(e.samplers,"samplers",r),e.techniques&&f(e.techniques,"techniques",r),e.materials&&f(e.materials,"materials",r),e.animations&&f(e.animations,"animations",r),e.skins&&f(e.skins,"skins",r),e.scenes&&(r.scenes=e.scenes),e.scene&&e.scenes&&(r.currentScene=e.scenes[e.scene]),r},e.LoadBufferAsync=function(e,t,n,r,i){var a=e.buffers[t];o.Tools.IsBase64(a.uri)?setTimeout(function(){return n(new Uint8Array(o.Tools.DecodeBase64(a.uri)))}):o.Tools.LoadFile(e.rootUrl+a.uri,function(e){return n(new Uint8Array(e))},i,void 0,!0,function(e){e&&r(e.status+" "+e.statusText)})},e.LoadTextureBufferAsync=function(e,t,n,r){var i=e.textures[t];if(i&&i.source)if(i.babylonTexture)n(null);else{var a=e.images[i.source];o.Tools.IsBase64(a.uri)?setTimeout(function(){return n(new Uint8Array(o.Tools.DecodeBase64(a.uri)))}):o.Tools.LoadFile(e.rootUrl+a.uri,function(e){return n(new Uint8Array(e))},void 0,void 0,!0,function(e){e&&r(e.status+" "+e.statusText)})}else r("")},e.CreateTextureAsync=function(e,t,n,r,s){var l=e.textures[t];if(l.babylonTexture)r(l.babylonTexture);else{var c=e.samplers[l.sampler],u=c.minFilter===i.ETextureFilterType.NEAREST_MIPMAP_NEAREST||c.minFilter===i.ETextureFilterType.NEAREST_MIPMAP_LINEAR||c.minFilter===i.ETextureFilterType.LINEAR_MIPMAP_NEAREST||c.minFilter===i.ETextureFilterType.LINEAR_MIPMAP_LINEAR,_=o.Texture.BILINEAR_SAMPLINGMODE,h=null==n?new Blob:new Blob([n]),f=URL.createObjectURL(h),d=function(){return URL.revokeObjectURL(f)},p=new o.Texture(f,e.scene,!u,!0,_,d,d);void 0!==c.wrapS&&(p.wrapU=a.GLTFUtils.GetWrapMode(c.wrapS)),void 0!==c.wrapT&&(p.wrapV=a.GLTFUtils.GetWrapMode(c.wrapT)),p.name=t,l.babylonTexture=p,r(p)}},e.LoadShaderStringAsync=function(e,t,n,r){var i=e.shaders[t];if(o.Tools.IsBase64(i.uri)){var a=atob(i.uri.split(",")[1]);n&&n(a)}else o.Tools.LoadFile(e.rootUrl+i.uri,n,void 0,void 0,!1,function(e){e&&r&&r(e.status+" "+e.statusText)})},e.LoadMaterialAsync=function(e,t,n,a){var s=e.materials[t];if(s.technique){var _=e.techniques[s.technique];if(!_){e.scene._blockEntityCollection=!!e.assetContainer;var h=new o.StandardMaterial(t,e.scene);return h._parentContainer=e.assetContainer,e.scene._blockEntityCollection=!1,h.diffuseColor=new o.Color3(.5,.5,.5),h.sideOrientation=o.Material.CounterClockWiseSideOrientation,void n(h)}var f=e.programs[_.program],d=_.states,m=o.Effect.ShadersStore[f.vertexShader+"VertexShader"],g=o.Effect.ShadersStore[f.fragmentShader+"PixelShader"],v="",b="",y=new l(m),x=new l(g),T={},O=[],P=[],C=[];for(var S in _.uniforms){var A=_.uniforms[S],B=_.parameters[A];if(T[S]=B,!B.semantic||B.node||B.source)B.type===i.EParameterType.SAMPLER_2D?C.push(S):O.push(S);else{var F=c.indexOf(B.semantic);-1!==F?(O.push(u[F]),delete T[S]):O.push(S)}}for(var R in _.attributes){var L=_.attributes[R];if((D=_.parameters[L]).semantic){var w=p(D);w&&P.push(w)}}for(;!y.isEnd()&&y.getNextToken();){if(y.currentToken===r.IDENTIFIER){var I=!1;for(var R in _.attributes){L=_.attributes[R];var D=_.parameters[L];if(y.currentIdentifier===R&&D.semantic){v+=p(D),I=!0;break}}I||(v+=E(y,_,T))}else v+=y.currentString}for(;!x.isEnd()&&x.getNextToken();){x.currentToken===r.IDENTIFIER?b+=E(x,_,T):b+=x.currentString}var N={vertex:f.vertexShader+t,fragment:f.fragmentShader+t},V={attributes:P,uniforms:O,samplers:C,needAlphaBlending:d&&d.enable&&-1!==d.enable.indexOf(3042)};o.Effect.ShadersStore[f.vertexShader+t+"VertexShader"]=v,o.Effect.ShadersStore[f.fragmentShader+t+"PixelShader"]=b;var j=new o.ShaderMaterial(t,e.scene,N,V);if(j.onError=function(e,t,n){return function(r,i){t.dispose(!0),n("Cannot compile program named "+e.name+". Error: "+i+". Default material will be applied")}}(f,j,a),j.onCompiled=M(e,j,_,s,T,n),j.sideOrientation=o.Material.CounterClockWiseSideOrientation,d&&d.functions){var k=d.functions;k.cullFace&&k.cullFace[0]!==i.ECullingType.BACK&&(j.backFaceCulling=!1);var z=k.blendFuncSeparate;z&&(z[0]===i.EBlendingFunction.SRC_ALPHA&&z[1]===i.EBlendingFunction.ONE_MINUS_SRC_ALPHA&&z[2]===i.EBlendingFunction.ONE&&z[3]===i.EBlendingFunction.ONE?j.alphaMode=o.Constants.ALPHA_COMBINE:z[0]===i.EBlendingFunction.ONE&&z[1]===i.EBlendingFunction.ONE&&z[2]===i.EBlendingFunction.ZERO&&z[3]===i.EBlendingFunction.ONE?j.alphaMode=o.Constants.ALPHA_ONEONE:z[0]===i.EBlendingFunction.SRC_ALPHA&&z[1]===i.EBlendingFunction.ONE&&z[2]===i.EBlendingFunction.ZERO&&z[3]===i.EBlendingFunction.ONE?j.alphaMode=o.Constants.ALPHA_ADD:z[0]===i.EBlendingFunction.ZERO&&z[1]===i.EBlendingFunction.ONE_MINUS_SRC_COLOR&&z[2]===i.EBlendingFunction.ONE&&z[3]===i.EBlendingFunction.ONE?j.alphaMode=o.Constants.ALPHA_SUBTRACT:z[0]===i.EBlendingFunction.DST_COLOR&&z[1]===i.EBlendingFunction.ZERO&&z[2]===i.EBlendingFunction.ONE&&z[3]===i.EBlendingFunction.ONE?j.alphaMode=o.Constants.ALPHA_MULTIPLY:z[0]===i.EBlendingFunction.SRC_ALPHA&&z[1]===i.EBlendingFunction.ONE_MINUS_SRC_COLOR&&z[2]===i.EBlendingFunction.ONE&&z[3]===i.EBlendingFunction.ONE&&(j.alphaMode=o.Constants.ALPHA_MAXIMIZED))}}else a&&a("No technique found.")},e}(),F=function(){function e(){}return e.RegisterExtension=function(t){e.Extensions[t.name]?o.Tools.Error('Tool with the same name "'+t.name+'" already exists'):e.Extensions[t.name]=t},e.prototype.dispose=function(){},e.prototype._importMeshAsync=function(e,t,n,r,i,a,l,c){var u=this;return t.useRightHandedSystem=!0,R.LoadRuntimeAsync(t,n,r,function(t){t.assetContainer=i,t.importOnlyMeshes=!0,""===e?t.importMeshesNames=[]:"string"==typeof e?t.importMeshesNames=[e]:!e||e instanceof Array?(t.importMeshesNames=[],o.Tools.Warn("Argument meshesNames must be of type string or string[]")):t.importMeshesNames=[e],u._createNodes(t);var n=new Array,r=new Array;for(var c in t.nodes){var _=t.nodes[c];_.babylonNode instanceof o.AbstractMesh&&n.push(_.babylonNode)}for(var h in t.skins){var f=t.skins[h];f.babylonSkeleton instanceof o.Skeleton&&r.push(f.babylonSkeleton)}u._loadBuffersAsync(t,function(){u._loadShadersAsync(t,function(){A(t),S(t),!s.GLTFFileLoader.IncrementalLoading&&a&&a(n,r)})},l),s.GLTFFileLoader.IncrementalLoading&&a&&a(n,r)},c),!0},e.prototype.importMeshAsync=function(e,t,n,r,i,o){var a=this;return new Promise(function(s,l){a._importMeshAsync(e,t,r,i,n,function(e,t){s({meshes:e,particleSystems:[],skeletons:t,animationGroups:[],lights:[],transformNodes:[],geometries:[]})},o,function(e){l(new Error(e))})})},e.prototype._loadAsync=function(e,t,n,r,i,o){var a=this;e.useRightHandedSystem=!0,R.LoadRuntimeAsync(e,t,n,function(e){R.LoadRuntimeExtensionsAsync(e,function(){a._createNodes(e),a._loadBuffersAsync(e,function(){a._loadShadersAsync(e,function(){A(e),S(e),s.GLTFFileLoader.IncrementalLoading||r()})}),s.GLTFFileLoader.IncrementalLoading&&r()},o)},o)},e.prototype.loadAsync=function(e,t,n,r){var i=this;return new Promise(function(o,a){i._loadAsync(e,t,n,function(){o()},r,function(e){a(new Error(e))})})},e.prototype._loadShadersAsync=function(e,t){var n=!1,r=function(n,r){R.LoadShaderStringAsync(e,n,function(a){a instanceof ArrayBuffer||(e.loadedShaderCount++,a&&(o.Effect.ShadersStore[n+(r.type===i.EShaderType.VERTEX?"VertexShader":"PixelShader")]=a),e.loadedShaderCount===e.shaderscount&&t())},function(){o.Tools.Error("Error when loading shader program named "+n+" located at "+r.uri)})};for(var a in e.shaders){n=!0;var s=e.shaders[a];s?r.bind(this,a,s)():o.Tools.Error("No shader named: "+a)}n||t()},e.prototype._loadBuffersAsync=function(e,t,n){var r=!1,i=function(n,r){R.LoadBufferAsync(e,n,function(i){e.loadedBufferCount++,i&&(i.byteLength!=e.buffers[n].byteLength&&o.Tools.Error("Buffer named "+n+" is length "+i.byteLength+". Expected: "+r.byteLength),e.loadedBufferViews[n]=i),e.loadedBufferCount===e.buffersCount&&t()},function(){o.Tools.Error("Error when loading buffer named "+n+" located at "+r.uri)})};for(var a in e.buffers){r=!0;var s=e.buffers[a];s?i.bind(this,a,s)():o.Tools.Error("No buffer named: "+a)}r||t()},e.prototype._createNodes=function(e){var t=e.currentScene;if(t)for(var n=0;n<t.nodes.length;n++)C(e,t.nodes[n],null);else for(var r in e.scenes){t=e.scenes[r];for(n=0;n<t.nodes.length;n++)C(e,t.nodes[n],null)}},e.Extensions={},e}(),R=function(){function e(e){this._name=e}return Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),e.prototype.loadRuntimeAsync=function(e,t,n,r,i){return!1},e.prototype.loadRuntimeExtensionsAsync=function(e,t,n){return!1},e.prototype.loadBufferAsync=function(e,t,n,r,i){return!1},e.prototype.loadTextureBufferAsync=function(e,t,n,r){return!1},e.prototype.createTextureAsync=function(e,t,n,r,i){return!1},e.prototype.loadShaderStringAsync=function(e,t,n,r){return!1},e.prototype.loadMaterialAsync=function(e,t,n,r){return!1},e.LoadRuntimeAsync=function(t,n,r,i,o){e.ApplyExtensions(function(e){return e.loadRuntimeAsync(t,n,r,i,o)},function(){setTimeout(function(){i&&i(B.CreateRuntime(n.json,t,r))})})},e.LoadRuntimeExtensionsAsync=function(t,n,r){e.ApplyExtensions(function(e){return e.loadRuntimeExtensionsAsync(t,n,r)},function(){setTimeout(function(){n()})})},e.LoadBufferAsync=function(t,n,r,i,o){e.ApplyExtensions(function(e){return e.loadBufferAsync(t,n,r,i,o)},function(){B.LoadBufferAsync(t,n,r,i,o)})},e.LoadTextureAsync=function(t,n,r,i){e.LoadTextureBufferAsync(t,n,function(o){o&&e.CreateTextureAsync(t,n,o,r,i)},i)},e.LoadShaderStringAsync=function(t,n,r,i){e.ApplyExtensions(function(e){return e.loadShaderStringAsync(t,n,r,i)},function(){B.LoadShaderStringAsync(t,n,r,i)})},e.LoadMaterialAsync=function(t,n,r,i){e.ApplyExtensions(function(e){return e.loadMaterialAsync(t,n,r,i)},function(){B.LoadMaterialAsync(t,n,r,i)})},e.LoadTextureBufferAsync=function(t,n,r,i){e.ApplyExtensions(function(e){return e.loadTextureBufferAsync(t,n,r,i)},function(){B.LoadTextureBufferAsync(t,n,r,i)})},e.CreateTextureAsync=function(t,n,r,i,o){e.ApplyExtensions(function(e){return e.createTextureAsync(t,n,r,i,o)},function(){B.CreateTextureAsync(t,n,r,i,o)})},e.ApplyExtensions=function(e,t){for(var n in F.Extensions){if(e(F.Extensions[n]))return}t()},e}();s.GLTFFileLoader._CreateGLTF1Loader=function(){return new F}},"./glTF/1.0/glTFLoaderInterfaces.ts":function(e,t,n){"use strict";var r,i,o,a,s,l,c,u;n.r(t),n.d(t,"EComponentType",function(){return r}),n.d(t,"EShaderType",function(){return i}),n.d(t,"EParameterType",function(){return o}),n.d(t,"ETextureWrapMode",function(){return a}),n.d(t,"ETextureFilterType",function(){return s}),n.d(t,"ETextureFormat",function(){return l}),n.d(t,"ECullingType",function(){return c}),n.d(t,"EBlendingFunction",function(){return u}),function(e){e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.FLOAT=5126]="FLOAT"}(r||(r={})),function(e){e[e.FRAGMENT=35632]="FRAGMENT",e[e.VERTEX=35633]="VERTEX"}(i||(i={})),function(e){e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D"}(o||(o={})),function(e){e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.REPEAT=10497]="REPEAT"}(a||(a={})),function(e){e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9728]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR"}(s||(s={})),function(e){e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA"}(l||(l={})),function(e){e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK"}(c||(c={})),function(e){e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE"}(u||(u={}))},"./glTF/1.0/glTFLoaderUtils.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"GLTFUtils",function(){return o});var r=n("./glTF/1.0/glTFLoaderInterfaces.ts"),i=n("babylonjs/Misc/observable"),o=function(){function e(){}return e.SetMatrix=function(e,t,n,o,a){var s=null;if("MODEL"===n.semantic?s=t.getWorldMatrix():"PROJECTION"===n.semantic?s=e.getProjectionMatrix():"VIEW"===n.semantic?s=e.getViewMatrix():"MODELVIEWINVERSETRANSPOSE"===n.semantic?s=i.Matrix.Transpose(t.getWorldMatrix().multiply(e.getViewMatrix()).invert()):"MODELVIEW"===n.semantic?s=t.getWorldMatrix().multiply(e.getViewMatrix()):"MODELVIEWPROJECTION"===n.semantic?s=t.getWorldMatrix().multiply(e.getTransformMatrix()):"MODELINVERSE"===n.semantic?s=t.getWorldMatrix().invert():"VIEWINVERSE"===n.semantic?s=e.getViewMatrix().invert():"PROJECTIONINVERSE"===n.semantic?s=e.getProjectionMatrix().invert():"MODELVIEWINVERSE"===n.semantic?s=t.getWorldMatrix().multiply(e.getViewMatrix()).invert():"MODELVIEWPROJECTIONINVERSE"===n.semantic?s=t.getWorldMatrix().multiply(e.getTransformMatrix()).invert():"MODELINVERSETRANSPOSE"===n.semantic&&(s=i.Matrix.Transpose(t.getWorldMatrix().invert())),s)switch(n.type){case r.EParameterType.FLOAT_MAT2:a.setMatrix2x2(o,i.Matrix.GetAsMatrix2x2(s));break;case r.EParameterType.FLOAT_MAT3:a.setMatrix3x3(o,i.Matrix.GetAsMatrix3x3(s));break;case r.EParameterType.FLOAT_MAT4:a.setMatrix(o,s)}},e.SetUniform=function(e,t,n,o){switch(o){case r.EParameterType.FLOAT:return e.setFloat(t,n),!0;case r.EParameterType.FLOAT_VEC2:return e.setVector2(t,i.Vector2.FromArray(n)),!0;case r.EParameterType.FLOAT_VEC3:return e.setVector3(t,i.Vector3.FromArray(n)),!0;case r.EParameterType.FLOAT_VEC4:return e.setVector4(t,i.Vector4.FromArray(n)),!0;default:return!1}},e.GetWrapMode=function(e){switch(e){case r.ETextureWrapMode.CLAMP_TO_EDGE:return i.Texture.CLAMP_ADDRESSMODE;case r.ETextureWrapMode.MIRRORED_REPEAT:return i.Texture.MIRROR_ADDRESSMODE;case r.ETextureWrapMode.REPEAT:default:return i.Texture.WRAP_ADDRESSMODE}},e.GetByteStrideFromType=function(e){switch(e.type){case"VEC2":return 2;case"VEC3":return 3;case"VEC4":case"MAT2":return 4;case"MAT3":return 9;case"MAT4":return 16;default:return 1}},e.GetTextureFilterMode=function(e){switch(e){case r.ETextureFilterType.LINEAR:case r.ETextureFilterType.LINEAR_MIPMAP_NEAREST:case r.ETextureFilterType.LINEAR_MIPMAP_LINEAR:return i.Texture.TRILINEAR_SAMPLINGMODE;case r.ETextureFilterType.NEAREST:case r.ETextureFilterType.NEAREST_MIPMAP_NEAREST:return i.Texture.NEAREST_SAMPLINGMODE;default:return i.Texture.BILINEAR_SAMPLINGMODE}},e.GetBufferFromBufferView=function(e,t,n,i,o){n=t.byteOffset+n;var a=e.loadedBufferViews[t.buffer];if(n+i>a.byteLength)throw new Error("Buffer access is out of range");var s=a.buffer;switch(n+=a.byteOffset,o){case r.EComponentType.BYTE:return new Int8Array(s,n,i);case r.EComponentType.UNSIGNED_BYTE:return new Uint8Array(s,n,i);case r.EComponentType.SHORT:return new Int16Array(s,n,i);case r.EComponentType.UNSIGNED_SHORT:return new Uint16Array(s,n,i);default:return new Float32Array(s,n,i)}},e.GetBufferFromAccessor=function(t,n){var r=t.bufferViews[n.bufferView],i=n.count*e.GetByteStrideFromType(n);return e.GetBufferFromBufferView(t,r,n.byteOffset,i,n.componentType)},e.DecodeBufferToText=function(e){for(var t="",n=e.byteLength,r=0;r<n;++r)t+=String.fromCharCode(e[r]);return t},e.GetDefaultMaterial=function(t){if(!e._DefaultMaterial){i.Effect.ShadersStore.GLTFDefaultMaterialVertexShader=["precision highp float;","","uniform mat4 worldView;","uniform mat4 projection;","","attribute vec3 position;","","void main(void)","{","    gl_Position = projection * worldView * vec4(position, 1.0);","}"].join("\n"),i.Effect.ShadersStore.GLTFDefaultMaterialPixelShader=["precision highp float;","","uniform vec4 u_emission;","","void main(void)","{","    gl_FragColor = u_emission;","}"].join("\n");var n={attributes:["position"],uniforms:["worldView","projection","u_emission"],samplers:new Array,needAlphaBlending:!1};e._DefaultMaterial=new i.ShaderMaterial("GLTFDefaultMaterial",t,{vertex:"GLTFDefaultMaterial",fragment:"GLTFDefaultMaterial"},n),e._DefaultMaterial.setColor4("u_emission",new i.Color4(.5,.5,.5,1))}return e._DefaultMaterial},e._DefaultMaterial=null,e}()},"./glTF/1.0/glTFMaterialsCommonExtension.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"GLTFMaterialsCommonExtension",function(){return a});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("./glTF/1.0/glTFLoader.ts"),o=n("babylonjs/Misc/observable"),a=function(e){function t(){return e.call(this,"KHR_materials_common")||this}return Object(r.__extends)(t,e),t.prototype.loadRuntimeExtensionsAsync=function(e,t,n){if(!e.extensions)return!1;var r=e.extensions[this.name];if(!r)return!1;var i=r.lights;if(i)for(var a in i){var s=i[a];switch(s.type){case"ambient":var l=new o.HemisphericLight(s.name,new o.Vector3(0,1,0),e.scene),c=s.ambient;c&&(l.diffuse=o.Color3.FromArray(c.color||[1,1,1]));break;case"point":var u=new o.PointLight(s.name,new o.Vector3(10,10,10),e.scene),_=s.point;_&&(u.diffuse=o.Color3.FromArray(_.color||[1,1,1]));break;case"directional":var h=new o.DirectionalLight(s.name,new o.Vector3(0,-1,0),e.scene),f=s.directional;f&&(h.diffuse=o.Color3.FromArray(f.color||[1,1,1]));break;case"spot":var d=s.spot;if(d)new o.SpotLight(s.name,new o.Vector3(0,10,0),new o.Vector3(0,-1,0),d.fallOffAngle||Math.PI,d.fallOffExponent||0,e.scene).diffuse=o.Color3.FromArray(d.color||[1,1,1]);break;default:o.Tools.Warn('GLTF Material Common extension: light type "'+s.type+" not supported")}}return!1},t.prototype.loadMaterialAsync=function(e,t,n,r){var i=e.materials[t];if(!i||!i.extensions)return!1;var a=i.extensions[this.name];if(!a)return!1;var s=new o.StandardMaterial(t,e.scene);return s.sideOrientation=o.Material.CounterClockWiseSideOrientation,"CONSTANT"===a.technique&&(s.disableLighting=!0),s.backFaceCulling=void 0!==a.doubleSided&&!a.doubleSided,s.alpha=void 0===a.values.transparency?1:a.values.transparency,s.specularPower=void 0===a.values.shininess?0:a.values.shininess,"string"==typeof a.values.ambient?this._loadTexture(e,a.values.ambient,s,"ambientTexture",r):s.ambientColor=o.Color3.FromArray(a.values.ambient||[0,0,0]),"string"==typeof a.values.diffuse?this._loadTexture(e,a.values.diffuse,s,"diffuseTexture",r):s.diffuseColor=o.Color3.FromArray(a.values.diffuse||[0,0,0]),"string"==typeof a.values.emission?this._loadTexture(e,a.values.emission,s,"emissiveTexture",r):s.emissiveColor=o.Color3.FromArray(a.values.emission||[0,0,0]),"string"==typeof a.values.specular?this._loadTexture(e,a.values.specular,s,"specularTexture",r):s.specularColor=o.Color3.FromArray(a.values.specular||[0,0,0]),!0},t.prototype._loadTexture=function(e,t,n,r,o){i.GLTFLoaderBase.LoadTextureBufferAsync(e,t,function(a){i.GLTFLoaderBase.CreateTextureAsync(e,t,a,function(e){return n[r]=e},o)},o)},t}(i.GLTFLoaderExtension);i.GLTFLoader.RegisterExtension(new a)},"./glTF/1.0/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./glTF/1.0/glTFBinaryExtension.ts");n.d(t,"GLTFBinaryExtension",function(){return r.GLTFBinaryExtension});var i=n("./glTF/1.0/glTFLoader.ts");n.d(t,"GLTFLoaderBase",function(){return i.GLTFLoaderBase}),n.d(t,"GLTFLoader",function(){return i.GLTFLoader}),n.d(t,"GLTFLoaderExtension",function(){return i.GLTFLoaderExtension});var o=n("./glTF/1.0/glTFLoaderInterfaces.ts");n.d(t,"EComponentType",function(){return o.EComponentType}),n.d(t,"EShaderType",function(){return o.EShaderType}),n.d(t,"EParameterType",function(){return o.EParameterType}),n.d(t,"ETextureWrapMode",function(){return o.ETextureWrapMode}),n.d(t,"ETextureFilterType",function(){return o.ETextureFilterType}),n.d(t,"ETextureFormat",function(){return o.ETextureFormat}),n.d(t,"ECullingType",function(){return o.ECullingType}),n.d(t,"EBlendingFunction",function(){return o.EBlendingFunction});var a=n("./glTF/1.0/glTFLoaderUtils.ts");n.d(t,"GLTFUtils",function(){return a.GLTFUtils});var s=n("./glTF/1.0/glTFMaterialsCommonExtension.ts");n.d(t,"GLTFMaterialsCommonExtension",function(){return s.GLTFMaterialsCommonExtension})},"./glTF/2.0/Extensions/EXT_lights_image_based.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"EXT_lights_image_based",function(){return a});var r=n("babylonjs/Misc/observable"),i=n("./glTF/2.0/glTFLoader.ts"),o="EXT_lights_image_based",a=function(){function e(e){this.name=o,this._loader=e,this.enabled=this._loader.isExtensionUsed(o)}return e.prototype.dispose=function(){this._loader=null,delete this._lights},e.prototype.onLoading=function(){var e=this._loader.gltf.extensions;if(e&&e[this.name]){var t=e[this.name];this._lights=t.lights}},e.prototype.loadSceneAsync=function(e,t){var n=this;return i.GLTFLoader.LoadExtensionAsync(e,t,this.name,function(r,o){var a=new Array;a.push(n._loader.loadSceneAsync(e,t)),n._loader.logOpen(""+r);var s=i.ArrayItem.Get(r+"/light",n._lights,o.light);return a.push(n._loadLightAsync("/extensions/"+n.name+"/lights/"+o.light,s).then(function(e){n._loader.babylonScene.environmentTexture=e})),n._loader.logClose(),Promise.all(a).then(function(){})})},e.prototype._loadLightAsync=function(e,t){var n=this;if(!t._loaded){var o=new Array;this._loader.logOpen(""+e);for(var a=new Array(t.specularImages.length),s=function(n){var r=t.specularImages[n];a[n]=new Array(r.length);for(var s=function(t){var s=e+"/specularImages/"+n+"/"+t;l._loader.logOpen(""+s);var c=r[t],u=i.ArrayItem.Get(s,l._loader.gltf.images,c);o.push(l._loader.loadImageAsync("/images/"+c,u).then(function(e){a[n][t]=e})),l._loader.logClose()},c=0;c<r.length;c++)s(c)},l=this,c=0;c<t.specularImages.length;c++)s(c);this._loader.logClose(),t._loaded=Promise.all(o).then(function(){var i=new r.RawCubeTexture(n._loader.babylonScene,null,t.specularImageSize);if(i.name=t.name||"environment",t._babylonTexture=i,null!=t.intensity&&(i.level=t.intensity),t.rotation){var o=r.Quaternion.FromArray(t.rotation);n._loader.babylonScene.useRightHandedSystem||(o=r.Quaternion.Inverse(o)),r.Matrix.FromQuaternionToRef(o,i.getReflectionTextureMatrix())}if(!t.irradianceCoefficients)throw new Error(e+": Irradiance coefficients are missing");var s=r.SphericalHarmonics.FromArray(t.irradianceCoefficients);s.scaleInPlace(t.intensity),s.convertIrradianceToLambertianRadiance();var l=r.SphericalPolynomial.FromHarmonics(s),c=(a.length-1)/r.Scalar.Log2(t.specularImageSize);return i.updateRGBDAsync(a,l,c)})}return t._loaded.then(function(){return t._babylonTexture})},e}();i.GLTFLoader.RegisterExtension(o,function(e){return new a(e)})},"./glTF/2.0/Extensions/EXT_mesh_gpu_instancing.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"EXT_mesh_gpu_instancing",function(){return a});var r=n("babylonjs/Misc/observable"),i=n("./glTF/2.0/glTFLoader.ts"),o="EXT_mesh_gpu_instancing",a=function(){function e(e){this.name=o,this._loader=e,this.enabled=this._loader.isExtensionUsed(o)}return e.prototype.dispose=function(){this._loader=null},e.prototype.loadNodeAsync=function(e,t,n){var o=this;return i.GLTFLoader.LoadExtensionAsync(e,t,this.name,function(e,a){o._loader._disableInstancedMesh++;var s=o._loader.loadNodeAsync("/nodes/"+t.index,t,n);if(o._loader._disableInstancedMesh--,!t._primitiveBabylonMeshes)return s;var l=new Array,c=0,u=function(t){if(null!=a.attributes[t]){var n=i.ArrayItem.Get(e+"/attributes/"+t,o._loader.gltf.accessors,a.attributes[t]);if(l.push(o._loader._loadFloatAccessorAsync("/accessors/"+n.bufferView,n)),0===c)c=n.count;else if(c!==n.count)throw new Error(e+"/attributes: Instance buffer accessors do not have the same count.")}else l.push(Promise.resolve(null))};return u("TRANSLATION"),u("ROTATION"),u("SCALE"),s.then(function(e){return Promise.all(l).then(function(n){var i=n[0],o=n[1],a=n[2],s=new Float32Array(16*c);r.TmpVectors.Vector3[0].copyFromFloats(0,0,0),r.TmpVectors.Quaternion[0].copyFromFloats(0,0,0,1),r.TmpVectors.Vector3[1].copyFromFloats(1,1,1);for(var l=0;l<c;++l)i&&r.Vector3.FromArrayToRef(i,3*l,r.TmpVectors.Vector3[0]),o&&r.Quaternion.FromArrayToRef(o,4*l,r.TmpVectors.Quaternion[0]),a&&r.Vector3.FromArrayToRef(a,3*l,r.TmpVectors.Vector3[1]),r.Matrix.ComposeToRef(r.TmpVectors.Vector3[1],r.TmpVectors.Quaternion[0],r.TmpVectors.Vector3[0],r.TmpVectors.Matrix[0]),r.TmpVectors.Matrix[0].copyToArray(s,16*l);for(var u=0,_=t._primitiveBabylonMeshes;u<_.length;u++){_[u].thinInstanceSetBuffer("matrix",s,16,!0)}return e})})})},e}();i.GLTFLoader.RegisterExtension(o,function(e){return new a(e)})},"./glTF/2.0/Extensions/EXT_meshopt_compression.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"EXT_meshopt_compression",function(){return a});var r=n("./glTF/2.0/glTFLoader.ts"),i=n("babylonjs/Misc/observable"),o="EXT_meshopt_compression",a=function(){function e(e){this.name=o,this.enabled=e.isExtensionUsed(o),this._loader=e}return e.prototype.dispose=function(){this._loader=null},e.prototype.loadBufferViewAsync=function(e,t){var n=this;return r.GLTFLoader.LoadExtensionAsync(e,t,this.name,function(o,a){var s=t;if(s._meshOptData)return s._meshOptData;var l=r.ArrayItem.Get(e+"/buffer",n._loader.gltf.buffers,a.buffer);return s._meshOptData=n._loader.loadBufferAsync("/buffers/"+l.index,l,a.byteOffset||0,a.byteLength).then(function(e){return i.MeshoptCompression.Default.decodeGltfBufferAsync(e,a.count,a.byteStride,a.mode,a.filter)}),s._meshOptData})},e}();r.GLTFLoader.RegisterExtension(o,function(e){return new a(e)})},"./glTF/2.0/Extensions/EXT_texture_webp.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"EXT_texture_webp",function(){return o});var r=n("./glTF/2.0/glTFLoader.ts"),i="EXT_texture_webp",o=function(){function e(e){this.name=i,this._loader=e,this.enabled=e.isExtensionUsed(i)}return e.prototype.dispose=function(){this._loader=null},e.prototype._loadTextureAsync=function(e,t,n){var i=this;return r.GLTFLoader.LoadExtensionAsync(e,t,this.name,function(o,a){var s=null==t.sampler?r.GLTFLoader.DefaultSampler:r.ArrayItem.Get(e+"/sampler",i._loader.gltf.samplers,t.sampler),l=r.ArrayItem.Get(o+"/source",i._loader.gltf.images,a.source);return i._loader._createTextureAsync(e,s,l,function(e){n(e)},void 0,!t._textureInfo.nonColorData)})},e}();r.GLTFLoader.RegisterExtension(i,function(e){return new o(e)})},"./glTF/2.0/Extensions/ExtrasAsMetadata.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"ExtrasAsMetadata",function(){return o});var r=n("./glTF/2.0/glTFLoader.ts"),i="ExtrasAsMetadata",o=function(){function e(e){this.name=i,this.enabled=!0,this._loader=e}return e.prototype._assignExtras=function(e,t){if(t.extras&&Object.keys(t.extras).length>0){var n=e.metadata=e.metadata||{};(n.gltf=n.gltf||{}).extras=t.extras}},e.prototype.dispose=function(){this._loader=null},e.prototype.loadNodeAsync=function(e,t,n){var r=this;return this._loader.loadNodeAsync(e,t,function(e){r._assignExtras(e,t),n(e)})},e.prototype.loadCameraAsync=function(e,t,n){var r=this;return this._loader.loadCameraAsync(e,t,function(e){r._assignExtras(e,t),n(e)})},e.prototype.createMaterial=function(e,t,n){var r=this._loader.createMaterial(e,t,n);return this._assignExtras(r,t),r},e}();r.GLTFLoader.RegisterExtension(i,function(e){return new o(e)})},"./glTF/2.0/Extensions/KHR_draco_mesh_compression.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"KHR_draco_mesh_compression",function(){return a});var r=n("babylonjs/Misc/observable"),i=n("./glTF/2.0/glTFLoader.ts"),o="KHR_draco_mesh_compression",a=function(){function e(e){this.name=o,this._loader=e,this.enabled=r.DracoCompression.DecoderAvailable&&this._loader.isExtensionUsed(o)}return e.prototype.dispose=function(){delete this.dracoCompression,this._loader=null},e.prototype._loadVertexDataAsync=function(e,t,n){var o=this;return i.GLTFLoader.LoadExtensionAsync(e,t,this.name,function(a,s){if(null!=t.mode){if(5!==t.mode&&4!==t.mode)throw new Error(e+": Unsupported mode "+t.mode);if(5===t.mode)throw new Error(e+": Mode "+t.mode+" is not currently supported")}var l={},c=function(e,t){var r=s.attributes[e];null!=r&&(n._delayInfo=n._delayInfo||[],-1===n._delayInfo.indexOf(t)&&n._delayInfo.push(t),l[t]=r)};c("POSITION",r.VertexBuffer.PositionKind),c("NORMAL",r.VertexBuffer.NormalKind),c("TANGENT",r.VertexBuffer.TangentKind),c("TEXCOORD_0",r.VertexBuffer.UVKind),c("TEXCOORD_1",r.VertexBuffer.UV2Kind),c("TEXCOORD_2",r.VertexBuffer.UV3Kind),c("TEXCOORD_3",r.VertexBuffer.UV4Kind),c("TEXCOORD_4",r.VertexBuffer.UV5Kind),c("TEXCOORD_5",r.VertexBuffer.UV6Kind),c("JOINTS_0",r.VertexBuffer.MatricesIndicesKind),c("WEIGHTS_0",r.VertexBuffer.MatricesWeightsKind),c("COLOR_0",r.VertexBuffer.ColorKind);var u=i.ArrayItem.Get(a,o._loader.gltf.bufferViews,s.bufferView);return u._dracoBabylonGeometry||(u._dracoBabylonGeometry=o._loader.loadBufferViewAsync("/bufferViews/"+u.index,u).then(function(t){return(o.dracoCompression||r.DracoCompression.Default).decodeMeshAsync(t,l).then(function(e){var t=new r.Geometry(n.name,o._loader.babylonScene);return e.applyToGeometry(t),t}).catch(function(t){throw new Error(e+": "+t.message)})})),u._dracoBabylonGeometry})},e}();i.GLTFLoader.RegisterExtension(o,function(e){return new a(e)})},"./glTF/2.0/Extensions/KHR_lights_punctual.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"KHR_lights",function(){return a});var r=n("babylonjs/Misc/observable"),i=n("./glTF/2.0/glTFLoader.ts"),o="KHR_lights_punctual",a=function(){function e(e){this.name=o,this._loader=e,this.enabled=this._loader.isExtensionUsed(o)}return e.prototype.dispose=function(){this._loader=null,delete this._lights},e.prototype.onLoading=function(){var e=this._loader.gltf.extensions;if(e&&e[this.name]){var t=e[this.name];this._lights=t.lights}},e.prototype.loadNodeAsync=function(e,t,n){var o=this;return i.GLTFLoader.LoadExtensionAsync(e,t,this.name,function(a,s){return o._loader.loadNodeAsync(e,t,function(e){var t,l=i.ArrayItem.Get(a,o._lights,s.light),c=l.name||e.name;switch(o._loader.babylonScene._blockEntityCollection=!!o._loader._assetContainer,l.type){case"directional":t=new r.DirectionalLight(c,r.Vector3.Backward(),o._loader.babylonScene);break;case"point":t=new r.PointLight(c,r.Vector3.Zero(),o._loader.babylonScene);break;case"spot":var u=new r.SpotLight(c,r.Vector3.Zero(),r.Vector3.Backward(),0,1,o._loader.babylonScene);u.angle=2*(l.spot&&l.spot.outerConeAngle||Math.PI/4),u.innerAngle=2*(l.spot&&l.spot.innerConeAngle||0),t=u;break;default:throw o._loader.babylonScene._blockEntityCollection=!1,new Error(a+": Invalid light type ("+l.type+")")}t._parentContainer=o._loader._assetContainer,o._loader.babylonScene._blockEntityCollection=!1,t.falloffType=r.Light.FALLOFF_GLTF,t.diffuse=l.color?r.Color3.FromArray(l.color):r.Color3.White(),t.intensity=null==l.intensity?1:l.intensity,t.range=null==l.range?Number.MAX_VALUE:l.range,t.parent=e,o._loader._babylonLights.push(t),i.GLTFLoader.AddPointerMetadata(t,a),n(e)})})},e}();i.GLTFLoader.RegisterExtension(o,function(e){return new a(e)})},"./glTF/2.0/Extensions/KHR_materials_clearcoat.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"KHR_materials_clearcoat",function(){return a});var r=n("babylonjs/Misc/observable"),i=n("./glTF/2.0/glTFLoader.ts"),o="KHR_materials_clearcoat",a=function(){function e(e){this.name=o,this.order=190,this._loader=e,this.enabled=this._loader.isExtensionUsed(o)}return e.prototype.dispose=function(){this._loader=null},e.prototype.loadMaterialPropertiesAsync=function(e,t,n){var r=this;return i.GLTFLoader.LoadExtensionAsync(e,t,this.name,function(i,o){var a=new Array;return a.push(r._loader.loadMaterialPropertiesAsync(e,t,n)),a.push(r._loadClearCoatPropertiesAsync(i,o,n)),Promise.all(a).then(function(){})})},e.prototype._loadClearCoatPropertiesAsync=function(e,t,n){if(!(n instanceof r.PBRMaterial))throw new Error(e+": Material type not supported");var i=new Array;return n.clearCoat.isEnabled=!0,n.clearCoat.useRoughnessFromMainTexture=!1,n.clearCoat.remapF0OnInterfaceChange=!1,null!=t.clearcoatFactor?n.clearCoat.intensity=t.clearcoatFactor:n.clearCoat.intensity=0,t.clearcoatTexture&&i.push(this._loader.loadTextureInfoAsync(e+"/clearcoatTexture",t.clearcoatTexture,function(e){e.name=n.name+" (ClearCoat Intensity)",n.clearCoat.texture=e})),null!=t.clearcoatRoughnessFactor?n.clearCoat.roughness=t.clearcoatRoughnessFactor:n.clearCoat.roughness=0,t.clearcoatRoughnessTexture&&(t.clearcoatRoughnessTexture.nonColorData=!0,i.push(this._loader.loadTextureInfoAsync(e+"/clearcoatRoughnessTexture",t.clearcoatRoughnessTexture,function(e){e.name=n.name+" (ClearCoat Roughness)",n.clearCoat.textureRoughness=e}))),t.clearcoatNormalTexture&&(t.clearcoatNormalTexture.nonColorData=!0,i.push(this._loader.loadTextureInfoAsync(e+"/clearcoatNormalTexture",t.clearcoatNormalTexture,function(e){e.name=n.name+" (ClearCoat Normal)",n.clearCoat.bumpTexture=e})),n.invertNormalMapX=!n.getScene().useRightHandedSystem,n.invertNormalMapY=n.getScene().useRightHandedSystem,null!=t.clearcoatNormalTexture.scale&&(n.clearCoat.bumpTexture.level=t.clearcoatNormalTexture.scale)),Promise.all(i).then(function(){})},e}();i.GLTFLoader.RegisterExtension(o,function(e){return new a(e)})},"./glTF/2.0/Extensions/KHR_materials_ior.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"KHR_materials_ior",function(){return a});var r=n("babylonjs/Misc/observable"),i=n("./glTF/2.0/glTFLoader.ts"),o="KHR_materials_ior",a=function(){function e(e){this.name=o,this.order=180,this._loader=e,this.enabled=this._loader.isExtensionUsed(o)}return e.prototype.dispose=function(){this._loader=null},e.prototype.loadMaterialPropertiesAsync=function(e,t,n){var r=this;return i.GLTFLoader.LoadExtensionAsync(e,t,this.name,function(i,o){var a=new Array;return a.push(r._loader.loadMaterialPropertiesAsync(e,t,n)),a.push(r._loadIorPropertiesAsync(i,o,n)),Promise.all(a).then(function(){})})},e.prototype._loadIorPropertiesAsync=function(t,n,i){if(!(i instanceof r.PBRMaterial))throw new Error(t+": Material type not supported");return void 0!==n.ior?i.indexOfRefraction=n.ior:i.indexOfRefraction=e._DEFAULT_IOR,Promise.resolve()},e._DEFAULT_IOR=1.5,e}();i.GLTFLoader.RegisterExtension(o,function(e){return new a(e)})},"./glTF/2.0/Extensions/KHR_materials_pbrSpecularGlossiness.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"KHR_materials_pbrSpecularGlossiness",function(){return a});var r=n("babylonjs/Misc/observable"),i=n("./glTF/2.0/glTFLoader.ts"),o="KHR_materials_pbrSpecularGlossiness",a=function(){function e(e){this.name=o,this.order=200,this._loader=e,this.enabled=this._loader.isExtensionUsed(o)}return e.prototype.dispose=function(){this._loader=null},e.prototype.loadMaterialPropertiesAsync=function(e,t,n){var r=this;return i.GLTFLoader.LoadExtensionAsync(e,t,this.name,function(i,o){var a=new Array;return a.push(r._loader.loadMaterialBasePropertiesAsync(e,t,n)),a.push(r._loadSpecularGlossinessPropertiesAsync(i,t,o,n)),r._loader.loadMaterialAlphaProperties(e,t,n),Promise.all(a).then(function(){})})},e.prototype._loadSpecularGlossinessPropertiesAsync=function(e,t,n,i){if(!(i instanceof r.PBRMaterial))throw new Error(e+": Material type not supported");var o=new Array;return i.metallic=null,i.roughness=null,n.diffuseFactor?(i.albedoColor=r.Color3.FromArray(n.diffuseFactor),i.alpha=n.diffuseFactor[3]):i.albedoColor=r.Color3.White(),i.reflectivityColor=n.specularFactor?r.Color3.FromArray(n.specularFactor):r.Color3.White(),i.microSurface=null==n.glossinessFactor?1:n.glossinessFactor,n.diffuseTexture&&o.push(this._loader.loadTextureInfoAsync(e+"/diffuseTexture",n.diffuseTexture,function(e){e.name=i.name+" (Diffuse)",i.albedoTexture=e})),n.specularGlossinessTexture&&(o.push(this._loader.loadTextureInfoAsync(e+"/specularGlossinessTexture",n.specularGlossinessTexture,function(e){e.name=i.name+" (Specular Glossiness)",i.reflectivityTexture=e})),i.reflectivityTexture.hasAlpha=!0,i.useMicroSurfaceFromReflectivityMapAlpha=!0),Promise.all(o).then(function(){})},e}();i.GLTFLoader.RegisterExtension(o,function(e){return new a(e)})},"./glTF/2.0/Extensions/KHR_materials_sheen.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"KHR_materials_sheen",function(){return a});var r=n("babylonjs/Misc/observable"),i=n("./glTF/2.0/glTFLoader.ts"),o="KHR_materials_sheen",a=function(){function e(e){this.name=o,this.order=190,this._loader=e,this.enabled=this._loader.isExtensionUsed(o)}return e.prototype.dispose=function(){this._loader=null},e.prototype.loadMaterialPropertiesAsync=function(e,t,n){var r=this;return i.GLTFLoader.LoadExtensionAsync(e,t,this.name,function(i,o){var a=new Array;return a.push(r._loader.loadMaterialPropertiesAsync(e,t,n)),a.push(r._loadSheenPropertiesAsync(i,o,n)),Promise.all(a).then(function(){})})},e.prototype._loadSheenPropertiesAsync=function(e,t,n){if(!(n instanceof r.PBRMaterial))throw new Error(e+": Material type not supported");var i=new Array;return n.sheen.isEnabled=!0,n.sheen.intensity=1,null!=t.sheenColorFactor?n.sheen.color=r.Color3.FromArray(t.sheenColorFactor):n.sheen.color=r.Color3.Black(),t.sheenColorTexture&&i.push(this._loader.loadTextureInfoAsync(e+"/sheenColorTexture",t.sheenColorTexture,function(e){e.name=n.name+" (Sheen Color)",n.sheen.texture=e})),void 0!==t.sheenRoughnessFactor?n.sheen.roughness=t.sheenRoughnessFactor:n.sheen.roughness=0,t.sheenRoughnessTexture&&(t.sheenRoughnessTexture.nonColorData=!0,i.push(this._loader.loadTextureInfoAsync(e+"/sheenRoughnessTexture",t.sheenRoughnessTexture,function(e){e.name=n.name+" (Sheen Roughness)",n.sheen.textureRoughness=e}))),n.sheen.albedoScaling=!0,n.sheen.useRoughnessFromMainTexture=!1,Promise.all(i).then(function(){})},e}();i.GLTFLoader.RegisterExtension(o,function(e){return new a(e)})},"./glTF/2.0/Extensions/KHR_materials_specular.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"KHR_materials_specular",function(){return a});var r=n("babylonjs/Misc/observable"),i=n("./glTF/2.0/glTFLoader.ts"),o="KHR_materials_specular",a=function(){function e(e){this.name=o,this.order=190,this._loader=e,this.enabled=this._loader.isExtensionUsed(o)}return e.prototype.dispose=function(){this._loader=null},e.prototype.loadMaterialPropertiesAsync=function(e,t,n){var r=this;return i.GLTFLoader.LoadExtensionAsync(e,t,this.name,function(i,o){var a=new Array;return a.push(r._loader.loadMaterialPropertiesAsync(e,t,n)),a.push(r._loadSpecularPropertiesAsync(i,o,n)),Promise.all(a).then(function(){})})},e.prototype._loadSpecularPropertiesAsync=function(e,t,n){if(!(n instanceof r.PBRMaterial))throw new Error(e+": Material type not supported");var i=new Array;return void 0!==t.specularFactor&&(n.metallicF0Factor=t.specularFactor),void 0!==t.specularColorFactor&&(n.metallicReflectanceColor=r.Color3.FromArray(t.specularColorFactor)),t.specularTexture&&(t.specularTexture.nonColorData=!0,i.push(this._loader.loadTextureInfoAsync(e+"/specularTexture",t.specularTexture,function(e){e.name=n.name+" (Specular F0 Strength)",n.metallicReflectanceTexture=e,n.useOnlyMetallicFromMetallicReflectanceTexture=!0}))),t.specularColorTexture&&i.push(this._loader.loadTextureInfoAsync(e+"/specularColorTexture",t.specularColorTexture,function(e){e.name=n.name+" (Specular F0 Color)",n.reflectanceTexture=e})),Promise.all(i).then(function(){})},e}();i.GLTFLoader.RegisterExtension(o,function(e){return new a(e)})},"./glTF/2.0/Extensions/KHR_materials_translucency.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"KHR_materials_translucency",function(){return a});var r=n("babylonjs/Misc/observable"),i=n("./glTF/2.0/glTFLoader.ts"),o="KHR_materials_translucency",a=function(){function e(e){this.name=o,this.order=174,this._loader=e,this.enabled=this._loader.isExtensionUsed(o),this.enabled&&(e.parent.transparencyAsCoverage=!0)}return e.prototype.dispose=function(){this._loader=null},e.prototype.loadMaterialPropertiesAsync=function(e,t,n){var r=this;return i.GLTFLoader.LoadExtensionAsync(e,t,this.name,function(i,o){var a=new Array;return a.push(r._loader.loadMaterialBasePropertiesAsync(e,t,n)),a.push(r._loader.loadMaterialPropertiesAsync(e,t,n)),a.push(r._loadTranslucentPropertiesAsync(i,t,n,o)),Promise.all(a).then(function(){})})},e.prototype._loadTranslucentPropertiesAsync=function(e,t,n,i){if(!(n instanceof r.PBRMaterial))throw new Error(e+": Material type not supported");var o=n;return o.subSurface.isTranslucencyEnabled=!0,o.subSurface.volumeIndexOfRefraction=1,o.subSurface.minimumThickness=0,o.subSurface.maximumThickness=0,o.subSurface.useAlbedoToTintTranslucency=!0,void 0===i.translucencyFactor?(o.subSurface.translucencyIntensity=0,o.subSurface.isTranslucencyEnabled=!1,Promise.resolve()):(o.subSurface.translucencyIntensity=i.translucencyFactor,i.translucencyTexture?(i.translucencyTexture.nonColorData=!0,this._loader.loadTextureInfoAsync(e+"/translucencyTexture",i.translucencyTexture).then(function(e){o.subSurface.translucencyIntensityTexture=e})):Promise.resolve())},e}();i.GLTFLoader.RegisterExtension(o,function(e){return new a(e)})},"./glTF/2.0/Extensions/KHR_materials_transmission.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"KHR_materials_transmission",function(){return l});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/observable"),o=n("./glTF/2.0/glTFLoader.ts"),a=function(){function e(t,n){var o=this;this._opaqueRenderTarget=null,this._opaqueMeshesCache=[],this._transparentMeshesCache=[],this._materialObservers={},this._options=Object(r.__assign)(Object(r.__assign)({},e._getDefaultOptions()),t),this._scene=n,this._scene._transmissionHelper=this,this.onErrorObservable=new i.Observable,this._scene.onDisposeObservable.addOnce(function(e){o.dispose()}),this._parseScene(),this._setupRenderTargets()}return e._getDefaultOptions=function(){return{renderSize:1024,samples:4,lodGenerationScale:1,lodGenerationOffset:-4,renderTargetTextureType:i.Constants.TEXTURETYPE_HALF_FLOAT,generateMipmaps:!0}},e.prototype.updateOptions=function(e){var t=this;if(Object.keys(e).filter(function(n){return t._options[n]!==e[n]}).length){var n=Object(r.__assign)(Object(r.__assign)({},this._options),e),i=this._options;this._options=n,n.renderSize===i.renderSize&&n.renderTargetTextureType===i.renderTargetTextureType&&n.generateMipmaps===i.generateMipmaps&&this._opaqueRenderTarget?(this._opaqueRenderTarget.samples=n.samples,this._opaqueRenderTarget.lodGenerationScale=n.lodGenerationScale,this._opaqueRenderTarget.lodGenerationOffset=n.lodGenerationOffset):this._setupRenderTargets()}},e.prototype.getOpaqueTarget=function(){return this._opaqueRenderTarget},e.prototype.shouldRenderAsTransmission=function(e){return!!e&&!!(e instanceof i.PBRMaterial&&e.subSurface.isRefractionEnabled)},e.prototype._addMesh=function(e){var t=this;this._materialObservers[e.uniqueId]=e.onMaterialChangedObservable.add(this._onMeshMaterialChanged.bind(this)),i.Tools.SetImmediate(function(){t.shouldRenderAsTransmission(e.material)?(e.material.refractionTexture=t._opaqueRenderTarget,t._transparentMeshesCache.push(e)):t._opaqueMeshesCache.push(e)})},e.prototype._removeMesh=function(e){e.onMaterialChangedObservable.remove(this._materialObservers[e.uniqueId]),delete this._materialObservers[e.uniqueId];var t=this._transparentMeshesCache.indexOf(e);-1!==t&&this._transparentMeshesCache.splice(t,1),-1!==(t=this._opaqueMeshesCache.indexOf(e))&&this._opaqueMeshesCache.splice(t,1)},e.prototype._parseScene=function(){this._scene.meshes.forEach(this._addMesh.bind(this)),this._scene.onNewMeshAddedObservable.add(this._addMesh.bind(this)),this._scene.onMeshRemovedObservable.add(this._removeMesh.bind(this))},e.prototype._onMeshMaterialChanged=function(e){var t=this._transparentMeshesCache.indexOf(e),n=this._opaqueMeshesCache.indexOf(e);this.shouldRenderAsTransmission(e.material)?(e.material instanceof i.PBRMaterial&&(e.material.subSurface.refractionTexture=this._opaqueRenderTarget),-1!==n?(this._opaqueMeshesCache.splice(n,1),this._transparentMeshesCache.push(e)):-1===t&&this._transparentMeshesCache.push(e)):-1!==t?(this._transparentMeshesCache.splice(t,1),this._opaqueMeshesCache.push(e)):-1===n&&this._opaqueMeshesCache.push(e)},e.prototype._setupRenderTargets=function(){var e,t,n,r,o=this;this._opaqueRenderTarget&&this._opaqueRenderTarget.dispose(),this._opaqueRenderTarget=new i.RenderTargetTexture("opaqueSceneTexture",this._options.renderSize,this._scene,this._options.generateMipmaps,void 0,this._options.renderTargetTextureType),this._opaqueRenderTarget.ignoreCameraViewport=!0,this._opaqueRenderTarget.renderList=this._opaqueMeshesCache,this._opaqueRenderTarget.clearColor=null!==(t=null===(e=this._options.clearColor)||void 0===e?void 0:e.clone())&&void 0!==t?t:this._scene.clearColor.clone(),this._opaqueRenderTarget.gammaSpace=!1,this._opaqueRenderTarget.lodGenerationScale=this._options.lodGenerationScale,this._opaqueRenderTarget.lodGenerationOffset=this._options.lodGenerationOffset,this._opaqueRenderTarget.samples=this._options.samples,this._opaqueRenderTarget.onBeforeBindObservable.add(function(e){r=o._scene.environmentIntensity,o._scene.environmentIntensity=1,n=o._scene.imageProcessingConfiguration.applyByPostProcess,o._options.clearColor?e.clearColor.copyFrom(o._options.clearColor):o._scene.clearColor.toLinearSpaceToRef(e.clearColor),o._scene.imageProcessingConfiguration.applyByPostProcess=!0}),this._opaqueRenderTarget.onAfterUnbindObservable.add(function(){o._scene.environmentIntensity=r,o._scene.imageProcessingConfiguration.applyByPostProcess=n}),this._transparentMeshesCache.forEach(function(e){o.shouldRenderAsTransmission(e.material)&&(e.material.refractionTexture=o._opaqueRenderTarget)})},e.prototype.dispose=function(){this._scene._transmissionHelper=void 0,this._opaqueRenderTarget&&(this._opaqueRenderTarget.dispose(),this._opaqueRenderTarget=null),this._transparentMeshesCache=[],this._opaqueMeshesCache=[]},e}(),s="KHR_materials_transmission",l=function(){function e(e){this.name=s,this.order=175,this._loader=e,this.enabled=this._loader.isExtensionUsed(s),this.enabled&&(e.parent.transparencyAsCoverage=!0)}return e.prototype.dispose=function(){this._loader=null},e.prototype.loadMaterialPropertiesAsync=function(e,t,n){var r=this;return o.GLTFLoader.LoadExtensionAsync(e,t,this.name,function(i,o){var a=new Array;return a.push(r._loader.loadMaterialBasePropertiesAsync(e,t,n)),a.push(r._loader.loadMaterialPropertiesAsync(e,t,n)),a.push(r._loadTransparentPropertiesAsync(i,t,n,o)),Promise.all(a).then(function(){})})},e.prototype._loadTransparentPropertiesAsync=function(e,t,n,r){if(!(n instanceof i.PBRMaterial))throw new Error(e+": Material type not supported");var o=n;if(o.subSurface.isRefractionEnabled=!0,o.subSurface.volumeIndexOfRefraction=1,o.subSurface.useAlbedoToTintRefraction=!0,void 0===r.transmissionFactor)return o.subSurface.refractionIntensity=0,o.subSurface.isRefractionEnabled=!1,Promise.resolve();o.subSurface.refractionIntensity=r.transmissionFactor;var s=o.getScene();return o.subSurface.refractionIntensity&&!s._transmissionHelper&&new a({},o.getScene()),o.subSurface.minimumThickness=0,o.subSurface.maximumThickness=0,r.transmissionTexture?(r.transmissionTexture.nonColorData=!0,this._loader.loadTextureInfoAsync(e+"/transmissionTexture",r.transmissionTexture,void 0).then(function(e){o.subSurface.refractionIntensityTexture=e,o.subSurface.useGltfStyleTextures=!0})):Promise.resolve()},e}();o.GLTFLoader.RegisterExtension(s,function(e){return new l(e)})},"./glTF/2.0/Extensions/KHR_materials_unlit.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"KHR_materials_unlit",function(){return a});var r=n("babylonjs/Misc/observable"),i=n("./glTF/2.0/glTFLoader.ts"),o="KHR_materials_unlit",a=function(){function e(e){this.name=o,this.order=210,this._loader=e,this.enabled=this._loader.isExtensionUsed(o)}return e.prototype.dispose=function(){this._loader=null},e.prototype.loadMaterialPropertiesAsync=function(e,t,n){var r=this;return i.GLTFLoader.LoadExtensionAsync(e,t,this.name,function(){return r._loadUnlitPropertiesAsync(e,t,n)})},e.prototype._loadUnlitPropertiesAsync=function(e,t,n){if(!(n instanceof r.PBRMaterial))throw new Error(e+": Material type not supported");var i=new Array;n.unlit=!0;var o=t.pbrMetallicRoughness;return o&&(o.baseColorFactor?(n.albedoColor=r.Color3.FromArray(o.baseColorFactor),n.alpha=o.baseColorFactor[3]):n.albedoColor=r.Color3.White(),o.baseColorTexture&&i.push(this._loader.loadTextureInfoAsync(e+"/baseColorTexture",o.baseColorTexture,function(e){e.name=n.name+" (Base Color)",n.albedoTexture=e}))),t.doubleSided&&(n.backFaceCulling=!1,n.twoSidedLighting=!0),this._loader.loadMaterialAlphaProperties(e,t,n),Promise.all(i).then(function(){})},e}();i.GLTFLoader.RegisterExtension(o,function(e){return new a(e)})},"./glTF/2.0/Extensions/KHR_materials_variants.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"KHR_materials_variants",function(){return a});var r=n("./glTF/2.0/glTFLoader.ts"),i=n("babylonjs/Misc/observable"),o="KHR_materials_variants",a=function(){function e(e){this.name=o,this._loader=e,this.enabled=this._loader.isExtensionUsed(o)}return e.prototype.dispose=function(){this._loader=null},e.GetAvailableVariants=function(e){var t=this._GetExtensionMetadata(e);return t?Object.keys(t.variants):[]},e.prototype.getAvailableVariants=function(t){return e.GetAvailableVariants(t)},e.SelectVariant=function(e,t){var n=this._GetExtensionMetadata(e);if(!n)throw new Error("Cannot select variant on a glTF mesh that does not have the "+o+" extension");var r=function(e){var t=n.variants[e];if(t)for(var r=0,i=t;r<i.length;r++){var o=i[r];o.mesh.material=o.material}};if(t instanceof Array)for(var i=0,a=t;i<a.length;i++){r(a[i])}else r(t);n.lastSelected=t},e.prototype.selectVariant=function(t,n){return e.SelectVariant(t,n)},e.Reset=function(e){var t=this._GetExtensionMetadata(e);if(!t)throw new Error("Cannot reset on a glTF mesh that does not have the "+o+" extension");for(var n=0,r=t.original;n<r.length;n++){var i=r[n];i.mesh.material=i.material}t.lastSelected=null},e.prototype.reset=function(t){return e.Reset(t)},e.GetLastSelectedVariant=function(e){var t=this._GetExtensionMetadata(e);if(!t)throw new Error("Cannot get the last selected variant on a glTF mesh that does not have the "+o+" extension");return t.lastSelected},e.prototype.getLastSelectedVariant=function(t){return e.GetLastSelectedVariant(t)},e._GetExtensionMetadata=function(e){var t,n;return(null===(n=null===(t=null==e?void 0:e.metadata)||void 0===t?void 0:t.gltf)||void 0===n?void 0:n[o])||null},e.prototype.onLoading=function(){var e=this._loader.gltf.extensions;if(e&&e[this.name]){var t=e[this.name];this._variants=t.variants}},e.prototype._loadMeshPrimitiveAsync=function(t,n,a,s,l,c){var u=this;return r.GLTFLoader.LoadExtensionAsync(t,l,this.name,function(_,h){var f=new Array;return f.push(u._loader._loadMeshPrimitiveAsync(t,n,a,s,l,function(n){if(c(n),n instanceof i.Mesh){var a=r.GLTFLoader._GetDrawMode(t,l.mode),s=u._loader.rootBabylonMesh,d=s.metadata=s.metadata||{},p=d.gltf=d.gltf||{},m=p[o]=p[o]||{lastSelected:null,original:[],variants:{}};m.original.push({mesh:n,material:n.material});for(var g=function(t){var i=h.mappings[t],l=r.ArrayItem.Get(_+"/mappings/"+t+"/material",u._loader.gltf.materials,i.material);f.push(u._loader._loadMaterialAsync("#/materials/"+i.material,l,n,a,function(t){for(var a=function(a){var l=i.variants[a],c=r.ArrayItem.Get("/extensions/"+o+"/variants/"+l,u._variants,l);m.variants[c.name]=m.variants[c.name]||[],m.variants[c.name].push({mesh:n,material:t}),n.onClonedObservable.add(function(t){var r=t,i=null,a=r;do{if(!(a=a.parent))return;i=e._GetExtensionMetadata(a)}while(null===i);if(i===e._GetExtensionMetadata(s)){for(var l in a.metadata={},s.metadata)a.metadata[l]=s.metadata[l];for(var l in a.metadata.gltf=[],s.metadata.gltf)a.metadata.gltf[l]=s.metadata.gltf[l];a.metadata.gltf[o]={lastSelected:null,original:[],variants:{}};for(var u=0,_=i.original;u<_.length;u++){var h=_[u];a.metadata.gltf[o].original.push({mesh:h.mesh,material:h.material})}for(var l in i.variants)if(i.variants.hasOwnProperty(l)){a.metadata.gltf[o].variants[l]=[];for(var f=0,d=i.variants[l];f<d.length;f++){var p=d[f];a.metadata.gltf[o].variants[l].push({mesh:p.mesh,material:p.material})}}i=a.metadata.gltf[o]}for(var m=0,g=i.original;m<g.length;m++){(y=g[m]).mesh===n&&(y.mesh=r)}for(var v=0,b=i.variants[c.name];v<b.length;v++){var y;(y=b[v]).mesh===n&&(y.mesh=r)}})},l=0;l<i.variants.length;++l)a(l)}))},v=0;v<h.mappings.length;++v)g(v)}})),Promise.all(f).then(function(e){return e[0]})})},e}();r.GLTFLoader.RegisterExtension(o,function(e){return new a(e)})},"./glTF/2.0/Extensions/KHR_materials_volume.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"KHR_materials_volume",function(){return a});var r=n("babylonjs/Misc/observable"),i=n("./glTF/2.0/glTFLoader.ts"),o="KHR_materials_volume",a=function(){function e(e){this.name=o,this.order=173,this._loader=e,this.enabled=this._loader.isExtensionUsed(o),this.enabled&&this._loader._disableInstancedMesh++}return e.prototype.dispose=function(){this.enabled&&this._loader._disableInstancedMesh--,this._loader=null},e.prototype.loadMaterialPropertiesAsync=function(e,t,n){var r=this;return i.GLTFLoader.LoadExtensionAsync(e,t,this.name,function(i,o){var a=new Array;return a.push(r._loader.loadMaterialBasePropertiesAsync(e,t,n)),a.push(r._loader.loadMaterialPropertiesAsync(e,t,n)),a.push(r._loadVolumePropertiesAsync(i,t,n,o)),Promise.all(a).then(function(){})})},e.prototype._loadVolumePropertiesAsync=function(e,t,n,i){if(!(n instanceof r.PBRMaterial))throw new Error(e+": Material type not supported");if(!n.subSurface.isRefractionEnabled&&!n.subSurface.isTranslucencyEnabled||!i.thicknessFactor)return Promise.resolve();n.subSurface.volumeIndexOfRefraction=n.indexOfRefraction;var o=void 0!==i.attenuationDistance?i.attenuationDistance:Number.MAX_VALUE;return n.subSurface.tintColorAtDistance=o,void 0!==i.attenuationColor&&3==i.attenuationColor.length&&n.subSurface.tintColor.copyFromFloats(i.attenuationColor[0],i.attenuationColor[1],i.attenuationColor[2]),n.subSurface.minimumThickness=0,n.subSurface.maximumThickness=i.thicknessFactor,n.subSurface.useThicknessAsDepth=!0,i.thicknessTexture?(i.thicknessTexture.nonColorData=!0,this._loader.loadTextureInfoAsync(e+"/thicknessTexture",i.thicknessTexture).then(function(e){n.subSurface.thicknessTexture=e,n.subSurface.useGltfStyleTextures=!0})):Promise.resolve()},e}();i.GLTFLoader.RegisterExtension(o,function(e){return new a(e)})},"./glTF/2.0/Extensions/KHR_mesh_quantization.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"KHR_mesh_quantization",function(){return o});var r=n("./glTF/2.0/glTFLoader.ts"),i="KHR_mesh_quantization",o=function(){function e(e){this.name=i,this.enabled=e.isExtensionUsed(i)}return e.prototype.dispose=function(){},e}();r.GLTFLoader.RegisterExtension(i,function(e){return new o(e)})},"./glTF/2.0/Extensions/KHR_texture_basisu.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"KHR_texture_basisu",function(){return o});var r=n("./glTF/2.0/glTFLoader.ts"),i="KHR_texture_basisu",o=function(){function e(e){this.name=i,this._loader=e,this.enabled=e.isExtensionUsed(i)}return e.prototype.dispose=function(){this._loader=null},e.prototype._loadTextureAsync=function(e,t,n){var i=this;return r.GLTFLoader.LoadExtensionAsync(e,t,this.name,function(o,a){var s=null==t.sampler?r.GLTFLoader.DefaultSampler:r.ArrayItem.Get(e+"/sampler",i._loader.gltf.samplers,t.sampler),l=r.ArrayItem.Get(o+"/source",i._loader.gltf.images,a.source);return i._loader._createTextureAsync(e,s,l,function(e){n(e)},t._textureInfo.nonColorData?{useRGBAIfASTCBC7NotAvailableWhenUASTC:!0}:void 0,!t._textureInfo.nonColorData)})},e}();r.GLTFLoader.RegisterExtension(i,function(e){return new o(e)})},"./glTF/2.0/Extensions/KHR_texture_transform.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"KHR_texture_transform",function(){return a});var r=n("babylonjs/Misc/observable"),i=n("./glTF/2.0/glTFLoader.ts"),o="KHR_texture_transform",a=function(){function e(e){this.name=o,this._loader=e,this.enabled=this._loader.isExtensionUsed(o)}return e.prototype.dispose=function(){this._loader=null},e.prototype.loadTextureInfoAsync=function(e,t,n){var o=this;return i.GLTFLoader.LoadExtensionAsync(e,t,this.name,function(i,a){return o._loader.loadTextureInfoAsync(e,t,function(e){if(!(e instanceof r.Texture))throw new Error(i+": Texture type not supported");a.offset&&(e.uOffset=a.offset[0],e.vOffset=a.offset[1]),e.uRotationCenter=0,e.vRotationCenter=0,a.rotation&&(e.wAng=-a.rotation),a.scale&&(e.uScale=a.scale[0],e.vScale=a.scale[1]),null!=a.texCoord&&(e.coordinatesIndex=a.texCoord),n(e)})})},e}();i.GLTFLoader.RegisterExtension(o,function(e){return new a(e)})},"./glTF/2.0/Extensions/KHR_xmp_json_ld.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"KHR_xmp_json_ld",function(){return o});var r=n("./glTF/2.0/glTFLoader.ts"),i="KHR_xmp_json_ld",o=function(){function e(e){this.name=i,this.order=100,this._loader=e,this.enabled=this._loader.isExtensionUsed(i)}return e.prototype.dispose=function(){this._loader=null},e.prototype.onLoading=function(){var e,t,n,r=null===(e=this._loader.gltf.extensions)||void 0===e?void 0:e.KHR_xmp_json_ld,i=null===(n=null===(t=this._loader.gltf.asset)||void 0===t?void 0:t.extensions)||void 0===n?void 0:n.KHR_xmp_json_ld;if(r&&i){var o=+i.packet;r.packets&&o<r.packets.length&&(this._loader.rootBabylonMesh.metadata=this._loader.rootBabylonMesh.metadata||{},this._loader.rootBabylonMesh.metadata.xmp=r.packets[o])}},e}();r.GLTFLoader.RegisterExtension(i,function(e){return new o(e)})},"./glTF/2.0/Extensions/MSFT_audio_emitter.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"MSFT_audio_emitter",function(){return a});var r=n("babylonjs/Misc/observable"),i=n("./glTF/2.0/glTFLoader.ts"),o="MSFT_audio_emitter",a=function(){function e(e){this.name=o,this._loader=e,this.enabled=this._loader.isExtensionUsed(o)}return e.prototype.dispose=function(){this._loader=null,this._clips=null,this._emitters=null},e.prototype.onLoading=function(){var e=this._loader.gltf.extensions;if(e&&e[this.name]){var t=e[this.name];this._clips=t.clips,this._emitters=t.emitters,i.ArrayItem.Assign(this._clips),i.ArrayItem.Assign(this._emitters)}},e.prototype.loadSceneAsync=function(e,t){var n=this;return i.GLTFLoader.LoadExtensionAsync(e,t,this.name,function(r,o){var a=new Array;a.push(n._loader.loadSceneAsync(e,t));for(var s=0,l=o.emitters;s<l.length;s++){var c=l[s],u=i.ArrayItem.Get(r+"/emitters",n._emitters,c);if(null!=u.refDistance||null!=u.maxDistance||null!=u.rolloffFactor||null!=u.distanceModel||null!=u.innerAngle||null!=u.outerAngle)throw new Error(r+": Direction or Distance properties are not allowed on emitters attached to a scene");a.push(n._loadEmitterAsync(r+"/emitters/"+u.index,u))}return Promise.all(a).then(function(){})})},e.prototype.loadNodeAsync=function(e,t,n){var o=this;return i.GLTFLoader.LoadExtensionAsync(e,t,this.name,function(e,a){var s=new Array;return o._loader.loadNodeAsync(e,t,function(t){for(var l=function(n){var a=i.ArrayItem.Get(e+"/emitters",o._emitters,n);s.push(o._loadEmitterAsync(e+"/emitters/"+a.index,a).then(function(){for(var e=0,n=a._babylonSounds;e<n.length;e++){var i=n[e];i.attachToMesh(t),null==a.innerAngle&&null==a.outerAngle||(i.setLocalDirectionToMesh(r.Vector3.Forward()),i.setDirectionalCone(2*r.Tools.ToDegrees(null==a.innerAngle?Math.PI:a.innerAngle),2*r.Tools.ToDegrees(null==a.outerAngle?Math.PI:a.outerAngle),0))}}))},c=0,u=a.emitters;c<u.length;c++){l(u[c])}n(t)}).then(function(e){return Promise.all(s).then(function(){return e})})})},e.prototype.loadAnimationAsync=function(e,t){var n=this;return i.GLTFLoader.LoadExtensionAsync(e,t,this.name,function(r,o){return n._loader.loadAnimationAsync(e,t).then(function(a){var s=new Array;i.ArrayItem.Assign(o.events);for(var l=0,c=o.events;l<c.length;l++){var u=c[l];s.push(n._loadAnimationEventAsync(r+"/events/"+u.index,e,t,u,a))}return Promise.all(s).then(function(){return a})})})},e.prototype._loadClipAsync=function(e,t){if(t._objectURL)return t._objectURL;var n;if(t.uri)n=this._loader.loadUriAsync(e,t,t.uri);else{var r=i.ArrayItem.Get(e+"/bufferView",this._loader.gltf.bufferViews,t.bufferView);n=this._loader.loadBufferViewAsync("/bufferViews/"+r.index,r)}return t._objectURL=n.then(function(e){return URL.createObjectURL(new Blob([e],{type:t.mimeType}))}),t._objectURL},e.prototype._loadEmitterAsync=function(e,t){var n=this;if(t._babylonSounds=t._babylonSounds||[],!t._babylonData){for(var o=new Array,a=t.name||"emitter"+t.index,s={loop:!1,autoplay:!1,volume:null==t.volume?1:t.volume},l=function(e){var l="/extensions/"+c.name+"/clips",u=i.ArrayItem.Get(l,c._clips,t.clips[e].clip);o.push(c._loadClipAsync(l+"/"+t.clips[e].clip,u).then(function(i){var o=t._babylonSounds[e]=new r.Sound(a,i,n._loader.babylonScene,null,s);o.refDistance=t.refDistance||1,o.maxDistance=t.maxDistance||256,o.rolloffFactor=t.rolloffFactor||1,o.distanceModel=t.distanceModel||"exponential"}))},c=this,u=0;u<t.clips.length;u++)l(u);var _=Promise.all(o).then(function(){var e=t.clips.map(function(e){return e.weight||1}),n=new r.WeightedSound(t.loop||!1,t._babylonSounds,e);t.innerAngle&&(n.directionalConeInnerAngle=2*r.Tools.ToDegrees(t.innerAngle)),t.outerAngle&&(n.directionalConeOuterAngle=2*r.Tools.ToDegrees(t.outerAngle)),t.volume&&(n.volume=t.volume),t._babylonData.sound=n});t._babylonData={loaded:_}}return t._babylonData.loaded},e.prototype._getEventAction=function(e,t,n,r,i){switch(n){case"play":return function(e){var n=(i||0)+(e-r);t.play(n)};case"stop":return function(e){t.stop()};case"pause":return function(e){t.pause()};default:throw new Error(e+": Unsupported action "+n)}},e.prototype._loadAnimationEventAsync=function(e,t,n,o,a){var s=this;if(0==a.targetedAnimations.length)return Promise.resolve();var l=a.targetedAnimations[0],c=o.emitter,u=i.ArrayItem.Get("/extensions/"+this.name+"/emitters",this._emitters,c);return this._loadEmitterAsync(e,u).then(function(){var t=u._babylonData.sound;if(t){var n=new r.AnimationEvent(o.time,s._getEventAction(e,t,o.action,o.time,o.startOffset));l.animation.addEvent(n),a.onAnimationGroupEndObservable.add(function(){t.stop()}),a.onAnimationGroupPauseObservable.add(function(){t.pause()})}})},e}();i.GLTFLoader.RegisterExtension(o,function(e){return new a(e)})},"./glTF/2.0/Extensions/MSFT_lod.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"MSFT_lod",function(){return a});var r=n("babylonjs/Misc/observable"),i=n("./glTF/2.0/glTFLoader.ts"),o="MSFT_lod",a=function(){function e(e){this.name=o,this.order=100,this.maxLODsToLoad=10,this.onNodeLODsLoadedObservable=new r.Observable,this.onMaterialLODsLoadedObservable=new r.Observable,this._bufferLODs=new Array,this._nodeIndexLOD=null,this._nodeSignalLODs=new Array,this._nodePromiseLODs=new Array,this._nodeBufferLODs=new Array,this._materialIndexLOD=null,this._materialSignalLODs=new Array,this._materialPromiseLODs=new Array,this._materialBufferLODs=new Array,this._loader=e,this.enabled=this._loader.isExtensionUsed(o)}return e.prototype.dispose=function(){this._loader=null,this._nodeIndexLOD=null,this._nodeSignalLODs.length=0,this._nodePromiseLODs.length=0,this._nodeBufferLODs.length=0,this._materialIndexLOD=null,this._materialSignalLODs.length=0,this._materialPromiseLODs.length=0,this._materialBufferLODs.length=0,this.onMaterialLODsLoadedObservable.clear(),this.onNodeLODsLoadedObservable.clear()},e.prototype.onReady=function(){for(var e=this,t=function(t){var r=Promise.all(n._nodePromiseLODs[t]).then(function(){0!==t&&(e._loader.endPerformanceCounter("Node LOD "+t),e._loader.log("Loaded node LOD "+t)),e.onNodeLODsLoadedObservable.notifyObservers(t),t!==e._nodePromiseLODs.length-1&&(e._loader.startPerformanceCounter("Node LOD "+(t+1)),e._loadBufferLOD(e._nodeBufferLODs,t+1),e._nodeSignalLODs[t]&&e._nodeSignalLODs[t].resolve())});n._loader._completePromises.push(r)},n=this,r=0;r<this._nodePromiseLODs.length;r++)t(r);var i=function(t){var n=Promise.all(o._materialPromiseLODs[t]).then(function(){0!==t&&(e._loader.endPerformanceCounter("Material LOD "+t),e._loader.log("Loaded material LOD "+t)),e.onMaterialLODsLoadedObservable.notifyObservers(t),t!==e._materialPromiseLODs.length-1&&(e._loader.startPerformanceCounter("Material LOD "+(t+1)),e._loadBufferLOD(e._materialBufferLODs,t+1),e._materialSignalLODs[t]&&e._materialSignalLODs[t].resolve())});o._loader._completePromises.push(n)},o=this;for(r=0;r<this._materialPromiseLODs.length;r++)i(r)},e.prototype.loadSceneAsync=function(e,t){var n=this._loader.loadSceneAsync(e,t);return this._loadBufferLOD(this._bufferLODs,0),n},e.prototype.loadNodeAsync=function(e,t,n){var o=this;return i.GLTFLoader.LoadExtensionAsync(e,t,this.name,function(e,i){var a,s=o._getLODs(e,t,o._loader.gltf.nodes,i.ids);o._loader.logOpen(""+e);for(var l=[],c=0;c<s.length;c++)l.push(null);var u=function(e){var t=s[e];0!==e&&(o._nodeIndexLOD=e,o._nodeSignalLODs[e]=o._nodeSignalLODs[e]||new r.Deferred);var i=o._loader.loadNodeAsync("/nodes/"+t.index,t,function(t){return function(e,t){var n,r,i;e.setEnabled(!1),l[t]=e;for(var a=!0,s=0;s<l.length;s++)l[s]||(a=!1);var c=l[l.length-1];if(a&&c&&o._isMesh(c)){var u=null===(i=null===(r=null===(n=c.metadata)||void 0===n?void 0:n.gltf)||void 0===r?void 0:r.extras)||void 0===i?void 0:i.MSFT_screencoverage;if(u&&u.length){for(u.reverse(),c.useLODScreenCoverage=!0,s=0;s<l.length-1;s++){var _=l[s];_&&o._isMesh(_)&&c.addLODLevel(u[s+1],_)}u[0]>0&&c.addLODLevel(u[0],null)}}}(t,e)}).then(function(t){var r,i,a,l=null===(a=null===(i=null===(r=s[s.length-1]._babylonTransformNode.metadata)||void 0===r?void 0:r.gltf)||void 0===i?void 0:i.extras)||void 0===a?void 0:a.MSFT_screencoverage;if(0!==e&&!l){var c=s[e-1];c._babylonTransformNode&&(o._disposeTransformNode(c._babylonTransformNode),delete c._babylonTransformNode)}return n(t),t.setEnabled(!0),t});o._nodePromiseLODs[e]=o._nodePromiseLODs[e]||[],0===e?a=i:(o._nodeIndexLOD=null,o._nodePromiseLODs[e].push(i))};for(c=0;c<s.length;c++)u(c);return o._loader.logClose(),a})},e.prototype._loadMaterialAsync=function(e,t,n,r,o){var a=this;return this._nodeIndexLOD?null:i.GLTFLoader.LoadExtensionAsync(e,t,this.name,function(e,i){var s,l=a._getLODs(e,t,a._loader.gltf.materials,i.ids);a._loader.logOpen(""+e);for(var c=function(e){var t=l[e];0!==e&&(a._materialIndexLOD=e);var i=a._loader._loadMaterialAsync("/materials/"+t.index,t,n,r,function(t){0===e&&o(t)}).then(function(t){if(0!==e){o(t);var n=l[e-1]._data;n[r]&&(a._disposeMaterials([n[r].babylonMaterial]),delete n[r])}return t});a._materialPromiseLODs[e]=a._materialPromiseLODs[e]||[],0===e?s=i:(a._materialIndexLOD=null,a._materialPromiseLODs[e].push(i))},u=0;u<l.length;u++)c(u);return a._loader.logClose(),s})},e.prototype._loadUriAsync=function(e,t,n){var i=this;if(null!==this._nodeIndexLOD){this._loader.log("deferred");var o=this._nodeIndexLOD-1;return this._nodeSignalLODs[o]=this._nodeSignalLODs[o]||new r.Deferred,this._nodeSignalLODs[this._nodeIndexLOD-1].promise.then(function(){return i._loader.loadUriAsync(e,t,n)})}if(null!==this._materialIndexLOD){this._loader.log("deferred");o=this._materialIndexLOD-1;return this._materialSignalLODs[o]=this._materialSignalLODs[o]||new r.Deferred,this._materialSignalLODs[o].promise.then(function(){return i._loader.loadUriAsync(e,t,n)})}return null},e.prototype.loadBufferAsync=function(e,t,n,i){if(this._loader.parent.useRangeRequests&&!t.uri){if(!this._loader.bin)throw new Error(e+": Uri is missing or the binary glTF is missing its binary chunk");var o=function(e,t){var o=n,a=o+i-1,s=e[t];return s?(s.start=Math.min(s.start,o),s.end=Math.max(s.end,a)):(s={start:o,end:a,loaded:new r.Deferred},e[t]=s),s.loaded.promise.then(function(e){return new Uint8Array(e.buffer,e.byteOffset+n-s.start,i)})};return this._loader.log("deferred"),null!==this._nodeIndexLOD?o(this._nodeBufferLODs,this._nodeIndexLOD):null!==this._materialIndexLOD?o(this._materialBufferLODs,this._materialIndexLOD):o(this._bufferLODs,0)}return null},e.prototype._isMesh=function(e){return!!e.addLODLevel},e.prototype._loadBufferLOD=function(e,t){var n=e[t];n&&(this._loader.log("Loading buffer range ["+n.start+"-"+n.end+"]"),this._loader.bin.readAsync(n.start,n.end-n.start+1).then(function(e){n.loaded.resolve(e)},function(e){n.loaded.reject(e)}))},e.prototype._getLODs=function(e,t,n,r){if(this.maxLODsToLoad<=0)throw new Error("maxLODsToLoad must be greater than zero");for(var o=new Array,a=r.length-1;a>=0;a--)if(o.push(i.ArrayItem.Get(e+"/ids/"+r[a],n,r[a])),o.length===this.maxLODsToLoad)return o;return o.push(t),o},e.prototype._disposeTransformNode=function(e){var t=this,n=new Array,r=e.material;r&&n.push(r);for(var i=0,o=e.getChildMeshes();i<o.length;i++){var a=o[i];a.material&&n.push(a.material)}e.dispose();var s=n.filter(function(e){return t._loader.babylonScene.meshes.every(function(t){return t.material!=e})});this._disposeMaterials(s)},e.prototype._disposeMaterials=function(e){for(var t={},n=0,r=e;n<r.length;n++){for(var i=0,o=(u=r[n]).getActiveTextures();i<o.length;i++){var a=o[i];t[a.uniqueId]=a}u.dispose()}for(var s in t)for(var l=0,c=this._loader.babylonScene.materials;l<c.length;l++){var u;(u=c[l]).hasTexture(t[s])&&delete t[s]}for(var s in t)t[s].dispose()},e}();i.GLTFLoader.RegisterExtension(o,function(e){return new a(e)})},"./glTF/2.0/Extensions/MSFT_minecraftMesh.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"MSFT_minecraftMesh",function(){return a});var r=n("babylonjs/Misc/observable"),i=n("./glTF/2.0/glTFLoader.ts"),o="MSFT_minecraftMesh",a=function(){function e(e){this.name=o,this._loader=e,this.enabled=this._loader.isExtensionUsed(o)}return e.prototype.dispose=function(){this._loader=null},e.prototype.loadMaterialPropertiesAsync=function(e,t,n){var o=this;return i.GLTFLoader.LoadExtraAsync(e,t,this.name,function(i,a){if(a){if(!(n instanceof r.PBRMaterial))throw new Error(i+": Material type not supported");var s=o._loader.loadMaterialPropertiesAsync(e,t,n);return n.needAlphaBlending()&&(n.forceDepthWrite=!0,n.separateCullingPass=!0),n.backFaceCulling=n.forceDepthWrite,n.twoSidedLighting=!0,s}return null})},e}();i.GLTFLoader.RegisterExtension(o,function(e){return new a(e)})},"./glTF/2.0/Extensions/MSFT_sRGBFactors.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"MSFT_sRGBFactors",function(){return a});var r=n("babylonjs/Misc/observable"),i=n("./glTF/2.0/glTFLoader.ts"),o="MSFT_sRGBFactors",a=function(){function e(e){this.name=o,this._loader=e,this.enabled=this._loader.isExtensionUsed(o)}return e.prototype.dispose=function(){this._loader=null},e.prototype.loadMaterialPropertiesAsync=function(e,t,n){var o=this;return i.GLTFLoader.LoadExtraAsync(e,t,this.name,function(i,a){if(a){if(!(n instanceof r.PBRMaterial))throw new Error(i+": Material type not supported");var s=o._loader.loadMaterialPropertiesAsync(e,t,n);return n.albedoTexture||n.albedoColor.toLinearSpaceToRef(n.albedoColor),n.reflectivityTexture||n.reflectivityColor.toLinearSpaceToRef(n.reflectivityColor),s}return null})},e}();i.GLTFLoader.RegisterExtension(o,function(e){return new a(e)})},"./glTF/2.0/Extensions/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./glTF/2.0/Extensions/EXT_lights_image_based.ts");n.d(t,"EXT_lights_image_based",function(){return r.EXT_lights_image_based});var i=n("./glTF/2.0/Extensions/EXT_mesh_gpu_instancing.ts");n.d(t,"EXT_mesh_gpu_instancing",function(){return i.EXT_mesh_gpu_instancing});var o=n("./glTF/2.0/Extensions/EXT_meshopt_compression.ts");n.d(t,"EXT_meshopt_compression",function(){return o.EXT_meshopt_compression});var a=n("./glTF/2.0/Extensions/EXT_texture_webp.ts");n.d(t,"EXT_texture_webp",function(){return a.EXT_texture_webp});var s=n("./glTF/2.0/Extensions/KHR_draco_mesh_compression.ts");n.d(t,"KHR_draco_mesh_compression",function(){return s.KHR_draco_mesh_compression});var l=n("./glTF/2.0/Extensions/KHR_lights_punctual.ts");n.d(t,"KHR_lights",function(){return l.KHR_lights});var c=n("./glTF/2.0/Extensions/KHR_materials_pbrSpecularGlossiness.ts");n.d(t,"KHR_materials_pbrSpecularGlossiness",function(){return c.KHR_materials_pbrSpecularGlossiness});var u=n("./glTF/2.0/Extensions/KHR_materials_unlit.ts");n.d(t,"KHR_materials_unlit",function(){return u.KHR_materials_unlit});var _=n("./glTF/2.0/Extensions/KHR_materials_clearcoat.ts");n.d(t,"KHR_materials_clearcoat",function(){return _.KHR_materials_clearcoat});var h=n("./glTF/2.0/Extensions/KHR_materials_sheen.ts");n.d(t,"KHR_materials_sheen",function(){return h.KHR_materials_sheen});var f=n("./glTF/2.0/Extensions/KHR_materials_specular.ts");n.d(t,"KHR_materials_specular",function(){return f.KHR_materials_specular});var d=n("./glTF/2.0/Extensions/KHR_materials_ior.ts");n.d(t,"KHR_materials_ior",function(){return d.KHR_materials_ior});var p=n("./glTF/2.0/Extensions/KHR_materials_variants.ts");n.d(t,"KHR_materials_variants",function(){return p.KHR_materials_variants});var m=n("./glTF/2.0/Extensions/KHR_materials_transmission.ts");n.d(t,"KHR_materials_transmission",function(){return m.KHR_materials_transmission});var g=n("./glTF/2.0/Extensions/KHR_materials_translucency.ts");n.d(t,"KHR_materials_translucency",function(){return g.KHR_materials_translucency});var v=n("./glTF/2.0/Extensions/KHR_materials_volume.ts");n.d(t,"KHR_materials_volume",function(){return v.KHR_materials_volume});var b=n("./glTF/2.0/Extensions/KHR_mesh_quantization.ts");n.d(t,"KHR_mesh_quantization",function(){return b.KHR_mesh_quantization});var y=n("./glTF/2.0/Extensions/KHR_texture_basisu.ts");n.d(t,"KHR_texture_basisu",function(){return y.KHR_texture_basisu});var x=n("./glTF/2.0/Extensions/KHR_texture_transform.ts");n.d(t,"KHR_texture_transform",function(){return x.KHR_texture_transform});var T=n("./glTF/2.0/Extensions/KHR_xmp_json_ld.ts");n.d(t,"KHR_xmp_json_ld",function(){return T.KHR_xmp_json_ld});var O=n("./glTF/2.0/Extensions/MSFT_audio_emitter.ts");n.d(t,"MSFT_audio_emitter",function(){return O.MSFT_audio_emitter});var P=n("./glTF/2.0/Extensions/MSFT_lod.ts");n.d(t,"MSFT_lod",function(){return P.MSFT_lod});var C=n("./glTF/2.0/Extensions/MSFT_minecraftMesh.ts");n.d(t,"MSFT_minecraftMesh",function(){return C.MSFT_minecraftMesh});var S=n("./glTF/2.0/Extensions/MSFT_sRGBFactors.ts");n.d(t,"MSFT_sRGBFactors",function(){return S.MSFT_sRGBFactors});var M=n("./glTF/2.0/Extensions/ExtrasAsMetadata.ts");n.d(t,"ExtrasAsMetadata",function(){return M.ExtrasAsMetadata})},"./glTF/2.0/glTFLoader.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"ArrayItem",function(){return o}),n.d(t,"GLTFLoader",function(){return a});var r=n("babylonjs/Misc/observable"),i=n("./glTF/glTFFileLoader.ts"),o=function(){function e(){}return e.Get=function(e,t,n){if(!t||null==n||!t[n])throw new Error(e+": Failed to find index ("+n+")");return t[n]},e.Assign=function(e){if(e)for(var t=0;t<e.length;t++)e[t].index=t},e}(),a=function(){function e(e){this._completePromises=new Array,this._assetContainer=null,this._babylonLights=[],this._disableInstancedMesh=0,this._disposed=!1,this._extensions=new Array,this._defaultBabylonMaterialData={},this._parent=e}return e.RegisterExtension=function(t,n){e.UnregisterExtension(t)&&r.Logger.Warn("Extension with the name '"+t+"' already exists"),e._RegisteredExtensions[t]={factory:n}},e.UnregisterExtension=function(t){return!!e._RegisteredExtensions[t]&&(delete e._RegisteredExtensions[t],!0)},Object.defineProperty(e.prototype,"gltf",{get:function(){return this._gltf},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bin",{get:function(){return this._bin},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"babylonScene",{get:function(){return this._babylonScene},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rootBabylonMesh",{get:function(){return this._rootBabylonMesh},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){if(!this._disposed){for(var e in this._disposed=!0,this._completePromises.length=0,this._extensions){var t=this._extensions[e];t.dispose&&t.dispose(),delete this._extensions[e]}this._gltf=null,this._babylonScene=null,this._rootBabylonMesh=null,this._parent.dispose()}},e.prototype.importMeshAsync=function(e,t,n,r,i,o,a){var s=this;return void 0===a&&(a=""),Promise.resolve().then(function(){s._babylonScene=t,s._assetContainer=n,s._loadData(r);var o=null;if(e){var l={};if(s._gltf.nodes)for(var c=0,u=s._gltf.nodes;c<u.length;c++){var _=u[c];_.name&&(l[_.name]=_.index)}o=(e instanceof Array?e:[e]).map(function(e){var t=l[e];if(void 0===t)throw new Error("Failed to find node '"+e+"'");return t})}return s._loadAsync(i,a,o,function(){return{meshes:s._getMeshes(),particleSystems:[],skeletons:s._getSkeletons(),animationGroups:s._getAnimationGroups(),lights:s._babylonLights,transformNodes:s._getTransformNodes(),geometries:s._getGeometries()}})})},e.prototype.loadAsync=function(e,t,n,r,i){var o=this;return void 0===i&&(i=""),Promise.resolve().then(function(){return o._babylonScene=e,o._loadData(t),o._loadAsync(n,i,null,function(){})})},e.prototype._loadAsync=function(e,t,n,a){var s=this;return Promise.resolve().then(function(){s._rootUrl=e,s._uniqueRootUrl=!r.StringTools.StartsWith(e,"file:")&&t?e:""+e+Date.now()+"/",s._fileName=t,s._loadExtensions(),s._checkExtensions();var l=i.GLTFLoaderState[i.GLTFLoaderState.LOADING]+" => "+i.GLTFLoaderState[i.GLTFLoaderState.READY],c=i.GLTFLoaderState[i.GLTFLoaderState.LOADING]+" => "+i.GLTFLoaderState[i.GLTFLoaderState.COMPLETE];s._parent._startPerformanceCounter(l),s._parent._startPerformanceCounter(c),s._parent._setState(i.GLTFLoaderState.LOADING),s._extensionsOnLoading();var u=new Array,_=s._babylonScene.blockMaterialDirtyMechanism;if(s._babylonScene.blockMaterialDirtyMechanism=!0,n)u.push(s.loadSceneAsync("/nodes",{nodes:n,index:-1}));else if(null!=s._gltf.scene||s._gltf.scenes&&s._gltf.scenes[0]){var h=o.Get("/scene",s._gltf.scenes,s._gltf.scene||0);u.push(s.loadSceneAsync("/scenes/"+h.index,h))}if(s.parent.loadAllMaterials&&s._gltf.materials)for(var f=0;f<s._gltf.materials.length;++f){var d=s._gltf.materials[f],p="/materials/"+f,m=r.Material.TriangleFillMode;u.push(s._loadMaterialAsync(p,d,null,m,function(e){}))}return s._babylonScene.blockMaterialDirtyMechanism=_,s._parent.compileMaterials&&u.push(s._compileMaterialsAsync()),s._parent.compileShadowGenerators&&u.push(s._compileShadowGeneratorsAsync()),Promise.all(u).then(function(){return s._rootBabylonMesh&&s._rootBabylonMesh.setEnabled(!0),s._extensionsOnReady(),s._parent._setState(i.GLTFLoaderState.READY),s._startAnimations(),a()}).then(function(e){return s._parent._endPerformanceCounter(l),r.Tools.SetImmediate(function(){s._disposed||Promise.all(s._completePromises).then(function(){s._parent._endPerformanceCounter(c),s._parent._setState(i.GLTFLoaderState.COMPLETE),s._parent.onCompleteObservable.notifyObservers(void 0),s._parent.onCompleteObservable.clear(),s.dispose()},function(e){s._parent.onErrorObservable.notifyObservers(e),s._parent.onErrorObservable.clear(),s.dispose()})}),e})}).catch(function(e){throw s._disposed||(s._parent.onErrorObservable.notifyObservers(e),s._parent.onErrorObservable.clear(),s.dispose()),e})},e.prototype._loadData=function(e){if(this._gltf=e.json,this._setupData(),e.bin){var t=this._gltf.buffers;if(t&&t[0]&&!t[0].uri){var n=t[0];(n.byteLength<e.bin.byteLength-3||n.byteLength>e.bin.byteLength)&&r.Logger.Warn("Binary buffer length ("+n.byteLength+") from JSON does not match chunk length ("+e.bin.byteLength+")"),this._bin=e.bin}else r.Logger.Warn("Unexpected BIN chunk")}},e.prototype._setupData=function(){if(o.Assign(this._gltf.accessors),o.Assign(this._gltf.animations),o.Assign(this._gltf.buffers),o.Assign(this._gltf.bufferViews),o.Assign(this._gltf.cameras),o.Assign(this._gltf.images),o.Assign(this._gltf.materials),o.Assign(this._gltf.meshes),o.Assign(this._gltf.nodes),o.Assign(this._gltf.samplers),o.Assign(this._gltf.scenes),o.Assign(this._gltf.skins),o.Assign(this._gltf.textures),this._gltf.nodes){for(var e={},t=0,n=this._gltf.nodes;t<n.length;t++){if((c=n[t]).children)for(var r=0,i=c.children;r<i.length;r++){e[i[r]]=c.index}}for(var a=this._createRootNode(),s=0,l=this._gltf.nodes;s<l.length;s++){var c,u=e[(c=l[s]).index];c.parent=void 0===u?a:this._gltf.nodes[u]}}},e.prototype._loadExtensions=function(){for(var t in e._RegisteredExtensions){var n=e._RegisteredExtensions[t].factory(this);n.name!==t&&r.Logger.Warn("The name of the glTF loader extension instance does not match the registered name: "+n.name+" !== "+t),this._extensions.push(n),this._parent.onExtensionLoadedObservable.notifyObservers(n)}this._extensions.sort(function(e,t){return(e.order||Number.MAX_VALUE)-(t.order||Number.MAX_VALUE)}),this._parent.onExtensionLoadedObservable.clear()},e.prototype._checkExtensions=function(){if(this._gltf.extensionsRequired)for(var e=function(e){if(!t._extensions.some(function(t){return t.name===e&&t.enabled}))throw new Error("Require extension "+e+" is not available")},t=this,n=0,r=this._gltf.extensionsRequired;n<r.length;n++){e(r[n])}},e.prototype._createRootNode=function(){this._babylonScene._blockEntityCollection=!!this._assetContainer,this._rootBabylonMesh=new r.Mesh("__root__",this._babylonScene),this._rootBabylonMesh._parentContainer=this._assetContainer,this._babylonScene._blockEntityCollection=!1,this._rootBabylonMesh.setEnabled(!1);var t={_babylonTransformNode:this._rootBabylonMesh,index:-1};switch(this._parent.coordinateSystemMode){case i.GLTFLoaderCoordinateSystemMode.AUTO:this._babylonScene.useRightHandedSystem||(t.rotation=[0,1,0,0],t.scale=[1,1,-1],e._LoadTransform(t,this._rootBabylonMesh));break;case i.GLTFLoaderCoordinateSystemMode.FORCE_RIGHT_HANDED:this._babylonScene.useRightHandedSystem=!0;break;default:throw new Error("Invalid coordinate system mode ("+this._parent.coordinateSystemMode+")")}return this._parent.onMeshLoadedObservable.notifyObservers(this._rootBabylonMesh),t},e.prototype.loadSceneAsync=function(e,t){var n=this,r=this._extensionsLoadSceneAsync(e,t);if(r)return r;var i=new Array;if(this.logOpen(e+" "+(t.name||"")),t.nodes)for(var a=0,s=t.nodes;a<s.length;a++){var l=s[a],c=o.Get(e+"/nodes/"+l,this._gltf.nodes,l);i.push(this.loadNodeAsync("/nodes/"+c.index,c,function(e){e.parent=n._rootBabylonMesh}))}if(this._gltf.nodes)for(var u=0,_=this._gltf.nodes;u<_.length;u++){if((c=_[u])._babylonTransformNode&&c._babylonBones)for(var h=0,f=c._babylonBones;h<f.length;h++){f[h].linkTransformNode(c._babylonTransformNode)}}return i.push(this._loadAnimationsAsync()),this.logClose(),Promise.all(i).then(function(){})},e.prototype._forEachPrimitive=function(e,t){if(e._primitiveBabylonMeshes)for(var n=0,r=e._primitiveBabylonMeshes;n<r.length;n++){t(r[n])}},e.prototype._getGeometries=function(){var e=new Array,t=this._gltf.nodes;if(t)for(var n=0,r=t;n<r.length;n++){var i=r[n];this._forEachPrimitive(i,function(t){var n=t.geometry;n&&-1===e.indexOf(n)&&e.push(n)})}return e},e.prototype._getMeshes=function(){var e=new Array;e.push(this._rootBabylonMesh);var t=this._gltf.nodes;if(t)for(var n=0,r=t;n<r.length;n++){var i=r[n];this._forEachPrimitive(i,function(t){e.push(t)})}return e},e.prototype._getTransformNodes=function(){var e=new Array,t=this._gltf.nodes;if(t)for(var n=0,r=t;n<r.length;n++){var i=r[n];i._babylonTransformNode&&"TransformNode"===i._babylonTransformNode.getClassName()&&e.push(i._babylonTransformNode)}return e},e.prototype._getSkeletons=function(){var e=new Array,t=this._gltf.skins;if(t)for(var n=0,r=t;n<r.length;n++){var i=r[n];i._data&&e.push(i._data.babylonSkeleton)}return e},e.prototype._getAnimationGroups=function(){var e=new Array,t=this._gltf.animations;if(t)for(var n=0,r=t;n<r.length;n++){var i=r[n];i._babylonAnimationGroup&&e.push(i._babylonAnimationGroup)}return e},e.prototype._startAnimations=function(){switch(this._parent.animationStartMode){case i.GLTFLoaderAnimationStartMode.NONE:break;case i.GLTFLoaderAnimationStartMode.FIRST:0!==(e=this._getAnimationGroups()).length&&e[0].start(!0);break;case i.GLTFLoaderAnimationStartMode.ALL:for(var e,t=0,n=e=this._getAnimationGroups();t<n.length;t++){n[t].start(!0)}break;default:return void r.Logger.Error("Invalid animation start mode ("+this._parent.animationStartMode+")")}},e.prototype.loadNodeAsync=function(t,n,i){var a=this;void 0===i&&(i=function(){});var s=this._extensionsLoadNodeAsync(t,n,i);if(s)return s;if(n._babylonTransformNode)throw new Error(t+": Invalid recursive node hierarchy");var l=new Array;this.logOpen(t+" "+(n.name||""));var c=function(r){if(e.AddPointerMetadata(r,t),e._LoadTransform(n,r),null!=n.camera){var s=o.Get(t+"/camera",a._gltf.cameras,n.camera);l.push(a.loadCameraAsync("/cameras/"+s.index,s,function(e){e.parent=r}))}if(n.children)for(var c=0,u=n.children;c<u.length;c++){var _=u[c],h=o.Get(t+"/children/"+_,a._gltf.nodes,_);l.push(a.loadNodeAsync("/nodes/"+h.index,h,function(e){e.parent=r}))}i(r)};if(null==n.mesh){var u=n.name||"node"+n.index;this._babylonScene._blockEntityCollection=!!this._assetContainer,n._babylonTransformNode=new r.TransformNode(u,this._babylonScene),n._babylonTransformNode._parentContainer=this._assetContainer,this._babylonScene._blockEntityCollection=!1,c(n._babylonTransformNode)}else{var _=o.Get(t+"/mesh",this._gltf.meshes,n.mesh);l.push(this._loadMeshAsync("/meshes/"+_.index,n,_,c))}return this.logClose(),Promise.all(l).then(function(){return a._forEachPrimitive(n,function(e){e.geometry&&e.geometry.useBoundingInfoFromGeometry?e._updateBoundingInfo():e.refreshBoundingInfo(!0)}),n._babylonTransformNode})},e.prototype._loadMeshAsync=function(e,t,n,i){var a=n.primitives;if(!a||!a.length)throw new Error(e+": Primitives are missing");null==a[0].index&&o.Assign(a);var s=new Array;this.logOpen(e+" "+(n.name||""));var l=t.name||"node"+t.index;if(1===a.length){var c=n.primitives[0];s.push(this._loadMeshPrimitiveAsync(e+"/primitives/"+c.index,l,t,n,c,function(e){t._babylonTransformNode=e,t._primitiveBabylonMeshes=[e]}))}else{this._babylonScene._blockEntityCollection=!!this._assetContainer,t._babylonTransformNode=new r.TransformNode(l,this._babylonScene),t._babylonTransformNode._parentContainer=this._assetContainer,this._babylonScene._blockEntityCollection=!1,t._primitiveBabylonMeshes=[];for(var u=0,_=a;u<_.length;u++){c=_[u];s.push(this._loadMeshPrimitiveAsync(e+"/primitives/"+c.index,l+"_primitive"+c.index,t,n,c,function(e){e.parent=t._babylonTransformNode,t._primitiveBabylonMeshes.push(e)}))}}if(null!=t.skin){var h=o.Get(e+"/skin",this._gltf.skins,t.skin);s.push(this._loadSkinAsync("/skins/"+h.index,t,h))}return i(t._babylonTransformNode),this.logClose(),Promise.all(s).then(function(){return t._babylonTransformNode})},e.prototype._loadMeshPrimitiveAsync=function(t,n,i,a,s,l){var c=this,u=this._extensionsLoadMeshPrimitiveAsync(t,n,i,a,s,l);if(u)return u;this.logOpen(""+t);var _,h,f=0===this._disableInstancedMesh&&this._parent.createInstances&&null==i.skin&&!a.primitives[0].targets;if(f&&s._instanceData)this._babylonScene._blockEntityCollection=!!this._assetContainer,(_=s._instanceData.babylonSourceMesh.createInstance(n))._parentContainer=this._assetContainer,this._babylonScene._blockEntityCollection=!1,h=s._instanceData.promise;else{var d=new Array;this._babylonScene._blockEntityCollection=!!this._assetContainer;var p=new r.Mesh(n,this._babylonScene);p._parentContainer=this._assetContainer,this._babylonScene._blockEntityCollection=!1,p.overrideMaterialSideOrientation=this._babylonScene.useRightHandedSystem?r.Material.CounterClockWiseSideOrientation:r.Material.ClockWiseSideOrientation,this._createMorphTargets(t,i,a,s,p),d.push(this._loadVertexDataAsync(t,s,p).then(function(e){return c._loadMorphTargetsAsync(t,s,p,e).then(function(){c._babylonScene._blockEntityCollection=!!c._assetContainer,e.applyToMesh(p),e._parentContainer=c._assetContainer,c._babylonScene._blockEntityCollection=!1})}));var m=e._GetDrawMode(t,s.mode);if(null==s.material){var g=this._defaultBabylonMaterialData[m];g||(g=this._createDefaultMaterial("__GLTFLoader._default",m),this._parent.onMaterialLoadedObservable.notifyObservers(g),this._defaultBabylonMaterialData[m]=g),p.material=g}else{var v=o.Get(t+"/material",this._gltf.materials,s.material);d.push(this._loadMaterialAsync("/materials/"+v.index,v,p,m,function(e){p.material=e}))}h=Promise.all(d),f&&(s._instanceData={babylonSourceMesh:p,promise:h}),_=p}return e.AddPointerMetadata(_,t),this._parent.onMeshLoadedObservable.notifyObservers(_),l(_),this.logClose(),h.then(function(){return _})},e.prototype._loadVertexDataAsync=function(e,t,n){var i=this,a=this._extensionsLoadVertexDataAsync(e,t,n);if(a)return a;var s=t.attributes;if(!s)throw new Error(e+": Attributes are missing");var l=new Array,c=new r.Geometry(n.name,this._babylonScene);if(null==t.indices)n.isUnIndexed=!0;else{var u=o.Get(e+"/indices",this._gltf.accessors,t.indices);l.push(this._loadIndicesAccessorAsync("/accessors/"+u.index,u).then(function(e){c.setIndices(e)}))}var _=function(t,a,u){if(null!=s[t]){n._delayInfo=n._delayInfo||[],-1===n._delayInfo.indexOf(a)&&n._delayInfo.push(a);var _=o.Get(e+"/attributes/"+t,i._gltf.accessors,s[t]);l.push(i._loadVertexAccessorAsync("/accessors/"+_.index,_,a).then(function(e){if(e.getKind()===r.VertexBuffer.PositionKind&&!i.parent.alwaysComputeBoundingBox&&!n.skeleton){var t=_.min,o=_.max;if(void 0!==t&&void 0!==o){if(_.normalized&&5126!==_.componentType){var a=1;switch(_.componentType){case 5120:a=127;break;case 5121:a=255;break;case 5122:a=32767;break;case 5123:a=65535}for(var s=0;s<3;++s)t[s]=Math.max(t[s]/a,-1),o[s]=Math.max(o[s]/a,-1)}var l=r.TmpVectors.Vector3[0],u=r.TmpVectors.Vector3[1];l.copyFromFloats.apply(l,t),u.copyFromFloats.apply(u,o),c._boundingInfo=new r.BoundingInfo(l,u),c.useBoundingInfoFromGeometry=!0}}c.setVerticesBuffer(e,_.count)})),a==r.VertexBuffer.MatricesIndicesExtraKind&&(n.numBoneInfluencers=8),u&&u(_)}};return _("POSITION",r.VertexBuffer.PositionKind),_("NORMAL",r.VertexBuffer.NormalKind),_("TANGENT",r.VertexBuffer.TangentKind),_("TEXCOORD_0",r.VertexBuffer.UVKind),_("TEXCOORD_1",r.VertexBuffer.UV2Kind),_("TEXCOORD_2",r.VertexBuffer.UV3Kind),_("TEXCOORD_3",r.VertexBuffer.UV4Kind),_("TEXCOORD_4",r.VertexBuffer.UV5Kind),_("TEXCOORD_5",r.VertexBuffer.UV6Kind),_("JOINTS_0",r.VertexBuffer.MatricesIndicesKind),_("WEIGHTS_0",r.VertexBuffer.MatricesWeightsKind),_("JOINTS_1",r.VertexBuffer.MatricesIndicesExtraKind),_("WEIGHTS_1",r.VertexBuffer.MatricesWeightsExtraKind),_("COLOR_0",r.VertexBuffer.ColorKind,function(e){"VEC4"===e.type&&(n.hasVertexAlpha=!0)}),Promise.all(l).then(function(){return c})},e.prototype._createMorphTargets=function(e,t,n,i,o){if(i.targets){if(null==t._numMorphTargets)t._numMorphTargets=i.targets.length;else if(i.targets.length!==t._numMorphTargets)throw new Error(e+": Primitives do not have the same number of targets");var a=n.extras?n.extras.targetNames:null;o.morphTargetManager=new r.MorphTargetManager(o.getScene()),o.morphTargetManager.areUpdatesFrozen=!0;for(var s=0;s<i.targets.length;s++){var l=t.weights?t.weights[s]:n.weights?n.weights[s]:0,c=a?a[s]:"morphTarget"+s;o.morphTargetManager.addTarget(new r.MorphTarget(c,l,o.getScene()))}}},e.prototype._loadMorphTargetsAsync=function(e,t,n,r){if(!t.targets)return Promise.resolve();for(var i=new Array,o=n.morphTargetManager,a=0;a<o.numTargets;a++){var s=o.getTarget(a);i.push(this._loadMorphTargetVertexDataAsync(e+"/targets/"+a,r,t.targets[a],s))}return Promise.all(i).then(function(){o.areUpdatesFrozen=!1})},e.prototype._loadMorphTargetVertexDataAsync=function(e,t,n,i){var a=this,s=new Array,l=function(r,i,l){if(null!=n[r]){var c=t.getVertexBuffer(i);if(c){var u=o.Get(e+"/"+r,a._gltf.accessors,n[r]);s.push(a._loadFloatAccessorAsync("/accessors/"+u.index,u).then(function(e){l(c,e)}))}}};return l("POSITION",r.VertexBuffer.PositionKind,function(e,t){var n=new Float32Array(t.length);e.forEach(t.length,function(e,r){n[r]=t[r]+e}),i.setPositions(n)}),l("NORMAL",r.VertexBuffer.NormalKind,function(e,t){var n=new Float32Array(t.length);e.forEach(n.length,function(e,r){n[r]=t[r]+e}),i.setNormals(n)}),l("TANGENT",r.VertexBuffer.TangentKind,function(e,t){var n=new Float32Array(t.length/3*4),r=0;e.forEach(t.length/3*4,function(e,i){(i+1)%4!=0&&(n[r]=t[r]+e,r++)}),i.setTangents(n)}),Promise.all(s).then(function(){})},e._LoadTransform=function(e,t){if(null==e.skin){var n=r.Vector3.Zero(),i=r.Quaternion.Identity(),o=r.Vector3.One();if(e.matrix)r.Matrix.FromArray(e.matrix).decompose(o,i,n);else e.translation&&(n=r.Vector3.FromArray(e.translation)),e.rotation&&(i=r.Quaternion.FromArray(e.rotation)),e.scale&&(o=r.Vector3.FromArray(e.scale));t.position=n,t.rotationQuaternion=i,t.scaling=o}},e.prototype._loadSkinAsync=function(e,t,n){var i=this,o=this._extensionsLoadSkinAsync(e,t,n);if(o)return o;var a=function(e){i._forEachPrimitive(t,function(t){t.skeleton=e})};if(n._data)return a(n._data.babylonSkeleton),n._data.promise;var s="skeleton"+n.index;this._babylonScene._blockEntityCollection=!!this._assetContainer;var l=new r.Skeleton(n.name||s,s,this._babylonScene);l._parentContainer=this._assetContainer,this._babylonScene._blockEntityCollection=!1,l.overrideMesh=this._rootBabylonMesh,this._loadBones(e,n,l),a(l);var c=this._loadSkinInverseBindMatricesDataAsync(e,n).then(function(e){i._updateBoneMatrices(l,e)});return n._data={babylonSkeleton:l,promise:c},c},e.prototype._loadBones=function(e,t,n){for(var r={},i=0,a=t.joints;i<a.length;i++){var s=a[i],l=o.Get(e+"/joints/"+s,this._gltf.nodes,s);this._loadBone(l,t,n,r)}},e.prototype._loadBone=function(e,t,n,i){var o=i[e.index];if(o)return o;var a=null;e.parent&&e.parent._babylonTransformNode!==this._rootBabylonMesh&&(a=this._loadBone(e.parent,t,n,i));var s=t.joints.indexOf(e.index);return o=new r.Bone(e.name||"joint"+e.index,n,a,this._getNodeMatrix(e),null,null,s),i[e.index]=o,e._babylonBones=e._babylonBones||[],e._babylonBones.push(o),o},e.prototype._loadSkinInverseBindMatricesDataAsync=function(e,t){if(null==t.inverseBindMatrices)return Promise.resolve(null);var n=o.Get(e+"/inverseBindMatrices",this._gltf.accessors,t.inverseBindMatrices);return this._loadFloatAccessorAsync("/accessors/"+n.index,n)},e.prototype._updateBoneMatrices=function(e,t){for(var n=0,i=e.bones;n<i.length;n++){var o=i[n],a=r.Matrix.Identity(),s=o._index;t&&-1!==s&&(r.Matrix.FromArrayToRef(t,16*s,a),a.invertToRef(a));var l=o.getParent();l&&a.multiplyToRef(l.getInvertedAbsoluteTransform(),a),o.updateMatrix(a,!1,!1),o._updateDifferenceMatrix(void 0,!1)}},e.prototype._getNodeMatrix=function(e){return e.matrix?r.Matrix.FromArray(e.matrix):r.Matrix.Compose(e.scale?r.Vector3.FromArray(e.scale):r.Vector3.One(),e.rotation?r.Quaternion.FromArray(e.rotation):r.Quaternion.Identity(),e.translation?r.Vector3.FromArray(e.translation):r.Vector3.Zero())},e.prototype.loadCameraAsync=function(t,n,i){void 0===i&&(i=function(){});var o=this._extensionsLoadCameraAsync(t,n,i);if(o)return o;var a=new Array;this.logOpen(t+" "+(n.name||"")),this._babylonScene._blockEntityCollection=!!this._assetContainer;var s=new r.FreeCamera(n.name||"camera"+n.index,r.Vector3.Zero(),this._babylonScene,!1);switch(s._parentContainer=this._assetContainer,this._babylonScene._blockEntityCollection=!1,s.ignoreParentScaling=!0,s.rotation=new r.Vector3(0,Math.PI,0),n.type){case"perspective":var l=n.perspective;if(!l)throw new Error(t+": Camera perspective properties are missing");s.fov=l.yfov,s.minZ=l.znear,s.maxZ=l.zfar||0;break;case"orthographic":if(!n.orthographic)throw new Error(t+": Camera orthographic properties are missing");s.mode=r.Camera.ORTHOGRAPHIC_CAMERA,s.orthoLeft=-n.orthographic.xmag,s.orthoRight=n.orthographic.xmag,s.orthoBottom=-n.orthographic.ymag,s.orthoTop=n.orthographic.ymag,s.minZ=n.orthographic.znear,s.maxZ=n.orthographic.zfar;break;default:throw new Error(t+": Invalid camera type ("+n.type+")")}return e.AddPointerMetadata(s,t),this._parent.onCameraLoadedObservable.notifyObservers(s),i(s),this.logClose(),Promise.all(a).then(function(){return s})},e.prototype._loadAnimationsAsync=function(){var e=this._gltf.animations;if(!e)return Promise.resolve();for(var t=new Array,n=0;n<e.length;n++){var r=e[n];t.push(this.loadAnimationAsync("/animations/"+r.index,r).then(function(e){0===e.targetedAnimations.length&&e.dispose()}))}return Promise.all(t).then(function(){})},e.prototype.loadAnimationAsync=function(e,t){var n=this._extensionsLoadAnimationAsync(e,t);if(n)return n;this._babylonScene._blockEntityCollection=!!this._assetContainer;var i=new r.AnimationGroup(t.name||"animation"+t.index,this._babylonScene);i._parentContainer=this._assetContainer,this._babylonScene._blockEntityCollection=!1,t._babylonAnimationGroup=i;var a=new Array;o.Assign(t.channels),o.Assign(t.samplers);for(var s=0,l=t.channels;s<l.length;s++){var c=l[s];a.push(this._loadAnimationChannelAsync(e+"/channels/"+c.index,e,t,c,i))}return Promise.all(a).then(function(){return i.normalize(0),i})},e.prototype._loadAnimationChannelAsync=function(e,t,n,i,a,s){var l=this;if(void 0===s&&(s=null),null==i.target.node)return Promise.resolve();var c=o.Get(e+"/target/node",this._gltf.nodes,i.target.node);if("weights"===i.target.path&&!c._numMorphTargets||"weights"!==i.target.path&&!c._babylonTransformNode)return Promise.resolve();var u=o.Get(e+"/sampler",n.samplers,i.sampler);return this._loadAnimationSamplerAsync(t+"/samplers/"+i.sampler,u).then(function(t){var n,o;switch(i.target.path){case"translation":n="position",o=r.Animation.ANIMATIONTYPE_VECTOR3;break;case"rotation":n="rotationQuaternion",o=r.Animation.ANIMATIONTYPE_QUATERNION;break;case"scale":n="scaling",o=r.Animation.ANIMATIONTYPE_VECTOR3;break;case"weights":n="influence",o=r.Animation.ANIMATIONTYPE_FLOAT;break;default:throw new Error(e+"/target/path: Invalid value ("+i.target.path+")")}var u,_,h=0;switch(n){case"position":u=function(){var e=r.Vector3.FromArray(t.output,h);return h+=3,e};break;case"rotationQuaternion":u=function(){var e=r.Quaternion.FromArray(t.output,h);return h+=4,e};break;case"scaling":u=function(){var e=r.Vector3.FromArray(t.output,h);return h+=3,e};break;case"influence":u=function(){for(var e=new Array(c._numMorphTargets),n=0;n<c._numMorphTargets;n++)e[n]=t.output[h++];return e}}switch(t.interpolation){case"STEP":_=function(e){return{frame:t.input[e],value:u(),interpolation:r.AnimationKeyInterpolation.STEP}};break;case"LINEAR":_=function(e){return{frame:t.input[e],value:u()}};break;case"CUBICSPLINE":_=function(e){return{frame:t.input[e],inTangent:u(),value:u(),outTangent:u()}}}for(var f=new Array(t.input.length),d=0;d<t.input.length;d++)f[d]=_(d);if("influence"===n)for(var p=function(e){var t=a.name+"_channel"+a.targetedAnimations.length,i=new r.Animation(t,n,1,o);i.setKeys(f.map(function(t){return{frame:t.frame,inTangent:t.inTangent?t.inTangent[e]:void 0,value:t.value[e],outTangent:t.outTangent?t.outTangent[e]:void 0}})),l._forEachPrimitive(c,function(t){var n=t.morphTargetManager.getTarget(e),r=i.clone();n.animations.push(r),a.addTargetedAnimation(r,n)})},m=0;m<c._numMorphTargets;m++)p(m);else{var g=a.name+"_channel"+a.targetedAnimations.length,v=new r.Animation(g,n,1,o);v.setKeys(f),null!=s&&null!=s.animations?(s.animations.push(v),a.addTargetedAnimation(v,s)):(c._babylonTransformNode.animations.push(v),a.addTargetedAnimation(v,c._babylonTransformNode))}})},e.prototype._loadAnimationSamplerAsync=function(e,t){if(t._data)return t._data;var n=t.interpolation||"LINEAR";switch(n){case"STEP":case"LINEAR":case"CUBICSPLINE":break;default:throw new Error(e+"/interpolation: Invalid value ("+t.interpolation+")")}var r=o.Get(e+"/input",this._gltf.accessors,t.input),i=o.Get(e+"/output",this._gltf.accessors,t.output);return t._data=Promise.all([this._loadFloatAccessorAsync("/accessors/"+r.index,r),this._loadFloatAccessorAsync("/accessors/"+i.index,i)]).then(function(e){var t=e[0],r=e[1];return{input:t,interpolation:n,output:r}}),t._data},e.prototype.loadBufferAsync=function(e,t,n,r){var i=this._extensionsLoadBufferAsync(e,t,n,r);if(i)return i;if(!t._data)if(t.uri)t._data=this.loadUriAsync(e+"/uri",t,t.uri);else{if(!this._bin)throw new Error(e+": Uri is missing or the binary glTF is missing its binary chunk");t._data=this._bin.readAsync(0,t.byteLength)}return t._data.then(function(t){try{return new Uint8Array(t.buffer,t.byteOffset+n,r)}catch(t){throw new Error(e+": "+t.message)}})},e.prototype.loadBufferViewAsync=function(e,t){var n=this._extensionsLoadBufferViewAsync(e,t);if(n)return n;if(t._data)return t._data;var r=o.Get(e+"/buffer",this._gltf.buffers,t.buffer);return t._data=this.loadBufferAsync("/buffers/"+r.index,r,t.byteOffset||0,t.byteLength),t._data},e.prototype._loadAccessorAsync=function(t,n,i){var a=this;if(n._data)return n._data;var s=e._GetNumComponents(t,n.type),l=s*r.VertexBuffer.GetTypeByteLength(n.componentType),c=s*n.count;if(null==n.bufferView)n._data=Promise.resolve(new i(c));else{var u=o.Get(t+"/bufferView",this._gltf.bufferViews,n.bufferView);n._data=this.loadBufferViewAsync("/bufferViews/"+u.index,u).then(function(o){if(5126!==n.componentType||n.normalized||u.byteStride&&u.byteStride!==l){var a=new i(c);return r.VertexBuffer.ForEach(o,n.byteOffset||0,u.byteStride||l,s,n.componentType,a.length,n.normalized||!1,function(e,t){a[t]=e}),a}return e._GetTypedArray(t,n.componentType,o,n.byteOffset,c)})}if(n.sparse){var _=n.sparse;n._data=n._data.then(function(c){var u=c,h=o.Get(t+"/sparse/indices/bufferView",a._gltf.bufferViews,_.indices.bufferView),f=o.Get(t+"/sparse/values/bufferView",a._gltf.bufferViews,_.values.bufferView);return Promise.all([a.loadBufferViewAsync("/bufferViews/"+h.index,h),a.loadBufferViewAsync("/bufferViews/"+f.index,f)]).then(function(o){var a,c=o[0],h=o[1],f=e._GetTypedArray(t+"/sparse/indices",_.indices.componentType,c,_.indices.byteOffset,_.count),d=s*_.count;if(5126!==n.componentType||n.normalized){var p=e._GetTypedArray(t+"/sparse/values",n.componentType,h,_.values.byteOffset,d);a=new i(d),r.VertexBuffer.ForEach(p,0,l,s,n.componentType,a.length,n.normalized||!1,function(e,t){a[t]=e})}else a=e._GetTypedArray(t+"/sparse/values",n.componentType,h,_.values.byteOffset,d);for(var m=0,g=0;g<f.length;g++)for(var v=f[g]*s,b=0;b<s;b++)u[v++]=a[m++];return u})})}return n._data},e.prototype._loadFloatAccessorAsync=function(e,t){return this._loadAccessorAsync(e,t,Float32Array)},e.prototype._loadIndicesAccessorAsync=function(t,n){if("SCALAR"!==n.type)throw new Error(t+"/type: Invalid value "+n.type);if(5121!==n.componentType&&5123!==n.componentType&&5125!==n.componentType)throw new Error(t+"/componentType: Invalid value "+n.componentType);if(n._data)return n._data;if(n.sparse){var r=e._GetTypedArrayConstructor(t+"/componentType",n.componentType);n._data=this._loadAccessorAsync(t,n,r)}else{var i=o.Get(t+"/bufferView",this._gltf.bufferViews,n.bufferView);n._data=this.loadBufferViewAsync("/bufferViews/"+i.index,i).then(function(r){return e._GetTypedArray(t,n.componentType,r,n.byteOffset,n.count)})}return n._data},e.prototype._loadVertexBufferViewAsync=function(e,t){var n=this;return e._babylonBuffer?e._babylonBuffer:(e._babylonBuffer=this.loadBufferViewAsync("/bufferViews/"+e.index,e).then(function(e){return new r.Buffer(n._babylonScene.getEngine(),e,!1)}),e._babylonBuffer)},e.prototype._loadVertexAccessorAsync=function(t,n,i){var a,s=this;if(null===(a=n._babylonVertexBuffer)||void 0===a?void 0:a[i])return n._babylonVertexBuffer[i];if(n._babylonVertexBuffer||(n._babylonVertexBuffer={}),n.sparse)n._babylonVertexBuffer[i]=this._loadFloatAccessorAsync(t,n).then(function(e){return new r.VertexBuffer(s._babylonScene.getEngine(),e,i,!1)});else if(i===r.VertexBuffer.MatricesIndicesKind||i===r.VertexBuffer.MatricesIndicesExtraKind)n._babylonVertexBuffer[i]=this._loadFloatAccessorAsync(t,n).then(function(e){return new r.VertexBuffer(s._babylonScene.getEngine(),e,i,!1)});else{var l=o.Get(t+"/bufferView",this._gltf.bufferViews,n.bufferView);n._babylonVertexBuffer[i]=this._loadVertexBufferViewAsync(l,i).then(function(o){var a=e._GetNumComponents(t,n.type);return new r.VertexBuffer(s._babylonScene.getEngine(),o,i,!1,!1,l.byteStride,!1,n.byteOffset,a,n.componentType,n.normalized,!0,1,!0)})}return n._babylonVertexBuffer[i]},e.prototype._loadMaterialMetallicRoughnessPropertiesAsync=function(e,t,n){if(!(n instanceof r.PBRMaterial))throw new Error(e+": Material type not supported");var i=new Array;return t&&(t.baseColorFactor?(n.albedoColor=r.Color3.FromArray(t.baseColorFactor),n.alpha=t.baseColorFactor[3]):n.albedoColor=r.Color3.White(),n.metallic=null==t.metallicFactor?1:t.metallicFactor,n.roughness=null==t.roughnessFactor?1:t.roughnessFactor,t.baseColorTexture&&i.push(this.loadTextureInfoAsync(e+"/baseColorTexture",t.baseColorTexture,function(e){e.name=n.name+" (Base Color)",n.albedoTexture=e})),t.metallicRoughnessTexture&&(t.metallicRoughnessTexture.nonColorData=!0,i.push(this.loadTextureInfoAsync(e+"/metallicRoughnessTexture",t.metallicRoughnessTexture,function(e){e.name=n.name+" (Metallic Roughness)",n.metallicTexture=e})),n.useMetallnessFromMetallicTextureBlue=!0,n.useRoughnessFromMetallicTextureGreen=!0,n.useRoughnessFromMetallicTextureAlpha=!1)),Promise.all(i).then(function(){})},e.prototype._loadMaterialAsync=function(t,n,r,i,o){void 0===o&&(o=function(){});var a=this._extensionsLoadMaterialAsync(t,n,r,i,o);if(a)return a;n._data=n._data||{};var s=n._data[i];if(!s){this.logOpen(t+" "+(n.name||""));var l=this.createMaterial(t,n,i);s={babylonMaterial:l,babylonMeshes:[],promise:this.loadMaterialPropertiesAsync(t,n,l)},n._data[i]=s,e.AddPointerMetadata(l,t),this._parent.onMaterialLoadedObservable.notifyObservers(l),this.logClose()}return r&&(s.babylonMeshes.push(r),r.onDisposeObservable.addOnce(function(){var e=s.babylonMeshes.indexOf(r);-1!==e&&s.babylonMeshes.splice(e,1)})),o(s.babylonMaterial),s.promise.then(function(){return s.babylonMaterial})},e.prototype._createDefaultMaterial=function(e,t){this._babylonScene._blockEntityCollection=!!this._assetContainer;var n=new r.PBRMaterial(e,this._babylonScene);return n._parentContainer=this._assetContainer,this._babylonScene._blockEntityCollection=!1,n.fillMode=t,n.enableSpecularAntiAliasing=!0,n.useRadianceOverAlpha=!this._parent.transparencyAsCoverage,n.useSpecularOverAlpha=!this._parent.transparencyAsCoverage,n.transparencyMode=r.PBRMaterial.PBRMATERIAL_OPAQUE,n.metallic=1,n.roughness=1,n},e.prototype.createMaterial=function(e,t,n){var r=this._extensionsCreateMaterial(e,t,n);if(r)return r;var i=t.name||"material"+t.index;return this._createDefaultMaterial(i,n)},e.prototype.loadMaterialPropertiesAsync=function(e,t,n){var r=this._extensionsLoadMaterialPropertiesAsync(e,t,n);if(r)return r;var i=new Array;return i.push(this.loadMaterialBasePropertiesAsync(e,t,n)),t.pbrMetallicRoughness&&i.push(this._loadMaterialMetallicRoughnessPropertiesAsync(e+"/pbrMetallicRoughness",t.pbrMetallicRoughness,n)),this.loadMaterialAlphaProperties(e,t,n),Promise.all(i).then(function(){})},e.prototype.loadMaterialBasePropertiesAsync=function(e,t,n){if(!(n instanceof r.PBRMaterial))throw new Error(e+": Material type not supported");var i=new Array;return n.emissiveColor=t.emissiveFactor?r.Color3.FromArray(t.emissiveFactor):new r.Color3(0,0,0),t.doubleSided&&(n.backFaceCulling=!1,n.twoSidedLighting=!0),t.normalTexture&&(t.normalTexture.nonColorData=!0,i.push(this.loadTextureInfoAsync(e+"/normalTexture",t.normalTexture,function(e){e.name=n.name+" (Normal)",n.bumpTexture=e})),n.invertNormalMapX=!this._babylonScene.useRightHandedSystem,n.invertNormalMapY=this._babylonScene.useRightHandedSystem,null!=t.normalTexture.scale&&(n.bumpTexture.level=t.normalTexture.scale),n.forceIrradianceInFragment=!0),t.occlusionTexture&&(t.occlusionTexture.nonColorData=!0,i.push(this.loadTextureInfoAsync(e+"/occlusionTexture",t.occlusionTexture,function(e){e.name=n.name+" (Occlusion)",n.ambientTexture=e})),n.useAmbientInGrayScale=!0,null!=t.occlusionTexture.strength&&(n.ambientTextureStrength=t.occlusionTexture.strength)),t.emissiveTexture&&i.push(this.loadTextureInfoAsync(e+"/emissiveTexture",t.emissiveTexture,function(e){e.name=n.name+" (Emissive)",n.emissiveTexture=e})),Promise.all(i).then(function(){})},e.prototype.loadMaterialAlphaProperties=function(e,t,n){if(!(n instanceof r.PBRMaterial))throw new Error(e+": Material type not supported");switch(t.alphaMode||"OPAQUE"){case"OPAQUE":n.transparencyMode=r.PBRMaterial.PBRMATERIAL_OPAQUE;break;case"MASK":n.transparencyMode=r.PBRMaterial.PBRMATERIAL_ALPHATEST,n.alphaCutOff=null==t.alphaCutoff?.5:t.alphaCutoff,n.albedoTexture&&(n.albedoTexture.hasAlpha=!0);break;case"BLEND":n.transparencyMode=r.PBRMaterial.PBRMATERIAL_ALPHABLEND,n.albedoTexture&&(n.albedoTexture.hasAlpha=!0,n.useAlphaFromAlbedoTexture=!0);break;default:throw new Error(e+"/alphaMode: Invalid value ("+t.alphaMode+")")}},e.prototype.loadTextureInfoAsync=function(t,n,r){var i=this;void 0===r&&(r=function(){});var a=this._extensionsLoadTextureInfoAsync(t,n,r);if(a)return a;if(this.logOpen(""+t),n.texCoord>=6)throw new Error(t+"/texCoord: Invalid value ("+n.texCoord+")");var s=o.Get(t+"/index",this._gltf.textures,n.index);s._textureInfo=n;var l=this._loadTextureAsync("/textures/"+n.index,s,function(o){o.coordinatesIndex=n.texCoord||0,e.AddPointerMetadata(o,t),i._parent.onTextureLoadedObservable.notifyObservers(o),r(o)});return this.logClose(),l},e.prototype._loadTextureAsync=function(t,n,r){void 0===r&&(r=function(){});var i=this._extensionsLoadTextureAsync(t,n,r);if(i)return i;this.logOpen(t+" "+(n.name||""));var a=null==n.sampler?e.DefaultSampler:o.Get(t+"/sampler",this._gltf.samplers,n.sampler),s=o.Get(t+"/source",this._gltf.images,n.source),l=this._createTextureAsync(t,a,s,r,void 0,!n._textureInfo.nonColorData);return this.logClose(),l},e.prototype._createTextureAsync=function(e,t,n,i,o,a){var s=this;void 0===i&&(i=function(){});var l=this._loadSampler("/samplers/"+t.index,t),c=new Array,u=new r.Deferred;this._babylonScene._blockEntityCollection=!!this._assetContainer;var _={noMipmap:l.noMipMaps,invertY:!1,samplingMode:l.samplingMode,onLoad:function(){s._disposed||u.resolve()},onError:function(t,n){s._disposed||u.reject(new Error(e+": "+(n&&n.message?n.message:t||"Failed to load texture")))},mimeType:n.mimeType,loaderOptions:o,useSRGBBuffer:!!a&&this._parent.useSRGBBuffers},h=new r.Texture(null,this._babylonScene,_);return h._parentContainer=this._assetContainer,this._babylonScene._blockEntityCollection=!1,c.push(u.promise),c.push(this.loadImageAsync("/images/"+n.index,n).then(function(e){var t=n.uri||s._fileName+"#image"+n.index,r="data:"+s._uniqueRootUrl+t;h.updateURL(r,e)})),h.wrapU=l.wrapU,h.wrapV=l.wrapV,i(h),Promise.all(c).then(function(){return h})},e.prototype._loadSampler=function(t,n){return n._data||(n._data={noMipMaps:9728===n.minFilter||9729===n.minFilter,samplingMode:e._GetTextureSamplingMode(t,n),wrapU:e._GetTextureWrapMode(t+"/wrapS",n.wrapS),wrapV:e._GetTextureWrapMode(t+"/wrapT",n.wrapT)}),n._data},e.prototype.loadImageAsync=function(e,t){if(!t._data){if(this.logOpen(e+" "+(t.name||"")),t.uri)t._data=this.loadUriAsync(e+"/uri",t,t.uri);else{var n=o.Get(e+"/bufferView",this._gltf.bufferViews,t.bufferView);t._data=this.loadBufferViewAsync("/bufferViews/"+n.index,n)}this.logClose()}return t._data},e.prototype.loadUriAsync=function(t,n,i){var o=this,a=this._extensionsLoadUriAsync(t,n,i);if(a)return a;if(!e._ValidateUri(i))throw new Error(t+": '"+i+"' is invalid");if(Object(r.IsBase64DataUrl)(i)){var s=new Uint8Array(Object(r.DecodeBase64UrlToBinary)(i));return this.log(t+": Decoded "+i.substr(0,64)+"... ("+s.length+" bytes)"),Promise.resolve(s)}return this.log(t+": Loading "+i),this._parent.preprocessUrlAsync(this._rootUrl+i).then(function(e){return new Promise(function(n,a){o._parent._loadFile(o._babylonScene,e,function(e){o._disposed||(o.log(t+": Loaded "+i+" ("+e.byteLength+" bytes)"),n(new Uint8Array(e)))},!0,function(e){a(new r.LoadFileError(t+": Failed to load '"+i+"'"+(e?": "+e.status+" "+e.statusText:""),e))})})})},e.AddPointerMetadata=function(e,t){var n=e.metadata=e.metadata||{},r=n.gltf=n.gltf||{};(r.pointers=r.pointers||[]).push(t)},e._GetTextureWrapMode=function(e,t){switch(t=null==t?10497:t){case 33071:return r.Texture.CLAMP_ADDRESSMODE;case 33648:return r.Texture.MIRROR_ADDRESSMODE;case 10497:return r.Texture.WRAP_ADDRESSMODE;default:return r.Logger.Warn(e+": Invalid value ("+t+")"),r.Texture.WRAP_ADDRESSMODE}},e._GetTextureSamplingMode=function(e,t){var n=null==t.magFilter?9729:t.magFilter,i=null==t.minFilter?9987:t.minFilter;if(9729===n)switch(i){case 9728:return r.Texture.LINEAR_NEAREST;case 9729:return r.Texture.LINEAR_LINEAR;case 9984:return r.Texture.LINEAR_NEAREST_MIPNEAREST;case 9985:return r.Texture.LINEAR_LINEAR_MIPNEAREST;case 9986:return r.Texture.LINEAR_NEAREST_MIPLINEAR;case 9987:return r.Texture.LINEAR_LINEAR_MIPLINEAR;default:return r.Logger.Warn(e+"/minFilter: Invalid value ("+i+")"),r.Texture.LINEAR_LINEAR_MIPLINEAR}else switch(9728!==n&&r.Logger.Warn(e+"/magFilter: Invalid value ("+n+")"),i){case 9728:return r.Texture.NEAREST_NEAREST;case 9729:return r.Texture.NEAREST_LINEAR;case 9984:return r.Texture.NEAREST_NEAREST_MIPNEAREST;case 9985:return r.Texture.NEAREST_LINEAR_MIPNEAREST;case 9986:return r.Texture.NEAREST_NEAREST_MIPLINEAR;case 9987:return r.Texture.NEAREST_LINEAR_MIPLINEAR;default:return r.Logger.Warn(e+"/minFilter: Invalid value ("+i+")"),r.Texture.NEAREST_NEAREST_MIPNEAREST}},e._GetTypedArrayConstructor=function(e,t){switch(t){case 5120:return Int8Array;case 5121:return Uint8Array;case 5122:return Int16Array;case 5123:return Uint16Array;case 5125:return Uint32Array;case 5126:return Float32Array;default:throw new Error(e+": Invalid component type "+t)}},e._GetTypedArray=function(t,n,i,o,a){var s=i.buffer;o=i.byteOffset+(o||0);var l=e._GetTypedArrayConstructor(t+"/componentType",n),c=r.VertexBuffer.GetTypeByteLength(n);return o%c!=0?(r.Logger.Warn(t+": Copying buffer as byte offset ("+o+") is not a multiple of component type byte length ("+c+")"),new l(s.slice(o,o+a*c),0)):new l(s,o,a)},e._GetNumComponents=function(e,t){switch(t){case"SCALAR":return 1;case"VEC2":return 2;case"VEC3":return 3;case"VEC4":case"MAT2":return 4;case"MAT3":return 9;case"MAT4":return 16}throw new Error(e+": Invalid type ("+t+")")},e._ValidateUri=function(e){return r.Tools.IsBase64(e)||-1===e.indexOf("..")},e._GetDrawMode=function(e,t){switch(null==t&&(t=4),t){case 0:return r.Material.PointListDrawMode;case 1:return r.Material.LineListDrawMode;case 2:return r.Material.LineLoopDrawMode;case 3:return r.Material.LineStripDrawMode;case 4:return r.Material.TriangleFillMode;case 5:return r.Material.TriangleStripDrawMode;case 6:return r.Material.TriangleFanDrawMode}throw new Error(e+": Invalid mesh primitive mode ("+t+")")},e.prototype._compileMaterialsAsync=function(){var e=this;this._parent._startPerformanceCounter("Compile materials");var t=new Array;if(this._gltf.materials)for(var n=0,r=this._gltf.materials;n<r.length;n++){var i=r[n];if(i._data)for(var o in i._data)for(var a=i._data[o],s=0,l=a.babylonMeshes;s<l.length;s++){var c=l[s];c.computeWorldMatrix(!0);var u=a.babylonMaterial;t.push(u.forceCompilationAsync(c)),t.push(u.forceCompilationAsync(c,{useInstances:!0})),this._parent.useClipPlane&&(t.push(u.forceCompilationAsync(c,{clipPlane:!0})),t.push(u.forceCompilationAsync(c,{clipPlane:!0,useInstances:!0})))}}return Promise.all(t).then(function(){e._parent._endPerformanceCounter("Compile materials")})},e.prototype._compileShadowGeneratorsAsync=function(){var e=this;this._parent._startPerformanceCounter("Compile shadow generators");for(var t=new Array,n=0,r=this._babylonScene.lights;n<r.length;n++){var i=r[n].getShadowGenerator();i&&t.push(i.forceCompilationAsync())}return Promise.all(t).then(function(){e._parent._endPerformanceCounter("Compile shadow generators")})},e.prototype._forEachExtensions=function(e){for(var t=0,n=this._extensions;t<n.length;t++){var r=n[t];r.enabled&&e(r)}},e.prototype._applyExtensions=function(e,t,n){for(var r=0,i=this._extensions;r<i.length;r++){var o=i[r];if(o.enabled){var a=o.name+"."+t,s=e;s._activeLoaderExtensionFunctions=s._activeLoaderExtensionFunctions||{};var l=s._activeLoaderExtensionFunctions;if(!l[a]){l[a]=!0;try{var c=n(o);if(c)return c}finally{delete l[a]}}}}return null},e.prototype._extensionsOnLoading=function(){this._forEachExtensions(function(e){return e.onLoading&&e.onLoading()})},e.prototype._extensionsOnReady=function(){this._forEachExtensions(function(e){return e.onReady&&e.onReady()})},e.prototype._extensionsLoadSceneAsync=function(e,t){return this._applyExtensions(t,"loadScene",function(n){return n.loadSceneAsync&&n.loadSceneAsync(e,t)})},e.prototype._extensionsLoadNodeAsync=function(e,t,n){return this._applyExtensions(t,"loadNode",function(r){return r.loadNodeAsync&&r.loadNodeAsync(e,t,n)})},e.prototype._extensionsLoadCameraAsync=function(e,t,n){return this._applyExtensions(t,"loadCamera",function(r){return r.loadCameraAsync&&r.loadCameraAsync(e,t,n)})},e.prototype._extensionsLoadVertexDataAsync=function(e,t,n){return this._applyExtensions(t,"loadVertexData",function(r){return r._loadVertexDataAsync&&r._loadVertexDataAsync(e,t,n)})},e.prototype._extensionsLoadMeshPrimitiveAsync=function(e,t,n,r,i,o){return this._applyExtensions(i,"loadMeshPrimitive",function(a){return a._loadMeshPrimitiveAsync&&a._loadMeshPrimitiveAsync(e,t,n,r,i,o)})},e.prototype._extensionsLoadMaterialAsync=function(e,t,n,r,i){return this._applyExtensions(t,"loadMaterial",function(o){return o._loadMaterialAsync&&o._loadMaterialAsync(e,t,n,r,i)})},e.prototype._extensionsCreateMaterial=function(e,t,n){return this._applyExtensions(t,"createMaterial",function(r){return r.createMaterial&&r.createMaterial(e,t,n)})},e.prototype._extensionsLoadMaterialPropertiesAsync=function(e,t,n){return this._applyExtensions(t,"loadMaterialProperties",function(r){return r.loadMaterialPropertiesAsync&&r.loadMaterialPropertiesAsync(e,t,n)})},e.prototype._extensionsLoadTextureInfoAsync=function(e,t,n){return this._applyExtensions(t,"loadTextureInfo",function(r){return r.loadTextureInfoAsync&&r.loadTextureInfoAsync(e,t,n)})},e.prototype._extensionsLoadTextureAsync=function(e,t,n){return this._applyExtensions(t,"loadTexture",function(r){return r._loadTextureAsync&&r._loadTextureAsync(e,t,n)})},e.prototype._extensionsLoadAnimationAsync=function(e,t){return this._applyExtensions(t,"loadAnimation",function(n){return n.loadAnimationAsync&&n.loadAnimationAsync(e,t)})},e.prototype._extensionsLoadSkinAsync=function(e,t,n){return this._applyExtensions(n,"loadSkin",function(r){return r._loadSkinAsync&&r._loadSkinAsync(e,t,n)})},e.prototype._extensionsLoadUriAsync=function(e,t,n){return this._applyExtensions(t,"loadUri",function(r){return r._loadUriAsync&&r._loadUriAsync(e,t,n)})},e.prototype._extensionsLoadBufferViewAsync=function(e,t){return this._applyExtensions(t,"loadBufferView",function(n){return n.loadBufferViewAsync&&n.loadBufferViewAsync(e,t)})},e.prototype._extensionsLoadBufferAsync=function(e,t,n,r){return this._applyExtensions(t,"loadBuffer",function(i){return i.loadBufferAsync&&i.loadBufferAsync(e,t,n,r)})},e.LoadExtensionAsync=function(e,t,n,r){if(!t.extensions)return null;var i=t.extensions[n];return i?r(e+"/extensions/"+n,i):null},e.LoadExtraAsync=function(e,t,n,r){if(!t.extras)return null;var i=t.extras[n];return i?r(e+"/extras/"+n,i):null},e.prototype.isExtensionUsed=function(e){return!!this._gltf.extensionsUsed&&-1!==this._gltf.extensionsUsed.indexOf(e)},e.prototype.logOpen=function(e){this._parent._logOpen(e)},e.prototype.logClose=function(){this._parent._logClose()},e.prototype.log=function(e){this._parent._log(e)},e.prototype.startPerformanceCounter=function(e){this._parent._startPerformanceCounter(e)},e.prototype.endPerformanceCounter=function(e){this._parent._endPerformanceCounter(e)},e._RegisteredExtensions={},e.DefaultSampler={index:-1},e}();i.GLTFFileLoader._CreateGLTF2Loader=function(e){return new a(e)}},"./glTF/2.0/glTFLoaderExtension.ts":function(e,t,n){"use strict";n.r(t)},"./glTF/2.0/glTFLoaderInterfaces.ts":function(e,t,n){"use strict";n.r(t)},"./glTF/2.0/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./glTF/2.0/glTFLoader.ts");n.d(t,"ArrayItem",function(){return r.ArrayItem}),n.d(t,"GLTFLoader",function(){return r.GLTFLoader});n("./glTF/2.0/glTFLoaderExtension.ts"),n("./glTF/2.0/glTFLoaderInterfaces.ts");var i=n("./glTF/2.0/Extensions/index.ts");n.d(t,"EXT_lights_image_based",function(){return i.EXT_lights_image_based}),n.d(t,"EXT_mesh_gpu_instancing",function(){return i.EXT_mesh_gpu_instancing}),n.d(t,"EXT_meshopt_compression",function(){return i.EXT_meshopt_compression}),n.d(t,"EXT_texture_webp",function(){return i.EXT_texture_webp}),n.d(t,"KHR_draco_mesh_compression",function(){return i.KHR_draco_mesh_compression}),n.d(t,"KHR_lights",function(){return i.KHR_lights}),n.d(t,"KHR_materials_pbrSpecularGlossiness",function(){return i.KHR_materials_pbrSpecularGlossiness}),n.d(t,"KHR_materials_unlit",function(){return i.KHR_materials_unlit}),n.d(t,"KHR_materials_clearcoat",function(){return i.KHR_materials_clearcoat}),n.d(t,"KHR_materials_sheen",function(){return i.KHR_materials_sheen}),n.d(t,"KHR_materials_specular",function(){return i.KHR_materials_specular}),n.d(t,"KHR_materials_ior",function(){return i.KHR_materials_ior}),n.d(t,"KHR_materials_variants",function(){return i.KHR_materials_variants}),n.d(t,"KHR_materials_transmission",function(){return i.KHR_materials_transmission}),n.d(t,"KHR_materials_translucency",function(){return i.KHR_materials_translucency}),n.d(t,"KHR_materials_volume",function(){return i.KHR_materials_volume}),n.d(t,"KHR_mesh_quantization",function(){return i.KHR_mesh_quantization}),n.d(t,"KHR_texture_basisu",function(){return i.KHR_texture_basisu}),n.d(t,"KHR_texture_transform",function(){return i.KHR_texture_transform}),n.d(t,"KHR_xmp_json_ld",function(){return i.KHR_xmp_json_ld}),n.d(t,"MSFT_audio_emitter",function(){return i.MSFT_audio_emitter}),n.d(t,"MSFT_lod",function(){return i.MSFT_lod}),n.d(t,"MSFT_minecraftMesh",function(){return i.MSFT_minecraftMesh}),n.d(t,"MSFT_sRGBFactors",function(){return i.MSFT_sRGBFactors}),n.d(t,"ExtrasAsMetadata",function(){return i.ExtrasAsMetadata})},"./glTF/glTFFileLoader.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"GLTFLoaderCoordinateSystemMode",function(){return r}),n.d(t,"GLTFLoaderAnimationStartMode",function(){return i}),n.d(t,"GLTFLoaderState",function(){return o}),n.d(t,"GLTFFileLoader",function(){return c});var r,i,o,a=n("babylonjs/Misc/observable"),s=n("./glTF/glTFValidation.ts");function l(e,t,n){try{return Promise.resolve(new Uint8Array(e,t,n))}catch(e){return Promise.reject(e)}}!function(e){e[e.AUTO=0]="AUTO",e[e.FORCE_RIGHT_HANDED=1]="FORCE_RIGHT_HANDED"}(r||(r={})),function(e){e[e.NONE=0]="NONE",e[e.FIRST=1]="FIRST",e[e.ALL=2]="ALL"}(i||(i={})),function(e){e[e.LOADING=0]="LOADING",e[e.READY=1]="READY",e[e.COMPLETE=2]="COMPLETE"}(o||(o={}));var c=function(){function e(){this.onParsedObservable=new a.Observable,this.coordinateSystemMode=r.AUTO,this.animationStartMode=i.FIRST,this.compileMaterials=!1,this.useClipPlane=!1,this.compileShadowGenerators=!1,this.transparencyAsCoverage=!1,this.useRangeRequests=!1,this.createInstances=!0,this.alwaysComputeBoundingBox=!1,this.loadAllMaterials=!1,this.useSRGBBuffers=!0,this.preprocessUrlAsync=function(e){return Promise.resolve(e)},this.onMeshLoadedObservable=new a.Observable,this.onTextureLoadedObservable=new a.Observable,this.onMaterialLoadedObservable=new a.Observable,this.onCameraLoadedObservable=new a.Observable,this.onCompleteObservable=new a.Observable,this.onErrorObservable=new a.Observable,this.onDisposeObservable=new a.Observable,this.onExtensionLoadedObservable=new a.Observable,this.validate=!1,this.onValidatedObservable=new a.Observable,this._loader=null,this._state=null,this._requests=new Array,this.name="gltf",this.extensions={".gltf":{isBinary:!1},".glb":{isBinary:!0}},this.onLoaderStateChangedObservable=new a.Observable,this._logIndentLevel=0,this._loggingEnabled=!1,this._log=this._logDisabled,this._capturePerformanceCounters=!1,this._startPerformanceCounter=this._startPerformanceCounterDisabled,this._endPerformanceCounter=this._endPerformanceCounterDisabled}return Object.defineProperty(e.prototype,"onParsed",{set:function(e){this._onParsedObserver&&this.onParsedObservable.remove(this._onParsedObserver),this._onParsedObserver=this.onParsedObservable.add(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onMeshLoaded",{set:function(e){this._onMeshLoadedObserver&&this.onMeshLoadedObservable.remove(this._onMeshLoadedObserver),this._onMeshLoadedObserver=this.onMeshLoadedObservable.add(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onTextureLoaded",{set:function(e){this._onTextureLoadedObserver&&this.onTextureLoadedObservable.remove(this._onTextureLoadedObserver),this._onTextureLoadedObserver=this.onTextureLoadedObservable.add(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onMaterialLoaded",{set:function(e){this._onMaterialLoadedObserver&&this.onMaterialLoadedObservable.remove(this._onMaterialLoadedObserver),this._onMaterialLoadedObserver=this.onMaterialLoadedObservable.add(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onCameraLoaded",{set:function(e){this._onCameraLoadedObserver&&this.onCameraLoadedObservable.remove(this._onCameraLoadedObserver),this._onCameraLoadedObserver=this.onCameraLoadedObservable.add(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onComplete",{set:function(e){this._onCompleteObserver&&this.onCompleteObservable.remove(this._onCompleteObserver),this._onCompleteObserver=this.onCompleteObservable.add(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onError",{set:function(e){this._onErrorObserver&&this.onErrorObservable.remove(this._onErrorObserver),this._onErrorObserver=this.onErrorObservable.add(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onDispose",{set:function(e){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onExtensionLoaded",{set:function(e){this._onExtensionLoadedObserver&&this.onExtensionLoadedObservable.remove(this._onExtensionLoadedObserver),this._onExtensionLoadedObserver=this.onExtensionLoadedObservable.add(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"loggingEnabled",{get:function(){return this._loggingEnabled},set:function(e){this._loggingEnabled!==e&&(this._loggingEnabled=e,this._loggingEnabled?this._log=this._logEnabled:this._log=this._logDisabled)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"capturePerformanceCounters",{get:function(){return this._capturePerformanceCounters},set:function(e){this._capturePerformanceCounters!==e&&(this._capturePerformanceCounters=e,this._capturePerformanceCounters?(this._startPerformanceCounter=this._startPerformanceCounterEnabled,this._endPerformanceCounter=this._endPerformanceCounterEnabled):(this._startPerformanceCounter=this._startPerformanceCounterDisabled,this._endPerformanceCounter=this._endPerformanceCounterDisabled))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onValidated",{set:function(e){this._onValidatedObserver&&this.onValidatedObservable.remove(this._onValidatedObserver),this._onValidatedObserver=this.onValidatedObservable.add(e)},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this._loader&&(this._loader.dispose(),this._loader=null);for(var e=0,t=this._requests;e<t.length;e++){t[e].abort()}this._requests.length=0,delete this._progressCallback,this.preprocessUrlAsync=function(e){return Promise.resolve(e)},this.onMeshLoadedObservable.clear(),this.onTextureLoadedObservable.clear(),this.onMaterialLoadedObservable.clear(),this.onCameraLoadedObservable.clear(),this.onCompleteObservable.clear(),this.onExtensionLoadedObservable.clear(),this.onDisposeObservable.notifyObservers(void 0),this.onDisposeObservable.clear()},e.prototype.loadFile=function(e,t,n,r,i,o){var s=this;if(this._progressCallback=r,i){if(this.useRangeRequests){this.validate&&a.Logger.Warn("glTF validation is not supported when range requests are enabled");var c={abort:function(){},onCompleteObservable:new a.Observable},u={readAsync:function(n,r){return new Promise(function(i,o){s._loadFile(e,t,function(e){i(new Uint8Array(e))},!0,function(e){o(e)},function(e){e.setRequestHeader("Range","bytes="+n+"-"+(n+r-1))})})},byteLength:0};return this._unpackBinaryAsync(new a.DataReader(u)).then(function(e){c.onCompleteObservable.notifyObservers(c),n(e)},o?function(e){return o(void 0,e)}:void 0),c}return this._loadFile(e,t,function(e){var t=e;s._unpackBinaryAsync(new a.DataReader({readAsync:function(e,n){return l(t,e,n)},byteLength:t.byteLength})).then(function(e){n(e)},o?function(e){return o(void 0,e)}:void 0)},!0,o)}return this._loadFile(e,t,function(r){if(t.name)s._validate(e,r,"file:",t.name);else{var i=t;s._validate(e,r,a.Tools.GetFolderPath(i),a.Tools.GetFilename(i))}n({json:s._parseJson(r)})},i,o)},e.prototype.importMeshAsync=function(e,t,n,r,i,o){var a=this;return Promise.resolve().then(function(){return a.onParsedObservable.notifyObservers(n),a.onParsedObservable.clear(),a._log("Loading "+(o||"")),a._loader=a._getLoader(n),a._loader.importMeshAsync(e,t,null,n,r,i,o)})},e.prototype.loadAsync=function(e,t,n,r,i){var o=this;return Promise.resolve().then(function(){return o.onParsedObservable.notifyObservers(t),o.onParsedObservable.clear(),o._log("Loading "+(i||"")),o._loader=o._getLoader(t),o._loader.loadAsync(e,t,n,r,i)})},e.prototype.loadAssetContainerAsync=function(e,t,n,r,i){var o=this;return Promise.resolve().then(function(){o.onParsedObservable.notifyObservers(t),o.onParsedObservable.clear(),o._log("Loading "+(i||"")),o._loader=o._getLoader(t);var s=new a.AssetContainer(e),l=[];o.onMaterialLoadedObservable.add(function(e){l.push(e)});var c=[];o.onTextureLoadedObservable.add(function(e){c.push(e)});var u=[];return o.onCameraLoadedObservable.add(function(e){u.push(e)}),o._loader.importMeshAsync(null,e,s,t,n,r,i).then(function(e){return Array.prototype.push.apply(s.geometries,e.geometries),Array.prototype.push.apply(s.meshes,e.meshes),Array.prototype.push.apply(s.particleSystems,e.particleSystems),Array.prototype.push.apply(s.skeletons,e.skeletons),Array.prototype.push.apply(s.animationGroups,e.animationGroups),Array.prototype.push.apply(s.materials,l),Array.prototype.push.apply(s.textures,c),Array.prototype.push.apply(s.lights,e.lights),Array.prototype.push.apply(s.transformNodes,e.transformNodes),Array.prototype.push.apply(s.cameras,u),s})})},e.prototype.canDirectLoad=function(t){return-1!==t.indexOf("asset")&&-1!==t.indexOf("version")||a.StringTools.StartsWith(t,"data:base64,"+e.magicBase64Encoded)||a.StringTools.StartsWith(t,"data:;base64,"+e.magicBase64Encoded)||a.StringTools.StartsWith(t,"data:application/octet-stream;base64,"+e.magicBase64Encoded)||a.StringTools.StartsWith(t,"data:model/gltf-binary;base64,"+e.magicBase64Encoded)},e.prototype.directLoad=function(t,n){if(a.StringTools.StartsWith(n,"base64,"+e.magicBase64Encoded)||a.StringTools.StartsWith(n,";base64,"+e.magicBase64Encoded)||a.StringTools.StartsWith(n,"application/octet-stream;base64,"+e.magicBase64Encoded)||a.StringTools.StartsWith(n,"model/gltf-binary;base64,"+e.magicBase64Encoded)){var r=Object(a.DecodeBase64UrlToBinary)(n);return this._validate(t,r),this._unpackBinaryAsync(new a.DataReader({readAsync:function(e,t){return l(r,e,t)},byteLength:r.byteLength}))}return this._validate(t,n),Promise.resolve({json:this._parseJson(n)})},e.prototype.createPlugin=function(){return new e},Object.defineProperty(e.prototype,"loaderState",{get:function(){return this._state},enumerable:!1,configurable:!0}),e.prototype.whenCompleteAsync=function(){var e=this;return new Promise(function(t,n){e.onCompleteObservable.addOnce(function(){t()}),e.onErrorObservable.addOnce(function(e){n(e)})})},e.prototype._setState=function(e){this._state!==e&&(this._state=e,this.onLoaderStateChangedObservable.notifyObservers(this._state),this._log(o[this._state]))},e.prototype._loadFile=function(e,t,n,r,i,o){var a=this,s=e._loadFile(t,n,function(e){a._onProgress(e,s)},!0,r,i,o);return s.onCompleteObservable.add(function(e){a._requests.splice(a._requests.indexOf(e),1)}),this._requests.push(s),s},e.prototype._onProgress=function(e,t){if(this._progressCallback){t._lengthComputable=e.lengthComputable,t._loaded=e.loaded,t._total=e.total;for(var n=!0,r=0,i=0,o=0,a=this._requests;o<a.length;o++){var s=a[o];if(void 0===s._lengthComputable||void 0===s._loaded||void 0===s._total)return;n=n&&s._lengthComputable,r+=s._loaded,i+=s._total}this._progressCallback({lengthComputable:n,loaded:r,total:n?i:0})}},e.prototype._validate=function(e,t,n,r){var i=this;void 0===n&&(n=""),void 0===r&&(r=""),this.validate&&(this._startPerformanceCounter("Validate JSON"),s.GLTFValidation.ValidateAsync(t,n,r,function(t){return i.preprocessUrlAsync(n+t).then(function(t){return e._loadFileAsync(t,void 0,!0,!0)})}).then(function(e){i._endPerformanceCounter("Validate JSON"),i.onValidatedObservable.notifyObservers(e),i.onValidatedObservable.clear()},function(e){i._endPerformanceCounter("Validate JSON"),a.Tools.Warn("Failed to validate: "+e.message),i.onValidatedObservable.clear()}))},e.prototype._getLoader=function(t){var n=t.json.asset||{};this._log("Asset version: "+n.version),n.minVersion&&this._log("Asset minimum version: "+n.minVersion),n.generator&&this._log("Asset generator: "+n.generator);var r=e._parseVersion(n.version);if(!r)throw new Error("Invalid version: "+n.version);if(void 0!==n.minVersion){var i=e._parseVersion(n.minVersion);if(!i)throw new Error("Invalid minimum version: "+n.minVersion);if(e._compareVersion(i,{major:2,minor:0})>0)throw new Error("Incompatible minimum version: "+n.minVersion)}var o={1:e._CreateGLTF1Loader,2:e._CreateGLTF2Loader}[r.major];if(!o)throw new Error("Unsupported version: "+n.version);return o(this)},e.prototype._parseJson=function(e){this._startPerformanceCounter("Parse JSON"),this._log("JSON length: "+e.length);var t=JSON.parse(e);return this._endPerformanceCounter("Parse JSON"),t},e.prototype._unpackBinaryAsync=function(e){var t=this;return this._startPerformanceCounter("Unpack Binary"),e.loadAsync(20).then(function(){var n=e.readUint32();if(1179937895!==n)throw new Error("Unexpected magic: "+n);var r=e.readUint32();t.loggingEnabled&&t._log("Binary version: "+r);var i,o=e.readUint32();if(0!==e.buffer.byteLength&&o!==e.buffer.byteLength)throw new Error("Length in header does not match actual data length: "+o+" != "+e.buffer.byteLength);switch(r){case 1:i=t._unpackBinaryV1Async(e,o);break;case 2:i=t._unpackBinaryV2Async(e,o);break;default:throw new Error("Unsupported version: "+r)}return t._endPerformanceCounter("Unpack Binary"),i})},e.prototype._unpackBinaryV1Async=function(e,t){var n=e.readUint32(),r=e.readUint32();if(0!==r)throw new Error("Unexpected content format: "+r);var i=t-e.byteOffset,o={json:this._parseJson(e.readString(n)),bin:null};if(0!==i){var a=e.byteOffset;o.bin={readAsync:function(t,n){return e.buffer.readAsync(a+t,n)},byteLength:i}}return Promise.resolve(o)},e.prototype._unpackBinaryV2Async=function(e,t){var n=this,r=1313821514,i=5130562,o=e.readUint32();if(e.readUint32()!==r)throw new Error("First chunk format is not JSON");return e.byteOffset+o===t?e.loadAsync(o).then(function(){return{json:n._parseJson(e.readString(o)),bin:null}}):e.loadAsync(o+8).then(function(){var a={json:n._parseJson(e.readString(o)),bin:null},s=function(){var n=e.readUint32();switch(e.readUint32()){case r:throw new Error("Unexpected JSON chunk");case i:var o=e.byteOffset;a.bin={readAsync:function(t,n){return e.buffer.readAsync(o+t,n)},byteLength:n},e.skipBytes(n);break;default:e.skipBytes(n)}return e.byteOffset!==t?e.loadAsync(8).then(s):Promise.resolve(a)};return s()})},e._parseVersion=function(e){if("1.0"===e||"1.0.1"===e)return{major:1,minor:0};var t=(e+"").match(/^(\d+)\.(\d+)/);return t?{major:parseInt(t[1]),minor:parseInt(t[2])}:null},e._compareVersion=function(e,t){return e.major>t.major?1:e.major<t.major?-1:e.minor>t.minor?1:e.minor<t.minor?-1:0},e.prototype._logOpen=function(e){this._log(e),this._logIndentLevel++},e.prototype._logClose=function(){--this._logIndentLevel},e.prototype._logEnabled=function(t){var n=e._logSpaces.substr(0,2*this._logIndentLevel);a.Logger.Log(""+n+t)},e.prototype._logDisabled=function(e){},e.prototype._startPerformanceCounterEnabled=function(e){a.Tools.StartPerformanceCounter(e)},e.prototype._startPerformanceCounterDisabled=function(e){},e.prototype._endPerformanceCounterEnabled=function(e){a.Tools.EndPerformanceCounter(e)},e.prototype._endPerformanceCounterDisabled=function(e){},e.IncrementalLoading=!0,e.HomogeneousCoordinates=!1,e.magicBase64Encoded="Z2xURg",e._logSpaces="                                ",e}();a.SceneLoader&&a.SceneLoader.RegisterPlugin(new c)},"./glTF/glTFValidation.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"GLTFValidation",function(){return o});var r=n("babylonjs/Misc/observable");function i(e,t,n,r){var i={externalResourceFunction:function(e){return r(e).then(function(e){return new Uint8Array(e)})}};return n&&(i.uri="file:"===t?n:t+n),e instanceof ArrayBuffer?GLTFValidator.validateBytes(new Uint8Array(e),i):GLTFValidator.validateString(e,i)}var o=function(){function e(){}return e.ValidateAsync=function(e,t,n,o){var a=this;return"function"==typeof Worker?new Promise(function(r,s){var l=i+"("+function(){var e=[];onmessage=function(t){var n=t.data;switch(n.id){case"init":importScripts(n.url);break;case"validate":i(n.data,n.rootUrl,n.fileName,function(t){return new Promise(function(n,r){var i=e.length;e.push({resolve:n,reject:r}),postMessage({id:"getExternalResource",index:i,uri:t})})}).then(function(e){postMessage({id:"validate.resolve",value:e})},function(e){postMessage({id:"validate.reject",reason:e})});break;case"getExternalResource.resolve":e[n.index].resolve(n.value);break;case"getExternalResource.reject":e[n.index].reject(n.reason)}}}+")()",c=URL.createObjectURL(new Blob([l],{type:"application/javascript"})),u=new Worker(c),_=function(e){u.removeEventListener("error",_),u.removeEventListener("message",h),s(e)},h=function(e){var t=e.data;switch(t.id){case"getExternalResource":o(t.uri).then(function(e){u.postMessage({id:"getExternalResource.resolve",index:t.index,value:e},[e])},function(e){u.postMessage({id:"getExternalResource.reject",index:t.index,reason:e})});break;case"validate.resolve":u.removeEventListener("error",_),u.removeEventListener("message",h),r(t.value);break;case"validate.reject":u.removeEventListener("error",_),u.removeEventListener("message",h),s(t.reason)}};u.addEventListener("error",_),u.addEventListener("message",h),u.postMessage({id:"init",url:a.Configuration.url}),u.postMessage({id:"validate",data:e,rootUrl:t,fileName:n})}):(this._LoadScriptPromise||(this._LoadScriptPromise=r.Tools.LoadScriptAsync(this.Configuration.url)),this._LoadScriptPromise.then(function(){return i(e,t,n,o)}))},e.Configuration={url:"https://preview.babylonjs.com/gltf_validator.js"},e}()},"./glTF/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./glTF/glTFFileLoader.ts");n.d(t,"GLTFLoaderCoordinateSystemMode",function(){return r.GLTFLoaderCoordinateSystemMode}),n.d(t,"GLTFLoaderAnimationStartMode",function(){return r.GLTFLoaderAnimationStartMode}),n.d(t,"GLTFLoaderState",function(){return r.GLTFLoaderState}),n.d(t,"GLTFFileLoader",function(){return r.GLTFFileLoader});var i=n("./glTF/glTFValidation.ts");n.d(t,"GLTFValidation",function(){return i.GLTFValidation});var o=n("./glTF/1.0/index.ts");n.d(t,"GLTF1",function(){return o});var a=n("./glTF/2.0/index.ts");n.d(t,"GLTF2",function(){return a})},"./index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./glTF/index.ts");n.d(t,"GLTFLoaderCoordinateSystemMode",function(){return r.GLTFLoaderCoordinateSystemMode}),n.d(t,"GLTFLoaderAnimationStartMode",function(){return r.GLTFLoaderAnimationStartMode}),n.d(t,"GLTFLoaderState",function(){return r.GLTFLoaderState}),n.d(t,"GLTFFileLoader",function(){return r.GLTFFileLoader}),n.d(t,"GLTFValidation",function(){return r.GLTFValidation}),n.d(t,"GLTF1",function(){return r.GLTF1}),n.d(t,"GLTF2",function(){return r.GLTF2});var i=n("./OBJ/index.ts");n.d(t,"MTLFileLoader",function(){return i.MTLFileLoader}),n.d(t,"SolidParser",function(){return i.SolidParser}),n.d(t,"OBJFileLoader",function(){return i.OBJFileLoader});var o=n("./STL/index.ts");n.d(t,"STLFileLoader",function(){return o.STLFileLoader})},"./legacy/legacy-glTF.ts":function(e,t,n){"use strict";n.r(t),function(e){var r=n("./glTF/glTFFileLoader.ts"),i=n("./glTF/glTFValidation.ts");n.d(t,"GLTFLoaderCoordinateSystemMode",function(){return r.GLTFLoaderCoordinateSystemMode}),n.d(t,"GLTFLoaderAnimationStartMode",function(){return r.GLTFLoaderAnimationStartMode}),n.d(t,"GLTFLoaderState",function(){return r.GLTFLoaderState}),n.d(t,"GLTFFileLoader",function(){return r.GLTFFileLoader}),n.d(t,"GLTFValidation",function(){return i.GLTFValidation});var o=void 0!==e?e:"undefined"!=typeof window?window:void 0;if(void 0!==o){for(var a in o.BABYLON=o.BABYLON||{},r)o.BABYLON[a]=r[a];for(var a in i)o.BABYLON[a]=i[a]}}.call(this,n("../../node_modules/webpack/buildin/global.js"))},"./legacy/legacy-glTF1.ts":function(e,t,n){"use strict";n.r(t),function(e){var r=n("./glTF/1.0/index.ts");n.d(t,"GLTF1",function(){return r});var i=void 0!==e?e:"undefined"!=typeof window?window:void 0;if(void 0!==i)for(var o in i.BABYLON=i.BABYLON||{},i.BABYLON.GLTF1=i.BABYLON.GLTF1||{},r)i.BABYLON.GLTF1[o]=r[o]}.call(this,n("../../node_modules/webpack/buildin/global.js"))},"./legacy/legacy-glTF2.ts":function(e,t,n){"use strict";n.r(t),function(e){var r=n("./glTF/2.0/Extensions/index.ts"),i=n("./glTF/2.0/glTFLoaderInterfaces.ts"),o=n("./glTF/2.0/index.ts");n.d(t,"GLTF2",function(){return o});var a=void 0!==e?e:"undefined"!=typeof window?window:void 0;if(void 0!==a){a.BABYLON=a.BABYLON||{};var s=a.BABYLON;s.GLTF2=s.GLTF2||{},s.GLTF2.Loader=s.GLTF2.Loader||{},s.GLTF2.Loader.Extensions=s.GLTF2.Loader.Extensions||{};var l=[];for(var c in r)s.GLTF2.Loader.Extensions[c]=r[c],l.push(c);for(var c in i)s.GLTF2.Loader[c]=i[c],l.push(c);for(var c in o)l.indexOf(c)>-1||(s.GLTF2[c]=o[c])}}.call(this,n("../../node_modules/webpack/buildin/global.js"))},"./legacy/legacy-objFileLoader.ts":function(e,t,n){"use strict";n.r(t),function(e){var r=n("./OBJ/index.ts");n.d(t,"MTLFileLoader",function(){return r.MTLFileLoader}),n.d(t,"SolidParser",function(){return r.SolidParser}),n.d(t,"OBJFileLoader",function(){return r.OBJFileLoader});var i=void 0!==e?e:"undefined"!=typeof window?window:void 0;if(void 0!==i)for(var o in r)i.BABYLON[o]=r[o]}.call(this,n("../../node_modules/webpack/buildin/global.js"))},"./legacy/legacy-stlFileLoader.ts":function(e,t,n){"use strict";n.r(t),function(e){var r=n("./STL/index.ts");n.d(t,"STLFileLoader",function(){return r.STLFileLoader});var i=void 0!==e?e:"undefined"!=typeof window?window:void 0;if(void 0!==i)for(var o in r)i.BABYLON[o]=r[o]}.call(this,n("../../node_modules/webpack/buildin/global.js"))},"./legacy/legacy.ts":function(e,t,n){"use strict";n.r(t);n("./index.ts");var r=n("./legacy/legacy-glTF.ts");n.d(t,"GLTFLoaderCoordinateSystemMode",function(){return r.GLTFLoaderCoordinateSystemMode}),n.d(t,"GLTFLoaderAnimationStartMode",function(){return r.GLTFLoaderAnimationStartMode}),n.d(t,"GLTFLoaderState",function(){return r.GLTFLoaderState}),n.d(t,"GLTFFileLoader",function(){return r.GLTFFileLoader}),n.d(t,"GLTFValidation",function(){return r.GLTFValidation});var i=n("./legacy/legacy-glTF1.ts");n.d(t,"GLTF1",function(){return i.GLTF1});var o=n("./legacy/legacy-glTF2.ts");n.d(t,"GLTF2",function(){return o.GLTF2});var a=n("./legacy/legacy-objFileLoader.ts");n.d(t,"MTLFileLoader",function(){return a.MTLFileLoader}),n.d(t,"SolidParser",function(){return a.SolidParser}),n.d(t,"OBJFileLoader",function(){return a.OBJFileLoader});var s=n("./legacy/legacy-stlFileLoader.ts");n.d(t,"STLFileLoader",function(){return s.STLFileLoader})},"babylonjs/Misc/observable":function(t,n){t.exports=e}})}),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("babylonjs")):"function"==typeof define&&define.amd?define("babylonjs-materials",["babylonjs"],t):"object"==typeof exports?exports["babylonjs-materials"]=t(require("babylonjs")):e.MATERIALS=t(e.BABYLON)}("undefined"!=typeof self?self:"undefined"!=typeof global?global:this,function(e){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./legacy/legacy.ts")}({"../../node_modules/tslib/tslib.es6.js":function(e,t,n){"use strict";n.r(t),n.d(t,"__extends",function(){return i}),n.d(t,"__assign",function(){return o}),n.d(t,"__rest",function(){return a}),n.d(t,"__decorate",function(){return s}),n.d(t,"__param",function(){return l}),n.d(t,"__metadata",function(){return c}),n.d(t,"__awaiter",function(){return u}),n.d(t,"__generator",function(){return _}),n.d(t,"__createBinding",function(){return h}),n.d(t,"__exportStar",function(){return f}),n.d(t,"__values",function(){return d}),n.d(t,"__read",function(){return p}),n.d(t,"__spread",function(){return m}),n.d(t,"__spreadArrays",function(){return g}),n.d(t,"__spreadArray",function(){return v}),n.d(t,"__await",function(){return b}),n.d(t,"__asyncGenerator",function(){return y}),n.d(t,"__asyncDelegator",function(){return x}),n.d(t,"__asyncValues",function(){return T}),n.d(t,"__makeTemplateObject",function(){return O}),n.d(t,"__importStar",function(){return C}),n.d(t,"__importDefault",function(){return S}),n.d(t,"__classPrivateFieldGet",function(){return M}),n.d(t,"__classPrivateFieldSet",function(){return E});var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function a(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function s(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function l(e,t){return function(n,r){t(n,r,e)}}function c(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function u(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}l((r=r.apply(e,t||[])).next())})}function _(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var h=Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]};function f(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||h(t,e,n)}function d(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function p(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function m(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(p(arguments[t]));return e}function g(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}function v(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function b(e){return this instanceof b?(this.v=e,this):new b(e)}function y(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(e){i[e]&&(r[e]=function(t){return new Promise(function(n,r){o.push([e,t,n,r])>1||s(e,t)})})}function s(e,t){try{(n=i[e](t)).value instanceof b?Promise.resolve(n.value.v).then(l,c):u(o[0][2],n)}catch(e){u(o[0][3],e)}var n}function l(e){s("next",e)}function c(e){s("throw",e)}function u(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}}function x(e){var t,n;return t={},r("next"),r("throw",function(e){throw e}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:b(e[r](t)),done:"return"===r}:i?i(t):t}:i}}function T(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=d(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,i){(function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)})(r,i,(t=e[n](t)).done,t.value)})}}}function O(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var P=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function C(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&h(t,e,n);return P(t,e),t}function S(e){return e&&e.__esModule?e:{default:e}}function M(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function E(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n}},"../../node_modules/webpack/buildin/global.js":function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},"./cell/cell.fragment.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"cellPixelShader",function(){return a});var r=n("babylonjs/Misc/decorators"),i="cellPixelShader",o="precision highp float;\n\nuniform vec4 vEyePosition;\nuniform vec4 vDiffuseColor;\n\nvarying vec3 vPositionW;\n#ifdef NORMAL\nvarying vec3 vNormalW;\n#endif\n#ifdef VERTEXCOLOR\nvarying vec4 vColor;\n#endif\n\n#include<helperFunctions>\n\n#include<__decl__lightFragment>[0..maxSimultaneousLights]\n#include<lightsFragmentFunctions>\n#include<shadowsFragmentFunctions>\n\n#ifdef DIFFUSE\nvarying vec2 vDiffuseUV;\nuniform sampler2D diffuseSampler;\nuniform vec2 vDiffuseInfos;\n#endif\n#include<clipPlaneFragmentDeclaration>\n\n#include<fogFragmentDeclaration>\n\nvec3 computeCustomDiffuseLighting(lightingInfo info,vec3 diffuseBase,float shadow)\n{\ndiffuseBase=info.diffuse*shadow;\n#ifdef CELLBASIC\nfloat level=1.0;\nif (info.ndl<0.5)\nlevel=0.5;\ndiffuseBase.rgb*vec3(level,level,level);\n#else\nfloat ToonThresholds[4];\nToonThresholds[0]=0.95;\nToonThresholds[1]=0.5;\nToonThresholds[2]=0.2;\nToonThresholds[3]=0.03;\nfloat ToonBrightnessLevels[5];\nToonBrightnessLevels[0]=1.0;\nToonBrightnessLevels[1]=0.8;\nToonBrightnessLevels[2]=0.6;\nToonBrightnessLevels[3]=0.35;\nToonBrightnessLevels[4]=0.2;\nif (info.ndl>ToonThresholds[0])\n{\ndiffuseBase.rgb*=ToonBrightnessLevels[0];\n}\nelse if (info.ndl>ToonThresholds[1])\n{\ndiffuseBase.rgb*=ToonBrightnessLevels[1];\n}\nelse if (info.ndl>ToonThresholds[2])\n{\ndiffuseBase.rgb*=ToonBrightnessLevels[2];\n}\nelse if (info.ndl>ToonThresholds[3])\n{\ndiffuseBase.rgb*=ToonBrightnessLevels[3];\n}\nelse\n{\ndiffuseBase.rgb*=ToonBrightnessLevels[4];\n}\n#endif\nreturn max(diffuseBase,vec3(0.2));\n}\nvoid main(void)\n{\n#include<clipPlaneFragment>\nvec3 viewDirectionW=normalize(vEyePosition.xyz-vPositionW);\n\nvec4 baseColor=vec4(1.,1.,1.,1.);\nvec3 diffuseColor=vDiffuseColor.rgb;\n\nfloat alpha=vDiffuseColor.a;\n#ifdef DIFFUSE\nbaseColor=texture2D(diffuseSampler,vDiffuseUV);\n#ifdef ALPHATEST\nif (baseColor.a<0.4)\ndiscard;\n#endif\n#include<depthPrePass>\nbaseColor.rgb*=vDiffuseInfos.y;\n#endif\n#ifdef VERTEXCOLOR\nbaseColor.rgb*=vColor.rgb;\n#endif\n\n#ifdef NORMAL\nvec3 normalW=normalize(vNormalW);\n#else\nvec3 normalW=vec3(1.0,1.0,1.0);\n#endif\n\nlightingInfo info;\nvec3 diffuseBase=vec3(0.,0.,0.);\nfloat shadow=1.;\nfloat glossiness=0.;\n#ifdef SPECULARTERM\nvec3 specularBase=vec3(0.,0.,0.);\n#endif\n#include<lightFragment>[0..maxSimultaneousLights]\n#ifdef VERTEXALPHA\nalpha*=vColor.a;\n#endif\nvec3 finalDiffuse=clamp(diffuseBase*diffuseColor,0.0,1.0)*baseColor.rgb;\n\nvec4 color=vec4(finalDiffuse,alpha);\n#include<fogFragment>\ngl_FragColor=color;\n#include<imageProcessingCompatibility>\n}";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./cell/cell.vertex.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"cellVertexShader",function(){return a});var r=n("babylonjs/Misc/decorators"),i="cellVertexShader",o="precision highp float;\n\nattribute vec3 position;\n#ifdef NORMAL\nattribute vec3 normal;\n#endif\n#ifdef UV1\nattribute vec2 uv;\n#endif\n#ifdef UV2\nattribute vec2 uv2;\n#endif\n#ifdef VERTEXCOLOR\nattribute vec4 color;\n#endif\n#include<bonesDeclaration>\n\n#include<instancesDeclaration>\nuniform mat4 view;\nuniform mat4 viewProjection;\n#ifdef DIFFUSE\nvarying vec2 vDiffuseUV;\nuniform mat4 diffuseMatrix;\nuniform vec2 vDiffuseInfos;\n#endif\n#ifdef POINTSIZE\nuniform float pointSize;\n#endif\n\nvarying vec3 vPositionW;\n#ifdef NORMAL\nvarying vec3 vNormalW;\n#endif\n#ifdef VERTEXCOLOR\nvarying vec4 vColor;\n#endif\n#include<clipPlaneVertexDeclaration>\n#include<fogVertexDeclaration>\n#include<__decl__lightFragment>[0..maxSimultaneousLights]\nvoid main(void) {\n#include<instancesVertex>\n#include<bonesVertex>\nvec4 worldPos=finalWorld*vec4(position,1.0);\ngl_Position=viewProjection*worldPos;\nvPositionW=vec3(worldPos);\n#ifdef NORMAL\nvNormalW=normalize(vec3(finalWorld*vec4(normal,0.0)));\n#endif\n\n#ifndef UV1\nvec2 uv=vec2(0.,0.);\n#endif\n#ifndef UV2\nvec2 uv2=vec2(0.,0.);\n#endif\n#ifdef DIFFUSE\nif (vDiffuseInfos.x == 0.)\n{\nvDiffuseUV=vec2(diffuseMatrix*vec4(uv,1.0,0.0));\n}\nelse\n{\nvDiffuseUV=vec2(diffuseMatrix*vec4(uv2,1.0,0.0));\n}\n#endif\n\n#include<clipPlaneVertex>\n\n#include<fogVertex>\n#include<shadowsVertex>[0..maxSimultaneousLights]\n\n#ifdef VERTEXCOLOR\nvColor=color;\n#endif\n\n#ifdef POINTSIZE\ngl_PointSize=pointSize;\n#endif\n}\n";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./cell/cellMaterial.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"CellMaterial",function(){return a});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/decorators"),o=(n("./cell/cell.fragment.ts"),n("./cell/cell.vertex.ts"),function(e){function t(){var t=e.call(this)||this;return t.DIFFUSE=!1,t.CLIPPLANE=!1,t.CLIPPLANE2=!1,t.CLIPPLANE3=!1,t.CLIPPLANE4=!1,t.CLIPPLANE5=!1,t.CLIPPLANE6=!1,t.ALPHATEST=!1,t.POINTSIZE=!1,t.FOG=!1,t.NORMAL=!1,t.UV1=!1,t.UV2=!1,t.VERTEXCOLOR=!1,t.VERTEXALPHA=!1,t.NUM_BONE_INFLUENCERS=0,t.BonesPerMesh=0,t.INSTANCES=!1,t.NDOTL=!0,t.CUSTOMUSERLIGHTING=!0,t.CELLBASIC=!0,t.DEPTHPREPASS=!1,t.IMAGEPROCESSINGPOSTPROCESS=!1,t.rebuild(),t}return Object(r.__extends)(t,e),t}(i.MaterialDefines)),a=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.diffuseColor=new i.Color3(1,1,1),r._computeHighLevel=!1,r._disableLighting=!1,r._maxSimultaneousLights=4,r}return Object(r.__extends)(t,e),t.prototype.needAlphaBlending=function(){return this.alpha<1},t.prototype.needAlphaTesting=function(){return!1},t.prototype.getAlphaTestTexture=function(){return null},t.prototype.isReadyForSubMesh=function(e,t,n){if(this.isFrozen&&t.effect&&t.effect._wasPreviouslyReady)return!0;t._materialDefines||(t.materialDefines=new o);var r=t._materialDefines,a=this.getScene();if(this._isReadyForSubMesh(t))return!0;var s=a.getEngine();if(r._areTexturesDirty&&(r._needUVs=!1,a.texturesEnabled&&this._diffuseTexture&&i.MaterialFlags.DiffuseTextureEnabled)){if(!this._diffuseTexture.isReady())return!1;r._needUVs=!0,r.DIFFUSE=!0}if(r.CELLBASIC=!this.computeHighLevel,i.MaterialHelper.PrepareDefinesForMisc(e,a,!1,this.pointsCloud,this.fogEnabled,this._shouldTurnAlphaTestOn(e),r),r._needNormals=i.MaterialHelper.PrepareDefinesForLights(a,e,r,!1,this._maxSimultaneousLights,this._disableLighting),i.MaterialHelper.PrepareDefinesForFrameBoundValues(a,s,r,!!n),i.MaterialHelper.PrepareDefinesForAttributes(e,r,!0,!0),r.isDirty){r.markAsProcessed(),a.resetCachedMaterial();var l=new i.EffectFallbacks;r.FOG&&l.addFallback(1,"FOG"),i.MaterialHelper.HandleFallbacksForShadows(r,l,this.maxSimultaneousLights),r.NUM_BONE_INFLUENCERS>0&&l.addCPUSkinningFallback(0,e),r.IMAGEPROCESSINGPOSTPROCESS=a.imageProcessingConfiguration.applyByPostProcess;var c=[i.VertexBuffer.PositionKind];r.NORMAL&&c.push(i.VertexBuffer.NormalKind),r.UV1&&c.push(i.VertexBuffer.UVKind),r.UV2&&c.push(i.VertexBuffer.UV2Kind),r.VERTEXCOLOR&&c.push(i.VertexBuffer.ColorKind),i.MaterialHelper.PrepareAttributesForBones(c,e,r,l),i.MaterialHelper.PrepareAttributesForInstances(c,r);var u=r.toString(),_=["world","view","viewProjection","vEyePosition","vLightsType","vDiffuseColor","vFogInfos","vFogColor","pointSize","vDiffuseInfos","mBones","vClipPlane","vClipPlane2","vClipPlane3","vClipPlane4","vClipPlane5","vClipPlane6","diffuseMatrix"],h=["diffuseSampler"],f=new Array;i.MaterialHelper.PrepareUniformsAndSamplersList({uniformsNames:_,uniformBuffersNames:f,samplers:h,defines:r,maxSimultaneousLights:this.maxSimultaneousLights}),t.setEffect(a.getEngine().createEffect("cell",{attributes:c,uniformsNames:_,uniformBuffersNames:f,samplers:h,defines:u,fallbacks:l,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousLights:this.maxSimultaneousLights-1}},s),r,this._materialContext)}return!(!t.effect||!t.effect.isReady())&&(r._renderId=a.getRenderId(),t.effect._wasPreviouslyReady=!0,!0)},t.prototype.bindForSubMesh=function(e,t,n){var r=this.getScene(),o=n._materialDefines;if(o){var a=n.effect;a&&(this._activeEffect=a,this.bindOnlyWorldMatrix(e),this._activeEffect.setMatrix("viewProjection",r.getTransformMatrix()),i.MaterialHelper.BindBonesParameters(t,this._activeEffect),this._mustRebind(r,a)&&(this._diffuseTexture&&i.MaterialFlags.DiffuseTextureEnabled&&(this._activeEffect.setTexture("diffuseSampler",this._diffuseTexture),this._activeEffect.setFloat2("vDiffuseInfos",this._diffuseTexture.coordinatesIndex,this._diffuseTexture.level),this._activeEffect.setMatrix("diffuseMatrix",this._diffuseTexture.getTextureMatrix())),i.MaterialHelper.BindClipPlane(this._activeEffect,r),this.pointsCloud&&this._activeEffect.setFloat("pointSize",this.pointSize),r.bindEyePosition(a)),this._activeEffect.setColor4("vDiffuseColor",this.diffuseColor,this.alpha*t.visibility),r.lightsEnabled&&!this.disableLighting&&i.MaterialHelper.BindLights(r,t,this._activeEffect,o,this._maxSimultaneousLights),r.fogEnabled&&t.applyFog&&r.fogMode!==i.Scene.FOGMODE_NONE&&this._activeEffect.setMatrix("view",r.getViewMatrix()),i.MaterialHelper.BindFogParameters(r,t,this._activeEffect),this._afterBind(t,this._activeEffect))}},t.prototype.getAnimatables=function(){var e=[];return this._diffuseTexture&&this._diffuseTexture.animations&&this._diffuseTexture.animations.length>0&&e.push(this._diffuseTexture),e},t.prototype.getActiveTextures=function(){var t=e.prototype.getActiveTextures.call(this);return this._diffuseTexture&&t.push(this._diffuseTexture),t},t.prototype.hasTexture=function(t){return!!e.prototype.hasTexture.call(this,t)||this._diffuseTexture===t},t.prototype.dispose=function(t){this._diffuseTexture&&this._diffuseTexture.dispose(),e.prototype.dispose.call(this,t)},t.prototype.getClassName=function(){return"CellMaterial"},t.prototype.clone=function(e){var n=this;return i.SerializationHelper.Clone(function(){return new t(e,n.getScene())},this)},t.prototype.serialize=function(){var e=i.SerializationHelper.Serialize(this);return e.customType="BABYLON.CellMaterial",e},t.Parse=function(e,n,r){return i.SerializationHelper.Parse(function(){return new t(e.name,n)},e,n,r)},Object(r.__decorate)([Object(i.serializeAsTexture)("diffuseTexture")],t.prototype,"_diffuseTexture",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"diffuseTexture",void 0),Object(r.__decorate)([Object(i.serializeAsColor3)("diffuse")],t.prototype,"diffuseColor",void 0),Object(r.__decorate)([Object(i.serialize)("computeHighLevel")],t.prototype,"_computeHighLevel",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"computeHighLevel",void 0),Object(r.__decorate)([Object(i.serialize)("disableLighting")],t.prototype,"_disableLighting",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsLightsDirty")],t.prototype,"disableLighting",void 0),Object(r.__decorate)([Object(i.serialize)("maxSimultaneousLights")],t.prototype,"_maxSimultaneousLights",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsLightsDirty")],t.prototype,"maxSimultaneousLights",void 0),t}(i.PushMaterial);Object(i.RegisterClass)("BABYLON.CellMaterial",a)},"./cell/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./cell/cellMaterial.ts");n.d(t,"CellMaterial",function(){return r.CellMaterial})},"./custom/customMaterial.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"CustomShaderStructure",function(){return o}),n.d(t,"ShaderSpecialParts",function(){return a}),n.d(t,"CustomMaterial",function(){return s});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/decorators"),o=function(){return function(){}}(),a=function(){return function(){}}(),s=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.CustomParts=new a,r.customShaderNameResolve=r.Builder,r.FragmentShader=i.Effect.ShadersStore.defaultPixelShader,r.VertexShader=i.Effect.ShadersStore.defaultVertexShader,r}return Object(r.__extends)(t,e),t.prototype.AttachAfterBind=function(e,t){if(this._newUniformInstances)for(var n in this._newUniformInstances){"vec2"==(r=n.toString().split("-"))[0]?t.setVector2(r[1],this._newUniformInstances[n]):"vec3"==r[0]?t.setVector3(r[1],this._newUniformInstances[n]):"vec4"==r[0]?t.setVector4(r[1],this._newUniformInstances[n]):"mat4"==r[0]?t.setMatrix(r[1],this._newUniformInstances[n]):"float"==r[0]&&t.setFloat(r[1],this._newUniformInstances[n])}if(this._newSamplerInstances)for(var n in this._newSamplerInstances){var r;"sampler2D"==(r=n.toString().split("-"))[0]&&this._newSamplerInstances[n].isReady&&this._newSamplerInstances[n].isReady()&&t.setTexture(r[1],this._newSamplerInstances[n])}},t.prototype.ReviewUniform=function(e,t){if("uniform"==e&&this._newUniforms)for(var n=0;n<this._newUniforms.length;n++)-1==this._customUniform[n].indexOf("sampler")&&t.push(this._newUniforms[n]);if("sampler"==e&&this._newUniforms)for(n=0;n<this._newUniforms.length;n++)-1!=this._customUniform[n].indexOf("sampler")&&t.push(this._newUniforms[n]);return t},t.prototype.Builder=function(e,n,r,o,a,s){var l=this;if(s&&this._customAttributes&&this._customAttributes.length>0&&s.push.apply(s,this._customAttributes),this.ReviewUniform("uniform",n),this.ReviewUniform("sampler",o),this._isCreatedShader)return this._createdShaderName;this._isCreatedShader=!1,t.ShaderIndexer++;var c="custom_"+t.ShaderIndexer,u=this._afterBind.bind(this);return this._afterBind=function(e,t){if(t){l.AttachAfterBind(e,t);try{u(e,t)}catch(t){}}},i.Effect.ShadersStore[c+"VertexShader"]=this.VertexShader.replace("#define CUSTOM_VERTEX_BEGIN",this.CustomParts.Vertex_Begin?this.CustomParts.Vertex_Begin:"").replace("#define CUSTOM_VERTEX_DEFINITIONS",(this._customUniform?this._customUniform.join("\n"):"")+(this.CustomParts.Vertex_Definitions?this.CustomParts.Vertex_Definitions:"")).replace("#define CUSTOM_VERTEX_MAIN_BEGIN",this.CustomParts.Vertex_MainBegin?this.CustomParts.Vertex_MainBegin:"").replace("#define CUSTOM_VERTEX_UPDATE_POSITION",this.CustomParts.Vertex_Before_PositionUpdated?this.CustomParts.Vertex_Before_PositionUpdated:"").replace("#define CUSTOM_VERTEX_UPDATE_NORMAL",this.CustomParts.Vertex_Before_NormalUpdated?this.CustomParts.Vertex_Before_NormalUpdated:"").replace("#define CUSTOM_VERTEX_MAIN_END",this.CustomParts.Vertex_MainEnd?this.CustomParts.Vertex_MainEnd:""),this.CustomParts.Vertex_After_WorldPosComputed&&(i.Effect.ShadersStore[c+"VertexShader"]=i.Effect.ShadersStore[c+"VertexShader"].replace("#define CUSTOM_VERTEX_UPDATE_WORLDPOS",this.CustomParts.Vertex_After_WorldPosComputed)),i.Effect.ShadersStore[c+"PixelShader"]=this.FragmentShader.replace("#define CUSTOM_FRAGMENT_BEGIN",this.CustomParts.Fragment_Begin?this.CustomParts.Fragment_Begin:"").replace("#define CUSTOM_FRAGMENT_MAIN_BEGIN",this.CustomParts.Fragment_MainBegin?this.CustomParts.Fragment_MainBegin:"").replace("#define CUSTOM_FRAGMENT_DEFINITIONS",(this._customUniform?this._customUniform.join("\n"):"")+(this.CustomParts.Fragment_Definitions?this.CustomParts.Fragment_Definitions:"")).replace("#define CUSTOM_FRAGMENT_UPDATE_DIFFUSE",this.CustomParts.Fragment_Custom_Diffuse?this.CustomParts.Fragment_Custom_Diffuse:"").replace("#define CUSTOM_FRAGMENT_UPDATE_ALPHA",this.CustomParts.Fragment_Custom_Alpha?this.CustomParts.Fragment_Custom_Alpha:"").replace("#define CUSTOM_FRAGMENT_BEFORE_LIGHTS",this.CustomParts.Fragment_Before_Lights?this.CustomParts.Fragment_Before_Lights:"").replace("#define CUSTOM_FRAGMENT_BEFORE_FRAGCOLOR",this.CustomParts.Fragment_Before_FragColor?this.CustomParts.Fragment_Before_FragColor:""),this.CustomParts.Fragment_Before_Fog&&(i.Effect.ShadersStore[c+"PixelShader"]=i.Effect.ShadersStore[c+"PixelShader"].replace("#define CUSTOM_FRAGMENT_BEFORE_FOG",this.CustomParts.Fragment_Before_Fog)),this._isCreatedShader=!0,this._createdShaderName=c,c},t.prototype.AddUniform=function(e,t,n){return this._customUniform||(this._customUniform=new Array,this._newUniforms=new Array,this._newSamplerInstances={},this._newUniformInstances={}),n&&(-1!=t.indexOf("sampler")?this._newSamplerInstances[t+"-"+e]=n:this._newUniformInstances[t+"-"+e]=n),this._customUniform.push("uniform "+t+" "+e+";"),this._newUniforms.push(e),this},t.prototype.AddAttribute=function(e){return this._customAttributes||(this._customAttributes=[]),this._customAttributes.push(e),this},t.prototype.Fragment_Begin=function(e){return this.CustomParts.Fragment_Begin=e,this},t.prototype.Fragment_Definitions=function(e){return this.CustomParts.Fragment_Definitions=e,this},t.prototype.Fragment_MainBegin=function(e){return this.CustomParts.Fragment_MainBegin=e,this},t.prototype.Fragment_Custom_Diffuse=function(e){return this.CustomParts.Fragment_Custom_Diffuse=e.replace("result","diffuseColor"),this},t.prototype.Fragment_Custom_Alpha=function(e){return this.CustomParts.Fragment_Custom_Alpha=e.replace("result","alpha"),this},t.prototype.Fragment_Before_Lights=function(e){return this.CustomParts.Fragment_Before_Lights=e,this},t.prototype.Fragment_Before_Fog=function(e){return this.CustomParts.Fragment_Before_Fog=e,this},t.prototype.Fragment_Before_FragColor=function(e){return this.CustomParts.Fragment_Before_FragColor=e.replace("result","color"),this},t.prototype.Vertex_Begin=function(e){return this.CustomParts.Vertex_Begin=e,this},t.prototype.Vertex_Definitions=function(e){return this.CustomParts.Vertex_Definitions=e,this},t.prototype.Vertex_MainBegin=function(e){return this.CustomParts.Vertex_MainBegin=e,this},t.prototype.Vertex_Before_PositionUpdated=function(e){return this.CustomParts.Vertex_Before_PositionUpdated=e.replace("result","positionUpdated"),this},t.prototype.Vertex_Before_NormalUpdated=function(e){return this.CustomParts.Vertex_Before_NormalUpdated=e.replace("result","normalUpdated"),this},t.prototype.Vertex_After_WorldPosComputed=function(e){return this.CustomParts.Vertex_After_WorldPosComputed=e,this},t.prototype.Vertex_MainEnd=function(e){return this.CustomParts.Vertex_MainEnd=e,this},t.ShaderIndexer=1,t}(i.StandardMaterial);Object(i.RegisterClass)("BABYLON.CustomMaterial",s)},"./custom/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./custom/customMaterial.ts");n.d(t,"CustomShaderStructure",function(){return r.CustomShaderStructure}),n.d(t,"ShaderSpecialParts",function(){return r.ShaderSpecialParts}),n.d(t,"CustomMaterial",function(){return r.CustomMaterial});var i=n("./custom/pbrCustomMaterial.ts");n.d(t,"ShaderAlebdoParts",function(){return i.ShaderAlebdoParts}),n.d(t,"PBRCustomMaterial",function(){return i.PBRCustomMaterial})},"./custom/pbrCustomMaterial.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"ShaderAlebdoParts",function(){return o}),n.d(t,"PBRCustomMaterial",function(){return a});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/decorators"),o=function(){return function(){}}(),a=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.CustomParts=new o,r.customShaderNameResolve=r.Builder,r.FragmentShader=i.Effect.ShadersStore.pbrPixelShader,r.VertexShader=i.Effect.ShadersStore.pbrVertexShader,r.FragmentShader=r.FragmentShader.replace(/#include<pbrBlockAlbedoOpacity>/g,i.Effect.IncludesShadersStore.pbrBlockAlbedoOpacity),r.FragmentShader=r.FragmentShader.replace(/#include<pbrBlockReflectivity>/g,i.Effect.IncludesShadersStore.pbrBlockReflectivity),r.FragmentShader=r.FragmentShader.replace(/#include<pbrBlockFinalColorComposition>/g,i.Effect.IncludesShadersStore.pbrBlockFinalColorComposition),r}return Object(r.__extends)(t,e),t.prototype.AttachAfterBind=function(e,t){if(this._newUniformInstances)for(var n in this._newUniformInstances){"vec2"==(r=n.toString().split("-"))[0]?t.setVector2(r[1],this._newUniformInstances[n]):"vec3"==r[0]?t.setVector3(r[1],this._newUniformInstances[n]):"vec4"==r[0]?t.setVector4(r[1],this._newUniformInstances[n]):"mat4"==r[0]?t.setMatrix(r[1],this._newUniformInstances[n]):"float"==r[0]&&t.setFloat(r[1],this._newUniformInstances[n])}if(this._newSamplerInstances)for(var n in this._newSamplerInstances){var r;"sampler2D"==(r=n.toString().split("-"))[0]&&this._newSamplerInstances[n].isReady&&this._newSamplerInstances[n].isReady()&&t.setTexture(r[1],this._newSamplerInstances[n])}},t.prototype.ReviewUniform=function(e,t){if("uniform"==e&&this._newUniforms)for(var n=0;n<this._newUniforms.length;n++)-1==this._customUniform[n].indexOf("sampler")&&t.push(this._newUniforms[n]);if("sampler"==e&&this._newUniforms)for(n=0;n<this._newUniforms.length;n++)-1!=this._customUniform[n].indexOf("sampler")&&t.push(this._newUniforms[n]);return t},t.prototype.Builder=function(e,n,r,o,a,s,l){var c=this;if(l){var u=l.processFinalCode;l.processFinalCode=function(e,t){if("vertex"===e)return u?u(e,t):t;var n=new i.ShaderCodeInliner(t);return n.inlineToken="#define pbr_inline",n.processCode(),u?u(e,n.code):n.code}}if(s&&this._customAttributes&&this._customAttributes.length>0&&s.push.apply(s,this._customAttributes),this.ReviewUniform("uniform",n),this.ReviewUniform("sampler",o),this._isCreatedShader)return this._createdShaderName;this._isCreatedShader=!1,t.ShaderIndexer++;var _="custom_"+t.ShaderIndexer,h=this._afterBind.bind(this);return this._afterBind=function(e,t){if(t){c.AttachAfterBind(e,t);try{h(e,t)}catch(t){}}},i.Effect.ShadersStore[_+"VertexShader"]=this.VertexShader.replace("#define CUSTOM_VERTEX_BEGIN",this.CustomParts.Vertex_Begin?this.CustomParts.Vertex_Begin:"").replace("#define CUSTOM_VERTEX_DEFINITIONS",(this._customUniform?this._customUniform.join("\n"):"")+(this.CustomParts.Vertex_Definitions?this.CustomParts.Vertex_Definitions:"")).replace("#define CUSTOM_VERTEX_MAIN_BEGIN",this.CustomParts.Vertex_MainBegin?this.CustomParts.Vertex_MainBegin:"").replace("#define CUSTOM_VERTEX_UPDATE_POSITION",this.CustomParts.Vertex_Before_PositionUpdated?this.CustomParts.Vertex_Before_PositionUpdated:"").replace("#define CUSTOM_VERTEX_UPDATE_NORMAL",this.CustomParts.Vertex_Before_NormalUpdated?this.CustomParts.Vertex_Before_NormalUpdated:"").replace("#define CUSTOM_VERTEX_MAIN_END",this.CustomParts.Vertex_MainEnd?this.CustomParts.Vertex_MainEnd:""),this.CustomParts.Vertex_After_WorldPosComputed&&(i.Effect.ShadersStore[_+"VertexShader"]=i.Effect.ShadersStore[_+"VertexShader"].replace("#define CUSTOM_VERTEX_UPDATE_WORLDPOS",this.CustomParts.Vertex_After_WorldPosComputed)),i.Effect.ShadersStore[_+"PixelShader"]=this.FragmentShader.replace("#define CUSTOM_FRAGMENT_BEGIN",this.CustomParts.Fragment_Begin?this.CustomParts.Fragment_Begin:"").replace("#define CUSTOM_FRAGMENT_MAIN_BEGIN",this.CustomParts.Fragment_MainBegin?this.CustomParts.Fragment_MainBegin:"").replace("#define CUSTOM_FRAGMENT_DEFINITIONS",(this._customUniform?this._customUniform.join("\n"):"")+(this.CustomParts.Fragment_Definitions?this.CustomParts.Fragment_Definitions:"")).replace("#define CUSTOM_FRAGMENT_UPDATE_ALBEDO",this.CustomParts.Fragment_Custom_Albedo?this.CustomParts.Fragment_Custom_Albedo:"").replace("#define CUSTOM_FRAGMENT_UPDATE_ALPHA",this.CustomParts.Fragment_Custom_Alpha?this.CustomParts.Fragment_Custom_Alpha:"").replace("#define CUSTOM_FRAGMENT_BEFORE_LIGHTS",this.CustomParts.Fragment_Before_Lights?this.CustomParts.Fragment_Before_Lights:"").replace("#define CUSTOM_FRAGMENT_UPDATE_METALLICROUGHNESS",this.CustomParts.Fragment_Custom_MetallicRoughness?this.CustomParts.Fragment_Custom_MetallicRoughness:"").replace("#define CUSTOM_FRAGMENT_UPDATE_MICROSURFACE",this.CustomParts.Fragment_Custom_MicroSurface?this.CustomParts.Fragment_Custom_MicroSurface:"").replace("#define CUSTOM_FRAGMENT_BEFORE_FINALCOLORCOMPOSITION",this.CustomParts.Fragment_Before_FinalColorComposition?this.CustomParts.Fragment_Before_FinalColorComposition:"").replace("#define CUSTOM_FRAGMENT_BEFORE_FRAGCOLOR",this.CustomParts.Fragment_Before_FragColor?this.CustomParts.Fragment_Before_FragColor:""),this.CustomParts.Fragment_Before_Fog&&(i.Effect.ShadersStore[_+"PixelShader"]=i.Effect.ShadersStore[_+"PixelShader"].replace("#define CUSTOM_FRAGMENT_BEFORE_FOG",this.CustomParts.Fragment_Before_Fog)),this._isCreatedShader=!0,this._createdShaderName=_,_},t.prototype.AddUniform=function(e,t,n){return this._customUniform||(this._customUniform=new Array,this._newUniforms=new Array,this._newSamplerInstances={},this._newUniformInstances={}),n&&(-1!=t.indexOf("sampler")?this._newSamplerInstances[t+"-"+e]=n:this._newUniformInstances[t+"-"+e]=n),this._customUniform.push("uniform "+t+" "+e+";"),this._newUniforms.push(e),this},t.prototype.AddAttribute=function(e){return this._customAttributes||(this._customAttributes=[]),this._customAttributes.push(e),this},t.prototype.Fragment_Begin=function(e){return this.CustomParts.Fragment_Begin=e,this},t.prototype.Fragment_Definitions=function(e){return this.CustomParts.Fragment_Definitions=e,this},t.prototype.Fragment_MainBegin=function(e){return this.CustomParts.Fragment_MainBegin=e,this},t.prototype.Fragment_Custom_Albedo=function(e){return this.CustomParts.Fragment_Custom_Albedo=e.replace("result","surfaceAlbedo"),this},t.prototype.Fragment_Custom_Alpha=function(e){return this.CustomParts.Fragment_Custom_Alpha=e.replace("result","alpha"),this},t.prototype.Fragment_Before_Lights=function(e){return this.CustomParts.Fragment_Before_Lights=e,this},t.prototype.Fragment_Custom_MetallicRoughness=function(e){return this.CustomParts.Fragment_Custom_MetallicRoughness=e,this},t.prototype.Fragment_Custom_MicroSurface=function(e){return this.CustomParts.Fragment_Custom_MicroSurface=e,this},t.prototype.Fragment_Before_Fog=function(e){return this.CustomParts.Fragment_Before_Fog=e,this},t.prototype.Fragment_Before_FinalColorComposition=function(e){return this.CustomParts.Fragment_Before_FinalColorComposition=e,this},t.prototype.Fragment_Before_FragColor=function(e){return this.CustomParts.Fragment_Before_FragColor=e.replace("result","color"),this},t.prototype.Vertex_Begin=function(e){return this.CustomParts.Vertex_Begin=e,this},t.prototype.Vertex_Definitions=function(e){return this.CustomParts.Vertex_Definitions=e,this},t.prototype.Vertex_MainBegin=function(e){return this.CustomParts.Vertex_MainBegin=e,this},t.prototype.Vertex_Before_PositionUpdated=function(e){return this.CustomParts.Vertex_Before_PositionUpdated=e.replace("result","positionUpdated"),this},t.prototype.Vertex_Before_NormalUpdated=function(e){return this.CustomParts.Vertex_Before_NormalUpdated=e.replace("result","normalUpdated"),this},t.prototype.Vertex_After_WorldPosComputed=function(e){return this.CustomParts.Vertex_After_WorldPosComputed=e,this},t.prototype.Vertex_MainEnd=function(e){return this.CustomParts.Vertex_MainEnd=e,this},t.ShaderIndexer=1,t}(i.PBRMaterial);Object(i.RegisterClass)("BABYLON.PBRCustomMaterial",a)},"./fire/fire.fragment.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"firePixelShader",function(){return a});var r=n("babylonjs/Misc/decorators"),i="firePixelShader",o="precision highp float;\n\nuniform vec4 vEyePosition;\n\nvarying vec3 vPositionW;\n#ifdef VERTEXCOLOR\nvarying vec4 vColor;\n#endif\n\n#ifdef DIFFUSE\nvarying vec2 vDiffuseUV;\nuniform sampler2D diffuseSampler;\nuniform vec2 vDiffuseInfos;\n#endif\n\nuniform sampler2D distortionSampler;\nuniform sampler2D opacitySampler;\n#ifdef DIFFUSE\nvarying vec2 vDistortionCoords1;\nvarying vec2 vDistortionCoords2;\nvarying vec2 vDistortionCoords3;\n#endif\n#include<clipPlaneFragmentDeclaration>\n\n#include<fogFragmentDeclaration>\nvec4 bx2(vec4 x)\n{\nreturn vec4(2.0)*x-vec4(1.0);\n}\nvoid main(void) {\n\n#include<clipPlaneFragment>\nvec3 viewDirectionW=normalize(vEyePosition.xyz-vPositionW);\n\nvec4 baseColor=vec4(1.,1.,1.,1.);\n\nfloat alpha=1.0;\n#ifdef DIFFUSE\n\nconst float distortionAmount0=0.092;\nconst float distortionAmount1=0.092;\nconst float distortionAmount2=0.092;\nvec2 heightAttenuation=vec2(0.3,0.39);\nvec4 noise0=texture2D(distortionSampler,vDistortionCoords1);\nvec4 noise1=texture2D(distortionSampler,vDistortionCoords2);\nvec4 noise2=texture2D(distortionSampler,vDistortionCoords3);\nvec4 noiseSum=bx2(noise0)*distortionAmount0+bx2(noise1)*distortionAmount1+bx2(noise2)*distortionAmount2;\nvec4 perturbedBaseCoords=vec4(vDiffuseUV,0.0,1.0)+noiseSum*(vDiffuseUV.y*heightAttenuation.x+heightAttenuation.y);\nvec4 opacityColor=texture2D(opacitySampler,perturbedBaseCoords.xy);\n#ifdef ALPHATEST\nif (opacityColor.r<0.1)\ndiscard;\n#endif\n#include<depthPrePass>\nbaseColor=texture2D(diffuseSampler,perturbedBaseCoords.xy)*2.0;\nbaseColor*=opacityColor;\nbaseColor.rgb*=vDiffuseInfos.y;\n#endif\n#ifdef VERTEXCOLOR\nbaseColor.rgb*=vColor.rgb;\n#endif\n\nvec3 diffuseBase=vec3(1.0,1.0,1.0);\n#ifdef VERTEXALPHA\nalpha*=vColor.a;\n#endif\n\nvec4 color=vec4(baseColor.rgb,alpha);\n#include<fogFragment>\ngl_FragColor=color;\n#include<imageProcessingCompatibility>\n}";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./fire/fire.vertex.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"fireVertexShader",function(){return a});var r=n("babylonjs/Misc/decorators"),i="fireVertexShader",o="precision highp float;\n\nattribute vec3 position;\n#ifdef UV1\nattribute vec2 uv;\n#endif\n#ifdef UV2\nattribute vec2 uv2;\n#endif\n#ifdef VERTEXCOLOR\nattribute vec4 color;\n#endif\n#include<bonesDeclaration>\n\n#include<instancesDeclaration>\nuniform mat4 view;\nuniform mat4 viewProjection;\n#ifdef DIFFUSE\nvarying vec2 vDiffuseUV;\n#endif\n#ifdef POINTSIZE\nuniform float pointSize;\n#endif\n\nvarying vec3 vPositionW;\n#ifdef VERTEXCOLOR\nvarying vec4 vColor;\n#endif\n#include<clipPlaneVertexDeclaration>\n#include<fogVertexDeclaration>\n\nuniform float time;\nuniform float speed;\n#ifdef DIFFUSE\nvarying vec2 vDistortionCoords1;\nvarying vec2 vDistortionCoords2;\nvarying vec2 vDistortionCoords3;\n#endif\nvoid main(void) {\n#include<instancesVertex>\n#include<bonesVertex>\nvec4 worldPos=finalWorld*vec4(position,1.0);\ngl_Position=viewProjection*worldPos;\nvPositionW=vec3(worldPos);\n\n#ifdef DIFFUSE\nvDiffuseUV=uv;\nvDiffuseUV.y-=0.2;\n#endif\n\n#include<clipPlaneVertex>\n\n#include<fogVertex>\n\n#ifdef VERTEXCOLOR\nvColor=color;\n#endif\n\n#ifdef POINTSIZE\ngl_PointSize=pointSize;\n#endif\n#ifdef DIFFUSE\n\nvec3 layerSpeed=vec3(-0.2,-0.52,-0.1)*speed;\nvDistortionCoords1.x=uv.x;\nvDistortionCoords1.y=uv.y+layerSpeed.x*time/1000.0;\nvDistortionCoords2.x=uv.x;\nvDistortionCoords2.y=uv.y+layerSpeed.y*time/1000.0;\nvDistortionCoords3.x=uv.x;\nvDistortionCoords3.y=uv.y+layerSpeed.z*time/1000.0;\n#endif\n}\n";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./fire/fireMaterial.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"FireMaterial",function(){return a});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/decorators"),o=(n("./fire/fire.fragment.ts"),n("./fire/fire.vertex.ts"),function(e){function t(){var t=e.call(this)||this;return t.DIFFUSE=!1,t.CLIPPLANE=!1,t.CLIPPLANE2=!1,t.CLIPPLANE3=!1,t.CLIPPLANE4=!1,t.CLIPPLANE5=!1,t.CLIPPLANE6=!1,t.ALPHATEST=!1,t.DEPTHPREPASS=!1,t.POINTSIZE=!1,t.FOG=!1,t.UV1=!1,t.VERTEXCOLOR=!1,t.VERTEXALPHA=!1,t.BonesPerMesh=0,t.NUM_BONE_INFLUENCERS=0,t.INSTANCES=!1,t.IMAGEPROCESSINGPOSTPROCESS=!1,t.rebuild(),t}return Object(r.__extends)(t,e),t}(i.MaterialDefines)),a=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.diffuseColor=new i.Color3(1,1,1),r.speed=1,r._scaledDiffuse=new i.Color3,r._lastTime=0,r}return Object(r.__extends)(t,e),t.prototype.needAlphaBlending=function(){return!1},t.prototype.needAlphaTesting=function(){return!0},t.prototype.getAlphaTestTexture=function(){return null},t.prototype.isReadyForSubMesh=function(e,t,n){if(this.isFrozen&&t.effect&&t.effect._wasPreviouslyReady)return!0;t._materialDefines||(t.materialDefines=new o);var r=t._materialDefines,a=this.getScene();if(this._isReadyForSubMesh(t))return!0;var s=a.getEngine();if(r._areTexturesDirty&&(r._needUVs=!1,this._diffuseTexture&&i.MaterialFlags.DiffuseTextureEnabled)){if(!this._diffuseTexture.isReady())return!1;r._needUVs=!0,r.DIFFUSE=!0}if(r.ALPHATEST=!!this._opacityTexture,r._areMiscDirty&&(r.POINTSIZE=this.pointsCloud||a.forcePointsCloud,r.FOG=a.fogEnabled&&e.applyFog&&a.fogMode!==i.Scene.FOGMODE_NONE&&this.fogEnabled),i.MaterialHelper.PrepareDefinesForFrameBoundValues(a,s,r,!!n),i.MaterialHelper.PrepareDefinesForAttributes(e,r,!1,!0),r.isDirty){r.markAsProcessed(),a.resetCachedMaterial();var l=new i.EffectFallbacks;r.FOG&&l.addFallback(1,"FOG"),r.NUM_BONE_INFLUENCERS>0&&l.addCPUSkinningFallback(0,e),r.IMAGEPROCESSINGPOSTPROCESS=a.imageProcessingConfiguration.applyByPostProcess;var c=[i.VertexBuffer.PositionKind];r.UV1&&c.push(i.VertexBuffer.UVKind),r.VERTEXCOLOR&&c.push(i.VertexBuffer.ColorKind),i.MaterialHelper.PrepareAttributesForBones(c,e,r,l),i.MaterialHelper.PrepareAttributesForInstances(c,r);var u=r.toString();t.setEffect(a.getEngine().createEffect("fire",{attributes:c,uniformsNames:["world","view","viewProjection","vEyePosition","vFogInfos","vFogColor","pointSize","vDiffuseInfos","mBones","vClipPlane","vClipPlane2","vClipPlane3","vClipPlane4","vClipPlane5","vClipPlane6","diffuseMatrix","time","speed"],uniformBuffersNames:[],samplers:["diffuseSampler","distortionSampler","opacitySampler"],defines:u,fallbacks:l,onCompiled:this.onCompiled,onError:this.onError,indexParameters:null,maxSimultaneousLights:4,transformFeedbackVaryings:null},s),r,this._materialContext)}return!(!t.effect||!t.effect.isReady())&&(r._renderId=a.getRenderId(),t.effect._wasPreviouslyReady=!0,!0)},t.prototype.bindForSubMesh=function(e,t,n){var r=this.getScene();if(n._materialDefines){var o=n.effect;o&&(this._activeEffect=o,this.bindOnlyWorldMatrix(e),this._activeEffect.setMatrix("viewProjection",r.getTransformMatrix()),i.MaterialHelper.BindBonesParameters(t,this._activeEffect),this._mustRebind(r,o)&&(this._diffuseTexture&&i.MaterialFlags.DiffuseTextureEnabled&&(this._activeEffect.setTexture("diffuseSampler",this._diffuseTexture),this._activeEffect.setFloat2("vDiffuseInfos",this._diffuseTexture.coordinatesIndex,this._diffuseTexture.level),this._activeEffect.setMatrix("diffuseMatrix",this._diffuseTexture.getTextureMatrix()),this._activeEffect.setTexture("distortionSampler",this._distortionTexture),this._activeEffect.setTexture("opacitySampler",this._opacityTexture)),i.MaterialHelper.BindClipPlane(this._activeEffect,r),this.pointsCloud&&this._activeEffect.setFloat("pointSize",this.pointSize),r.bindEyePosition(o)),this._activeEffect.setColor4("vDiffuseColor",this._scaledDiffuse,this.alpha*t.visibility),r.fogEnabled&&t.applyFog&&r.fogMode!==i.Scene.FOGMODE_NONE&&this._activeEffect.setMatrix("view",r.getViewMatrix()),i.MaterialHelper.BindFogParameters(r,t,this._activeEffect),this._lastTime+=r.getEngine().getDeltaTime(),this._activeEffect.setFloat("time",this._lastTime),this._activeEffect.setFloat("speed",this.speed),this._afterBind(t,this._activeEffect))}},t.prototype.getAnimatables=function(){var e=[];return this._diffuseTexture&&this._diffuseTexture.animations&&this._diffuseTexture.animations.length>0&&e.push(this._diffuseTexture),this._distortionTexture&&this._distortionTexture.animations&&this._distortionTexture.animations.length>0&&e.push(this._distortionTexture),this._opacityTexture&&this._opacityTexture.animations&&this._opacityTexture.animations.length>0&&e.push(this._opacityTexture),e},t.prototype.getActiveTextures=function(){var t=e.prototype.getActiveTextures.call(this);return this._diffuseTexture&&t.push(this._diffuseTexture),this._distortionTexture&&t.push(this._distortionTexture),this._opacityTexture&&t.push(this._opacityTexture),t},t.prototype.hasTexture=function(t){return!!e.prototype.hasTexture.call(this,t)||(this._diffuseTexture===t||(this._distortionTexture===t||this._opacityTexture===t))},t.prototype.getClassName=function(){return"FireMaterial"},t.prototype.dispose=function(t){this._diffuseTexture&&this._diffuseTexture.dispose(),this._distortionTexture&&this._distortionTexture.dispose(),e.prototype.dispose.call(this,t)},t.prototype.clone=function(e){var n=this;return i.SerializationHelper.Clone(function(){return new t(e,n.getScene())},this)},t.prototype.serialize=function(){var t=e.prototype.serialize.call(this);return t.customType="BABYLON.FireMaterial",t.diffuseColor=this.diffuseColor.asArray(),t.speed=this.speed,this._diffuseTexture&&(t._diffuseTexture=this._diffuseTexture.serialize()),this._distortionTexture&&(t._distortionTexture=this._distortionTexture.serialize()),this._opacityTexture&&(t._opacityTexture=this._opacityTexture.serialize()),t},t.Parse=function(e,n,r){var o=new t(e.name,n);return o.diffuseColor=i.Color3.FromArray(e.diffuseColor),o.speed=e.speed,o.alpha=e.alpha,o.id=e.id,i.Tags.AddTagsTo(o,e.tags),o.backFaceCulling=e.backFaceCulling,o.wireframe=e.wireframe,e._diffuseTexture&&(o._diffuseTexture=i.Texture.Parse(e._diffuseTexture,n,r)),e._distortionTexture&&(o._distortionTexture=i.Texture.Parse(e._distortionTexture,n,r)),e._opacityTexture&&(o._opacityTexture=i.Texture.Parse(e._opacityTexture,n,r)),o},Object(r.__decorate)([Object(i.serializeAsTexture)("diffuseTexture")],t.prototype,"_diffuseTexture",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"diffuseTexture",void 0),Object(r.__decorate)([Object(i.serializeAsTexture)("distortionTexture")],t.prototype,"_distortionTexture",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"distortionTexture",void 0),Object(r.__decorate)([Object(i.serializeAsTexture)("opacityTexture")],t.prototype,"_opacityTexture",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"opacityTexture",void 0),Object(r.__decorate)([Object(i.serializeAsColor3)("diffuse")],t.prototype,"diffuseColor",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"speed",void 0),t}(i.PushMaterial);Object(i.RegisterClass)("BABYLON.FireMaterial",a)},"./fire/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./fire/fireMaterial.ts");n.d(t,"FireMaterial",function(){return r.FireMaterial})},"./fur/fur.fragment.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"furPixelShader",function(){return a});var r=n("babylonjs/Misc/decorators"),i="furPixelShader",o="precision highp float;\n\nuniform vec4 vEyePosition;\nuniform vec4 vDiffuseColor;\n\nuniform vec4 furColor;\nuniform float furLength;\nvarying vec3 vPositionW;\nvarying float vfur_length;\n#ifdef NORMAL\nvarying vec3 vNormalW;\n#endif\n#ifdef VERTEXCOLOR\nvarying vec4 vColor;\n#endif\n\n#include<helperFunctions>\n\n#include<__decl__lightFragment>[0..maxSimultaneousLights]\n\n#ifdef DIFFUSE\nvarying vec2 vDiffuseUV;\nuniform sampler2D diffuseSampler;\nuniform vec2 vDiffuseInfos;\n#endif\n\n#ifdef HIGHLEVEL\nuniform float furOffset;\nuniform float furOcclusion;\nuniform sampler2D furTexture;\nvarying vec2 vFurUV;\n#endif\n#include<lightsFragmentFunctions>\n#include<shadowsFragmentFunctions>\n#include<fogFragmentDeclaration>\n#include<clipPlaneFragmentDeclaration>\nfloat Rand(vec3 rv) {\nfloat x=dot(rv,vec3(12.9898,78.233,24.65487));\nreturn fract(sin(x)*43758.5453);\n}\nvoid main(void) {\n\n#include<clipPlaneFragment>\nvec3 viewDirectionW=normalize(vEyePosition.xyz-vPositionW);\n\nvec4 baseColor=furColor;\nvec3 diffuseColor=vDiffuseColor.rgb;\n\nfloat alpha=vDiffuseColor.a;\n#ifdef DIFFUSE\nbaseColor*=texture2D(diffuseSampler,vDiffuseUV);\n#ifdef ALPHATEST\nif (baseColor.a<0.4)\ndiscard;\n#endif\n#include<depthPrePass>\nbaseColor.rgb*=vDiffuseInfos.y;\n#endif\n#ifdef VERTEXCOLOR\nbaseColor.rgb*=vColor.rgb;\n#endif\n\n#ifdef NORMAL\nvec3 normalW=normalize(vNormalW);\n#else\nvec3 normalW=vec3(1.0,1.0,1.0);\n#endif\n#ifdef HIGHLEVEL\n\nvec4 furTextureColor=texture2D(furTexture,vec2(vFurUV.x,vFurUV.y));\nif (furTextureColor.a<=0.0 || furTextureColor.g<furOffset) {\ndiscard;\n}\nfloat occlusion=mix(0.0,furTextureColor.b*1.2,furOffset);\nbaseColor=vec4(baseColor.xyz*max(occlusion,furOcclusion),1.1-furOffset);\n#endif\n\nvec3 diffuseBase=vec3(0.,0.,0.);\nlightingInfo info;\nfloat shadow=1.;\nfloat glossiness=0.;\n#ifdef SPECULARTERM\nvec3 specularBase=vec3(0.,0.,0.);\n#endif\n#include<lightFragment>[0..maxSimultaneousLights]\n#ifdef VERTEXALPHA\nalpha*=vColor.a;\n#endif\nvec3 finalDiffuse=clamp(diffuseBase.rgb*baseColor.rgb,0.0,1.0);\n\n#ifdef HIGHLEVEL\nvec4 color=vec4(finalDiffuse,alpha);\n#else\nfloat r=vfur_length/furLength*0.5;\nvec4 color=vec4(finalDiffuse*(0.5+r),alpha);\n#endif\n#include<fogFragment>\ngl_FragColor=color;\n#include<imageProcessingCompatibility>\n}";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./fur/fur.vertex.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"furVertexShader",function(){return a});var r=n("babylonjs/Misc/decorators"),i="furVertexShader",o="precision highp float;\n\nattribute vec3 position;\nattribute vec3 normal;\n#ifdef UV1\nattribute vec2 uv;\n#endif\n#ifdef UV2\nattribute vec2 uv2;\n#endif\n#ifdef VERTEXCOLOR\nattribute vec4 color;\n#endif\n#include<bonesDeclaration>\n\nuniform float furLength;\nuniform float furAngle;\n#ifdef HIGHLEVEL\nuniform float furOffset;\nuniform vec3 furGravity;\nuniform float furTime;\nuniform float furSpacing;\nuniform float furDensity;\n#endif\n#ifdef HEIGHTMAP\nuniform sampler2D heightTexture;\n#endif\n#ifdef HIGHLEVEL\nvarying vec2 vFurUV;\n#endif\n#include<instancesDeclaration>\nuniform mat4 view;\nuniform mat4 viewProjection;\n#ifdef DIFFUSE\nvarying vec2 vDiffuseUV;\nuniform mat4 diffuseMatrix;\nuniform vec2 vDiffuseInfos;\n#endif\n#ifdef POINTSIZE\nuniform float pointSize;\n#endif\n\nvarying vec3 vPositionW;\n#ifdef NORMAL\nvarying vec3 vNormalW;\n#endif\nvarying float vfur_length;\n#ifdef VERTEXCOLOR\nvarying vec4 vColor;\n#endif\n#include<clipPlaneVertexDeclaration>\n#include<fogVertexDeclaration>\n#include<__decl__lightFragment>[0..maxSimultaneousLights]\nfloat Rand(vec3 rv) {\nfloat x=dot(rv,vec3(12.9898,78.233,24.65487));\nreturn fract(sin(x)*43758.5453);\n}\nvoid main(void) {\n#include<instancesVertex>\n#include<bonesVertex>\n\nfloat r=Rand(position);\n#ifdef HEIGHTMAP\n#if __VERSION__>100\nvfur_length=furLength*texture(heightTexture,uv).x;\n#else\nvfur_length=furLength*texture2D(heightTexture,uv).r;\n#endif\n#else\nvfur_length=(furLength*r);\n#endif\nvec3 tangent1=vec3(normal.y,-normal.x,0);\nvec3 tangent2=vec3(-normal.z,0,normal.x);\nr=Rand(tangent1*r);\nfloat J=(2.0+4.0*r);\nr=Rand(tangent2*r);\nfloat K=(2.0+2.0*r);\ntangent1=tangent1*J+tangent2*K;\ntangent1=normalize(tangent1);\nvec3 newPosition=position+normal*vfur_length*cos(furAngle)+tangent1*vfur_length*sin(furAngle);\n#ifdef HIGHLEVEL\n\nvec3 forceDirection=vec3(0.0,0.0,0.0);\nforceDirection.x=sin(furTime+position.x*0.05)*0.2;\nforceDirection.y=cos(furTime*0.7+position.y*0.04)*0.2;\nforceDirection.z=sin(furTime*0.7+position.z*0.04)*0.2;\nvec3 displacement=vec3(0.0,0.0,0.0);\ndisplacement=furGravity+forceDirection;\nfloat displacementFactor=pow(furOffset,3.0);\nvec3 aNormal=normal;\naNormal.xyz+=displacement*displacementFactor;\nnewPosition=vec3(newPosition.x,newPosition.y,newPosition.z)+(normalize(aNormal)*furOffset*furSpacing);\n#endif\n#ifdef NORMAL\nvNormalW=normalize(vec3(finalWorld*vec4(normal,0.0)));\n#endif\n\ngl_Position=viewProjection*finalWorld*vec4(newPosition,1.0);\nvec4 worldPos=finalWorld*vec4(newPosition,1.0);\nvPositionW=vec3(worldPos);\n\n#ifndef UV1\nvec2 uv=vec2(0.,0.);\n#endif\n#ifndef UV2\nvec2 uv2=vec2(0.,0.);\n#endif\n#ifdef DIFFUSE\nif (vDiffuseInfos.x == 0.)\n{\nvDiffuseUV=vec2(diffuseMatrix*vec4(uv,1.0,0.0));\n}\nelse\n{\nvDiffuseUV=vec2(diffuseMatrix*vec4(uv2,1.0,0.0));\n}\n#ifdef HIGHLEVEL\nvFurUV=vDiffuseUV*furDensity;\n#endif\n#else\n#ifdef HIGHLEVEL\nvFurUV=uv*furDensity;\n#endif\n#endif\n\n#include<clipPlaneVertex>\n\n#include<fogVertex>\n\n#include<shadowsVertex>[0..maxSimultaneousLights]\n\n#ifdef VERTEXCOLOR\nvColor=color;\n#endif\n\n#ifdef POINTSIZE\ngl_PointSize=pointSize;\n#endif\n}\n";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./fur/furMaterial.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"FurMaterial",function(){return a});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/decorators"),o=(n("./fur/fur.fragment.ts"),n("./fur/fur.vertex.ts"),function(e){function t(){var t=e.call(this)||this;return t.DIFFUSE=!1,t.HEIGHTMAP=!1,t.CLIPPLANE=!1,t.CLIPPLANE2=!1,t.CLIPPLANE3=!1,t.CLIPPLANE4=!1,t.CLIPPLANE5=!1,t.CLIPPLANE6=!1,t.ALPHATEST=!1,t.DEPTHPREPASS=!1,t.POINTSIZE=!1,t.FOG=!1,t.NORMAL=!1,t.UV1=!1,t.UV2=!1,t.VERTEXCOLOR=!1,t.VERTEXALPHA=!1,t.NUM_BONE_INFLUENCERS=0,t.BonesPerMesh=0,t.INSTANCES=!1,t.HIGHLEVEL=!1,t.IMAGEPROCESSINGPOSTPROCESS=!1,t.rebuild(),t}return Object(r.__extends)(t,e),t}(i.MaterialDefines)),a=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.diffuseColor=new i.Color3(1,1,1),r.furLength=1,r.furAngle=0,r.furColor=new i.Color3(.44,.21,.02),r.furOffset=0,r.furSpacing=12,r.furGravity=new i.Vector3(0,0,0),r.furSpeed=100,r.furDensity=20,r.furOcclusion=0,r._disableLighting=!1,r._maxSimultaneousLights=4,r.highLevelFur=!0,r._furTime=0,r}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"furTime",{get:function(){return this._furTime},set:function(e){this._furTime=e},enumerable:!1,configurable:!0}),t.prototype.needAlphaBlending=function(){return this.alpha<1},t.prototype.needAlphaTesting=function(){return!1},t.prototype.getAlphaTestTexture=function(){return null},t.prototype.updateFur=function(){for(var e=1;e<this._meshes.length;e++){var t=this._meshes[e].material;t.furLength=this.furLength,t.furAngle=this.furAngle,t.furGravity=this.furGravity,t.furSpacing=this.furSpacing,t.furSpeed=this.furSpeed,t.furColor=this.furColor,t.diffuseTexture=this.diffuseTexture,t.furTexture=this.furTexture,t.highLevelFur=this.highLevelFur,t.furTime=this.furTime,t.furDensity=this.furDensity}},t.prototype.isReadyForSubMesh=function(e,t,n){if(this.isFrozen&&t.effect&&t.effect._wasPreviouslyReady)return!0;t._materialDefines||(t.materialDefines=new o);var r=t._materialDefines,a=this.getScene();if(this._isReadyForSubMesh(t))return!0;var s=a.getEngine();if(r._areTexturesDirty&&a.texturesEnabled){if(this.diffuseTexture&&i.MaterialFlags.DiffuseTextureEnabled){if(!this.diffuseTexture.isReady())return!1;r._needUVs=!0,r.DIFFUSE=!0}if(this.heightTexture&&s.getCaps().maxVertexTextureImageUnits){if(!this.heightTexture.isReady())return!1;r._needUVs=!0,r.HEIGHTMAP=!0}}if(this.highLevelFur!==r.HIGHLEVEL&&(r.HIGHLEVEL=!0,r.markAsUnprocessed()),i.MaterialHelper.PrepareDefinesForMisc(e,a,!1,this.pointsCloud,this.fogEnabled,this._shouldTurnAlphaTestOn(e),r),r._needNormals=i.MaterialHelper.PrepareDefinesForLights(a,e,r,!1,this._maxSimultaneousLights,this._disableLighting),i.MaterialHelper.PrepareDefinesForFrameBoundValues(a,s,r,!!n),i.MaterialHelper.PrepareDefinesForAttributes(e,r,!0,!0),r.isDirty){r.markAsProcessed(),a.resetCachedMaterial();var l=new i.EffectFallbacks;r.FOG&&l.addFallback(1,"FOG"),i.MaterialHelper.HandleFallbacksForShadows(r,l,this.maxSimultaneousLights),r.NUM_BONE_INFLUENCERS>0&&l.addCPUSkinningFallback(0,e),r.IMAGEPROCESSINGPOSTPROCESS=a.imageProcessingConfiguration.applyByPostProcess;var c=[i.VertexBuffer.PositionKind];r.NORMAL&&c.push(i.VertexBuffer.NormalKind),r.UV1&&c.push(i.VertexBuffer.UVKind),r.UV2&&c.push(i.VertexBuffer.UV2Kind),r.VERTEXCOLOR&&c.push(i.VertexBuffer.ColorKind),i.MaterialHelper.PrepareAttributesForBones(c,e,r,l),i.MaterialHelper.PrepareAttributesForInstances(c,r);var u=r.toString(),_=["world","view","viewProjection","vEyePosition","vLightsType","vDiffuseColor","vFogInfos","vFogColor","pointSize","vDiffuseInfos","mBones","vClipPlane","vClipPlane2","vClipPlane3","vClipPlane4","vClipPlane5","vClipPlane6","diffuseMatrix","furLength","furAngle","furColor","furOffset","furGravity","furTime","furSpacing","furDensity","furOcclusion"],h=["diffuseSampler","heightTexture","furTexture"],f=new Array;i.MaterialHelper.PrepareUniformsAndSamplersList({uniformsNames:_,uniformBuffersNames:f,samplers:h,defines:r,maxSimultaneousLights:this.maxSimultaneousLights}),t.setEffect(a.getEngine().createEffect("fur",{attributes:c,uniformsNames:_,uniformBuffersNames:f,samplers:h,defines:u,fallbacks:l,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousLights:this.maxSimultaneousLights}},s),r,this._materialContext)}return!(!t.effect||!t.effect.isReady())&&(r._renderId=a.getRenderId(),t.effect._wasPreviouslyReady=!0,!0)},t.prototype.bindForSubMesh=function(e,t,n){var r=this.getScene(),o=n._materialDefines;if(o){var a=n.effect;a&&(this._activeEffect=a,this.bindOnlyWorldMatrix(e),this._activeEffect.setMatrix("viewProjection",r.getTransformMatrix()),i.MaterialHelper.BindBonesParameters(t,this._activeEffect),r.getCachedMaterial()!==this&&(this._diffuseTexture&&i.MaterialFlags.DiffuseTextureEnabled&&(this._activeEffect.setTexture("diffuseSampler",this._diffuseTexture),this._activeEffect.setFloat2("vDiffuseInfos",this._diffuseTexture.coordinatesIndex,this._diffuseTexture.level),this._activeEffect.setMatrix("diffuseMatrix",this._diffuseTexture.getTextureMatrix())),this._heightTexture&&this._activeEffect.setTexture("heightTexture",this._heightTexture),i.MaterialHelper.BindClipPlane(this._activeEffect,r),this.pointsCloud&&this._activeEffect.setFloat("pointSize",this.pointSize),r.bindEyePosition(a)),this._activeEffect.setColor4("vDiffuseColor",this.diffuseColor,this.alpha*t.visibility),r.lightsEnabled&&!this.disableLighting&&i.MaterialHelper.BindLights(r,t,this._activeEffect,o,this.maxSimultaneousLights),r.fogEnabled&&t.applyFog&&r.fogMode!==i.Scene.FOGMODE_NONE&&this._activeEffect.setMatrix("view",r.getViewMatrix()),i.MaterialHelper.BindFogParameters(r,t,this._activeEffect),this._activeEffect.setFloat("furLength",this.furLength),this._activeEffect.setFloat("furAngle",this.furAngle),this._activeEffect.setColor4("furColor",this.furColor,1),this.highLevelFur&&(this._activeEffect.setVector3("furGravity",this.furGravity),this._activeEffect.setFloat("furOffset",this.furOffset),this._activeEffect.setFloat("furSpacing",this.furSpacing),this._activeEffect.setFloat("furDensity",this.furDensity),this._activeEffect.setFloat("furOcclusion",this.furOcclusion),this._furTime+=this.getScene().getEngine().getDeltaTime()/this.furSpeed,this._activeEffect.setFloat("furTime",this._furTime),this._activeEffect.setTexture("furTexture",this.furTexture)),this._afterBind(t,this._activeEffect))}},t.prototype.getAnimatables=function(){var e=[];return this.diffuseTexture&&this.diffuseTexture.animations&&this.diffuseTexture.animations.length>0&&e.push(this.diffuseTexture),this.heightTexture&&this.heightTexture.animations&&this.heightTexture.animations.length>0&&e.push(this.heightTexture),e},t.prototype.getActiveTextures=function(){var t=e.prototype.getActiveTextures.call(this);return this._diffuseTexture&&t.push(this._diffuseTexture),this._heightTexture&&t.push(this._heightTexture),t},t.prototype.hasTexture=function(t){return!!e.prototype.hasTexture.call(this,t)||(this.diffuseTexture===t||this._heightTexture===t)},t.prototype.dispose=function(t){if(this.diffuseTexture&&this.diffuseTexture.dispose(),this._meshes)for(var n=1;n<this._meshes.length;n++){var r=this._meshes[n].material;r&&r.dispose(t),this._meshes[n].dispose()}e.prototype.dispose.call(this,t)},t.prototype.clone=function(e){var n=this;return i.SerializationHelper.Clone(function(){return new t(e,n.getScene())},this)},t.prototype.serialize=function(){var e=i.SerializationHelper.Serialize(this);return e.customType="BABYLON.FurMaterial",this._meshes&&(e.sourceMeshName=this._meshes[0].name,e.quality=this._meshes.length),e},t.prototype.getClassName=function(){return"FurMaterial"},t.Parse=function(e,n,r){var o=i.SerializationHelper.Parse(function(){return new t(e.name,n)},e,n,r);return e.sourceMeshName&&o.highLevelFur&&n.executeWhenReady(function(){var r=n.getMeshByName(e.sourceMeshName);if(r){var i=t.GenerateTexture("Fur Texture",n);o.furTexture=i,t.FurifyMesh(r,e.quality)}}),o},t.GenerateTexture=function(e,t){for(var n=new i.DynamicTexture("FurTexture "+e,256,t,!0),r=n.getContext(),o=0;o<2e4;++o)r.fillStyle="rgba(255, "+Math.floor(255*Math.random())+", "+Math.floor(255*Math.random())+", 1)",r.fillRect(Math.random()*n.getSize().width,Math.random()*n.getSize().height,2,2);return n.update(!1),n.wrapU=i.Texture.WRAP_ADDRESSMODE,n.wrapV=i.Texture.WRAP_ADDRESSMODE,n},t.FurifyMesh=function(e,n){var r,o=[e],a=e.material;if(!(a instanceof t))throw"The material of the source mesh must be a Fur Material";for(r=1;r<n;r++){var s=new t(a.name+r,e.getScene());e.getScene().materials.pop(),i.Tags.EnableFor(s),i.Tags.AddTagsTo(s,"furShellMaterial"),s.furLength=a.furLength,s.furAngle=a.furAngle,s.furGravity=a.furGravity,s.furSpacing=a.furSpacing,s.furSpeed=a.furSpeed,s.furColor=a.furColor,s.diffuseTexture=a.diffuseTexture,s.furOffset=r/n,s.furTexture=a.furTexture,s.highLevelFur=a.highLevelFur,s.furTime=a.furTime,s.furDensity=a.furDensity;var l=e.clone(e.name+r);l.material=s,l.skeleton=e.skeleton,l.position=i.Vector3.Zero(),o.push(l)}for(r=1;r<o.length;r++)o[r].parent=e;return e.material._meshes=o,o},Object(r.__decorate)([Object(i.serializeAsTexture)("diffuseTexture")],t.prototype,"_diffuseTexture",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"diffuseTexture",void 0),Object(r.__decorate)([Object(i.serializeAsTexture)("heightTexture")],t.prototype,"_heightTexture",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"heightTexture",void 0),Object(r.__decorate)([Object(i.serializeAsColor3)()],t.prototype,"diffuseColor",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"furLength",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"furAngle",void 0),Object(r.__decorate)([Object(i.serializeAsColor3)()],t.prototype,"furColor",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"furOffset",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"furSpacing",void 0),Object(r.__decorate)([Object(i.serializeAsVector3)()],t.prototype,"furGravity",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"furSpeed",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"furDensity",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"furOcclusion",void 0),Object(r.__decorate)([Object(i.serialize)("disableLighting")],t.prototype,"_disableLighting",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsLightsDirty")],t.prototype,"disableLighting",void 0),Object(r.__decorate)([Object(i.serialize)("maxSimultaneousLights")],t.prototype,"_maxSimultaneousLights",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsLightsDirty")],t.prototype,"maxSimultaneousLights",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"highLevelFur",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"furTime",null),t}(i.PushMaterial);Object(i.RegisterClass)("BABYLON.FurMaterial",a)},"./fur/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./fur/furMaterial.ts");n.d(t,"FurMaterial",function(){return r.FurMaterial})},"./gradient/gradient.fragment.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"gradientPixelShader",function(){return a});var r=n("babylonjs/Misc/decorators"),i="gradientPixelShader",o="precision highp float;\n\nuniform vec4 vEyePosition;\n\nuniform vec4 topColor;\nuniform vec4 bottomColor;\nuniform float offset;\nuniform float scale;\nuniform float smoothness;\n\nvarying vec3 vPositionW;\nvarying vec3 vPosition;\n#ifdef NORMAL\nvarying vec3 vNormalW;\n#endif\n#ifdef VERTEXCOLOR\nvarying vec4 vColor;\n#endif\n\n#include<helperFunctions>\n\n#include<__decl__lightFragment>[0]\n#include<__decl__lightFragment>[1]\n#include<__decl__lightFragment>[2]\n#include<__decl__lightFragment>[3]\n#include<lightsFragmentFunctions>\n#include<shadowsFragmentFunctions>\n#include<clipPlaneFragmentDeclaration>\n\n#include<fogFragmentDeclaration>\nvoid main(void) {\n#include<clipPlaneFragment>\nvec3 viewDirectionW=normalize(vEyePosition.xyz-vPositionW);\nfloat h=vPosition.y*scale+offset;\nfloat mysmoothness=clamp(smoothness,0.01,max(smoothness,10.));\nvec4 baseColor=mix(bottomColor,topColor,max(pow(max(h,0.0),mysmoothness),0.0));\n\nvec3 diffuseColor=baseColor.rgb;\n\nfloat alpha=baseColor.a;\n#ifdef ALPHATEST\nif (baseColor.a<0.4)\ndiscard;\n#endif\n#include<depthPrePass>\n#ifdef VERTEXCOLOR\nbaseColor.rgb*=vColor.rgb;\n#endif\n\n#ifdef NORMAL\nvec3 normalW=normalize(vNormalW);\n#else\nvec3 normalW=vec3(1.0,1.0,1.0);\n#endif\n\n#ifdef EMISSIVE\nvec3 diffuseBase=baseColor.rgb;\n#else\nvec3 diffuseBase=vec3(0.,0.,0.);\n#endif\nlightingInfo info;\nfloat shadow=1.;\nfloat glossiness=0.;\n#include<lightFragment>[0..maxSimultaneousLights]\n#ifdef VERTEXALPHA\nalpha*=vColor.a;\n#endif\nvec3 finalDiffuse=clamp(diffuseBase*diffuseColor,0.0,1.0)*baseColor.rgb;\n\nvec4 color=vec4(finalDiffuse,alpha);\n#include<fogFragment>\ngl_FragColor=color;\n#include<imageProcessingCompatibility>\n}\n";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./gradient/gradient.vertex.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"gradientVertexShader",function(){return a});var r=n("babylonjs/Misc/decorators"),i="gradientVertexShader",o="precision highp float;\n\nattribute vec3 position;\n#ifdef NORMAL\nattribute vec3 normal;\n#endif\n#ifdef UV1\nattribute vec2 uv;\n#endif\n#ifdef UV2\nattribute vec2 uv2;\n#endif\n#ifdef VERTEXCOLOR\nattribute vec4 color;\n#endif\n#include<bonesDeclaration>\n\n#include<instancesDeclaration>\nuniform mat4 view;\nuniform mat4 viewProjection;\n#ifdef POINTSIZE\nuniform float pointSize;\n#endif\n\nvarying vec3 vPositionW;\nvarying vec3 vPosition;\n#ifdef NORMAL\nvarying vec3 vNormalW;\n#endif\n#ifdef VERTEXCOLOR\nvarying vec4 vColor;\n#endif\n#include<clipPlaneVertexDeclaration>\n#include<fogVertexDeclaration>\n#include<__decl__lightFragment>[0..maxSimultaneousLights]\nvoid main(void) {\n#include<instancesVertex>\n#include<bonesVertex>\nvec4 worldPos=finalWorld*vec4(position,1.0);\ngl_Position=viewProjection*worldPos;\nvPositionW=vec3(worldPos);\nvPosition=position;\n#ifdef NORMAL\nvNormalW=normalize(vec3(finalWorld*vec4(normal,0.0)));\n#endif\n\n#ifndef UV1\nvec2 uv=vec2(0.,0.);\n#endif\n#ifndef UV2\nvec2 uv2=vec2(0.,0.);\n#endif\n\n#include<clipPlaneVertex>\n\n#include<fogVertex>\n#include<shadowsVertex>[0..maxSimultaneousLights]\n\n#ifdef VERTEXCOLOR\nvColor=color;\n#endif\n\n#ifdef POINTSIZE\ngl_PointSize=pointSize;\n#endif\n}\n";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./gradient/gradientMaterial.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"GradientMaterial",function(){return a});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/decorators"),o=(n("./gradient/gradient.fragment.ts"),n("./gradient/gradient.vertex.ts"),function(e){function t(){var t=e.call(this)||this;return t.EMISSIVE=!1,t.CLIPPLANE=!1,t.CLIPPLANE2=!1,t.CLIPPLANE3=!1,t.CLIPPLANE4=!1,t.CLIPPLANE5=!1,t.CLIPPLANE6=!1,t.ALPHATEST=!1,t.DEPTHPREPASS=!1,t.POINTSIZE=!1,t.FOG=!1,t.NORMAL=!1,t.UV1=!1,t.UV2=!1,t.VERTEXCOLOR=!1,t.VERTEXALPHA=!1,t.NUM_BONE_INFLUENCERS=0,t.BonesPerMesh=0,t.INSTANCES=!1,t.IMAGEPROCESSINGPOSTPROCESS=!1,t.rebuild(),t}return Object(r.__extends)(t,e),t}(i.MaterialDefines)),a=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r._maxSimultaneousLights=4,r.topColor=new i.Color3(1,0,0),r.topColorAlpha=1,r.bottomColor=new i.Color3(0,0,1),r.bottomColorAlpha=1,r.offset=0,r.scale=1,r.smoothness=1,r._disableLighting=!1,r}return Object(r.__extends)(t,e),t.prototype.needAlphaBlending=function(){return this.alpha<1||this.topColorAlpha<1||this.bottomColorAlpha<1},t.prototype.needAlphaTesting=function(){return!0},t.prototype.getAlphaTestTexture=function(){return null},t.prototype.isReadyForSubMesh=function(e,t,n){if(this.isFrozen&&t.effect&&t.effect._wasPreviouslyReady)return!0;t._materialDefines||(t.materialDefines=new o);var r=t._materialDefines,a=this.getScene();if(this._isReadyForSubMesh(t))return!0;var s=a.getEngine();if(i.MaterialHelper.PrepareDefinesForFrameBoundValues(a,s,r,!!n),i.MaterialHelper.PrepareDefinesForMisc(e,a,!1,this.pointsCloud,this.fogEnabled,this._shouldTurnAlphaTestOn(e),r),r._needNormals=i.MaterialHelper.PrepareDefinesForLights(a,e,r,!1,this._maxSimultaneousLights,this._disableLighting),r.EMISSIVE=this._disableLighting,i.MaterialHelper.PrepareDefinesForAttributes(e,r,!1,!0),r.isDirty){r.markAsProcessed(),a.resetCachedMaterial();var l=new i.EffectFallbacks;r.FOG&&l.addFallback(1,"FOG"),i.MaterialHelper.HandleFallbacksForShadows(r,l),r.NUM_BONE_INFLUENCERS>0&&l.addCPUSkinningFallback(0,e),r.IMAGEPROCESSINGPOSTPROCESS=a.imageProcessingConfiguration.applyByPostProcess;var c=[i.VertexBuffer.PositionKind];r.NORMAL&&c.push(i.VertexBuffer.NormalKind),r.UV1&&c.push(i.VertexBuffer.UVKind),r.UV2&&c.push(i.VertexBuffer.UV2Kind),r.VERTEXCOLOR&&c.push(i.VertexBuffer.ColorKind),i.MaterialHelper.PrepareAttributesForBones(c,e,r,l),i.MaterialHelper.PrepareAttributesForInstances(c,r);var u=r.toString(),_=["world","view","viewProjection","vEyePosition","vLightsType","vFogInfos","vFogColor","pointSize","mBones","vClipPlane","vClipPlane2","vClipPlane3","vClipPlane4","vClipPlane5","vClipPlane6","topColor","bottomColor","offset","smoothness","scale"],h=[],f=new Array;i.MaterialHelper.PrepareUniformsAndSamplersList({uniformsNames:_,uniformBuffersNames:f,samplers:h,defines:r,maxSimultaneousLights:4}),t.setEffect(a.getEngine().createEffect("gradient",{attributes:c,uniformsNames:_,uniformBuffersNames:f,samplers:h,defines:u,fallbacks:l,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousLights:4}},s),r,this._materialContext)}return!(!t.effect||!t.effect.isReady())&&(r._renderId=a.getRenderId(),t.effect._wasPreviouslyReady=!0,!0)},t.prototype.bindForSubMesh=function(e,t,n){var r=this.getScene(),o=n._materialDefines;if(o){var a=n.effect;a&&(this._activeEffect=a,this.bindOnlyWorldMatrix(e),this._activeEffect.setMatrix("viewProjection",r.getTransformMatrix()),i.MaterialHelper.BindBonesParameters(t,a),this._mustRebind(r,a)&&(i.MaterialHelper.BindClipPlane(a,r),this.pointsCloud&&this._activeEffect.setFloat("pointSize",this.pointSize),r.bindEyePosition(a)),r.lightsEnabled&&!this.disableLighting&&i.MaterialHelper.BindLights(r,t,this._activeEffect,o,this.maxSimultaneousLights),r.fogEnabled&&t.applyFog&&r.fogMode!==i.Scene.FOGMODE_NONE&&this._activeEffect.setMatrix("view",r.getViewMatrix()),i.MaterialHelper.BindFogParameters(r,t,this._activeEffect),this._activeEffect.setColor4("topColor",this.topColor,this.topColorAlpha),this._activeEffect.setColor4("bottomColor",this.bottomColor,this.bottomColorAlpha),this._activeEffect.setFloat("offset",this.offset),this._activeEffect.setFloat("scale",this.scale),this._activeEffect.setFloat("smoothness",this.smoothness),this._afterBind(t,this._activeEffect))}},t.prototype.getAnimatables=function(){return[]},t.prototype.dispose=function(t){e.prototype.dispose.call(this,t)},t.prototype.clone=function(e){var n=this;return i.SerializationHelper.Clone(function(){return new t(e,n.getScene())},this)},t.prototype.serialize=function(){var e=i.SerializationHelper.Serialize(this);return e.customType="BABYLON.GradientMaterial",e},t.prototype.getClassName=function(){return"GradientMaterial"},t.Parse=function(e,n,r){return i.SerializationHelper.Parse(function(){return new t(e.name,n)},e,n,r)},Object(r.__decorate)([Object(i.serialize)("maxSimultaneousLights")],t.prototype,"_maxSimultaneousLights",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsLightsDirty")],t.prototype,"maxSimultaneousLights",void 0),Object(r.__decorate)([Object(i.serializeAsColor3)()],t.prototype,"topColor",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"topColorAlpha",void 0),Object(r.__decorate)([Object(i.serializeAsColor3)()],t.prototype,"bottomColor",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"bottomColorAlpha",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"offset",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"scale",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"smoothness",void 0),Object(r.__decorate)([Object(i.serialize)("disableLighting")],t.prototype,"_disableLighting",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsLightsDirty")],t.prototype,"disableLighting",void 0),t}(i.PushMaterial);Object(i.RegisterClass)("BABYLON.GradientMaterial",a)},"./gradient/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./gradient/gradientMaterial.ts");n.d(t,"GradientMaterial",function(){return r.GradientMaterial})},"./grid/grid.fragment.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"gridPixelShader",function(){return a});var r=n("babylonjs/Misc/decorators"),i="gridPixelShader",o="#extension GL_OES_standard_derivatives : enable\n#define SQRT2 1.41421356\n#define PI 3.14159\nprecision highp float;\nuniform vec3 mainColor;\nuniform vec3 lineColor;\nuniform vec4 gridControl;\nuniform vec3 gridOffset;\n\n#ifdef TRANSPARENT\nvarying vec4 vCameraSpacePosition;\n#endif\nvarying vec3 vPosition;\nvarying vec3 vNormal;\n#include<fogFragmentDeclaration>\nfloat getVisibility(float position) {\n\nfloat majorGridFrequency=gridControl.y;\nif (floor(position+0.5) == floor(position/majorGridFrequency+0.5)*majorGridFrequency)\n{\nreturn 1.0;\n} \nreturn gridControl.z;\n}\nfloat getAnisotropicAttenuation(float differentialLength) {\nconst float maxNumberOfLines=10.0;\nreturn clamp(1.0/(differentialLength+1.0)-1.0/maxNumberOfLines,0.0,1.0);\n}\nfloat isPointOnLine(float position,float differentialLength) {\nfloat fractionPartOfPosition=position-floor(position+0.5); \nfractionPartOfPosition/=differentialLength; \nfractionPartOfPosition=clamp(fractionPartOfPosition,-1.,1.);\nfloat result=0.5+0.5*cos(fractionPartOfPosition*PI); \nreturn result; \n}\nfloat contributionOnAxis(float position) {\nfloat differentialLength=length(vec2(dFdx(position),dFdy(position)));\ndifferentialLength*=SQRT2; \n\nfloat result=isPointOnLine(position,differentialLength);\n\nfloat visibility=getVisibility(position);\nresult*=visibility;\n\nfloat anisotropicAttenuation=getAnisotropicAttenuation(differentialLength);\nresult*=anisotropicAttenuation;\nreturn result;\n}\nfloat normalImpactOnAxis(float x) {\nfloat normalImpact=clamp(1.0-3.0*abs(x*x*x),0.0,1.0);\nreturn normalImpact;\n}\nvoid main(void) {\n\nfloat gridRatio=gridControl.x;\nvec3 gridPos=(vPosition+gridOffset)/gridRatio;\n\nfloat x=contributionOnAxis(gridPos.x);\nfloat y=contributionOnAxis(gridPos.y);\nfloat z=contributionOnAxis(gridPos.z);\n\nvec3 normal=normalize(vNormal);\nx*=normalImpactOnAxis(normal.x);\ny*=normalImpactOnAxis(normal.y);\nz*=normalImpactOnAxis(normal.z);\n\nfloat grid=clamp(x+y+z,0.,1.);\n\nvec3 color=mix(mainColor,lineColor,grid);\n#ifdef FOG\n#include<fogFragment>\n#endif\n#ifdef TRANSPARENT\nfloat distanceToFragment=length(vCameraSpacePosition.xyz);\nfloat cameraPassThrough=clamp(distanceToFragment-0.25,0.0,1.0);\nfloat opacity=clamp(grid,0.08,cameraPassThrough*gridControl.w*grid);\ngl_FragColor=vec4(color.rgb,opacity);\n#ifdef PREMULTIPLYALPHA\ngl_FragColor.rgb*=opacity;\n#endif\n#else\n\ngl_FragColor=vec4(color.rgb,mix(0.08,1.0,grid*100.0));\n#endif\n}";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./grid/grid.vertex.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"gridVertexShader",function(){return a});var r=n("babylonjs/Misc/decorators"),i="gridVertexShader",o="precision highp float;\n\nattribute vec3 position;\nattribute vec3 normal;\n#ifdef UV1\nattribute vec2 uv;\n#endif\n#ifdef UV2\nattribute vec2 uv2;\n#endif\n#include<instancesDeclaration>\n\nuniform mat4 projection;\nuniform mat4 view;\n\nvarying vec3 vPosition;\nvarying vec3 vNormal;\n#include<fogVertexDeclaration>\n#ifdef OPACITY\nvarying vec2 vOpacityUV;\nuniform mat4 opacityMatrix;\nuniform vec2 vOpacityInfos;\n#endif\nvoid main(void) {\n#include<instancesVertex>\nvec4 worldPos=finalWorld*vec4(position,1.0);\n#include<fogVertex>\nvec4 cameraSpacePosition=view*worldPos;\ngl_Position=projection*cameraSpacePosition;\n#ifdef OPACITY\n#ifndef UV1\nvec2 uv=vec2(0.,0.);\n#endif\n#ifndef UV2\nvec2 uv2=vec2(0.,0.);\n#endif\nif (vOpacityInfos.x == 0.)\n{\nvOpacityUV=vec2(opacityMatrix*vec4(uv,1.0,0.0));\n}\nelse\n{\nvOpacityUV=vec2(opacityMatrix*vec4(uv2,1.0,0.0));\n}\n#endif\nvPosition=position;\nvNormal=normal;\n}";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./grid/gridMaterial.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"GridMaterial",function(){return a});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/decorators"),o=(n("./grid/grid.fragment.ts"),n("./grid/grid.vertex.ts"),function(e){function t(){var t=e.call(this)||this;return t.OPACITY=!1,t.TRANSPARENT=!1,t.FOG=!1,t.PREMULTIPLYALPHA=!1,t.UV1=!1,t.UV2=!1,t.INSTANCES=!1,t.THIN_INSTANCES=!1,t.IMAGEPROCESSINGPOSTPROCESS=!1,t.rebuild(),t}return Object(r.__extends)(t,e),t}(i.MaterialDefines)),a=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.mainColor=i.Color3.Black(),r.lineColor=i.Color3.Teal(),r.gridRatio=1,r.gridOffset=i.Vector3.Zero(),r.majorUnitFrequency=10,r.minorUnitVisibility=.33,r.opacity=1,r.preMultiplyAlpha=!1,r._gridControl=new i.Vector4(r.gridRatio,r.majorUnitFrequency,r.minorUnitVisibility,r.opacity),r}return Object(r.__extends)(t,e),t.prototype.needAlphaBlending=function(){return!0},t.prototype.needAlphaBlendingForMesh=function(e){return e.visibility<1||this.needAlphaBlending()},t.prototype.isReadyForSubMesh=function(e,t,n){if(this.isFrozen&&t.effect&&t.effect._wasPreviouslyReady)return!0;t._materialDefines||(t.materialDefines=new o);var r=t._materialDefines,a=this.getScene();if(this._isReadyForSubMesh(t))return!0;if(r.TRANSPARENT!==this.opacity<1&&(r.TRANSPARENT=!r.TRANSPARENT,r.markAsUnprocessed()),r.PREMULTIPLYALPHA!=this.preMultiplyAlpha&&(r.PREMULTIPLYALPHA=!r.PREMULTIPLYALPHA,r.markAsUnprocessed()),r._areTexturesDirty&&(r._needUVs=!1,a.texturesEnabled&&this._opacityTexture&&i.MaterialFlags.OpacityTextureEnabled)){if(!this._opacityTexture.isReady())return!1;r._needUVs=!0,r.OPACITY=!0}if(i.MaterialHelper.PrepareDefinesForMisc(e,a,!1,!1,this.fogEnabled,!1,r),i.MaterialHelper.PrepareDefinesForFrameBoundValues(a,a.getEngine(),r,!!n),r.isDirty){r.markAsProcessed(),a.resetCachedMaterial(),i.MaterialHelper.PrepareDefinesForAttributes(e,r,!1,!1);var s=[i.VertexBuffer.PositionKind,i.VertexBuffer.NormalKind];r.UV1&&s.push(i.VertexBuffer.UVKind),r.UV2&&s.push(i.VertexBuffer.UV2Kind),r.IMAGEPROCESSINGPOSTPROCESS=a.imageProcessingConfiguration.applyByPostProcess,i.MaterialHelper.PrepareAttributesForInstances(s,r);var l=r.toString();t.setEffect(a.getEngine().createEffect("grid",s,["projection","mainColor","lineColor","gridControl","gridOffset","vFogInfos","vFogColor","world","view","opacityMatrix","vOpacityInfos","visibility"],["opacitySampler"],l,void 0,this.onCompiled,this.onError),r,this._materialContext)}return!(!t.effect||!t.effect.isReady())&&(r._renderId=a.getRenderId(),t.effect._wasPreviouslyReady=!0,!0)},t.prototype.bindForSubMesh=function(e,t,n){var r=this.getScene(),o=n._materialDefines;if(o){var a=n.effect;a&&(this._activeEffect=a,this._activeEffect.setFloat("visibility",t.visibility),o.INSTANCES&&!o.THIN_INSTANCE||this.bindOnlyWorldMatrix(e),this._activeEffect.setMatrix("view",r.getViewMatrix()),this._activeEffect.setMatrix("projection",r.getProjectionMatrix()),this._mustRebind(r,a)&&(this._activeEffect.setColor3("mainColor",this.mainColor),this._activeEffect.setColor3("lineColor",this.lineColor),this._activeEffect.setVector3("gridOffset",this.gridOffset),this._gridControl.x=this.gridRatio,this._gridControl.y=Math.round(this.majorUnitFrequency),this._gridControl.z=this.minorUnitVisibility,this._gridControl.w=this.opacity,this._activeEffect.setVector4("gridControl",this._gridControl),this._opacityTexture&&i.MaterialFlags.OpacityTextureEnabled&&(this._activeEffect.setTexture("opacitySampler",this._opacityTexture),this._activeEffect.setFloat2("vOpacityInfos",this._opacityTexture.coordinatesIndex,this._opacityTexture.level),this._activeEffect.setMatrix("opacityMatrix",this._opacityTexture.getTextureMatrix()))),i.MaterialHelper.BindFogParameters(r,t,this._activeEffect),this._afterBind(t,this._activeEffect))}},t.prototype.dispose=function(t){e.prototype.dispose.call(this,t)},t.prototype.clone=function(e){var n=this;return i.SerializationHelper.Clone(function(){return new t(e,n.getScene())},this)},t.prototype.serialize=function(){var e=i.SerializationHelper.Serialize(this);return e.customType="BABYLON.GridMaterial",e},t.prototype.getClassName=function(){return"GridMaterial"},t.Parse=function(e,n,r){return i.SerializationHelper.Parse(function(){return new t(e.name,n)},e,n,r)},Object(r.__decorate)([Object(i.serializeAsColor3)()],t.prototype,"mainColor",void 0),Object(r.__decorate)([Object(i.serializeAsColor3)()],t.prototype,"lineColor",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"gridRatio",void 0),Object(r.__decorate)([Object(i.serializeAsVector3)()],t.prototype,"gridOffset",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"majorUnitFrequency",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"minorUnitVisibility",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"opacity",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"preMultiplyAlpha",void 0),Object(r.__decorate)([Object(i.serializeAsTexture)("opacityTexture")],t.prototype,"_opacityTexture",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"opacityTexture",void 0),t}(i.PushMaterial);Object(i.RegisterClass)("BABYLON.GridMaterial",a)},"./grid/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./grid/gridMaterial.ts");n.d(t,"GridMaterial",function(){return r.GridMaterial})},"./index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./cell/index.ts");n.d(t,"CellMaterial",function(){return r.CellMaterial});var i=n("./custom/index.ts");n.d(t,"CustomShaderStructure",function(){return i.CustomShaderStructure}),n.d(t,"ShaderSpecialParts",function(){return i.ShaderSpecialParts}),n.d(t,"CustomMaterial",function(){return i.CustomMaterial}),n.d(t,"ShaderAlebdoParts",function(){return i.ShaderAlebdoParts}),n.d(t,"PBRCustomMaterial",function(){return i.PBRCustomMaterial});var o=n("./fire/index.ts");n.d(t,"FireMaterial",function(){return o.FireMaterial});var a=n("./fur/index.ts");n.d(t,"FurMaterial",function(){return a.FurMaterial});var s=n("./gradient/index.ts");n.d(t,"GradientMaterial",function(){return s.GradientMaterial});var l=n("./grid/index.ts");n.d(t,"GridMaterial",function(){return l.GridMaterial});var c=n("./lava/index.ts");n.d(t,"LavaMaterial",function(){return c.LavaMaterial});var u=n("./mix/index.ts");n.d(t,"MixMaterial",function(){return u.MixMaterial});var _=n("./normal/index.ts");n.d(t,"NormalMaterial",function(){return _.NormalMaterial});var h=n("./shadowOnly/index.ts");n.d(t,"ShadowOnlyMaterial",function(){return h.ShadowOnlyMaterial});var f=n("./simple/index.ts");n.d(t,"SimpleMaterial",function(){return f.SimpleMaterial});var d=n("./sky/index.ts");n.d(t,"SkyMaterial",function(){return d.SkyMaterial});var p=n("./terrain/index.ts");n.d(t,"TerrainMaterial",function(){return p.TerrainMaterial});var m=n("./triPlanar/index.ts");n.d(t,"TriPlanarMaterial",function(){return m.TriPlanarMaterial});var g=n("./water/index.ts");n.d(t,"WaterMaterial",function(){return g.WaterMaterial})},"./lava/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./lava/lavaMaterial.ts");n.d(t,"LavaMaterial",function(){return r.LavaMaterial})},"./lava/lava.fragment.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"lavaPixelShader",function(){return a});var r=n("babylonjs/Misc/decorators"),i="lavaPixelShader",o="precision highp float;\n\nuniform vec4 vEyePosition;\nuniform vec4 vDiffuseColor;\n\nvarying vec3 vPositionW;\n\nuniform float time;\nuniform float speed;\nuniform float movingSpeed;\nuniform vec3 fogColor;\nuniform sampler2D noiseTexture;\nuniform float fogDensity;\n\nvarying float noise;\n#ifdef NORMAL\nvarying vec3 vNormalW;\n#endif\n#ifdef VERTEXCOLOR\nvarying vec4 vColor;\n#endif\n\n#include<helperFunctions>\n\n#include<__decl__lightFragment>[0]\n#include<__decl__lightFragment>[1]\n#include<__decl__lightFragment>[2]\n#include<__decl__lightFragment>[3]\n#include<lightsFragmentFunctions>\n#include<shadowsFragmentFunctions>\n\n#ifdef DIFFUSE\nvarying vec2 vDiffuseUV;\nuniform sampler2D diffuseSampler;\nuniform vec2 vDiffuseInfos;\n#endif\n#include<clipPlaneFragmentDeclaration>\n\n#include<fogFragmentDeclaration>\nfloat random( vec3 scale,float seed ){\nreturn fract( sin( dot( gl_FragCoord.xyz+seed,scale ) )*43758.5453+seed ) ;\n}\nvoid main(void) {\n#include<clipPlaneFragment>\nvec3 viewDirectionW=normalize(vEyePosition.xyz-vPositionW);\n\nvec4 baseColor=vec4(1.,1.,1.,1.);\nvec3 diffuseColor=vDiffuseColor.rgb;\n\nfloat alpha=vDiffuseColor.a;\n#ifdef DIFFUSE\n\nvec4 noiseTex=texture2D( noiseTexture,vDiffuseUV );\nvec2 T1=vDiffuseUV+vec2( 1.5,-1.5 )*time*0.02;\nvec2 T2=vDiffuseUV+vec2( -0.5,2.0 )*time*0.01*speed;\nT1.x+=noiseTex.x*2.0;\nT1.y+=noiseTex.y*2.0;\nT2.x-=noiseTex.y*0.2+time*0.001*movingSpeed;\nT2.y+=noiseTex.z*0.2+time*0.002*movingSpeed;\nfloat p=texture2D( noiseTexture,T1*3.0 ).a;\nvec4 lavaColor=texture2D( diffuseSampler,T2*4.0);\nvec4 temp=lavaColor*( vec4( p,p,p,p )*2. )+( lavaColor*lavaColor-0.1 );\nbaseColor=temp;\nfloat depth=gl_FragCoord.z*4.0;\nconst float LOG2=1.442695;\nfloat fogFactor=exp2(-fogDensity*fogDensity*depth*depth*LOG2 );\nfogFactor=1.0-clamp( fogFactor,0.0,1.0 );\nbaseColor=mix( baseColor,vec4( fogColor,baseColor.w ),fogFactor );\ndiffuseColor=baseColor.rgb;\n\n\n#ifdef ALPHATEST\nif (baseColor.a<0.4)\ndiscard;\n#endif\n#include<depthPrePass>\nbaseColor.rgb*=vDiffuseInfos.y;\n#endif\n#ifdef VERTEXCOLOR\nbaseColor.rgb*=vColor.rgb;\n#endif\n\n#ifdef NORMAL\nvec3 normalW=normalize(vNormalW);\n#else\nvec3 normalW=vec3(1.0,1.0,1.0);\n#endif\n#ifdef UNLIT\nvec3 diffuseBase=vec3(1.,1.,1.);\n#else\n\nvec3 diffuseBase=vec3(0.,0.,0.);\nlightingInfo info;\nfloat shadow=1.;\nfloat glossiness=0.;\n#include<lightFragment>[0]\n#include<lightFragment>[1]\n#include<lightFragment>[2]\n#include<lightFragment>[3]\n#endif\n#ifdef VERTEXALPHA\nalpha*=vColor.a;\n#endif\nvec3 finalDiffuse=clamp(diffuseBase*diffuseColor,0.0,1.0)*baseColor.rgb;\n\nvec4 color=vec4(finalDiffuse,alpha);\n#include<fogFragment>\ngl_FragColor=color;\n#include<imageProcessingCompatibility>\n}";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./lava/lava.vertex.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"lavaVertexShader",function(){return a});var r=n("babylonjs/Misc/decorators"),i="lavaVertexShader",o="precision highp float;\n\nuniform float time;\nuniform float lowFrequencySpeed;\n\nvarying float noise;\n\nattribute vec3 position;\n#ifdef NORMAL\nattribute vec3 normal;\n#endif\n#ifdef UV1\nattribute vec2 uv;\n#endif\n#ifdef UV2\nattribute vec2 uv2;\n#endif\n#ifdef VERTEXCOLOR\nattribute vec4 color;\n#endif\n#include<bonesDeclaration>\n\n#include<instancesDeclaration>\nuniform mat4 view;\nuniform mat4 viewProjection;\n#ifdef DIFFUSE\nvarying vec2 vDiffuseUV;\nuniform mat4 diffuseMatrix;\nuniform vec2 vDiffuseInfos;\n#endif\n#ifdef POINTSIZE\nuniform float pointSize;\n#endif\n\nvarying vec3 vPositionW;\n#ifdef NORMAL\nvarying vec3 vNormalW;\n#endif\n#ifdef VERTEXCOLOR\nvarying vec4 vColor;\n#endif\n#include<clipPlaneVertexDeclaration>\n#include<fogVertexDeclaration>\n#include<__decl__lightFragment>[0..maxSimultaneousLights]\n\n\n\nvec3 mod289(vec3 x)\n{\nreturn x-floor(x*(1.0/289.0))*289.0;\n}\nvec4 mod289(vec4 x)\n{\nreturn x-floor(x*(1.0/289.0))*289.0;\n}\nvec4 permute(vec4 x)\n{\nreturn mod289(((x*34.0)+1.0)*x);\n}\nvec4 taylorInvSqrt(vec4 r)\n{\nreturn 1.79284291400159-0.85373472095314*r;\n}\nvec3 fade(vec3 t) {\nreturn t*t*t*(t*(t*6.0-15.0)+10.0);\n}\n\nfloat pnoise(vec3 P,vec3 rep)\n{\nvec3 Pi0=mod(floor(P),rep);\nvec3 Pi1=mod(Pi0+vec3(1.0),rep);\nPi0=mod289(Pi0);\nPi1=mod289(Pi1);\nvec3 Pf0=fract(P);\nvec3 Pf1=Pf0-vec3(1.0);\nvec4 ix=vec4(Pi0.x,Pi1.x,Pi0.x,Pi1.x);\nvec4 iy=vec4(Pi0.yy,Pi1.yy);\nvec4 iz0=Pi0.zzzz;\nvec4 iz1=Pi1.zzzz;\nvec4 ixy=permute(permute(ix)+iy);\nvec4 ixy0=permute(ixy+iz0);\nvec4 ixy1=permute(ixy+iz1);\nvec4 gx0=ixy0*(1.0/7.0);\nvec4 gy0=fract(floor(gx0)*(1.0/7.0))-0.5;\ngx0=fract(gx0);\nvec4 gz0=vec4(0.5)-abs(gx0)-abs(gy0);\nvec4 sz0=step(gz0,vec4(0.0));\ngx0-=sz0*(step(0.0,gx0)-0.5);\ngy0-=sz0*(step(0.0,gy0)-0.5);\nvec4 gx1=ixy1*(1.0/7.0);\nvec4 gy1=fract(floor(gx1)*(1.0/7.0))-0.5;\ngx1=fract(gx1);\nvec4 gz1=vec4(0.5)-abs(gx1)-abs(gy1);\nvec4 sz1=step(gz1,vec4(0.0));\ngx1-=sz1*(step(0.0,gx1)-0.5);\ngy1-=sz1*(step(0.0,gy1)-0.5);\nvec3 g000=vec3(gx0.x,gy0.x,gz0.x);\nvec3 g100=vec3(gx0.y,gy0.y,gz0.y);\nvec3 g010=vec3(gx0.z,gy0.z,gz0.z);\nvec3 g110=vec3(gx0.w,gy0.w,gz0.w);\nvec3 g001=vec3(gx1.x,gy1.x,gz1.x);\nvec3 g101=vec3(gx1.y,gy1.y,gz1.y);\nvec3 g011=vec3(gx1.z,gy1.z,gz1.z);\nvec3 g111=vec3(gx1.w,gy1.w,gz1.w);\nvec4 norm0=taylorInvSqrt(vec4(dot(g000,g000),dot(g010,g010),dot(g100,g100),dot(g110,g110)));\ng000*=norm0.x;\ng010*=norm0.y;\ng100*=norm0.z;\ng110*=norm0.w;\nvec4 norm1=taylorInvSqrt(vec4(dot(g001,g001),dot(g011,g011),dot(g101,g101),dot(g111,g111)));\ng001*=norm1.x;\ng011*=norm1.y;\ng101*=norm1.z;\ng111*=norm1.w;\nfloat n000=dot(g000,Pf0);\nfloat n100=dot(g100,vec3(Pf1.x,Pf0.yz));\nfloat n010=dot(g010,vec3(Pf0.x,Pf1.y,Pf0.z));\nfloat n110=dot(g110,vec3(Pf1.xy,Pf0.z));\nfloat n001=dot(g001,vec3(Pf0.xy,Pf1.z));\nfloat n101=dot(g101,vec3(Pf1.x,Pf0.y,Pf1.z));\nfloat n011=dot(g011,vec3(Pf0.x,Pf1.yz));\nfloat n111=dot(g111,Pf1);\nvec3 fade_xyz=fade(Pf0);\nvec4 n_z=mix(vec4(n000,n100,n010,n110),vec4(n001,n101,n011,n111),fade_xyz.z);\nvec2 n_yz=mix(n_z.xy,n_z.zw,fade_xyz.y);\nfloat n_xyz=mix(n_yz.x,n_yz.y,fade_xyz.x);\nreturn 2.2*n_xyz;\n}\n\nfloat turbulence( vec3 p ) {\nfloat w=100.0;\nfloat t=-.5;\nfor (float f=1.0 ; f<=10.0 ; f++ ){\nfloat power=pow( 2.0,f );\nt+=abs( pnoise( vec3( power*p ),vec3( 10.0,10.0,10.0 ) )/power );\n}\nreturn t;\n}\nvoid main(void) {\n#include<instancesVertex>\n#include<bonesVertex>\n#ifdef NORMAL\n\nnoise=10.0*-.10*turbulence( .5*normal+time*1.15 );\n\nfloat b=lowFrequencySpeed*5.0*pnoise( 0.05*position +vec3(time*1.025),vec3( 100.0 ) );\n\nfloat displacement =-1.5*noise+b;\n\nvec3 newPosition=position+normal*displacement;\ngl_Position=viewProjection*finalWorld*vec4( newPosition,1.0 );\nvec4 worldPos=finalWorld*vec4(newPosition,1.0);\nvPositionW=vec3(worldPos);\nvNormalW=normalize(vec3(finalWorld*vec4(normal,0.0)));\n#endif\n\n#ifndef UV1\nvec2 uv=vec2(0.,0.);\n#endif\n#ifndef UV2\nvec2 uv2=vec2(0.,0.);\n#endif\n#ifdef DIFFUSE\nif (vDiffuseInfos.x == 0.)\n{\nvDiffuseUV=vec2(diffuseMatrix*vec4(uv,1.0,0.0));\n}\nelse\n{\nvDiffuseUV=vec2(diffuseMatrix*vec4(uv2,1.0,0.0));\n}\n#endif\n\n#include<clipPlaneVertex>\n\n#include<fogVertex>\n#include<shadowsVertex>[0..maxSimultaneousLights]\n\n#ifdef VERTEXCOLOR\nvColor=color;\n#endif\n\n#ifdef POINTSIZE\ngl_PointSize=pointSize;\n#endif\n}";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./lava/lavaMaterial.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"LavaMaterial",function(){return a});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/decorators"),o=(n("./lava/lava.fragment.ts"),n("./lava/lava.vertex.ts"),function(e){function t(){var t=e.call(this)||this;return t.DIFFUSE=!1,t.CLIPPLANE=!1,t.CLIPPLANE2=!1,t.CLIPPLANE3=!1,t.CLIPPLANE4=!1,t.CLIPPLANE5=!1,t.CLIPPLANE6=!1,t.ALPHATEST=!1,t.DEPTHPREPASS=!1,t.POINTSIZE=!1,t.FOG=!1,t.LIGHT0=!1,t.LIGHT1=!1,t.LIGHT2=!1,t.LIGHT3=!1,t.SPOTLIGHT0=!1,t.SPOTLIGHT1=!1,t.SPOTLIGHT2=!1,t.SPOTLIGHT3=!1,t.HEMILIGHT0=!1,t.HEMILIGHT1=!1,t.HEMILIGHT2=!1,t.HEMILIGHT3=!1,t.DIRLIGHT0=!1,t.DIRLIGHT1=!1,t.DIRLIGHT2=!1,t.DIRLIGHT3=!1,t.POINTLIGHT0=!1,t.POINTLIGHT1=!1,t.POINTLIGHT2=!1,t.POINTLIGHT3=!1,t.SHADOW0=!1,t.SHADOW1=!1,t.SHADOW2=!1,t.SHADOW3=!1,t.SHADOWS=!1,t.SHADOWESM0=!1,t.SHADOWESM1=!1,t.SHADOWESM2=!1,t.SHADOWESM3=!1,t.SHADOWPOISSON0=!1,t.SHADOWPOISSON1=!1,t.SHADOWPOISSON2=!1,t.SHADOWPOISSON3=!1,t.SHADOWPCF0=!1,t.SHADOWPCF1=!1,t.SHADOWPCF2=!1,t.SHADOWPCF3=!1,t.SHADOWPCSS0=!1,t.SHADOWPCSS1=!1,t.SHADOWPCSS2=!1,t.SHADOWPCSS3=!1,t.NORMAL=!1,t.UV1=!1,t.UV2=!1,t.VERTEXCOLOR=!1,t.VERTEXALPHA=!1,t.NUM_BONE_INFLUENCERS=0,t.BonesPerMesh=0,t.INSTANCES=!1,t.UNLIT=!1,t.IMAGEPROCESSINGPOSTPROCESS=!1,t.rebuild(),t}return Object(r.__extends)(t,e),t}(i.MaterialDefines)),a=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.speed=1,r.movingSpeed=1,r.lowFrequencySpeed=1,r.fogDensity=.15,r._lastTime=0,r.diffuseColor=new i.Color3(1,1,1),r._disableLighting=!1,r._unlit=!1,r._maxSimultaneousLights=4,r._scaledDiffuse=new i.Color3,r}return Object(r.__extends)(t,e),t.prototype.needAlphaBlending=function(){return this.alpha<1},t.prototype.needAlphaTesting=function(){return!1},t.prototype.getAlphaTestTexture=function(){return null},t.prototype.isReadyForSubMesh=function(e,t,n){if(this.isFrozen&&t.effect&&t.effect._wasPreviouslyReady)return!0;t._materialDefines||(t.materialDefines=new o);var r=t._materialDefines,a=this.getScene();if(this._isReadyForSubMesh(t))return!0;var s=a.getEngine();if(r._areTexturesDirty&&(r._needUVs=!1,a.texturesEnabled&&this._diffuseTexture&&i.MaterialFlags.DiffuseTextureEnabled)){if(!this._diffuseTexture.isReady())return!1;r._needUVs=!0,r.DIFFUSE=!0}if(i.MaterialHelper.PrepareDefinesForMisc(e,a,!1,this.pointsCloud,this.fogEnabled,this._shouldTurnAlphaTestOn(e),r),r._needNormals=!0,i.MaterialHelper.PrepareDefinesForLights(a,e,r,!1,this._maxSimultaneousLights,this._disableLighting),i.MaterialHelper.PrepareDefinesForFrameBoundValues(a,s,r,!!n),i.MaterialHelper.PrepareDefinesForAttributes(e,r,!0,!0),r.isDirty){r.markAsProcessed(),a.resetCachedMaterial();var l=new i.EffectFallbacks;r.FOG&&l.addFallback(1,"FOG"),i.MaterialHelper.HandleFallbacksForShadows(r,l),r.NUM_BONE_INFLUENCERS>0&&l.addCPUSkinningFallback(0,e),r.IMAGEPROCESSINGPOSTPROCESS=a.imageProcessingConfiguration.applyByPostProcess;var c=[i.VertexBuffer.PositionKind];r.NORMAL&&c.push(i.VertexBuffer.NormalKind),r.UV1&&c.push(i.VertexBuffer.UVKind),r.UV2&&c.push(i.VertexBuffer.UV2Kind),r.VERTEXCOLOR&&c.push(i.VertexBuffer.ColorKind),i.MaterialHelper.PrepareAttributesForBones(c,e,r,l),i.MaterialHelper.PrepareAttributesForInstances(c,r);var u=r.toString(),_=["world","view","viewProjection","vEyePosition","vLightsType","vDiffuseColor","vFogInfos","vFogColor","pointSize","vDiffuseInfos","mBones","vClipPlane","vClipPlane2","vClipPlane3","vClipPlane4","vClipPlane5","vClipPlane6","diffuseMatrix","time","speed","movingSpeed","fogColor","fogDensity","lowFrequencySpeed"],h=["diffuseSampler","noiseTexture"],f=new Array;i.MaterialHelper.PrepareUniformsAndSamplersList({uniformsNames:_,uniformBuffersNames:f,samplers:h,defines:r,maxSimultaneousLights:this.maxSimultaneousLights}),t.setEffect(a.getEngine().createEffect("lava",{attributes:c,uniformsNames:_,uniformBuffersNames:f,samplers:h,defines:u,fallbacks:l,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousLights:this.maxSimultaneousLights}},s),r,this._materialContext)}return!(!t.effect||!t.effect.isReady())&&(r._renderId=a.getRenderId(),t.effect._wasPreviouslyReady=!0,!0)},t.prototype.bindForSubMesh=function(e,t,n){var r=this.getScene(),o=n._materialDefines;if(o){var a=n.effect;a&&(this._activeEffect=a,o.UNLIT=this._unlit,this.bindOnlyWorldMatrix(e),this._activeEffect.setMatrix("viewProjection",r.getTransformMatrix()),i.MaterialHelper.BindBonesParameters(t,this._activeEffect),this._mustRebind(r,a)&&(this.diffuseTexture&&i.MaterialFlags.DiffuseTextureEnabled&&(this._activeEffect.setTexture("diffuseSampler",this.diffuseTexture),this._activeEffect.setFloat2("vDiffuseInfos",this.diffuseTexture.coordinatesIndex,this.diffuseTexture.level),this._activeEffect.setMatrix("diffuseMatrix",this.diffuseTexture.getTextureMatrix())),this.noiseTexture&&this._activeEffect.setTexture("noiseTexture",this.noiseTexture),i.MaterialHelper.BindClipPlane(this._activeEffect,r),this.pointsCloud&&this._activeEffect.setFloat("pointSize",this.pointSize),r.bindEyePosition(a)),this._activeEffect.setColor4("vDiffuseColor",this._scaledDiffuse,this.alpha*t.visibility),r.lightsEnabled&&!this.disableLighting&&i.MaterialHelper.BindLights(r,t,this._activeEffect,o),r.fogEnabled&&t.applyFog&&r.fogMode!==i.Scene.FOGMODE_NONE&&this._activeEffect.setMatrix("view",r.getViewMatrix()),i.MaterialHelper.BindFogParameters(r,t,this._activeEffect),this._lastTime+=r.getEngine().getDeltaTime(),this._activeEffect.setFloat("time",this._lastTime*this.speed/1e3),this.fogColor||(this.fogColor=i.Color3.Black()),this._activeEffect.setColor3("fogColor",this.fogColor),this._activeEffect.setFloat("fogDensity",this.fogDensity),this._activeEffect.setFloat("lowFrequencySpeed",this.lowFrequencySpeed),this._activeEffect.setFloat("movingSpeed",this.movingSpeed),this._afterBind(t,this._activeEffect))}},t.prototype.getAnimatables=function(){var e=[];return this.diffuseTexture&&this.diffuseTexture.animations&&this.diffuseTexture.animations.length>0&&e.push(this.diffuseTexture),this.noiseTexture&&this.noiseTexture.animations&&this.noiseTexture.animations.length>0&&e.push(this.noiseTexture),e},t.prototype.getActiveTextures=function(){var t=e.prototype.getActiveTextures.call(this);return this._diffuseTexture&&t.push(this._diffuseTexture),t},t.prototype.hasTexture=function(t){return!!e.prototype.hasTexture.call(this,t)||this.diffuseTexture===t},t.prototype.dispose=function(t){this.diffuseTexture&&this.diffuseTexture.dispose(),this.noiseTexture&&this.noiseTexture.dispose(),e.prototype.dispose.call(this,t)},t.prototype.clone=function(e){var n=this;return i.SerializationHelper.Clone(function(){return new t(e,n.getScene())},this)},t.prototype.serialize=function(){var e=i.SerializationHelper.Serialize(this);return e.customType="BABYLON.LavaMaterial",e},t.prototype.getClassName=function(){return"LavaMaterial"},t.Parse=function(e,n,r){return i.SerializationHelper.Parse(function(){return new t(e.name,n)},e,n,r)},Object(r.__decorate)([Object(i.serializeAsTexture)("diffuseTexture")],t.prototype,"_diffuseTexture",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"diffuseTexture",void 0),Object(r.__decorate)([Object(i.serializeAsTexture)()],t.prototype,"noiseTexture",void 0),Object(r.__decorate)([Object(i.serializeAsColor3)()],t.prototype,"fogColor",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"speed",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"movingSpeed",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"lowFrequencySpeed",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"fogDensity",void 0),Object(r.__decorate)([Object(i.serializeAsColor3)()],t.prototype,"diffuseColor",void 0),Object(r.__decorate)([Object(i.serialize)("disableLighting")],t.prototype,"_disableLighting",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsLightsDirty")],t.prototype,"disableLighting",void 0),Object(r.__decorate)([Object(i.serialize)("unlit")],t.prototype,"_unlit",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsLightsDirty")],t.prototype,"unlit",void 0),Object(r.__decorate)([Object(i.serialize)("maxSimultaneousLights")],t.prototype,"_maxSimultaneousLights",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsLightsDirty")],t.prototype,"maxSimultaneousLights",void 0),t}(i.PushMaterial);Object(i.RegisterClass)("BABYLON.LavaMaterial",a)},"./legacy/legacy.ts":function(e,t,n){"use strict";n.r(t),function(e){var r=n("./index.ts");n.d(t,"CellMaterial",function(){return r.CellMaterial}),n.d(t,"CustomShaderStructure",function(){return r.CustomShaderStructure}),n.d(t,"ShaderSpecialParts",function(){return r.ShaderSpecialParts}),n.d(t,"CustomMaterial",function(){return r.CustomMaterial}),n.d(t,"ShaderAlebdoParts",function(){return r.ShaderAlebdoParts}),n.d(t,"PBRCustomMaterial",function(){return r.PBRCustomMaterial}),n.d(t,"FireMaterial",function(){return r.FireMaterial}),n.d(t,"FurMaterial",function(){return r.FurMaterial}),n.d(t,"GradientMaterial",function(){return r.GradientMaterial}),n.d(t,"GridMaterial",function(){return r.GridMaterial}),n.d(t,"LavaMaterial",function(){return r.LavaMaterial}),n.d(t,"MixMaterial",function(){return r.MixMaterial}),n.d(t,"NormalMaterial",function(){return r.NormalMaterial}),n.d(t,"ShadowOnlyMaterial",function(){return r.ShadowOnlyMaterial}),n.d(t,"SimpleMaterial",function(){return r.SimpleMaterial}),n.d(t,"SkyMaterial",function(){return r.SkyMaterial}),n.d(t,"TerrainMaterial",function(){return r.TerrainMaterial}),n.d(t,"TriPlanarMaterial",function(){return r.TriPlanarMaterial}),n.d(t,"WaterMaterial",function(){return r.WaterMaterial});var i=void 0!==e?e:"undefined"!=typeof window?window:void 0;if(void 0!==i)for(var o in i.BABYLON=i.BABYLON||{},r)i.BABYLON[o]=r[o]}.call(this,n("../../node_modules/webpack/buildin/global.js"))},"./mix/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./mix/mixMaterial.ts");n.d(t,"MixMaterial",function(){return r.MixMaterial})},"./mix/mix.fragment.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"mixPixelShader",function(){return a});var r=n("babylonjs/Misc/decorators"),i="mixPixelShader",o="precision highp float;\n\nuniform vec4 vEyePosition;\nuniform vec4 vDiffuseColor;\n#ifdef SPECULARTERM\nuniform vec4 vSpecularColor;\n#endif\n\nvarying vec3 vPositionW;\n#ifdef NORMAL\nvarying vec3 vNormalW;\n#endif\n#ifdef VERTEXCOLOR\nvarying vec4 vColor;\n#endif\n\n#include<helperFunctions>\n\n#include<__decl__lightFragment>[0..maxSimultaneousLights]\n\n#ifdef DIFFUSE\nvarying vec2 vTextureUV;\nuniform sampler2D mixMap1Sampler;\nuniform vec2 vTextureInfos;\n#ifdef MIXMAP2\nuniform sampler2D mixMap2Sampler;\n#endif\nuniform sampler2D diffuse1Sampler;\nuniform sampler2D diffuse2Sampler;\nuniform sampler2D diffuse3Sampler;\nuniform sampler2D diffuse4Sampler;\nuniform vec2 diffuse1Infos;\nuniform vec2 diffuse2Infos;\nuniform vec2 diffuse3Infos;\nuniform vec2 diffuse4Infos;\n#ifdef MIXMAP2\nuniform sampler2D diffuse5Sampler;\nuniform sampler2D diffuse6Sampler;\nuniform sampler2D diffuse7Sampler;\nuniform sampler2D diffuse8Sampler;\nuniform vec2 diffuse5Infos;\nuniform vec2 diffuse6Infos;\nuniform vec2 diffuse7Infos;\nuniform vec2 diffuse8Infos;\n#endif\n#endif\n\n#include<lightsFragmentFunctions>\n#include<shadowsFragmentFunctions>\n#include<clipPlaneFragmentDeclaration>\n\n#include<fogFragmentDeclaration>\nvoid main(void) {\n\n#include<clipPlaneFragment>\nvec3 viewDirectionW=normalize(vEyePosition.xyz-vPositionW);\n\nvec4 finalMixColor=vec4(1.,1.,1.,1.);\nvec3 diffuseColor=vDiffuseColor.rgb;\n#ifdef MIXMAP2\nvec4 mixColor2=vec4(1.,1.,1.,1.);\n#endif\n#ifdef SPECULARTERM\nfloat glossiness=vSpecularColor.a;\nvec3 specularColor=vSpecularColor.rgb;\n#else\nfloat glossiness=0.;\n#endif\n\nfloat alpha=vDiffuseColor.a;\n\n#ifdef NORMAL\nvec3 normalW=normalize(vNormalW);\n#else\nvec3 normalW=vec3(1.0,1.0,1.0);\n#endif\n#ifdef DIFFUSE\nvec4 mixColor=texture2D(mixMap1Sampler,vTextureUV);\n#include<depthPrePass>\nmixColor.rgb*=vTextureInfos.y;\nvec4 diffuse1Color=texture2D(diffuse1Sampler,vTextureUV*diffuse1Infos);\nvec4 diffuse2Color=texture2D(diffuse2Sampler,vTextureUV*diffuse2Infos);\nvec4 diffuse3Color=texture2D(diffuse3Sampler,vTextureUV*diffuse3Infos);\nvec4 diffuse4Color=texture2D(diffuse4Sampler,vTextureUV*diffuse4Infos);\ndiffuse1Color.rgb*=mixColor.r;\ndiffuse2Color.rgb=mix(diffuse1Color.rgb,diffuse2Color.rgb,mixColor.g);\ndiffuse3Color.rgb=mix(diffuse2Color.rgb,diffuse3Color.rgb,mixColor.b);\nfinalMixColor.rgb=mix(diffuse3Color.rgb,diffuse4Color.rgb,1.0-mixColor.a);\n#ifdef MIXMAP2\nmixColor=texture2D(mixMap2Sampler,vTextureUV);\nmixColor.rgb*=vTextureInfos.y;\nvec4 diffuse5Color=texture2D(diffuse5Sampler,vTextureUV*diffuse5Infos);\nvec4 diffuse6Color=texture2D(diffuse6Sampler,vTextureUV*diffuse6Infos);\nvec4 diffuse7Color=texture2D(diffuse7Sampler,vTextureUV*diffuse7Infos);\nvec4 diffuse8Color=texture2D(diffuse8Sampler,vTextureUV*diffuse8Infos);\ndiffuse5Color.rgb=mix(finalMixColor.rgb,diffuse5Color.rgb,mixColor.r);\ndiffuse6Color.rgb=mix(diffuse5Color.rgb,diffuse6Color.rgb,mixColor.g);\ndiffuse7Color.rgb=mix(diffuse6Color.rgb,diffuse7Color.rgb,mixColor.b);\nfinalMixColor.rgb=mix(diffuse7Color.rgb,diffuse8Color.rgb,1.0-mixColor.a);\n#endif\n#endif\n#ifdef VERTEXCOLOR\nfinalMixColor.rgb*=vColor.rgb;\n#endif\n\nvec3 diffuseBase=vec3(0.,0.,0.);\nlightingInfo info;\nfloat shadow=1.;\n#ifdef SPECULARTERM\nvec3 specularBase=vec3(0.,0.,0.);\n#endif\n#include<lightFragment>[0..maxSimultaneousLights]\n#ifdef VERTEXALPHA\nalpha*=vColor.a;\n#endif\n#ifdef SPECULARTERM\nvec3 finalSpecular=specularBase*specularColor;\n#else\nvec3 finalSpecular=vec3(0.0);\n#endif\nvec3 finalDiffuse=clamp(diffuseBase*diffuseColor*finalMixColor.rgb,0.0,1.0);\n\nvec4 color=vec4(finalDiffuse+finalSpecular,alpha);\n#include<fogFragment>\ngl_FragColor=color;\n#include<imageProcessingCompatibility>\n}\n";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./mix/mix.vertex.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"mixVertexShader",function(){return a});var r=n("babylonjs/Misc/decorators"),i="mixVertexShader",o="precision highp float;\n\nattribute vec3 position;\n#ifdef NORMAL\nattribute vec3 normal;\n#endif\n#ifdef UV1\nattribute vec2 uv;\n#endif\n#ifdef UV2\nattribute vec2 uv2;\n#endif\n#ifdef VERTEXCOLOR\nattribute vec4 color;\n#endif\n#include<bonesDeclaration>\n\n#include<instancesDeclaration>\nuniform mat4 view;\nuniform mat4 viewProjection;\n#ifdef DIFFUSE\nvarying vec2 vTextureUV;\nuniform mat4 textureMatrix;\nuniform vec2 vTextureInfos;\n#endif\n#ifdef POINTSIZE\nuniform float pointSize;\n#endif\n\nvarying vec3 vPositionW;\n#ifdef NORMAL\nvarying vec3 vNormalW;\n#endif\n#ifdef VERTEXCOLOR\nvarying vec4 vColor;\n#endif\n#include<clipPlaneVertexDeclaration>\n#include<fogVertexDeclaration>\n#include<__decl__lightFragment>[0..maxSimultaneousLights]\nvoid main(void) {\n#include<instancesVertex>\n#include<bonesVertex>\nvec4 worldPos=finalWorld*vec4(position,1.0);\ngl_Position=viewProjection*worldPos;\nvPositionW=vec3(worldPos);\n#ifdef NORMAL\nvNormalW=normalize(vec3(finalWorld*vec4(normal,0.0)));\n#endif\n\n#ifndef UV1\nvec2 uv=vec2(0.,0.);\n#endif\n#ifndef UV2\nvec2 uv2=vec2(0.,0.);\n#endif\n#ifdef DIFFUSE\nif (vTextureInfos.x == 0.)\n{\nvTextureUV=vec2(textureMatrix*vec4(uv,1.0,0.0));\n}\nelse\n{\nvTextureUV=vec2(textureMatrix*vec4(uv2,1.0,0.0));\n}\n#endif\n\n#include<clipPlaneVertex>\n\n#include<fogVertex>\n\n#include<shadowsVertex>[0..maxSimultaneousLights]\n\n#ifdef VERTEXCOLOR\nvColor=color;\n#endif\n\n#ifdef POINTSIZE\ngl_PointSize=pointSize;\n#endif\n}\n";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./mix/mixMaterial.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"MixMaterial",function(){return a});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/decorators"),o=(n("./mix/mix.fragment.ts"),n("./mix/mix.vertex.ts"),function(e){function t(){var t=e.call(this)||this;return t.DIFFUSE=!1,t.CLIPPLANE=!1,t.CLIPPLANE2=!1,t.CLIPPLANE3=!1,t.CLIPPLANE4=!1,t.CLIPPLANE5=!1,t.CLIPPLANE6=!1,t.ALPHATEST=!1,t.DEPTHPREPASS=!1,t.POINTSIZE=!1,t.FOG=!1,t.SPECULARTERM=!1,t.NORMAL=!1,t.UV1=!1,t.UV2=!1,t.VERTEXCOLOR=!1,t.VERTEXALPHA=!1,t.NUM_BONE_INFLUENCERS=0,t.BonesPerMesh=0,t.INSTANCES=!1,t.MIXMAP2=!1,t.IMAGEPROCESSINGPOSTPROCESS=!1,t.rebuild(),t}return Object(r.__extends)(t,e),t}(i.MaterialDefines)),a=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.diffuseColor=new i.Color3(1,1,1),r.specularColor=new i.Color3(0,0,0),r.specularPower=64,r._disableLighting=!1,r._maxSimultaneousLights=4,r}return Object(r.__extends)(t,e),t.prototype.needAlphaBlending=function(){return this.alpha<1},t.prototype.needAlphaTesting=function(){return!1},t.prototype.getAlphaTestTexture=function(){return null},t.prototype.isReadyForSubMesh=function(e,t,n){if(this.isFrozen&&t.effect&&t.effect._wasPreviouslyReady)return!0;t._materialDefines||(t.materialDefines=new o);var r=t._materialDefines,a=this.getScene();if(this._isReadyForSubMesh(t))return!0;var s=a.getEngine();if(a.texturesEnabled){if(!this._mixTexture1||!this._mixTexture1.isReady())return!1;if(r._needUVs=!0,i.MaterialFlags.DiffuseTextureEnabled){if(!this._diffuseTexture1||!this._diffuseTexture1.isReady())return!1;if(r.DIFFUSE=!0,!this._diffuseTexture2||!this._diffuseTexture2.isReady())return!1;if(!this._diffuseTexture3||!this._diffuseTexture3.isReady())return!1;if(!this._diffuseTexture4||!this._diffuseTexture4.isReady())return!1;if(this._mixTexture2){if(!this._mixTexture2.isReady())return!1;if(r.MIXMAP2=!0,!this._diffuseTexture5||!this._diffuseTexture5.isReady())return!1;if(!this._diffuseTexture6||!this._diffuseTexture6.isReady())return!1;if(!this._diffuseTexture7||!this._diffuseTexture7.isReady())return!1;if(!this._diffuseTexture8||!this._diffuseTexture8.isReady())return!1}}}if(i.MaterialHelper.PrepareDefinesForMisc(e,a,!1,this.pointsCloud,this.fogEnabled,this._shouldTurnAlphaTestOn(e),r),r._needNormals=i.MaterialHelper.PrepareDefinesForLights(a,e,r,!1,this._maxSimultaneousLights,this._disableLighting),i.MaterialHelper.PrepareDefinesForFrameBoundValues(a,s,r,!!n),i.MaterialHelper.PrepareDefinesForAttributes(e,r,!0,!0),r.isDirty){r.markAsProcessed(),a.resetCachedMaterial();var l=new i.EffectFallbacks;r.FOG&&l.addFallback(1,"FOG"),i.MaterialHelper.HandleFallbacksForShadows(r,l,this.maxSimultaneousLights),r.NUM_BONE_INFLUENCERS>0&&l.addCPUSkinningFallback(0,e),r.IMAGEPROCESSINGPOSTPROCESS=a.imageProcessingConfiguration.applyByPostProcess;var c=[i.VertexBuffer.PositionKind];r.NORMAL&&c.push(i.VertexBuffer.NormalKind),r.UV1&&c.push(i.VertexBuffer.UVKind),r.UV2&&c.push(i.VertexBuffer.UV2Kind),r.VERTEXCOLOR&&c.push(i.VertexBuffer.ColorKind),i.MaterialHelper.PrepareAttributesForBones(c,e,r,l),i.MaterialHelper.PrepareAttributesForInstances(c,r);var u=r.toString(),_=["world","view","viewProjection","vEyePosition","vLightsType","vDiffuseColor","vSpecularColor","vFogInfos","vFogColor","pointSize","vTextureInfos","mBones","vClipPlane","vClipPlane2","vClipPlane3","vClipPlane4","vClipPlane5","vClipPlane6","textureMatrix","diffuse1Infos","diffuse2Infos","diffuse3Infos","diffuse4Infos","diffuse5Infos","diffuse6Infos","diffuse7Infos","diffuse8Infos"],h=["mixMap1Sampler","mixMap2Sampler","diffuse1Sampler","diffuse2Sampler","diffuse3Sampler","diffuse4Sampler","diffuse5Sampler","diffuse6Sampler","diffuse7Sampler","diffuse8Sampler"],f=new Array;i.MaterialHelper.PrepareUniformsAndSamplersList({uniformsNames:_,uniformBuffersNames:f,samplers:h,defines:r,maxSimultaneousLights:this.maxSimultaneousLights}),t.setEffect(a.getEngine().createEffect("mix",{attributes:c,uniformsNames:_,uniformBuffersNames:f,samplers:h,defines:u,fallbacks:l,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousLights:this.maxSimultaneousLights}},s),r,this._materialContext)}return!(!t.effect||!t.effect.isReady())&&(r._renderId=a.getRenderId(),t.effect._wasPreviouslyReady=!0,!0)},t.prototype.bindForSubMesh=function(e,t,n){var r=this.getScene(),o=n._materialDefines;if(o){var a=n.effect;a&&(this._activeEffect=a,this.bindOnlyWorldMatrix(e),this._activeEffect.setMatrix("viewProjection",r.getTransformMatrix()),i.MaterialHelper.BindBonesParameters(t,this._activeEffect),this._mustRebind(r,a)&&(this._mixTexture1&&(this._activeEffect.setTexture("mixMap1Sampler",this._mixTexture1),this._activeEffect.setFloat2("vTextureInfos",this._mixTexture1.coordinatesIndex,this._mixTexture1.level),this._activeEffect.setMatrix("textureMatrix",this._mixTexture1.getTextureMatrix()),i.MaterialFlags.DiffuseTextureEnabled&&(this._diffuseTexture1&&(this._activeEffect.setTexture("diffuse1Sampler",this._diffuseTexture1),this._activeEffect.setFloat2("diffuse1Infos",this._diffuseTexture1.uScale,this._diffuseTexture1.vScale)),this._diffuseTexture2&&(this._activeEffect.setTexture("diffuse2Sampler",this._diffuseTexture2),this._activeEffect.setFloat2("diffuse2Infos",this._diffuseTexture2.uScale,this._diffuseTexture2.vScale)),this._diffuseTexture3&&(this._activeEffect.setTexture("diffuse3Sampler",this._diffuseTexture3),this._activeEffect.setFloat2("diffuse3Infos",this._diffuseTexture3.uScale,this._diffuseTexture3.vScale)),this._diffuseTexture4&&(this._activeEffect.setTexture("diffuse4Sampler",this._diffuseTexture4),this._activeEffect.setFloat2("diffuse4Infos",this._diffuseTexture4.uScale,this._diffuseTexture4.vScale)))),this._mixTexture2&&(this._activeEffect.setTexture("mixMap2Sampler",this._mixTexture2),i.MaterialFlags.DiffuseTextureEnabled&&(this._diffuseTexture5&&(this._activeEffect.setTexture("diffuse5Sampler",this._diffuseTexture5),this._activeEffect.setFloat2("diffuse5Infos",this._diffuseTexture5.uScale,this._diffuseTexture5.vScale)),this._diffuseTexture6&&(this._activeEffect.setTexture("diffuse6Sampler",this._diffuseTexture6),this._activeEffect.setFloat2("diffuse6Infos",this._diffuseTexture6.uScale,this._diffuseTexture6.vScale)),this._diffuseTexture7&&(this._activeEffect.setTexture("diffuse7Sampler",this._diffuseTexture7),this._activeEffect.setFloat2("diffuse7Infos",this._diffuseTexture7.uScale,this._diffuseTexture7.vScale)),this._diffuseTexture8&&(this._activeEffect.setTexture("diffuse8Sampler",this._diffuseTexture8),this._activeEffect.setFloat2("diffuse8Infos",this._diffuseTexture8.uScale,this._diffuseTexture8.vScale)))),i.MaterialHelper.BindClipPlane(this._activeEffect,r),this.pointsCloud&&this._activeEffect.setFloat("pointSize",this.pointSize),r.bindEyePosition(a)),this._activeEffect.setColor4("vDiffuseColor",this.diffuseColor,this.alpha*t.visibility),o.SPECULARTERM&&this._activeEffect.setColor4("vSpecularColor",this.specularColor,this.specularPower),r.lightsEnabled&&!this.disableLighting&&i.MaterialHelper.BindLights(r,t,this._activeEffect,o,this.maxSimultaneousLights),r.fogEnabled&&t.applyFog&&r.fogMode!==i.Scene.FOGMODE_NONE&&this._activeEffect.setMatrix("view",r.getViewMatrix()),i.MaterialHelper.BindFogParameters(r,t,this._activeEffect),this._afterBind(t,this._activeEffect))}},t.prototype.getAnimatables=function(){var e=[];return this._mixTexture1&&this._mixTexture1.animations&&this._mixTexture1.animations.length>0&&e.push(this._mixTexture1),this._mixTexture2&&this._mixTexture2.animations&&this._mixTexture2.animations.length>0&&e.push(this._mixTexture2),e},t.prototype.getActiveTextures=function(){var t=e.prototype.getActiveTextures.call(this);return this._mixTexture1&&t.push(this._mixTexture1),this._diffuseTexture1&&t.push(this._diffuseTexture1),this._diffuseTexture2&&t.push(this._diffuseTexture2),this._diffuseTexture3&&t.push(this._diffuseTexture3),this._diffuseTexture4&&t.push(this._diffuseTexture4),this._mixTexture2&&t.push(this._mixTexture2),this._diffuseTexture5&&t.push(this._diffuseTexture5),this._diffuseTexture6&&t.push(this._diffuseTexture6),this._diffuseTexture7&&t.push(this._diffuseTexture7),this._diffuseTexture8&&t.push(this._diffuseTexture8),t},t.prototype.hasTexture=function(t){return!!e.prototype.hasTexture.call(this,t)||(this._mixTexture1===t||(this._diffuseTexture1===t||(this._diffuseTexture2===t||(this._diffuseTexture3===t||(this._diffuseTexture4===t||(this._mixTexture2===t||(this._diffuseTexture5===t||(this._diffuseTexture6===t||(this._diffuseTexture7===t||this._diffuseTexture8===t)))))))))},t.prototype.dispose=function(t){this._mixTexture1&&this._mixTexture1.dispose(),e.prototype.dispose.call(this,t)},t.prototype.clone=function(e){var n=this;return i.SerializationHelper.Clone(function(){return new t(e,n.getScene())},this)},t.prototype.serialize=function(){var e=i.SerializationHelper.Serialize(this);return e.customType="BABYLON.MixMaterial",e},t.prototype.getClassName=function(){return"MixMaterial"},t.Parse=function(e,n,r){return i.SerializationHelper.Parse(function(){return new t(e.name,n)},e,n,r)},Object(r.__decorate)([Object(i.serializeAsTexture)("mixTexture1")],t.prototype,"_mixTexture1",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"mixTexture1",void 0),Object(r.__decorate)([Object(i.serializeAsTexture)("mixTexture2")],t.prototype,"_mixTexture2",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"mixTexture2",void 0),Object(r.__decorate)([Object(i.serializeAsTexture)("diffuseTexture1")],t.prototype,"_diffuseTexture1",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"diffuseTexture1",void 0),Object(r.__decorate)([Object(i.serializeAsTexture)("diffuseTexture2")],t.prototype,"_diffuseTexture2",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"diffuseTexture2",void 0),Object(r.__decorate)([Object(i.serializeAsTexture)("diffuseTexture3")],t.prototype,"_diffuseTexture3",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"diffuseTexture3",void 0),Object(r.__decorate)([Object(i.serializeAsTexture)("diffuseTexture4")],t.prototype,"_diffuseTexture4",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"diffuseTexture4",void 0),Object(r.__decorate)([Object(i.serializeAsTexture)("diffuseTexture1")],t.prototype,"_diffuseTexture5",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"diffuseTexture5",void 0),Object(r.__decorate)([Object(i.serializeAsTexture)("diffuseTexture2")],t.prototype,"_diffuseTexture6",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"diffuseTexture6",void 0),Object(r.__decorate)([Object(i.serializeAsTexture)("diffuseTexture3")],t.prototype,"_diffuseTexture7",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"diffuseTexture7",void 0),Object(r.__decorate)([Object(i.serializeAsTexture)("diffuseTexture4")],t.prototype,"_diffuseTexture8",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"diffuseTexture8",void 0),Object(r.__decorate)([Object(i.serializeAsColor3)()],t.prototype,"diffuseColor",void 0),Object(r.__decorate)([Object(i.serializeAsColor3)()],t.prototype,"specularColor",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"specularPower",void 0),Object(r.__decorate)([Object(i.serialize)("disableLighting")],t.prototype,"_disableLighting",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsLightsDirty")],t.prototype,"disableLighting",void 0),Object(r.__decorate)([Object(i.serialize)("maxSimultaneousLights")],t.prototype,"_maxSimultaneousLights",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsLightsDirty")],t.prototype,"maxSimultaneousLights",void 0),t}(i.PushMaterial);Object(i.RegisterClass)("BABYLON.MixMaterial",a)},"./normal/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./normal/normalMaterial.ts");n.d(t,"NormalMaterial",function(){return r.NormalMaterial})},"./normal/normal.fragment.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"normalPixelShader",function(){return a});var r=n("babylonjs/Misc/decorators"),i="normalPixelShader",o="precision highp float;\n\nuniform vec4 vEyePosition;\nuniform vec4 vDiffuseColor;\n\nvarying vec3 vPositionW;\n#ifdef NORMAL\nvarying vec3 vNormalW;\n#endif\n#ifdef LIGHTING\n\n#include<helperFunctions>\n\n#include<__decl__lightFragment>[0]\n#include<__decl__lightFragment>[1]\n#include<__decl__lightFragment>[2]\n#include<__decl__lightFragment>[3]\n#include<lightsFragmentFunctions>\n#include<shadowsFragmentFunctions>\n#endif\n\n#ifdef DIFFUSE\nvarying vec2 vDiffuseUV;\nuniform sampler2D diffuseSampler;\nuniform vec2 vDiffuseInfos;\n#endif\n#include<clipPlaneFragmentDeclaration>\n\n#include<fogFragmentDeclaration>\nvoid main(void) {\n#include<clipPlaneFragment>\nvec3 viewDirectionW=normalize(vEyePosition.xyz-vPositionW);\n\nvec4 baseColor=vec4(1.,1.,1.,1.);\nvec3 diffuseColor=vDiffuseColor.rgb;\n\nfloat alpha=vDiffuseColor.a;\n#ifdef DIFFUSE\nbaseColor=texture2D(diffuseSampler,vDiffuseUV);\n#ifdef ALPHATEST\nif (baseColor.a<0.4)\ndiscard;\n#endif\n#include<depthPrePass>\nbaseColor.rgb*=vDiffuseInfos.y;\n#endif\n#ifdef NORMAL\nbaseColor=mix(baseColor,vec4(vNormalW,1.0),0.5);\n#endif\n\n#ifdef NORMAL\nvec3 normalW=normalize(vNormalW);\n#else\nvec3 normalW=vec3(1.0,1.0,1.0);\n#endif\n\n#ifdef LIGHTING\nvec3 diffuseBase=vec3(0.,0.,0.);\nlightingInfo info;\nfloat shadow=1.;\nfloat glossiness=0.;\n#include<lightFragment>[0]\n#include<lightFragment>[1]\n#include<lightFragment>[2]\n#include<lightFragment>[3]\nvec3 finalDiffuse=clamp(diffuseBase*diffuseColor,0.0,1.0)*baseColor.rgb;\n#else\nvec3 finalDiffuse=baseColor.rgb;\n#endif\n\nvec4 color=vec4(finalDiffuse,alpha);\n#include<fogFragment>\ngl_FragColor=color;\n#include<imageProcessingCompatibility>\n}";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./normal/normal.vertex.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"normalVertexShader",function(){return a});var r=n("babylonjs/Misc/decorators"),i="normalVertexShader",o="precision highp float;\n\nattribute vec3 position;\n#ifdef NORMAL\nattribute vec3 normal;\n#endif\n#ifdef UV1\nattribute vec2 uv;\n#endif\n#ifdef UV2\nattribute vec2 uv2;\n#endif\n#ifdef VERTEXCOLOR\nattribute vec4 color;\n#endif\n#include<bonesDeclaration>\n\n#include<instancesDeclaration>\nuniform mat4 view;\nuniform mat4 viewProjection;\n#ifdef DIFFUSE\nvarying vec2 vDiffuseUV;\nuniform mat4 diffuseMatrix;\nuniform vec2 vDiffuseInfos;\n#endif\n#ifdef POINTSIZE\nuniform float pointSize;\n#endif\n\nvarying vec3 vPositionW;\n#ifdef NORMAL\nvarying vec3 vNormalW;\n#endif\n#include<clipPlaneVertexDeclaration>\n#include<fogVertexDeclaration>\n#include<__decl__lightFragment>[0..maxSimultaneousLights]\nvoid main(void) {\n#include<instancesVertex>\n#include<bonesVertex>\nvec4 worldPos=finalWorld*vec4(position,1.0);\ngl_Position=viewProjection*worldPos;\nvPositionW=vec3(worldPos);\n#ifdef NORMAL\nvNormalW=normalize(vec3(finalWorld*vec4(normal,0.0)));\n#endif\n\n#ifndef UV1\nvec2 uv=vec2(0.,0.);\n#endif\n#ifndef UV2\nvec2 uv2=vec2(0.,0.);\n#endif\n#ifdef DIFFUSE\nif (vDiffuseInfos.x == 0.)\n{\nvDiffuseUV=vec2(diffuseMatrix*vec4(uv,1.0,0.0));\n}\nelse\n{\nvDiffuseUV=vec2(diffuseMatrix*vec4(uv2,1.0,0.0));\n}\n#endif\n\n#include<clipPlaneVertex>\n\n#include<fogVertex>\n#include<shadowsVertex>[0..maxSimultaneousLights]\n\n#ifdef POINTSIZE\ngl_PointSize=pointSize;\n#endif\n}\n";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./normal/normalMaterial.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"NormalMaterial",function(){return a});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/decorators"),o=(n("./normal/normal.fragment.ts"),n("./normal/normal.vertex.ts"),function(e){function t(){var t=e.call(this)||this;return t.DIFFUSE=!1,t.CLIPPLANE=!1,t.CLIPPLANE2=!1,t.CLIPPLANE3=!1,t.CLIPPLANE4=!1,t.CLIPPLANE5=!1,t.CLIPPLANE6=!1,t.ALPHATEST=!1,t.DEPTHPREPASS=!1,t.POINTSIZE=!1,t.FOG=!1,t.LIGHT0=!1,t.LIGHT1=!1,t.LIGHT2=!1,t.LIGHT3=!1,t.SPOTLIGHT0=!1,t.SPOTLIGHT1=!1,t.SPOTLIGHT2=!1,t.SPOTLIGHT3=!1,t.HEMILIGHT0=!1,t.HEMILIGHT1=!1,t.HEMILIGHT2=!1,t.HEMILIGHT3=!1,t.DIRLIGHT0=!1,t.DIRLIGHT1=!1,t.DIRLIGHT2=!1,t.DIRLIGHT3=!1,t.POINTLIGHT0=!1,t.POINTLIGHT1=!1,t.POINTLIGHT2=!1,t.POINTLIGHT3=!1,t.SHADOW0=!1,t.SHADOW1=!1,t.SHADOW2=!1,t.SHADOW3=!1,t.SHADOWS=!1,t.SHADOWESM0=!1,t.SHADOWESM1=!1,t.SHADOWESM2=!1,t.SHADOWESM3=!1,t.SHADOWPOISSON0=!1,t.SHADOWPOISSON1=!1,t.SHADOWPOISSON2=!1,t.SHADOWPOISSON3=!1,t.SHADOWPCF0=!1,t.SHADOWPCF1=!1,t.SHADOWPCF2=!1,t.SHADOWPCF3=!1,t.SHADOWPCSS0=!1,t.SHADOWPCSS1=!1,t.SHADOWPCSS2=!1,t.SHADOWPCSS3=!1,t.NORMAL=!1,t.UV1=!1,t.UV2=!1,t.NUM_BONE_INFLUENCERS=0,t.BonesPerMesh=0,t.INSTANCES=!1,t.LIGHTING=!1,t.IMAGEPROCESSINGPOSTPROCESS=!1,t.rebuild(),t}return Object(r.__extends)(t,e),t}(i.MaterialDefines)),a=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.diffuseColor=new i.Color3(1,1,1),r._disableLighting=!1,r._maxSimultaneousLights=4,r}return Object(r.__extends)(t,e),t.prototype.needAlphaBlending=function(){return this.alpha<1},t.prototype.needAlphaBlendingForMesh=function(e){return this.needAlphaBlending()||e.visibility<1},t.prototype.needAlphaTesting=function(){return!1},t.prototype.getAlphaTestTexture=function(){return null},t.prototype.isReadyForSubMesh=function(e,t,n){if(this.isFrozen&&t.effect&&t.effect._wasPreviouslyReady)return!0;t._materialDefines||(t.materialDefines=new o);var r=t.materialDefines,a=this.getScene();if(this._isReadyForSubMesh(t))return!0;var s=a.getEngine();if(r._areTexturesDirty&&(r._needUVs=!1,a.texturesEnabled&&this._diffuseTexture&&i.MaterialFlags.DiffuseTextureEnabled)){if(!this._diffuseTexture.isReady())return!1;r._needUVs=!0,r.DIFFUSE=!0}if(i.MaterialHelper.PrepareDefinesForMisc(e,a,!1,this.pointsCloud,this.fogEnabled,this._shouldTurnAlphaTestOn(e),r),r._needNormals=!0,i.MaterialHelper.PrepareDefinesForLights(a,e,r,!1,this._maxSimultaneousLights,this._disableLighting),i.MaterialHelper.PrepareDefinesForFrameBoundValues(a,s,r,!!n),r.LIGHTING=!this._disableLighting,i.MaterialHelper.PrepareDefinesForAttributes(e,r,!0,!0),r.isDirty){r.markAsProcessed(),a.resetCachedMaterial();var l=new i.EffectFallbacks;r.FOG&&l.addFallback(1,"FOG"),i.MaterialHelper.HandleFallbacksForShadows(r,l),r.NUM_BONE_INFLUENCERS>0&&l.addCPUSkinningFallback(0,e),r.IMAGEPROCESSINGPOSTPROCESS=a.imageProcessingConfiguration.applyByPostProcess;var c=[i.VertexBuffer.PositionKind];r.NORMAL&&c.push(i.VertexBuffer.NormalKind),r.UV1&&c.push(i.VertexBuffer.UVKind),r.UV2&&c.push(i.VertexBuffer.UV2Kind),i.MaterialHelper.PrepareAttributesForBones(c,e,r,l),i.MaterialHelper.PrepareAttributesForInstances(c,r);var u=r.toString(),_=["world","view","viewProjection","vEyePosition","vLightsType","vDiffuseColor","vFogInfos","vFogColor","pointSize","vDiffuseInfos","mBones","vClipPlane","vClipPlane2","vClipPlane3","vClipPlane4","vClipPlane5","vClipPlane6","diffuseMatrix"],h=["diffuseSampler"],f=new Array;i.MaterialHelper.PrepareUniformsAndSamplersList({uniformsNames:_,uniformBuffersNames:f,samplers:h,defines:r,maxSimultaneousLights:4}),t.setEffect(a.getEngine().createEffect("normal",{attributes:c,uniformsNames:_,uniformBuffersNames:f,samplers:h,defines:u,fallbacks:l,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousLights:4}},s),r,this._materialContext)}return!(!t.effect||!t.effect.isReady())&&(r._renderId=a.getRenderId(),t.effect._wasPreviouslyReady=!0,!0)},t.prototype.bindForSubMesh=function(e,t,n){var r=this.getScene(),o=n._materialDefines;if(o){var a=n.effect;a&&(this._activeEffect=a,this.bindOnlyWorldMatrix(e),this._activeEffect.setMatrix("viewProjection",r.getTransformMatrix()),i.MaterialHelper.BindBonesParameters(t,this._activeEffect),this._mustRebind(r,a)&&(this.diffuseTexture&&i.MaterialFlags.DiffuseTextureEnabled&&(this._activeEffect.setTexture("diffuseSampler",this.diffuseTexture),this._activeEffect.setFloat2("vDiffuseInfos",this.diffuseTexture.coordinatesIndex,this.diffuseTexture.level),this._activeEffect.setMatrix("diffuseMatrix",this.diffuseTexture.getTextureMatrix())),i.MaterialHelper.BindClipPlane(this._activeEffect,r),this.pointsCloud&&this._activeEffect.setFloat("pointSize",this.pointSize),r.bindEyePosition(a)),this._activeEffect.setColor4("vDiffuseColor",this.diffuseColor,this.alpha*t.visibility),r.lightsEnabled&&!this.disableLighting&&i.MaterialHelper.BindLights(r,t,this._activeEffect,o),r.fogEnabled&&t.applyFog&&r.fogMode!==i.Scene.FOGMODE_NONE&&this._activeEffect.setMatrix("view",r.getViewMatrix()),i.MaterialHelper.BindFogParameters(r,t,this._activeEffect),this._afterBind(t,this._activeEffect))}},t.prototype.getAnimatables=function(){var e=[];return this.diffuseTexture&&this.diffuseTexture.animations&&this.diffuseTexture.animations.length>0&&e.push(this.diffuseTexture),e},t.prototype.getActiveTextures=function(){var t=e.prototype.getActiveTextures.call(this);return this._diffuseTexture&&t.push(this._diffuseTexture),t},t.prototype.hasTexture=function(t){return!!e.prototype.hasTexture.call(this,t)||this.diffuseTexture===t},t.prototype.dispose=function(t){this.diffuseTexture&&this.diffuseTexture.dispose(),e.prototype.dispose.call(this,t)},t.prototype.clone=function(e){var n=this;return i.SerializationHelper.Clone(function(){return new t(e,n.getScene())},this)},t.prototype.serialize=function(){var e=i.SerializationHelper.Serialize(this);return e.customType="BABYLON.NormalMaterial",e},t.prototype.getClassName=function(){return"NormalMaterial"},t.Parse=function(e,n,r){return i.SerializationHelper.Parse(function(){return new t(e.name,n)},e,n,r)},Object(r.__decorate)([Object(i.serializeAsTexture)("diffuseTexture")],t.prototype,"_diffuseTexture",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"diffuseTexture",void 0),Object(r.__decorate)([Object(i.serializeAsColor3)()],t.prototype,"diffuseColor",void 0),Object(r.__decorate)([Object(i.serialize)("disableLighting")],t.prototype,"_disableLighting",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsLightsDirty")],t.prototype,"disableLighting",void 0),Object(r.__decorate)([Object(i.serialize)("maxSimultaneousLights")],t.prototype,"_maxSimultaneousLights",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsLightsDirty")],t.prototype,"maxSimultaneousLights",void 0),t}(i.PushMaterial);Object(i.RegisterClass)("BABYLON.NormalMaterial",a)},"./shadowOnly/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./shadowOnly/shadowOnlyMaterial.ts");n.d(t,"ShadowOnlyMaterial",function(){return r.ShadowOnlyMaterial})},"./shadowOnly/shadowOnly.fragment.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"shadowOnlyPixelShader",function(){return a});var r=n("babylonjs/Misc/decorators"),i="shadowOnlyPixelShader",o="precision highp float;\n\nuniform vec4 vEyePosition;\nuniform float alpha;\nuniform vec3 shadowColor;\n\nvarying vec3 vPositionW;\n#ifdef NORMAL\nvarying vec3 vNormalW;\n#endif\n\n#include<helperFunctions>\n\n#include<__decl__lightFragment>[0..maxSimultaneousLights]\n#include<lightsFragmentFunctions>\n#include<shadowsFragmentFunctions>\n#include<clipPlaneFragmentDeclaration>\n\n#include<fogFragmentDeclaration>\nvoid main(void) {\n#include<clipPlaneFragment>\nvec3 viewDirectionW=normalize(vEyePosition.xyz-vPositionW);\n\n#ifdef NORMAL\nvec3 normalW=normalize(vNormalW);\n#else\nvec3 normalW=vec3(1.0,1.0,1.0);\n#endif\n\nvec3 diffuseBase=vec3(0.,0.,0.);\nlightingInfo info;\nfloat shadow=1.;\nfloat glossiness=0.;\n#include<lightFragment>[0..1]\n\nvec4 color=vec4(shadowColor,(1.0-clamp(shadow,0.,1.))*alpha);\n#include<fogFragment>\ngl_FragColor=color;\n#include<imageProcessingCompatibility>\n}";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./shadowOnly/shadowOnly.vertex.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"shadowOnlyVertexShader",function(){return a});var r=n("babylonjs/Misc/decorators"),i="shadowOnlyVertexShader",o="precision highp float;\n\nattribute vec3 position;\n#ifdef NORMAL\nattribute vec3 normal;\n#endif\n#include<bonesDeclaration>\n\n#include<instancesDeclaration>\nuniform mat4 view;\nuniform mat4 viewProjection;\n#ifdef POINTSIZE\nuniform float pointSize;\n#endif\n\nvarying vec3 vPositionW;\n#ifdef NORMAL\nvarying vec3 vNormalW;\n#endif\n#ifdef VERTEXCOLOR\nvarying vec4 vColor;\n#endif\n#include<clipPlaneVertexDeclaration>\n#include<fogVertexDeclaration>\n#include<__decl__lightFragment>[0..maxSimultaneousLights]\nvoid main(void) {\n#include<instancesVertex>\n#include<bonesVertex>\nvec4 worldPos=finalWorld*vec4(position,1.0);\ngl_Position=viewProjection*worldPos;\nvPositionW=vec3(worldPos);\n#ifdef NORMAL\nvNormalW=normalize(vec3(finalWorld*vec4(normal,0.0)));\n#endif\n\n#include<clipPlaneVertex>\n\n#include<fogVertex>\n#include<shadowsVertex>[0..maxSimultaneousLights]\n\n#ifdef POINTSIZE\ngl_PointSize=pointSize;\n#endif\n}\n";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./shadowOnly/shadowOnlyMaterial.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"ShadowOnlyMaterial",function(){return a});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/decorators"),o=(n("./shadowOnly/shadowOnly.fragment.ts"),n("./shadowOnly/shadowOnly.vertex.ts"),function(e){function t(){var t=e.call(this)||this;return t.CLIPPLANE=!1,t.CLIPPLANE2=!1,t.CLIPPLANE3=!1,t.CLIPPLANE4=!1,t.CLIPPLANE5=!1,t.CLIPPLANE6=!1,t.POINTSIZE=!1,t.FOG=!1,t.NORMAL=!1,t.NUM_BONE_INFLUENCERS=0,t.BonesPerMesh=0,t.INSTANCES=!1,t.IMAGEPROCESSINGPOSTPROCESS=!1,t.rebuild(),t}return Object(r.__extends)(t,e),t}(i.MaterialDefines)),a=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r._needAlphaBlending=!0,r.shadowColor=i.Color3.Black(),r}return Object(r.__extends)(t,e),t.prototype.needAlphaBlending=function(){return this._needAlphaBlending},t.prototype.needAlphaTesting=function(){return!1},t.prototype.getAlphaTestTexture=function(){return null},Object.defineProperty(t.prototype,"activeLight",{get:function(){return this._activeLight},set:function(e){this._activeLight=e},enumerable:!1,configurable:!0}),t.prototype._getFirstShadowLightForMesh=function(e){for(var t=0,n=e.lightSources;t<n.length;t++){var r=n[t];if(r.shadowEnabled)return r}return null},t.prototype.isReadyForSubMesh=function(e,t,n){var r;if(this.isFrozen&&t.effect&&t.effect._wasPreviouslyReady)return!0;t._materialDefines||(t.materialDefines=new o);var a=t._materialDefines,s=this.getScene();if(this._isReadyForSubMesh(t))return!0;var l=s.getEngine();if(this._activeLight)for(var c=0,u=e.lightSources;c<u.length;c++){var _=u[c];if(_.shadowEnabled){if(this._activeLight===_)break;var h=e.lightSources.indexOf(this._activeLight);-1!==h&&(e.lightSources.splice(h,1),e.lightSources.splice(0,0,this._activeLight));break}}i.MaterialHelper.PrepareDefinesForFrameBoundValues(s,l,a,!!n),i.MaterialHelper.PrepareDefinesForMisc(e,s,!1,this.pointsCloud,this.fogEnabled,this._shouldTurnAlphaTestOn(e),a),a._needNormals=i.MaterialHelper.PrepareDefinesForLights(s,e,a,!1,1);var f=null===(r=this._getFirstShadowLightForMesh(e))||void 0===r?void 0:r.getShadowGenerator();if(this._needAlphaBlending=!0,f&&f.getClassName&&"CascadedShadowGenerator"===f.getClassName()){var d=f;this._needAlphaBlending=!d.autoCalcDepthBounds}if(i.MaterialHelper.PrepareDefinesForAttributes(e,a,!1,!0),a.isDirty){a.markAsProcessed(),s.resetCachedMaterial();var p=new i.EffectFallbacks;a.FOG&&p.addFallback(1,"FOG"),i.MaterialHelper.HandleFallbacksForShadows(a,p,1),a.NUM_BONE_INFLUENCERS>0&&p.addCPUSkinningFallback(0,e),a.IMAGEPROCESSINGPOSTPROCESS=s.imageProcessingConfiguration.applyByPostProcess;var m=[i.VertexBuffer.PositionKind];a.NORMAL&&m.push(i.VertexBuffer.NormalKind),i.MaterialHelper.PrepareAttributesForBones(m,e,a,p),i.MaterialHelper.PrepareAttributesForInstances(m,a);var g=a.toString(),v=["world","view","viewProjection","vEyePosition","vLightsType","vFogInfos","vFogColor","pointSize","alpha","shadowColor","mBones","vClipPlane","vClipPlane2","vClipPlane3","vClipPlane4","vClipPlane5","vClipPlane6"],b=new Array,y=new Array;i.MaterialHelper.PrepareUniformsAndSamplersList({uniformsNames:v,uniformBuffersNames:y,samplers:b,defines:a,maxSimultaneousLights:1}),t.setEffect(s.getEngine().createEffect("shadowOnly",{attributes:m,uniformsNames:v,uniformBuffersNames:y,samplers:b,defines:g,fallbacks:p,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousLights:1}},l),a,this._materialContext)}return!(!t.effect||!t.effect.isReady())&&(a._renderId=s.getRenderId(),t.effect._wasPreviouslyReady=!0,!0)},t.prototype.bindForSubMesh=function(e,t,n){var r=this.getScene(),o=n._materialDefines;if(o){var a=n.effect;if(a){if(this._activeEffect=a,this.bindOnlyWorldMatrix(e),this._activeEffect.setMatrix("viewProjection",r.getTransformMatrix()),i.MaterialHelper.BindBonesParameters(t,this._activeEffect),this._mustRebind(r,a)&&(i.MaterialHelper.BindClipPlane(this._activeEffect,r),this.pointsCloud&&this._activeEffect.setFloat("pointSize",this.pointSize),this._activeEffect.setFloat("alpha",this.alpha),this._activeEffect.setColor3("shadowColor",this.shadowColor),r.bindEyePosition(a)),r.lightsEnabled){i.MaterialHelper.BindLights(r,t,this._activeEffect,o,1);var s=this._getFirstShadowLightForMesh(t);s&&(s._renderId=-1)}(r.fogEnabled&&t.applyFog&&r.fogMode!==i.Scene.FOGMODE_NONE||o.SHADOWCSM0)&&this._activeEffect.setMatrix("view",r.getViewMatrix()),i.MaterialHelper.BindFogParameters(r,t,this._activeEffect),this._afterBind(t,this._activeEffect)}}},t.prototype.clone=function(e){var n=this;return i.SerializationHelper.Clone(function(){return new t(e,n.getScene())},this)},t.prototype.serialize=function(){var e=i.SerializationHelper.Serialize(this);return e.customType="BABYLON.ShadowOnlyMaterial",e},t.prototype.getClassName=function(){return"ShadowOnlyMaterial"},t.Parse=function(e,n,r){return i.SerializationHelper.Parse(function(){return new t(e.name,n)},e,n,r)},t}(i.PushMaterial);Object(i.RegisterClass)("BABYLON.ShadowOnlyMaterial",a)},"./simple/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./simple/simpleMaterial.ts");n.d(t,"SimpleMaterial",function(){return r.SimpleMaterial})},"./simple/simple.fragment.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"simplePixelShader",function(){return a});var r=n("babylonjs/Misc/decorators"),i="simplePixelShader",o="precision highp float;\n\nuniform vec4 vEyePosition;\nuniform vec4 vDiffuseColor;\n\nvarying vec3 vPositionW;\n#ifdef NORMAL\nvarying vec3 vNormalW;\n#endif\n#ifdef VERTEXCOLOR\nvarying vec4 vColor;\n#endif\n\n#include<helperFunctions>\n\n#include<__decl__lightFragment>[0..maxSimultaneousLights]\n#include<lightsFragmentFunctions>\n#include<shadowsFragmentFunctions>\n\n#ifdef DIFFUSE\nvarying vec2 vDiffuseUV;\nuniform sampler2D diffuseSampler;\nuniform vec2 vDiffuseInfos;\n#endif\n#include<clipPlaneFragmentDeclaration>\n\n#include<fogFragmentDeclaration>\nvoid main(void) {\n#include<clipPlaneFragment>\nvec3 viewDirectionW=normalize(vEyePosition.xyz-vPositionW);\n\nvec4 baseColor=vec4(1.,1.,1.,1.);\nvec3 diffuseColor=vDiffuseColor.rgb;\n\nfloat alpha=vDiffuseColor.a;\n#ifdef DIFFUSE\nbaseColor=texture2D(diffuseSampler,vDiffuseUV);\n#ifdef ALPHATEST\nif (baseColor.a<0.4)\ndiscard;\n#endif\n#include<depthPrePass>\nbaseColor.rgb*=vDiffuseInfos.y;\n#endif\n#ifdef VERTEXCOLOR\nbaseColor.rgb*=vColor.rgb;\n#endif\n\n#ifdef NORMAL\nvec3 normalW=normalize(vNormalW);\n#else\nvec3 normalW=vec3(1.0,1.0,1.0);\n#endif\n\nvec3 diffuseBase=vec3(0.,0.,0.);\nlightingInfo info;\nfloat shadow=1.;\nfloat glossiness=0.;\n#ifdef SPECULARTERM\nvec3 specularBase=vec3(0.,0.,0.);\n#endif\n#include<lightFragment>[0..maxSimultaneousLights]\n#ifdef VERTEXALPHA\nalpha*=vColor.a;\n#endif\nvec3 finalDiffuse=clamp(diffuseBase*diffuseColor,0.0,1.0)*baseColor.rgb;\n\nvec4 color=vec4(finalDiffuse,alpha);\n#include<fogFragment>\ngl_FragColor=color;\n#include<imageProcessingCompatibility>\n}";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./simple/simple.vertex.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"simpleVertexShader",function(){return a});var r=n("babylonjs/Misc/decorators"),i="simpleVertexShader",o="precision highp float;\n\nattribute vec3 position;\n#ifdef NORMAL\nattribute vec3 normal;\n#endif\n#ifdef UV1\nattribute vec2 uv;\n#endif\n#ifdef UV2\nattribute vec2 uv2;\n#endif\n#ifdef VERTEXCOLOR\nattribute vec4 color;\n#endif\n#include<bonesDeclaration>\n\n#include<instancesDeclaration>\nuniform mat4 view;\nuniform mat4 viewProjection;\n#ifdef DIFFUSE\nvarying vec2 vDiffuseUV;\nuniform mat4 diffuseMatrix;\nuniform vec2 vDiffuseInfos;\n#endif\n#ifdef POINTSIZE\nuniform float pointSize;\n#endif\n\nvarying vec3 vPositionW;\n#ifdef NORMAL\nvarying vec3 vNormalW;\n#endif\n#ifdef VERTEXCOLOR\nvarying vec4 vColor;\n#endif\n#include<clipPlaneVertexDeclaration>\n#include<fogVertexDeclaration>\n#include<__decl__lightFragment>[0..maxSimultaneousLights]\nvoid main(void) {\n#include<instancesVertex>\n#include<bonesVertex>\nvec4 worldPos=finalWorld*vec4(position,1.0);\ngl_Position=viewProjection*worldPos;\nvPositionW=vec3(worldPos);\n#ifdef NORMAL\nvNormalW=normalize(vec3(finalWorld*vec4(normal,0.0)));\n#endif\n\n#ifndef UV1\nvec2 uv=vec2(0.,0.);\n#endif\n#ifndef UV2\nvec2 uv2=vec2(0.,0.);\n#endif\n#ifdef DIFFUSE\nif (vDiffuseInfos.x == 0.)\n{\nvDiffuseUV=vec2(diffuseMatrix*vec4(uv,1.0,0.0));\n}\nelse\n{\nvDiffuseUV=vec2(diffuseMatrix*vec4(uv2,1.0,0.0));\n}\n#endif\n\n#include<clipPlaneVertex>\n\n#include<fogVertex>\n#include<shadowsVertex>[0..maxSimultaneousLights]\n\n#ifdef VERTEXCOLOR\nvColor=color;\n#endif\n\n#ifdef POINTSIZE\ngl_PointSize=pointSize;\n#endif\n}\n";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./simple/simpleMaterial.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"SimpleMaterial",function(){return a});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/decorators"),o=(n("./simple/simple.fragment.ts"),n("./simple/simple.vertex.ts"),function(e){function t(){var t=e.call(this)||this;return t.DIFFUSE=!1,t.CLIPPLANE=!1,t.CLIPPLANE2=!1,t.CLIPPLANE3=!1,t.CLIPPLANE4=!1,t.CLIPPLANE5=!1,t.CLIPPLANE6=!1,t.ALPHATEST=!1,t.DEPTHPREPASS=!1,t.POINTSIZE=!1,t.FOG=!1,t.NORMAL=!1,t.UV1=!1,t.UV2=!1,t.VERTEXCOLOR=!1,t.VERTEXALPHA=!1,t.NUM_BONE_INFLUENCERS=0,t.BonesPerMesh=0,t.INSTANCES=!1,t.IMAGEPROCESSINGPOSTPROCESS=!1,t.rebuild(),t}return Object(r.__extends)(t,e),t}(i.MaterialDefines)),a=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.diffuseColor=new i.Color3(1,1,1),r._disableLighting=!1,r._maxSimultaneousLights=4,r}return Object(r.__extends)(t,e),t.prototype.needAlphaBlending=function(){return this.alpha<1},t.prototype.needAlphaTesting=function(){return!1},t.prototype.getAlphaTestTexture=function(){return null},t.prototype.isReadyForSubMesh=function(e,t,n){if(this.isFrozen&&t.effect&&t.effect._wasPreviouslyReady)return!0;t._materialDefines||(t.materialDefines=new o);var r=t._materialDefines,a=this.getScene();if(this._isReadyForSubMesh(t))return!0;var s=a.getEngine();if(r._areTexturesDirty&&(r._needUVs=!1,a.texturesEnabled&&this._diffuseTexture&&i.MaterialFlags.DiffuseTextureEnabled)){if(!this._diffuseTexture.isReady())return!1;r._needUVs=!0,r.DIFFUSE=!0}if(i.MaterialHelper.PrepareDefinesForMisc(e,a,!1,this.pointsCloud,this.fogEnabled,this._shouldTurnAlphaTestOn(e),r),r._needNormals=i.MaterialHelper.PrepareDefinesForLights(a,e,r,!1,this._maxSimultaneousLights,this._disableLighting),i.MaterialHelper.PrepareDefinesForFrameBoundValues(a,s,r,!!n),i.MaterialHelper.PrepareDefinesForAttributes(e,r,!0,!0),r.isDirty){r.markAsProcessed(),a.resetCachedMaterial();var l=new i.EffectFallbacks;r.FOG&&l.addFallback(1,"FOG"),i.MaterialHelper.HandleFallbacksForShadows(r,l,this.maxSimultaneousLights),r.NUM_BONE_INFLUENCERS>0&&l.addCPUSkinningFallback(0,e),r.IMAGEPROCESSINGPOSTPROCESS=a.imageProcessingConfiguration.applyByPostProcess;var c=[i.VertexBuffer.PositionKind];r.NORMAL&&c.push(i.VertexBuffer.NormalKind),r.UV1&&c.push(i.VertexBuffer.UVKind),r.UV2&&c.push(i.VertexBuffer.UV2Kind),r.VERTEXCOLOR&&c.push(i.VertexBuffer.ColorKind),i.MaterialHelper.PrepareAttributesForBones(c,e,r,l),i.MaterialHelper.PrepareAttributesForInstances(c,r);var u=r.toString(),_=["world","view","viewProjection","vEyePosition","vLightsType","vDiffuseColor","vFogInfos","vFogColor","pointSize","vDiffuseInfos","mBones","vClipPlane","vClipPlane2","vClipPlane3","vClipPlane4","vClipPlane5","vClipPlane6","diffuseMatrix"],h=["diffuseSampler"],f=new Array;i.MaterialHelper.PrepareUniformsAndSamplersList({uniformsNames:_,uniformBuffersNames:f,samplers:h,defines:r,maxSimultaneousLights:this.maxSimultaneousLights}),t.setEffect(a.getEngine().createEffect("simple",{attributes:c,uniformsNames:_,uniformBuffersNames:f,samplers:h,defines:u,fallbacks:l,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousLights:this._maxSimultaneousLights-1}},s),r,this._materialContext)}return!(!t.effect||!t.effect.isReady())&&(r._renderId=a.getRenderId(),t.effect._wasPreviouslyReady=!0,!0)},t.prototype.bindForSubMesh=function(e,t,n){var r=this.getScene(),o=n._materialDefines;if(o){var a=n.effect;a&&(this._activeEffect=a,this.bindOnlyWorldMatrix(e),this._activeEffect.setMatrix("viewProjection",r.getTransformMatrix()),i.MaterialHelper.BindBonesParameters(t,this._activeEffect),this._mustRebind(r,a)&&(this._diffuseTexture&&i.MaterialFlags.DiffuseTextureEnabled&&(this._activeEffect.setTexture("diffuseSampler",this._diffuseTexture),this._activeEffect.setFloat2("vDiffuseInfos",this._diffuseTexture.coordinatesIndex,this._diffuseTexture.level),this._activeEffect.setMatrix("diffuseMatrix",this._diffuseTexture.getTextureMatrix())),i.MaterialHelper.BindClipPlane(this._activeEffect,r),this.pointsCloud&&this._activeEffect.setFloat("pointSize",this.pointSize),r.bindEyePosition(a)),this._activeEffect.setColor4("vDiffuseColor",this.diffuseColor,this.alpha*t.visibility),r.lightsEnabled&&!this.disableLighting&&i.MaterialHelper.BindLights(r,t,this._activeEffect,o,this.maxSimultaneousLights),r.fogEnabled&&t.applyFog&&r.fogMode!==i.Scene.FOGMODE_NONE&&this._activeEffect.setMatrix("view",r.getViewMatrix()),i.MaterialHelper.BindFogParameters(r,t,this._activeEffect),this._afterBind(t,this._activeEffect))}},t.prototype.getAnimatables=function(){var e=[];return this._diffuseTexture&&this._diffuseTexture.animations&&this._diffuseTexture.animations.length>0&&e.push(this._diffuseTexture),e},t.prototype.getActiveTextures=function(){var t=e.prototype.getActiveTextures.call(this);return this._diffuseTexture&&t.push(this._diffuseTexture),t},t.prototype.hasTexture=function(t){return!!e.prototype.hasTexture.call(this,t)||this.diffuseTexture===t},t.prototype.dispose=function(t){this._diffuseTexture&&this._diffuseTexture.dispose(),e.prototype.dispose.call(this,t)},t.prototype.clone=function(e){var n=this;return i.SerializationHelper.Clone(function(){return new t(e,n.getScene())},this)},t.prototype.serialize=function(){var e=i.SerializationHelper.Serialize(this);return e.customType="BABYLON.SimpleMaterial",e},t.prototype.getClassName=function(){return"SimpleMaterial"},t.Parse=function(e,n,r){return i.SerializationHelper.Parse(function(){return new t(e.name,n)},e,n,r)},Object(r.__decorate)([Object(i.serializeAsTexture)("diffuseTexture")],t.prototype,"_diffuseTexture",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"diffuseTexture",void 0),Object(r.__decorate)([Object(i.serializeAsColor3)("diffuse")],t.prototype,"diffuseColor",void 0),Object(r.__decorate)([Object(i.serialize)("disableLighting")],t.prototype,"_disableLighting",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsLightsDirty")],t.prototype,"disableLighting",void 0),Object(r.__decorate)([Object(i.serialize)("maxSimultaneousLights")],t.prototype,"_maxSimultaneousLights",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsLightsDirty")],t.prototype,"maxSimultaneousLights",void 0),t}(i.PushMaterial);Object(i.RegisterClass)("BABYLON.SimpleMaterial",a)},"./sky/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./sky/skyMaterial.ts");n.d(t,"SkyMaterial",function(){return r.SkyMaterial})},"./sky/sky.fragment.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"skyPixelShader",function(){return a});var r=n("babylonjs/Misc/decorators"),i="skyPixelShader",o="precision highp float;\n\nvarying vec3 vPositionW;\n#ifdef VERTEXCOLOR\nvarying vec4 vColor;\n#endif\n#include<clipPlaneFragmentDeclaration>\n\nuniform vec3 cameraPosition;\nuniform vec3 cameraOffset;\nuniform vec3 up;\nuniform float luminance;\nuniform float turbidity;\nuniform float rayleigh;\nuniform float mieCoefficient;\nuniform float mieDirectionalG;\nuniform vec3 sunPosition;\n\n#include<fogFragmentDeclaration>\n\nconst float e=2.71828182845904523536028747135266249775724709369995957;\nconst float pi=3.141592653589793238462643383279502884197169;\nconst float n=1.0003;\nconst float N=2.545E25;\nconst float pn=0.035;\nconst vec3 lambda=vec3(680E-9,550E-9,450E-9);\nconst vec3 K=vec3(0.686,0.678,0.666);\nconst float v=4.0;\nconst float rayleighZenithLength=8.4E3;\nconst float mieZenithLength=1.25E3;\nconst float EE=1000.0;\nconst float sunAngularDiameterCos=0.999956676946448443553574619906976478926848692873900859324;\nconst float cutoffAngle=pi/1.95;\nconst float steepness=1.5;\nvec3 totalRayleigh(vec3 lambda)\n{\nreturn (8.0*pow(pi,3.0)*pow(pow(n,2.0)-1.0,2.0)*(6.0+3.0*pn))/(3.0*N*pow(lambda,vec3(4.0))*(6.0-7.0*pn));\n}\nvec3 simplifiedRayleigh()\n{\nreturn 0.0005/vec3(94,40,18);\n}\nfloat rayleighPhase(float cosTheta)\n{\nreturn (3.0/(16.0*pi))*(1.0+pow(cosTheta,2.0));\n}\nvec3 totalMie(vec3 lambda,vec3 K,float T)\n{\nfloat c=(0.2*T )*10E-18;\nreturn 0.434*c*pi*pow((2.0*pi)/lambda,vec3(v-2.0))*K;\n}\nfloat hgPhase(float cosTheta,float g)\n{\nreturn (1.0/(4.0*pi))*((1.0-pow(g,2.0))/pow(1.0-2.0*g*cosTheta+pow(g,2.0),1.5));\n}\nfloat sunIntensity(float zenithAngleCos)\n{\nreturn EE*max(0.0,1.0-exp((-(cutoffAngle-acos(zenithAngleCos))/steepness)));\n}\nfloat A=0.15;\nfloat B=0.50;\nfloat C=0.10;\nfloat D=0.20;\nfloat EEE=0.02;\nfloat F=0.30;\nfloat W=1000.0;\nvec3 Uncharted2Tonemap(vec3 x)\n{\nreturn ((x*(A*x+C*B)+D*EEE)/(x*(A*x+B)+D*F))-EEE/F;\n}\nvoid main(void) {\n\n#include<clipPlaneFragment>\n\nfloat sunfade=1.0-clamp(1.0-exp((sunPosition.y/450000.0)),0.0,1.0);\nfloat rayleighCoefficient=rayleigh-(1.0*(1.0-sunfade));\nvec3 sunDirection=normalize(sunPosition);\nfloat sunE=sunIntensity(dot(sunDirection,up));\nvec3 betaR=simplifiedRayleigh()*rayleighCoefficient;\nvec3 betaM=totalMie(lambda,K,turbidity)*mieCoefficient;\nfloat zenithAngle=acos(max(0.0,dot(up,normalize(vPositionW-cameraPosition+cameraOffset))));\nfloat sR=rayleighZenithLength/(cos(zenithAngle)+0.15*pow(93.885-((zenithAngle*180.0)/pi),-1.253));\nfloat sM=mieZenithLength/(cos(zenithAngle)+0.15*pow(93.885-((zenithAngle*180.0)/pi),-1.253));\nvec3 Fex=exp(-(betaR*sR+betaM*sM));\nfloat cosTheta=dot(normalize(vPositionW-cameraPosition),sunDirection);\nfloat rPhase=rayleighPhase(cosTheta*0.5+0.5);\nvec3 betaRTheta=betaR*rPhase;\nfloat mPhase=hgPhase(cosTheta,mieDirectionalG);\nvec3 betaMTheta=betaM*mPhase;\nvec3 Lin=pow(sunE*((betaRTheta+betaMTheta)/(betaR+betaM))*(1.0-Fex),vec3(1.5));\nLin*=mix(vec3(1.0),pow(sunE*((betaRTheta+betaMTheta)/(betaR+betaM))*Fex,vec3(1.0/2.0)),clamp(pow(1.0-dot(up,sunDirection),5.0),0.0,1.0));\nvec3 direction=normalize(vPositionW-cameraPosition);\nfloat theta=acos(direction.y);\nfloat phi=atan(direction.z,direction.x);\nvec2 uv=vec2(phi,theta)/vec2(2.0*pi,pi)+vec2(0.5,0.0);\nvec3 L0=vec3(0.1)*Fex;\nfloat sundisk=smoothstep(sunAngularDiameterCos,sunAngularDiameterCos+0.00002,cosTheta);\nL0+=(sunE*19000.0*Fex)*sundisk;\nvec3 whiteScale=1.0/Uncharted2Tonemap(vec3(W));\nvec3 texColor=(Lin+L0);\ntexColor*=0.04 ;\ntexColor+=vec3(0.0,0.001,0.0025)*0.3;\nfloat g_fMaxLuminance=1.0;\nfloat fLumScaled=0.1/luminance;\nfloat fLumCompressed=(fLumScaled*(1.0+(fLumScaled/(g_fMaxLuminance*g_fMaxLuminance))))/(1.0+fLumScaled);\nfloat ExposureBias=fLumCompressed;\nvec3 curr=Uncharted2Tonemap((log2(2.0/pow(luminance,4.0)))*texColor);\n\n\n\nvec3 retColor=curr*whiteScale;\n\n\nfloat alpha=1.0;\n#ifdef VERTEXCOLOR\nretColor.rgb*=vColor.rgb;\n#endif\n#ifdef VERTEXALPHA\nalpha*=vColor.a;\n#endif\n\nvec4 color=clamp(vec4(retColor.rgb,alpha),0.0,1.0);\n\n#include<fogFragment>\ngl_FragColor=color;\n#include<imageProcessingCompatibility>\n}\n";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./sky/sky.vertex.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"skyVertexShader",function(){return a});var r=n("babylonjs/Misc/decorators"),i="skyVertexShader",o="precision highp float;\n\nattribute vec3 position;\n#ifdef VERTEXCOLOR\nattribute vec4 color;\n#endif\n\nuniform mat4 world;\nuniform mat4 view;\nuniform mat4 viewProjection;\n#ifdef POINTSIZE\nuniform float pointSize;\n#endif\n\nvarying vec3 vPositionW;\n#ifdef VERTEXCOLOR\nvarying vec4 vColor;\n#endif\n#include<clipPlaneVertexDeclaration>\n#include<fogVertexDeclaration>\nvoid main(void) {\ngl_Position=viewProjection*world*vec4(position,1.0);\nvec4 worldPos=world*vec4(position,1.0);\nvPositionW=vec3(worldPos);\n\n#include<clipPlaneVertex>\n\n#include<fogVertex>\n\n#ifdef VERTEXCOLOR\nvColor=color;\n#endif\n\n#ifdef POINTSIZE\ngl_PointSize=pointSize;\n#endif\n}\n";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./sky/skyMaterial.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"SkyMaterial",function(){return a});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/decorators"),o=(n("./sky/sky.fragment.ts"),n("./sky/sky.vertex.ts"),function(e){function t(){var t=e.call(this)||this;return t.CLIPPLANE=!1,t.CLIPPLANE2=!1,t.CLIPPLANE3=!1,t.CLIPPLANE4=!1,t.CLIPPLANE5=!1,t.CLIPPLANE6=!1,t.POINTSIZE=!1,t.FOG=!1,t.VERTEXCOLOR=!1,t.VERTEXALPHA=!1,t.IMAGEPROCESSINGPOSTPROCESS=!1,t.rebuild(),t}return Object(r.__extends)(t,e),t}(i.MaterialDefines)),a=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.luminance=1,r.turbidity=10,r.rayleigh=2,r.mieCoefficient=.005,r.mieDirectionalG=.8,r.distance=500,r.inclination=.49,r.azimuth=.25,r.sunPosition=new i.Vector3(0,100,0),r.useSunPosition=!1,r.cameraOffset=i.Vector3.Zero(),r.up=i.Vector3.Up(),r._cameraPosition=i.Vector3.Zero(),r._skyOrientation=new i.Quaternion,r}return Object(r.__extends)(t,e),t.prototype.needAlphaBlending=function(){return this.alpha<1},t.prototype.needAlphaTesting=function(){return!1},t.prototype.getAlphaTestTexture=function(){return null},t.prototype.isReadyForSubMesh=function(e,t,n){if(this.isFrozen&&t.effect&&t.effect._wasPreviouslyReady)return!0;t._materialDefines||(t.materialDefines=new o);var r=t._materialDefines,a=this.getScene();if(this._isReadyForSubMesh(t))return!0;if(i.MaterialHelper.PrepareDefinesForMisc(e,a,!1,this.pointsCloud,this.fogEnabled,!1,r),i.MaterialHelper.PrepareDefinesForAttributes(e,r,!0,!1),r.IMAGEPROCESSINGPOSTPROCESS!==a.imageProcessingConfiguration.applyByPostProcess&&r.markAsMiscDirty(),r.isDirty){r.markAsProcessed(),a.resetCachedMaterial();var s=new i.EffectFallbacks;r.FOG&&s.addFallback(1,"FOG"),r.IMAGEPROCESSINGPOSTPROCESS=a.imageProcessingConfiguration.applyByPostProcess;var l=[i.VertexBuffer.PositionKind];r.VERTEXCOLOR&&l.push(i.VertexBuffer.ColorKind);var c=r.toString();t.setEffect(a.getEngine().createEffect("sky",l,["world","viewProjection","view","vFogInfos","vFogColor","pointSize","vClipPlane","vClipPlane2","vClipPlane3","vClipPlane4","vClipPlane5","vClipPlane6","luminance","turbidity","rayleigh","mieCoefficient","mieDirectionalG","sunPosition","cameraPosition","cameraOffset","up"],[],c,s,this.onCompiled,this.onError),r,this._materialContext)}return!(!t.effect||!t.effect.isReady())&&(r._renderId=a.getRenderId(),t.effect._wasPreviouslyReady=!0,!0)},t.prototype.bindForSubMesh=function(e,t,n){var r=this.getScene();if(n._materialDefines){var o=n.effect;if(o){this._activeEffect=o,this.bindOnlyWorldMatrix(e),this._activeEffect.setMatrix("viewProjection",r.getTransformMatrix()),this._mustRebind(r,o)&&(i.MaterialHelper.BindClipPlane(this._activeEffect,r),this.pointsCloud&&this._activeEffect.setFloat("pointSize",this.pointSize)),r.fogEnabled&&t.applyFog&&r.fogMode!==i.Scene.FOGMODE_NONE&&this._activeEffect.setMatrix("view",r.getViewMatrix()),i.MaterialHelper.BindFogParameters(r,t,this._activeEffect);var a=r.activeCamera;if(a){var s=a.getWorldMatrix();this._cameraPosition.x=s.m[12],this._cameraPosition.y=s.m[13],this._cameraPosition.z=s.m[14],this._activeEffect.setVector3("cameraPosition",this._cameraPosition)}if(this._activeEffect.setVector3("cameraOffset",this.cameraOffset),this._activeEffect.setVector3("up",this.up),this.luminance>0&&this._activeEffect.setFloat("luminance",this.luminance),this._activeEffect.setFloat("turbidity",this.turbidity),this._activeEffect.setFloat("rayleigh",this.rayleigh),this._activeEffect.setFloat("mieCoefficient",this.mieCoefficient),this._activeEffect.setFloat("mieDirectionalG",this.mieDirectionalG),!this.useSunPosition){var l=Math.PI*(this.inclination-.5),c=2*Math.PI*(this.azimuth-.5);this.sunPosition.x=this.distance*Math.cos(c)*Math.cos(l),this.sunPosition.y=this.distance*Math.sin(-l),this.sunPosition.z=this.distance*Math.sin(c)*Math.cos(l),i.Quaternion.FromUnitVectorsToRef(i.Vector3.UpReadOnly,this.up,this._skyOrientation),this.sunPosition.rotateByQuaternionToRef(this._skyOrientation,this.sunPosition)}this._activeEffect.setVector3("sunPosition",this.sunPosition),this._afterBind(t,this._activeEffect)}}},t.prototype.getAnimatables=function(){return[]},t.prototype.dispose=function(t){e.prototype.dispose.call(this,t)},t.prototype.clone=function(e){var n=this;return i.SerializationHelper.Clone(function(){return new t(e,n.getScene())},this)},t.prototype.serialize=function(){var e=i.SerializationHelper.Serialize(this);return e.customType="BABYLON.SkyMaterial",e},t.prototype.getClassName=function(){return"SkyMaterial"},t.Parse=function(e,n,r){return i.SerializationHelper.Parse(function(){return new t(e.name,n)},e,n,r)},Object(r.__decorate)([Object(i.serialize)()],t.prototype,"luminance",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"turbidity",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"rayleigh",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"mieCoefficient",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"mieDirectionalG",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"distance",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"inclination",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"azimuth",void 0),Object(r.__decorate)([Object(i.serializeAsVector3)()],t.prototype,"sunPosition",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"useSunPosition",void 0),Object(r.__decorate)([Object(i.serializeAsVector3)()],t.prototype,"cameraOffset",void 0),Object(r.__decorate)([Object(i.serializeAsVector3)()],t.prototype,"up",void 0),t}(i.PushMaterial);Object(i.RegisterClass)("BABYLON.SkyMaterial",a)},"./terrain/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./terrain/terrainMaterial.ts");n.d(t,"TerrainMaterial",function(){return r.TerrainMaterial})},"./terrain/terrain.fragment.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"terrainPixelShader",function(){return a});var r=n("babylonjs/Misc/decorators"),i="terrainPixelShader",o="precision highp float;\n\nuniform vec4 vEyePosition;\nuniform vec4 vDiffuseColor;\n#ifdef SPECULARTERM\nuniform vec4 vSpecularColor;\n#endif\n\nvarying vec3 vPositionW;\n#ifdef NORMAL\nvarying vec3 vNormalW;\n#endif\n#ifdef VERTEXCOLOR\nvarying vec4 vColor;\n#endif\n\n#include<helperFunctions>\n\n#include<__decl__lightFragment>[0..maxSimultaneousLights]\n\n#ifdef DIFFUSE\nvarying vec2 vTextureUV;\nuniform sampler2D textureSampler;\nuniform vec2 vTextureInfos;\nuniform sampler2D diffuse1Sampler;\nuniform sampler2D diffuse2Sampler;\nuniform sampler2D diffuse3Sampler;\nuniform vec2 diffuse1Infos;\nuniform vec2 diffuse2Infos;\nuniform vec2 diffuse3Infos;\n#endif\n#ifdef BUMP\nuniform sampler2D bump1Sampler;\nuniform sampler2D bump2Sampler;\nuniform sampler2D bump3Sampler;\n#endif\n\n#include<lightsFragmentFunctions>\n#include<shadowsFragmentFunctions>\n#include<clipPlaneFragmentDeclaration>\n\n#include<fogFragmentDeclaration>\n\n#ifdef BUMP\n#extension GL_OES_standard_derivatives : enable\n\nmat3 cotangent_frame(vec3 normal,vec3 p,vec2 uv)\n{\n\nvec3 dp1=dFdx(p);\nvec3 dp2=dFdy(p);\nvec2 duv1=dFdx(uv);\nvec2 duv2=dFdy(uv);\n\nvec3 dp2perp=cross(dp2,normal);\nvec3 dp1perp=cross(normal,dp1);\nvec3 tangent=dp2perp*duv1.x+dp1perp*duv2.x;\nvec3 binormal=dp2perp*duv1.y+dp1perp*duv2.y;\n\nfloat invmax=inversesqrt(max(dot(tangent,tangent),dot(binormal,binormal)));\nreturn mat3(tangent*invmax,binormal*invmax,normal);\n}\nvec3 perturbNormal(vec3 viewDir,vec3 mixColor)\n{\nvec3 bump1Color=texture2D(bump1Sampler,vTextureUV*diffuse1Infos).xyz;\nvec3 bump2Color=texture2D(bump2Sampler,vTextureUV*diffuse2Infos).xyz;\nvec3 bump3Color=texture2D(bump3Sampler,vTextureUV*diffuse3Infos).xyz;\nbump1Color.rgb*=mixColor.r;\nbump2Color.rgb=mix(bump1Color.rgb,bump2Color.rgb,mixColor.g);\nvec3 map=mix(bump2Color.rgb,bump3Color.rgb,mixColor.b);\nmap=map*255./127.-128./127.;\nmat3 TBN=cotangent_frame(vNormalW*vTextureInfos.y,-viewDir,vTextureUV);\nreturn normalize(TBN*map);\n}\n#endif\nvoid main(void) {\n\n#include<clipPlaneFragment>\nvec3 viewDirectionW=normalize(vEyePosition.xyz-vPositionW);\n\nvec4 baseColor=vec4(1.,1.,1.,1.);\nvec3 diffuseColor=vDiffuseColor.rgb;\n#ifdef SPECULARTERM\nfloat glossiness=vSpecularColor.a;\nvec3 specularColor=vSpecularColor.rgb;\n#else\nfloat glossiness=0.;\n#endif\n\nfloat alpha=vDiffuseColor.a;\n\n#ifdef NORMAL\nvec3 normalW=normalize(vNormalW);\n#else\nvec3 normalW=vec3(1.0,1.0,1.0);\n#endif\n#ifdef DIFFUSE\nbaseColor=texture2D(textureSampler,vTextureUV);\n#if defined(BUMP) && defined(DIFFUSE)\nnormalW=perturbNormal(viewDirectionW,baseColor.rgb);\n#endif\n#ifdef ALPHATEST\nif (baseColor.a<0.4)\ndiscard;\n#endif\n#include<depthPrePass>\nbaseColor.rgb*=vTextureInfos.y;\nvec4 diffuse1Color=texture2D(diffuse1Sampler,vTextureUV*diffuse1Infos);\nvec4 diffuse2Color=texture2D(diffuse2Sampler,vTextureUV*diffuse2Infos);\nvec4 diffuse3Color=texture2D(diffuse3Sampler,vTextureUV*diffuse3Infos);\ndiffuse1Color.rgb*=baseColor.r;\ndiffuse2Color.rgb=mix(diffuse1Color.rgb,diffuse2Color.rgb,baseColor.g);\nbaseColor.rgb=mix(diffuse2Color.rgb,diffuse3Color.rgb,baseColor.b);\n#endif\n#ifdef VERTEXCOLOR\nbaseColor.rgb*=vColor.rgb;\n#endif\n\nvec3 diffuseBase=vec3(0.,0.,0.);\nlightingInfo info;\nfloat shadow=1.;\n#ifdef SPECULARTERM\nvec3 specularBase=vec3(0.,0.,0.);\n#endif\n#include<lightFragment>[0..maxSimultaneousLights]\n#ifdef VERTEXALPHA\nalpha*=vColor.a;\n#endif\n#ifdef SPECULARTERM\nvec3 finalSpecular=specularBase*specularColor;\n#else\nvec3 finalSpecular=vec3(0.0);\n#endif\nvec3 finalDiffuse=clamp(diffuseBase*diffuseColor*baseColor.rgb,0.0,1.0);\n\nvec4 color=vec4(finalDiffuse+finalSpecular,alpha);\n#include<fogFragment>\ngl_FragColor=color;\n#include<imageProcessingCompatibility>\n}\n";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./terrain/terrain.vertex.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"terrainVertexShader",function(){return a});var r=n("babylonjs/Misc/decorators"),i="terrainVertexShader",o="precision highp float;\n\nattribute vec3 position;\n#ifdef NORMAL\nattribute vec3 normal;\n#endif\n#ifdef UV1\nattribute vec2 uv;\n#endif\n#ifdef UV2\nattribute vec2 uv2;\n#endif\n#ifdef VERTEXCOLOR\nattribute vec4 color;\n#endif\n#include<bonesDeclaration>\n\n#include<instancesDeclaration>\nuniform mat4 view;\nuniform mat4 viewProjection;\n#ifdef DIFFUSE\nvarying vec2 vTextureUV;\nuniform mat4 textureMatrix;\nuniform vec2 vTextureInfos;\n#endif\n#ifdef POINTSIZE\nuniform float pointSize;\n#endif\n\nvarying vec3 vPositionW;\n#ifdef NORMAL\nvarying vec3 vNormalW;\n#endif\n#ifdef VERTEXCOLOR\nvarying vec4 vColor;\n#endif\n#include<clipPlaneVertexDeclaration>\n#include<fogVertexDeclaration>\n#include<__decl__lightFragment>[0..maxSimultaneousLights]\nvoid main(void) {\n#include<instancesVertex>\n#include<bonesVertex>\nvec4 worldPos=finalWorld*vec4(position,1.0);\ngl_Position=viewProjection*worldPos;\nvPositionW=vec3(worldPos);\n#ifdef NORMAL\nvNormalW=normalize(vec3(finalWorld*vec4(normal,0.0)));\n#endif\n\n#ifndef UV1\nvec2 uv=vec2(0.,0.);\n#endif\n#ifndef UV2\nvec2 uv2=vec2(0.,0.);\n#endif\n#ifdef DIFFUSE\nif (vTextureInfos.x == 0.)\n{\nvTextureUV=vec2(textureMatrix*vec4(uv,1.0,0.0));\n}\nelse\n{\nvTextureUV=vec2(textureMatrix*vec4(uv2,1.0,0.0));\n}\n#endif\n\n#include<clipPlaneVertex>\n\n#include<fogVertex>\n\n#include<shadowsVertex>[0..maxSimultaneousLights]\n\n#ifdef VERTEXCOLOR\nvColor=color;\n#endif\n\n#ifdef POINTSIZE\ngl_PointSize=pointSize;\n#endif\n}\n";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./terrain/terrainMaterial.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"TerrainMaterial",function(){return a});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/decorators"),o=(n("./terrain/terrain.fragment.ts"),n("./terrain/terrain.vertex.ts"),function(e){function t(){var t=e.call(this)||this;return t.DIFFUSE=!1,t.BUMP=!1,t.CLIPPLANE=!1,t.CLIPPLANE2=!1,t.CLIPPLANE3=!1,t.CLIPPLANE4=!1,t.CLIPPLANE5=!1,t.CLIPPLANE6=!1,t.ALPHATEST=!1,t.DEPTHPREPASS=!1,t.POINTSIZE=!1,t.FOG=!1,t.SPECULARTERM=!1,t.NORMAL=!1,t.UV1=!1,t.UV2=!1,t.VERTEXCOLOR=!1,t.VERTEXALPHA=!1,t.NUM_BONE_INFLUENCERS=0,t.BonesPerMesh=0,t.INSTANCES=!1,t.IMAGEPROCESSINGPOSTPROCESS=!1,t.rebuild(),t}return Object(r.__extends)(t,e),t}(i.MaterialDefines)),a=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.diffuseColor=new i.Color3(1,1,1),r.specularColor=new i.Color3(0,0,0),r.specularPower=64,r._disableLighting=!1,r._maxSimultaneousLights=4,r}return Object(r.__extends)(t,e),t.prototype.needAlphaBlending=function(){return this.alpha<1},t.prototype.needAlphaTesting=function(){return!1},t.prototype.getAlphaTestTexture=function(){return null},t.prototype.isReadyForSubMesh=function(e,t,n){if(this.isFrozen&&t.effect&&t.effect._wasPreviouslyReady)return!0;t._materialDefines||(t.materialDefines=new o);var r=t._materialDefines,a=this.getScene();if(this._isReadyForSubMesh(t))return!0;var s=a.getEngine();if(a.texturesEnabled){if(!this.mixTexture||!this.mixTexture.isReady())return!1;if(r._needUVs=!0,i.MaterialFlags.DiffuseTextureEnabled){if(!this.diffuseTexture1||!this.diffuseTexture1.isReady())return!1;if(!this.diffuseTexture2||!this.diffuseTexture2.isReady())return!1;if(!this.diffuseTexture3||!this.diffuseTexture3.isReady())return!1;r.DIFFUSE=!0}if(this.bumpTexture1&&this.bumpTexture2&&this.bumpTexture3&&i.MaterialFlags.BumpTextureEnabled){if(!this.bumpTexture1.isReady())return!1;if(!this.bumpTexture2.isReady())return!1;if(!this.bumpTexture3.isReady())return!1;r._needNormals=!0,r.BUMP=!0}}if(i.MaterialHelper.PrepareDefinesForMisc(e,a,!1,this.pointsCloud,this.fogEnabled,this._shouldTurnAlphaTestOn(e),r),r._needNormals=i.MaterialHelper.PrepareDefinesForLights(a,e,r,!1,this._maxSimultaneousLights,this._disableLighting),i.MaterialHelper.PrepareDefinesForFrameBoundValues(a,s,r,!!n),i.MaterialHelper.PrepareDefinesForAttributes(e,r,!0,!0),r.isDirty){r.markAsProcessed(),a.resetCachedMaterial();var l=new i.EffectFallbacks;r.FOG&&l.addFallback(1,"FOG"),i.MaterialHelper.HandleFallbacksForShadows(r,l,this.maxSimultaneousLights),r.NUM_BONE_INFLUENCERS>0&&l.addCPUSkinningFallback(0,e),r.IMAGEPROCESSINGPOSTPROCESS=a.imageProcessingConfiguration.applyByPostProcess;var c=[i.VertexBuffer.PositionKind];r.NORMAL&&c.push(i.VertexBuffer.NormalKind),r.UV1&&c.push(i.VertexBuffer.UVKind),r.UV2&&c.push(i.VertexBuffer.UV2Kind),r.VERTEXCOLOR&&c.push(i.VertexBuffer.ColorKind),i.MaterialHelper.PrepareAttributesForBones(c,e,r,l),i.MaterialHelper.PrepareAttributesForInstances(c,r);var u=r.toString(),_=["world","view","viewProjection","vEyePosition","vLightsType","vDiffuseColor","vSpecularColor","vFogInfos","vFogColor","pointSize","vTextureInfos","mBones","vClipPlane","vClipPlane2","vClipPlane3","vClipPlane4","vClipPlane5","vClipPlane6","textureMatrix","diffuse1Infos","diffuse2Infos","diffuse3Infos"],h=["textureSampler","diffuse1Sampler","diffuse2Sampler","diffuse3Sampler","bump1Sampler","bump2Sampler","bump3Sampler"],f=new Array;i.MaterialHelper.PrepareUniformsAndSamplersList({uniformsNames:_,uniformBuffersNames:f,samplers:h,defines:r,maxSimultaneousLights:this.maxSimultaneousLights}),t.setEffect(a.getEngine().createEffect("terrain",{attributes:c,uniformsNames:_,uniformBuffersNames:f,samplers:h,defines:u,fallbacks:l,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousLights:this.maxSimultaneousLights}},s),r,this._materialContext)}return!(!t.effect||!t.effect.isReady())&&(r._renderId=a.getRenderId(),t.effect._wasPreviouslyReady=!0,!0)},t.prototype.bindForSubMesh=function(e,t,n){var r=this.getScene(),o=n._materialDefines;if(o){var a=n.effect;a&&(this._activeEffect=a,this.bindOnlyWorldMatrix(e),this._activeEffect.setMatrix("viewProjection",r.getTransformMatrix()),i.MaterialHelper.BindBonesParameters(t,this._activeEffect),this._mustRebind(r,a)&&(this.mixTexture&&(this._activeEffect.setTexture("textureSampler",this._mixTexture),this._activeEffect.setFloat2("vTextureInfos",this._mixTexture.coordinatesIndex,this._mixTexture.level),this._activeEffect.setMatrix("textureMatrix",this._mixTexture.getTextureMatrix()),i.MaterialFlags.DiffuseTextureEnabled&&(this._diffuseTexture1&&(this._activeEffect.setTexture("diffuse1Sampler",this._diffuseTexture1),this._activeEffect.setFloat2("diffuse1Infos",this._diffuseTexture1.uScale,this._diffuseTexture1.vScale)),this._diffuseTexture2&&(this._activeEffect.setTexture("diffuse2Sampler",this._diffuseTexture2),this._activeEffect.setFloat2("diffuse2Infos",this._diffuseTexture2.uScale,this._diffuseTexture2.vScale)),this._diffuseTexture3&&(this._activeEffect.setTexture("diffuse3Sampler",this._diffuseTexture3),this._activeEffect.setFloat2("diffuse3Infos",this._diffuseTexture3.uScale,this._diffuseTexture3.vScale))),i.MaterialFlags.BumpTextureEnabled&&r.getEngine().getCaps().standardDerivatives&&(this._bumpTexture1&&this._activeEffect.setTexture("bump1Sampler",this._bumpTexture1),this._bumpTexture2&&this._activeEffect.setTexture("bump2Sampler",this._bumpTexture2),this._bumpTexture3&&this._activeEffect.setTexture("bump3Sampler",this._bumpTexture3))),i.MaterialHelper.BindClipPlane(this._activeEffect,r),this.pointsCloud&&this._activeEffect.setFloat("pointSize",this.pointSize),r.bindEyePosition(a)),this._activeEffect.setColor4("vDiffuseColor",this.diffuseColor,this.alpha*t.visibility),o.SPECULARTERM&&this._activeEffect.setColor4("vSpecularColor",this.specularColor,this.specularPower),r.lightsEnabled&&!this.disableLighting&&i.MaterialHelper.BindLights(r,t,this._activeEffect,o,this.maxSimultaneousLights),r.fogEnabled&&t.applyFog&&r.fogMode!==i.Scene.FOGMODE_NONE&&this._activeEffect.setMatrix("view",r.getViewMatrix()),i.MaterialHelper.BindFogParameters(r,t,this._activeEffect),this._afterBind(t,this._activeEffect))}},t.prototype.getAnimatables=function(){var e=[];return this.mixTexture&&this.mixTexture.animations&&this.mixTexture.animations.length>0&&e.push(this.mixTexture),e},t.prototype.getActiveTextures=function(){var t=e.prototype.getActiveTextures.call(this);return this._mixTexture&&t.push(this._mixTexture),this._diffuseTexture1&&t.push(this._diffuseTexture1),this._diffuseTexture2&&t.push(this._diffuseTexture2),this._diffuseTexture3&&t.push(this._diffuseTexture3),this._bumpTexture1&&t.push(this._bumpTexture1),this._bumpTexture2&&t.push(this._bumpTexture2),this._bumpTexture3&&t.push(this._bumpTexture3),t},t.prototype.hasTexture=function(t){return!!e.prototype.hasTexture.call(this,t)||(this._mixTexture===t||(this._diffuseTexture1===t||(this._diffuseTexture2===t||(this._diffuseTexture3===t||(this._bumpTexture1===t||(this._bumpTexture2===t||this._bumpTexture3===t))))))},t.prototype.dispose=function(t){this.mixTexture&&this.mixTexture.dispose(),e.prototype.dispose.call(this,t)},t.prototype.clone=function(e){var n=this;return i.SerializationHelper.Clone(function(){return new t(e,n.getScene())},this)},t.prototype.serialize=function(){var e=i.SerializationHelper.Serialize(this);return e.customType="BABYLON.TerrainMaterial",e},t.prototype.getClassName=function(){return"TerrainMaterial"},t.Parse=function(e,n,r){return i.SerializationHelper.Parse(function(){return new t(e.name,n)},e,n,r)},Object(r.__decorate)([Object(i.serializeAsTexture)("mixTexture")],t.prototype,"_mixTexture",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"mixTexture",void 0),Object(r.__decorate)([Object(i.serializeAsTexture)("diffuseTexture1")],t.prototype,"_diffuseTexture1",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"diffuseTexture1",void 0),Object(r.__decorate)([Object(i.serializeAsTexture)("diffuseTexture2")],t.prototype,"_diffuseTexture2",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"diffuseTexture2",void 0),Object(r.__decorate)([Object(i.serializeAsTexture)("diffuseTexture3")],t.prototype,"_diffuseTexture3",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"diffuseTexture3",void 0),Object(r.__decorate)([Object(i.serializeAsTexture)("bumpTexture1")],t.prototype,"_bumpTexture1",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"bumpTexture1",void 0),Object(r.__decorate)([Object(i.serializeAsTexture)("bumpTexture2")],t.prototype,"_bumpTexture2",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"bumpTexture2",void 0),Object(r.__decorate)([Object(i.serializeAsTexture)("bumpTexture3")],t.prototype,"_bumpTexture3",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"bumpTexture3",void 0),Object(r.__decorate)([Object(i.serializeAsColor3)()],t.prototype,"diffuseColor",void 0),Object(r.__decorate)([Object(i.serializeAsColor3)()],t.prototype,"specularColor",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"specularPower",void 0),Object(r.__decorate)([Object(i.serialize)("disableLighting")],t.prototype,"_disableLighting",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsLightsDirty")],t.prototype,"disableLighting",void 0),Object(r.__decorate)([Object(i.serialize)("maxSimultaneousLights")],t.prototype,"_maxSimultaneousLights",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsLightsDirty")],t.prototype,"maxSimultaneousLights",void 0),t}(i.PushMaterial);Object(i.RegisterClass)("BABYLON.TerrainMaterial",a)},"./triPlanar/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./triPlanar/triPlanarMaterial.ts");n.d(t,"TriPlanarMaterial",function(){return r.TriPlanarMaterial})},"./triPlanar/triPlanarMaterial.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"TriPlanarMaterial",function(){return a});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/decorators"),o=(n("./triPlanar/triplanar.fragment.ts"),n("./triPlanar/triplanar.vertex.ts"),function(e){function t(){var t=e.call(this)||this;return t.DIFFUSEX=!1,t.DIFFUSEY=!1,t.DIFFUSEZ=!1,t.BUMPX=!1,t.BUMPY=!1,t.BUMPZ=!1,t.CLIPPLANE=!1,t.CLIPPLANE2=!1,t.CLIPPLANE3=!1,t.CLIPPLANE4=!1,t.CLIPPLANE5=!1,t.CLIPPLANE6=!1,t.ALPHATEST=!1,t.DEPTHPREPASS=!1,t.POINTSIZE=!1,t.FOG=!1,t.SPECULARTERM=!1,t.NORMAL=!1,t.VERTEXCOLOR=!1,t.VERTEXALPHA=!1,t.NUM_BONE_INFLUENCERS=0,t.BonesPerMesh=0,t.INSTANCES=!1,t.IMAGEPROCESSINGPOSTPROCESS=!1,t.rebuild(),t}return Object(r.__extends)(t,e),t}(i.MaterialDefines)),a=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.tileSize=1,r.diffuseColor=new i.Color3(1,1,1),r.specularColor=new i.Color3(.2,.2,.2),r.specularPower=64,r._disableLighting=!1,r._maxSimultaneousLights=4,r}return Object(r.__extends)(t,e),t.prototype.needAlphaBlending=function(){return this.alpha<1},t.prototype.needAlphaTesting=function(){return!1},t.prototype.getAlphaTestTexture=function(){return null},t.prototype.isReadyForSubMesh=function(e,t,n){if(this.isFrozen&&t.effect&&t.effect._wasPreviouslyReady)return!0;t._materialDefines||(t.materialDefines=new o);var r=t._materialDefines,a=this.getScene();if(this._isReadyForSubMesh(t))return!0;var s=a.getEngine();if(r._areTexturesDirty&&a.texturesEnabled){if(i.MaterialFlags.DiffuseTextureEnabled)for(var l=[this.diffuseTextureX,this.diffuseTextureY,this.diffuseTextureZ],c=["DIFFUSEX","DIFFUSEY","DIFFUSEZ"],u=0;u<l.length;u++)if(l[u]){if(!l[u].isReady())return!1;r[c[u]]=!0}if(i.MaterialFlags.BumpTextureEnabled)for(l=[this.normalTextureX,this.normalTextureY,this.normalTextureZ],c=["BUMPX","BUMPY","BUMPZ"],u=0;u<l.length;u++)if(l[u]){if(!l[u].isReady())return!1;r[c[u]]=!0}}if(i.MaterialHelper.PrepareDefinesForMisc(e,a,!1,this.pointsCloud,this.fogEnabled,this._shouldTurnAlphaTestOn(e),r),r._needNormals=i.MaterialHelper.PrepareDefinesForLights(a,e,r,!1,this._maxSimultaneousLights,this._disableLighting),i.MaterialHelper.PrepareDefinesForFrameBoundValues(a,s,r,!!n),i.MaterialHelper.PrepareDefinesForAttributes(e,r,!0,!0),r.isDirty){r.markAsProcessed(),a.resetCachedMaterial();var _=new i.EffectFallbacks;r.FOG&&_.addFallback(1,"FOG"),i.MaterialHelper.HandleFallbacksForShadows(r,_,this.maxSimultaneousLights),r.NUM_BONE_INFLUENCERS>0&&_.addCPUSkinningFallback(0,e),r.IMAGEPROCESSINGPOSTPROCESS=a.imageProcessingConfiguration.applyByPostProcess;var h=[i.VertexBuffer.PositionKind];r.NORMAL&&h.push(i.VertexBuffer.NormalKind),r.VERTEXCOLOR&&h.push(i.VertexBuffer.ColorKind),i.MaterialHelper.PrepareAttributesForBones(h,e,r,_),i.MaterialHelper.PrepareAttributesForInstances(h,r);var f=r.toString(),d=["world","view","viewProjection","vEyePosition","vLightsType","vDiffuseColor","vSpecularColor","vFogInfos","vFogColor","pointSize","mBones","vClipPlane","vClipPlane2","vClipPlane3","vClipPlane4","vClipPlane5","vClipPlane6","tileSize"],p=["diffuseSamplerX","diffuseSamplerY","diffuseSamplerZ","normalSamplerX","normalSamplerY","normalSamplerZ"],m=new Array;i.MaterialHelper.PrepareUniformsAndSamplersList({uniformsNames:d,uniformBuffersNames:m,samplers:p,defines:r,maxSimultaneousLights:this.maxSimultaneousLights}),t.setEffect(a.getEngine().createEffect("triplanar",{attributes:h,uniformsNames:d,uniformBuffersNames:m,samplers:p,defines:f,fallbacks:_,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousLights:this.maxSimultaneousLights}},s),r,this._materialContext)}return!(!t.effect||!t.effect.isReady())&&(r._renderId=a.getRenderId(),t.effect._wasPreviouslyReady=!0,!0)},t.prototype.bindForSubMesh=function(e,t,n){var r=this.getScene(),o=n._materialDefines;if(o){var a=n.effect;a&&(this._activeEffect=a,this.bindOnlyWorldMatrix(e),this._activeEffect.setMatrix("viewProjection",r.getTransformMatrix()),i.MaterialHelper.BindBonesParameters(t,this._activeEffect),this._activeEffect.setFloat("tileSize",this.tileSize),r.getCachedMaterial()!==this&&(this.diffuseTextureX&&this._activeEffect.setTexture("diffuseSamplerX",this.diffuseTextureX),this.diffuseTextureY&&this._activeEffect.setTexture("diffuseSamplerY",this.diffuseTextureY),this.diffuseTextureZ&&this._activeEffect.setTexture("diffuseSamplerZ",this.diffuseTextureZ),this.normalTextureX&&this._activeEffect.setTexture("normalSamplerX",this.normalTextureX),this.normalTextureY&&this._activeEffect.setTexture("normalSamplerY",this.normalTextureY),this.normalTextureZ&&this._activeEffect.setTexture("normalSamplerZ",this.normalTextureZ),i.MaterialHelper.BindClipPlane(this._activeEffect,r),this.pointsCloud&&this._activeEffect.setFloat("pointSize",this.pointSize),r.bindEyePosition(a)),this._activeEffect.setColor4("vDiffuseColor",this.diffuseColor,this.alpha*t.visibility),o.SPECULARTERM&&this._activeEffect.setColor4("vSpecularColor",this.specularColor,this.specularPower),r.lightsEnabled&&!this.disableLighting&&i.MaterialHelper.BindLights(r,t,this._activeEffect,o,this.maxSimultaneousLights),r.fogEnabled&&t.applyFog&&r.fogMode!==i.Scene.FOGMODE_NONE&&this._activeEffect.setMatrix("view",r.getViewMatrix()),i.MaterialHelper.BindFogParameters(r,t,this._activeEffect),this._afterBind(t,this._activeEffect))}},t.prototype.getAnimatables=function(){var e=[];return this.mixTexture&&this.mixTexture.animations&&this.mixTexture.animations.length>0&&e.push(this.mixTexture),e},t.prototype.getActiveTextures=function(){var t=e.prototype.getActiveTextures.call(this);return this._diffuseTextureX&&t.push(this._diffuseTextureX),this._diffuseTextureY&&t.push(this._diffuseTextureY),this._diffuseTextureZ&&t.push(this._diffuseTextureZ),this._normalTextureX&&t.push(this._normalTextureX),this._normalTextureY&&t.push(this._normalTextureY),this._normalTextureZ&&t.push(this._normalTextureZ),t},t.prototype.hasTexture=function(t){return!!e.prototype.hasTexture.call(this,t)||(this._diffuseTextureX===t||(this._diffuseTextureY===t||(this._diffuseTextureZ===t||(this._normalTextureX===t||(this._normalTextureY===t||this._normalTextureZ===t)))))},t.prototype.dispose=function(t){this.mixTexture&&this.mixTexture.dispose(),e.prototype.dispose.call(this,t)},t.prototype.clone=function(e){var n=this;return i.SerializationHelper.Clone(function(){return new t(e,n.getScene())},this)},t.prototype.serialize=function(){var e=i.SerializationHelper.Serialize(this);return e.customType="BABYLON.TriPlanarMaterial",e},t.prototype.getClassName=function(){return"TriPlanarMaterial"},t.Parse=function(e,n,r){return i.SerializationHelper.Parse(function(){return new t(e.name,n)},e,n,r)},Object(r.__decorate)([Object(i.serializeAsTexture)()],t.prototype,"mixTexture",void 0),Object(r.__decorate)([Object(i.serializeAsTexture)("diffuseTextureX")],t.prototype,"_diffuseTextureX",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"diffuseTextureX",void 0),Object(r.__decorate)([Object(i.serializeAsTexture)("diffuseTexturY")],t.prototype,"_diffuseTextureY",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"diffuseTextureY",void 0),Object(r.__decorate)([Object(i.serializeAsTexture)("diffuseTextureZ")],t.prototype,"_diffuseTextureZ",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"diffuseTextureZ",void 0),Object(r.__decorate)([Object(i.serializeAsTexture)("normalTextureX")],t.prototype,"_normalTextureX",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"normalTextureX",void 0),Object(r.__decorate)([Object(i.serializeAsTexture)("normalTextureY")],t.prototype,"_normalTextureY",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"normalTextureY",void 0),Object(r.__decorate)([Object(i.serializeAsTexture)("normalTextureZ")],t.prototype,"_normalTextureZ",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"normalTextureZ",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"tileSize",void 0),Object(r.__decorate)([Object(i.serializeAsColor3)()],t.prototype,"diffuseColor",void 0),Object(r.__decorate)([Object(i.serializeAsColor3)()],t.prototype,"specularColor",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"specularPower",void 0),Object(r.__decorate)([Object(i.serialize)("disableLighting")],t.prototype,"_disableLighting",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsLightsDirty")],t.prototype,"disableLighting",void 0),Object(r.__decorate)([Object(i.serialize)("maxSimultaneousLights")],t.prototype,"_maxSimultaneousLights",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsLightsDirty")],t.prototype,"maxSimultaneousLights",void 0),t}(i.PushMaterial);Object(i.RegisterClass)("BABYLON.TriPlanarMaterial",a)},"./triPlanar/triplanar.fragment.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"triplanarPixelShader",function(){return a});var r=n("babylonjs/Misc/decorators"),i="triplanarPixelShader",o="precision highp float;\n\nuniform vec4 vEyePosition;\nuniform vec4 vDiffuseColor;\n#ifdef SPECULARTERM\nuniform vec4 vSpecularColor;\n#endif\n\nvarying vec3 vPositionW;\n#ifdef VERTEXCOLOR\nvarying vec4 vColor;\n#endif\n\n#include<helperFunctions>\n\n#include<__decl__lightFragment>[0..maxSimultaneousLights]\n\n#ifdef DIFFUSEX\nvarying vec2 vTextureUVX;\nuniform sampler2D diffuseSamplerX;\n#ifdef BUMPX\nuniform sampler2D normalSamplerX;\n#endif\n#endif\n#ifdef DIFFUSEY\nvarying vec2 vTextureUVY;\nuniform sampler2D diffuseSamplerY;\n#ifdef BUMPY\nuniform sampler2D normalSamplerY;\n#endif\n#endif\n#ifdef DIFFUSEZ\nvarying vec2 vTextureUVZ;\nuniform sampler2D diffuseSamplerZ;\n#ifdef BUMPZ\nuniform sampler2D normalSamplerZ;\n#endif\n#endif\n#ifdef NORMAL\nvarying mat3 tangentSpace;\n#endif\n#include<lightsFragmentFunctions>\n#include<shadowsFragmentFunctions>\n#include<clipPlaneFragmentDeclaration>\n#include<fogFragmentDeclaration>\nvoid main(void) {\n\n#include<clipPlaneFragment>\nvec3 viewDirectionW=normalize(vEyePosition.xyz-vPositionW);\n\nvec4 baseColor=vec4(0.,0.,0.,1.);\nvec3 diffuseColor=vDiffuseColor.rgb;\n\nfloat alpha=vDiffuseColor.a;\n\n#ifdef NORMAL\nvec3 normalW=tangentSpace[2];\n#else\nvec3 normalW=vec3(1.0,1.0,1.0);\n#endif\nvec4 baseNormal=vec4(0.0,0.0,0.0,1.0);\nnormalW*=normalW;\n#ifdef DIFFUSEX\nbaseColor+=texture2D(diffuseSamplerX,vTextureUVX)*normalW.x;\n#ifdef BUMPX\nbaseNormal+=texture2D(normalSamplerX,vTextureUVX)*normalW.x;\n#endif\n#endif\n#ifdef DIFFUSEY\nbaseColor+=texture2D(diffuseSamplerY,vTextureUVY)*normalW.y;\n#ifdef BUMPY\nbaseNormal+=texture2D(normalSamplerY,vTextureUVY)*normalW.y;\n#endif\n#endif\n#ifdef DIFFUSEZ\nbaseColor+=texture2D(diffuseSamplerZ,vTextureUVZ)*normalW.z;\n#ifdef BUMPZ\nbaseNormal+=texture2D(normalSamplerZ,vTextureUVZ)*normalW.z;\n#endif\n#endif\n#ifdef NORMAL\nnormalW=normalize((2.0*baseNormal.xyz-1.0)*tangentSpace);\n#endif\n#ifdef ALPHATEST\nif (baseColor.a<0.4)\ndiscard;\n#endif\n#include<depthPrePass>\n#ifdef VERTEXCOLOR\nbaseColor.rgb*=vColor.rgb;\n#endif\n\nvec3 diffuseBase=vec3(0.,0.,0.);\nlightingInfo info;\nfloat shadow=1.;\n#ifdef SPECULARTERM\nfloat glossiness=vSpecularColor.a;\nvec3 specularBase=vec3(0.,0.,0.);\nvec3 specularColor=vSpecularColor.rgb;\n#else\nfloat glossiness=0.;\n#endif\n#include<lightFragment>[0..maxSimultaneousLights]\n#ifdef VERTEXALPHA\nalpha*=vColor.a;\n#endif\n#ifdef SPECULARTERM\nvec3 finalSpecular=specularBase*specularColor;\n#else\nvec3 finalSpecular=vec3(0.0);\n#endif\nvec3 finalDiffuse=clamp(diffuseBase*diffuseColor,0.0,1.0)*baseColor.rgb;\n\nvec4 color=vec4(finalDiffuse+finalSpecular,alpha);\n#include<fogFragment>\ngl_FragColor=color;\n#include<imageProcessingCompatibility>\n}\n";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./triPlanar/triplanar.vertex.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"triplanarVertexShader",function(){return a});var r=n("babylonjs/Misc/decorators"),i="triplanarVertexShader",o="precision highp float;\n\nattribute vec3 position;\n#ifdef NORMAL\nattribute vec3 normal;\n#endif\n#ifdef VERTEXCOLOR\nattribute vec4 color;\n#endif\n#include<bonesDeclaration>\n\n#include<instancesDeclaration>\nuniform mat4 view;\nuniform mat4 viewProjection;\n#ifdef DIFFUSEX\nvarying vec2 vTextureUVX;\n#endif\n#ifdef DIFFUSEY\nvarying vec2 vTextureUVY;\n#endif\n#ifdef DIFFUSEZ\nvarying vec2 vTextureUVZ;\n#endif\nuniform float tileSize;\n#ifdef POINTSIZE\nuniform float pointSize;\n#endif\n\nvarying vec3 vPositionW;\n#ifdef NORMAL\nvarying mat3 tangentSpace;\n#endif\n#ifdef VERTEXCOLOR\nvarying vec4 vColor;\n#endif\n#include<clipPlaneVertexDeclaration>\n#include<fogVertexDeclaration>\n#include<__decl__lightFragment>[0..maxSimultaneousLights]\nvoid main(void)\n{\n#include<instancesVertex>\n#include<bonesVertex>\nvec4 worldPos=finalWorld*vec4(position,1.0);\ngl_Position=viewProjection*worldPos;\nvPositionW=vec3(worldPos);\n#ifdef DIFFUSEX\nvTextureUVX=worldPos.zy/tileSize;\n#endif\n#ifdef DIFFUSEY\nvTextureUVY=worldPos.xz/tileSize;\n#endif\n#ifdef DIFFUSEZ\nvTextureUVZ=worldPos.xy/tileSize;\n#endif\n#ifdef NORMAL\n\nvec3 xtan=vec3(0,0,1);\nvec3 xbin=vec3(0,1,0);\nvec3 ytan=vec3(1,0,0);\nvec3 ybin=vec3(0,0,1);\nvec3 ztan=vec3(1,0,0);\nvec3 zbin=vec3(0,1,0);\nvec3 normalizedNormal=normalize(normal);\nnormalizedNormal*=normalizedNormal;\nvec3 worldBinormal=normalize(xbin*normalizedNormal.x+ybin*normalizedNormal.y+zbin*normalizedNormal.z);\nvec3 worldTangent=normalize(xtan*normalizedNormal.x+ytan*normalizedNormal.y+ztan*normalizedNormal.z);\nworldTangent=(world*vec4(worldTangent,0.0)).xyz;\nworldBinormal=(world*vec4(worldBinormal,0.0)).xyz;\nvec3 worldNormal=(world*vec4(normalize(normal),0.0)).xyz;\ntangentSpace[0]=worldTangent;\ntangentSpace[1]=worldBinormal;\ntangentSpace[2]=worldNormal;\n#endif\n\n#include<clipPlaneVertex>\n\n#include<fogVertex>\n\n#include<shadowsVertex>[0..maxSimultaneousLights]\n\n#ifdef VERTEXCOLOR\nvColor=color;\n#endif\n\n#ifdef POINTSIZE\ngl_PointSize=pointSize;\n#endif\n}\n";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./water/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./water/waterMaterial.ts");n.d(t,"WaterMaterial",function(){return r.WaterMaterial})},"./water/water.fragment.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"waterPixelShader",function(){return a});var r=n("babylonjs/Misc/decorators"),i="waterPixelShader",o="#ifdef LOGARITHMICDEPTH\n#extension GL_EXT_frag_depth : enable\n#endif\nprecision highp float;\n\nuniform vec4 vEyePosition;\nuniform vec4 vDiffuseColor;\n#ifdef SPECULARTERM\nuniform vec4 vSpecularColor;\n#endif\n\nvarying vec3 vPositionW;\n#ifdef NORMAL\nvarying vec3 vNormalW;\n#endif\n#ifdef VERTEXCOLOR\nvarying vec4 vColor;\n#endif\n\n#include<helperFunctions>\n#include<imageProcessingDeclaration>\n#include<imageProcessingFunctions>\n\n#include<__decl__lightFragment>[0..maxSimultaneousLights]\n#include<lightsFragmentFunctions>\n#include<shadowsFragmentFunctions>\n\n#ifdef BUMP\nvarying vec2 vNormalUV;\n#ifdef BUMPSUPERIMPOSE\nvarying vec2 vNormalUV2;\n#endif\nuniform sampler2D normalSampler;\nuniform vec2 vNormalInfos;\n#endif\nuniform sampler2D refractionSampler;\nuniform sampler2D reflectionSampler;\n\nconst float LOG2=1.442695;\nuniform vec3 cameraPosition;\nuniform vec4 waterColor;\nuniform float colorBlendFactor;\nuniform vec4 waterColor2;\nuniform float colorBlendFactor2;\nuniform float bumpHeight;\nuniform float time;\n\nvarying vec3 vRefractionMapTexCoord;\nvarying vec3 vReflectionMapTexCoord;\nvarying vec3 vPosition;\n#include<clipPlaneFragmentDeclaration>\n#include<logDepthDeclaration>\n\n#include<fogFragmentDeclaration>\nvoid main(void) {\n\n#include<clipPlaneFragment>\nvec3 viewDirectionW=normalize(vEyePosition.xyz-vPositionW);\n\nvec4 baseColor=vec4(1.,1.,1.,1.);\nvec3 diffuseColor=vDiffuseColor.rgb;\n\nfloat alpha=vDiffuseColor.a;\n#ifdef BUMP\n#ifdef BUMPSUPERIMPOSE\nbaseColor=0.6*texture2D(normalSampler,vNormalUV)+0.4*texture2D(normalSampler,vec2(vNormalUV2.x,vNormalUV2.y));\n#else\nbaseColor=texture2D(normalSampler,vNormalUV);\n#endif\nvec3 bumpColor=baseColor.rgb;\n#ifdef ALPHATEST\nif (baseColor.a<0.4)\ndiscard;\n#endif\nbaseColor.rgb*=vNormalInfos.y;\n#else\nvec3 bumpColor=vec3(1.0);\n#endif\n#ifdef VERTEXCOLOR\nbaseColor.rgb*=vColor.rgb;\n#endif\n\n#ifdef NORMAL\nvec2 perturbation=bumpHeight*(baseColor.rg-0.5);\n#ifdef BUMPAFFECTSREFLECTION\nvec3 normalW=normalize(vNormalW+vec3(perturbation.x*8.0,0.0,perturbation.y*8.0));\nif (normalW.y<0.0) {\nnormalW.y=-normalW.y;\n}\n#else\nvec3 normalW=normalize(vNormalW);\n#endif\n#else\nvec3 normalW=vec3(1.0,1.0,1.0);\nvec2 perturbation=bumpHeight*(vec2(1.0,1.0)-0.5);\n#endif\n#ifdef FRESNELSEPARATE\n#ifdef REFLECTION\n\nvec2 projectedRefractionTexCoords=clamp(vRefractionMapTexCoord.xy/vRefractionMapTexCoord.z+perturbation*0.5,0.0,1.0);\nvec4 refractiveColor=texture2D(refractionSampler,projectedRefractionTexCoords);\n#ifdef IS_REFRACTION_LINEAR\nrefractiveColor.rgb=toGammaSpace(refractiveColor.rgb);\n#endif\nvec2 projectedReflectionTexCoords=clamp(vec2(\nvReflectionMapTexCoord.x/vReflectionMapTexCoord.z+perturbation.x*0.3,\nvReflectionMapTexCoord.y/vReflectionMapTexCoord.z+perturbation.y\n),0.0,1.0);\nvec4 reflectiveColor=texture2D(reflectionSampler,projectedReflectionTexCoords);\n#ifdef IS_REFLECTION_LINEAR\nreflectiveColor.rgb=toGammaSpace(reflectiveColor.rgb);\n#endif\nvec3 upVector=vec3(0.0,1.0,0.0);\nfloat fresnelTerm=clamp(abs(pow(dot(viewDirectionW,upVector),3.0)),0.05,0.65);\nfloat IfresnelTerm=1.0-fresnelTerm;\nrefractiveColor=colorBlendFactor*waterColor+(1.0-colorBlendFactor)*refractiveColor;\nreflectiveColor=IfresnelTerm*colorBlendFactor2*waterColor+(1.0-colorBlendFactor2*IfresnelTerm)*reflectiveColor;\nvec4 combinedColor=refractiveColor*fresnelTerm+reflectiveColor*IfresnelTerm;\nbaseColor=combinedColor;\n#endif\n\nvec3 diffuseBase=vec3(0.,0.,0.);\nlightingInfo info;\nfloat shadow=1.;\n#ifdef SPECULARTERM\nfloat glossiness=vSpecularColor.a;\nvec3 specularBase=vec3(0.,0.,0.);\nvec3 specularColor=vSpecularColor.rgb;\n#else\nfloat glossiness=0.;\n#endif\n#include<lightFragment>[0..maxSimultaneousLights]\nvec3 finalDiffuse=clamp(baseColor.rgb,0.0,1.0);\n#ifdef VERTEXALPHA\nalpha*=vColor.a;\n#endif\n#ifdef SPECULARTERM\nvec3 finalSpecular=specularBase*specularColor;\n#else\nvec3 finalSpecular=vec3(0.0);\n#endif\n#else\n#ifdef REFLECTION\n\nvec2 projectedRefractionTexCoords=clamp(vRefractionMapTexCoord.xy/vRefractionMapTexCoord.z+perturbation,0.0,1.0);\nvec4 refractiveColor=texture2D(refractionSampler,projectedRefractionTexCoords);\n#ifdef IS_REFRACTION_LINEAR\nrefractiveColor.rgb=toGammaSpace(refractiveColor.rgb);\n#endif\nvec2 projectedReflectionTexCoords=clamp(vReflectionMapTexCoord.xy/vReflectionMapTexCoord.z+perturbation,0.0,1.0);\nvec4 reflectiveColor=texture2D(reflectionSampler,projectedReflectionTexCoords);\n#ifdef IS_REFLECTION_LINEAR\nreflectiveColor.rgb=toGammaSpace(reflectiveColor.rgb);\n#endif\nvec3 upVector=vec3(0.0,1.0,0.0);\nfloat fresnelTerm=max(dot(viewDirectionW,upVector),0.0);\nvec4 combinedColor=refractiveColor*fresnelTerm+reflectiveColor*(1.0-fresnelTerm);\nbaseColor=colorBlendFactor*waterColor+(1.0-colorBlendFactor)*combinedColor;\n#endif\n\nvec3 diffuseBase=vec3(0.,0.,0.);\nlightingInfo info;\nfloat shadow=1.;\n#ifdef SPECULARTERM\nfloat glossiness=vSpecularColor.a;\nvec3 specularBase=vec3(0.,0.,0.);\nvec3 specularColor=vSpecularColor.rgb;\n#else\nfloat glossiness=0.;\n#endif\n#include<lightFragment>[0..maxSimultaneousLights]\nvec3 finalDiffuse=clamp(baseColor.rgb,0.0,1.0);\n#ifdef VERTEXALPHA\nalpha*=vColor.a;\n#endif\n#ifdef SPECULARTERM\nvec3 finalSpecular=specularBase*specularColor;\n#else\nvec3 finalSpecular=vec3(0.0);\n#endif\n#endif\n\nvec4 color=vec4(finalDiffuse+finalSpecular,alpha);\n#include<logDepthFragment>\n#include<fogFragment>\n\n\n#ifdef IMAGEPROCESSINGPOSTPROCESS\ncolor.rgb=toLinearSpace(color.rgb);\n#elif defined(IMAGEPROCESSING)\ncolor.rgb=toLinearSpace(color.rgb);\ncolor=applyImageProcessing(color);\n#endif\ngl_FragColor=color;\n}\n";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./water/water.vertex.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"waterVertexShader",function(){return a});var r=n("babylonjs/Misc/decorators"),i="waterVertexShader",o="precision highp float;\n\nattribute vec3 position;\n#ifdef NORMAL\nattribute vec3 normal;\n#endif\n#ifdef UV1\nattribute vec2 uv;\n#endif\n#ifdef UV2\nattribute vec2 uv2;\n#endif\n#ifdef VERTEXCOLOR\nattribute vec4 color;\n#endif\n#include<bonesDeclaration>\n\n#include<instancesDeclaration>\nuniform mat4 view;\nuniform mat4 viewProjection;\n#ifdef BUMP\nvarying vec2 vNormalUV;\n#ifdef BUMPSUPERIMPOSE\nvarying vec2 vNormalUV2;\n#endif\nuniform mat4 normalMatrix;\nuniform vec2 vNormalInfos;\n#endif\n#ifdef POINTSIZE\nuniform float pointSize;\n#endif\n\nvarying vec3 vPositionW;\n#ifdef NORMAL\nvarying vec3 vNormalW;\n#endif\n#ifdef VERTEXCOLOR\nvarying vec4 vColor;\n#endif\n#include<clipPlaneVertexDeclaration>\n#include<fogVertexDeclaration>\n#include<__decl__lightFragment>[0..maxSimultaneousLights]\n#include<logDepthDeclaration>\n\nuniform mat4 worldReflectionViewProjection;\nuniform vec2 windDirection;\nuniform float waveLength;\nuniform float time;\nuniform float windForce;\nuniform float waveHeight;\nuniform float waveSpeed;\nuniform float waveCount;\n\nvarying vec3 vPosition;\nvarying vec3 vRefractionMapTexCoord;\nvarying vec3 vReflectionMapTexCoord;\nvoid main(void) {\n#include<instancesVertex>\n#include<bonesVertex>\nvec4 worldPos=finalWorld*vec4(position,1.0);\nvPositionW=vec3(worldPos);\n#ifdef NORMAL\nvNormalW=normalize(vec3(finalWorld*vec4(normal,0.0)));\n#endif\n\n#ifndef UV1\nvec2 uv=vec2(0.,0.);\n#endif\n#ifndef UV2\nvec2 uv2=vec2(0.,0.);\n#endif\n#ifdef BUMP\nif (vNormalInfos.x == 0.)\n{\nvNormalUV=vec2(normalMatrix*vec4((uv*1.0)/waveLength+time*windForce*windDirection,1.0,0.0));\n#ifdef BUMPSUPERIMPOSE\nvNormalUV2=vec2(normalMatrix*vec4((uv*0.721)/waveLength+time*1.2*windForce*windDirection,1.0,0.0));\n#endif\n}\nelse\n{\nvNormalUV=vec2(normalMatrix*vec4((uv2*1.0)/waveLength+time*windForce*windDirection ,1.0,0.0));\n#ifdef BUMPSUPERIMPOSE\nvNormalUV2=vec2(normalMatrix*vec4((uv2*0.721)/waveLength+time*1.2*windForce*windDirection ,1.0,0.0));\n#endif\n}\n#endif\n\n#include<clipPlaneVertex>\n\n#include<fogVertex>\n\n#include<shadowsVertex>[0..maxSimultaneousLights]\n\n#ifdef VERTEXCOLOR\nvColor=color;\n#endif\n\n#ifdef POINTSIZE\ngl_PointSize=pointSize;\n#endif\nfloat finalWaveCount=1.0/(waveCount*0.5);\nvec3 p=position;\nfloat newY=(sin(((p.x/finalWaveCount)+time*waveSpeed))*waveHeight*windDirection.x*5.0)\n+(cos(((p.z/finalWaveCount)+time*waveSpeed))*waveHeight*windDirection.y*5.0);\np.y+=abs(newY);\ngl_Position=viewProjection*finalWorld*vec4(p,1.0);\n#ifdef REFLECTION\nworldPos=viewProjection*finalWorld*vec4(p,1.0);\n\nvPosition=position;\nvRefractionMapTexCoord.x=0.5*(worldPos.w+worldPos.x);\nvRefractionMapTexCoord.y=0.5*(worldPos.w+worldPos.y);\nvRefractionMapTexCoord.z=worldPos.w;\nworldPos=worldReflectionViewProjection*vec4(position,1.0);\nvReflectionMapTexCoord.x=0.5*(worldPos.w+worldPos.x);\nvReflectionMapTexCoord.y=0.5*(worldPos.w+worldPos.y);\nvReflectionMapTexCoord.z=worldPos.w;\n#endif\n#include<logDepthVertex>\n}\n";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./water/waterMaterial.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"WaterMaterial",function(){return a});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/decorators"),o=(n("./water/water.fragment.ts"),n("./water/water.vertex.ts"),function(e){function t(){var t=e.call(this)||this;return t.BUMP=!1,t.REFLECTION=!1,t.CLIPPLANE=!1,t.CLIPPLANE2=!1,t.CLIPPLANE3=!1,t.CLIPPLANE4=!1,t.CLIPPLANE5=!1,t.CLIPPLANE6=!1,t.ALPHATEST=!1,t.DEPTHPREPASS=!1,t.POINTSIZE=!1,t.FOG=!1,t.NORMAL=!1,t.UV1=!1,t.UV2=!1,t.VERTEXCOLOR=!1,t.VERTEXALPHA=!1,t.NUM_BONE_INFLUENCERS=0,t.BonesPerMesh=0,t.INSTANCES=!1,t.SPECULARTERM=!1,t.LOGARITHMICDEPTH=!1,t.USE_REVERSE_DEPTHBUFFER=!1,t.FRESNELSEPARATE=!1,t.BUMPSUPERIMPOSE=!1,t.BUMPAFFECTSREFLECTION=!1,t.IMAGEPROCESSING=!1,t.VIGNETTE=!1,t.VIGNETTEBLENDMODEMULTIPLY=!1,t.VIGNETTEBLENDMODEOPAQUE=!1,t.TONEMAPPING=!1,t.TONEMAPPING_ACES=!1,t.CONTRAST=!1,t.EXPOSURE=!1,t.COLORCURVES=!1,t.COLORGRADING=!1,t.COLORGRADING3D=!1,t.SAMPLER3DGREENDEPTH=!1,t.SAMPLER3DBGRMAP=!1,t.IMAGEPROCESSINGPOSTPROCESS=!1,t.rebuild(),t}return Object(r.__extends)(t,e),t}(i.MaterialDefines)),a=function(e){function t(t,n,r){void 0===r&&(r=new i.Vector2(512,512));var o=e.call(this,t,n)||this;return o.renderTargetSize=r,o.diffuseColor=new i.Color3(1,1,1),o.specularColor=new i.Color3(0,0,0),o.specularPower=64,o._disableLighting=!1,o._maxSimultaneousLights=4,o.windForce=6,o.windDirection=new i.Vector2(0,1),o.waveHeight=.4,o.bumpHeight=.4,o._bumpSuperimpose=!1,o._fresnelSeparate=!1,o._bumpAffectsReflection=!1,o.waterColor=new i.Color3(.1,.1,.6),o.colorBlendFactor=.2,o.waterColor2=new i.Color3(.1,.1,.6),o.colorBlendFactor2=.2,o.waveLength=.1,o.waveSpeed=1,o.waveCount=20,o.disableClipPlane=!1,o._renderTargets=new i.SmartArray(16),o._mesh=null,o._reflectionTransform=i.Matrix.Zero(),o._lastTime=0,o._lastDeltaTime=0,o._createRenderTargets(n,r),o.getRenderTargetTextures=function(){return o._renderTargets.reset(),o._renderTargets.push(o._reflectionRTT),o._renderTargets.push(o._refractionRTT),o._renderTargets},o._imageProcessingConfiguration=o.getScene().imageProcessingConfiguration,o._imageProcessingConfiguration&&(o._imageProcessingObserver=o._imageProcessingConfiguration.onUpdateParameters.add(function(){o._markAllSubMeshesAsImageProcessingDirty()})),o}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"hasRenderTargetTextures",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"useLogarithmicDepth",{get:function(){return this._useLogarithmicDepth},set:function(e){this._useLogarithmicDepth=e&&this.getScene().getEngine().getCaps().fragmentDepthSupported,this._markAllSubMeshesAsMiscDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"refractionTexture",{get:function(){return this._refractionRTT},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"reflectionTexture",{get:function(){return this._reflectionRTT},enumerable:!1,configurable:!0}),t.prototype.addToRenderList=function(e){this._refractionRTT&&this._refractionRTT.renderList&&this._refractionRTT.renderList.push(e),this._reflectionRTT&&this._reflectionRTT.renderList&&this._reflectionRTT.renderList.push(e)},t.prototype.enableRenderTargets=function(e){var t=e?1:0;this._refractionRTT&&(this._refractionRTT.refreshRate=t),this._reflectionRTT&&(this._reflectionRTT.refreshRate=t)},t.prototype.getRenderList=function(){return this._refractionRTT?this._refractionRTT.renderList:[]},Object.defineProperty(t.prototype,"renderTargetsEnabled",{get:function(){return!(this._refractionRTT&&0===this._refractionRTT.refreshRate)},enumerable:!1,configurable:!0}),t.prototype.needAlphaBlending=function(){return this.alpha<1},t.prototype.needAlphaTesting=function(){return!1},t.prototype.getAlphaTestTexture=function(){return null},t.prototype.isReadyForSubMesh=function(e,t,n){if(this.isFrozen&&t.effect&&t.effect._wasPreviouslyReady)return!0;t._materialDefines||(t.materialDefines=new o);var r=t._materialDefines,a=this.getScene();if(this._isReadyForSubMesh(t))return!0;var s=a.getEngine();if(r._areTexturesDirty&&(r._needUVs=!1,a.texturesEnabled)){if(this.bumpTexture&&i.MaterialFlags.BumpTextureEnabled){if(!this.bumpTexture.isReady())return!1;r._needUVs=!0,r.BUMP=!0}i.MaterialFlags.ReflectionTextureEnabled&&(r.REFLECTION=!0)}if(i.MaterialHelper.PrepareDefinesForFrameBoundValues(a,s,r,!!n),i.MaterialHelper.PrepareDefinesForMisc(e,a,this._useLogarithmicDepth,this.pointsCloud,this.fogEnabled,this._shouldTurnAlphaTestOn(e),r),r._areMiscDirty&&(this._fresnelSeparate&&(r.FRESNELSEPARATE=!0),this._bumpSuperimpose&&(r.BUMPSUPERIMPOSE=!0),this._bumpAffectsReflection&&(r.BUMPAFFECTSREFLECTION=!0)),r._needNormals=i.MaterialHelper.PrepareDefinesForLights(a,e,r,!0,this._maxSimultaneousLights,this._disableLighting),r._areImageProcessingDirty&&this._imageProcessingConfiguration){if(!this._imageProcessingConfiguration.isReady())return!1;this._imageProcessingConfiguration.prepareDefines(r),r.IS_REFLECTION_LINEAR=null!=this.reflectionTexture&&!this.reflectionTexture.gammaSpace,r.IS_REFRACTION_LINEAR=null!=this.refractionTexture&&!this.refractionTexture.gammaSpace}if(i.MaterialHelper.PrepareDefinesForAttributes(e,r,!0,!0),this._mesh=e,this._waitingRenderList){for(var l=0;l<this._waitingRenderList.length;l++)this.addToRenderList(a.getNodeById(this._waitingRenderList[l]));this._waitingRenderList=null}if(r.isDirty){r.markAsProcessed(),a.resetCachedMaterial();var c=new i.EffectFallbacks;r.FOG&&c.addFallback(1,"FOG"),r.LOGARITHMICDEPTH&&c.addFallback(0,"LOGARITHMICDEPTH"),i.MaterialHelper.HandleFallbacksForShadows(r,c,this.maxSimultaneousLights),r.NUM_BONE_INFLUENCERS>0&&c.addCPUSkinningFallback(0,e);var u=[i.VertexBuffer.PositionKind];r.NORMAL&&u.push(i.VertexBuffer.NormalKind),r.UV1&&u.push(i.VertexBuffer.UVKind),r.UV2&&u.push(i.VertexBuffer.UV2Kind),r.VERTEXCOLOR&&u.push(i.VertexBuffer.ColorKind),i.MaterialHelper.PrepareAttributesForBones(u,e,r,c),i.MaterialHelper.PrepareAttributesForInstances(u,r);var _=r.toString(),h=["world","view","viewProjection","vEyePosition","vLightsType","vDiffuseColor","vSpecularColor","vFogInfos","vFogColor","pointSize","vNormalInfos","mBones","vClipPlane","vClipPlane2","vClipPlane3","vClipPlane4","vClipPlane5","vClipPlane6","normalMatrix","logarithmicDepthConstant","worldReflectionViewProjection","windDirection","waveLength","time","windForce","cameraPosition","bumpHeight","waveHeight","waterColor","waterColor2","colorBlendFactor","colorBlendFactor2","waveSpeed","waveCount"],f=["normalSampler","refractionSampler","reflectionSampler"],d=new Array;i.ImageProcessingConfiguration&&(i.ImageProcessingConfiguration.PrepareUniforms(h,r),i.ImageProcessingConfiguration.PrepareSamplers(f,r)),i.MaterialHelper.PrepareUniformsAndSamplersList({uniformsNames:h,uniformBuffersNames:d,samplers:f,defines:r,maxSimultaneousLights:this.maxSimultaneousLights}),t.setEffect(a.getEngine().createEffect("water",{attributes:u,uniformsNames:h,uniformBuffersNames:d,samplers:f,defines:_,fallbacks:c,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousLights:this._maxSimultaneousLights}},s),r,this._materialContext)}return!(!t.effect||!t.effect.isReady())&&(r._renderId=a.getRenderId(),t.effect._wasPreviouslyReady=!0,!0)},t.prototype.bindForSubMesh=function(e,t,n){var r=this.getScene(),o=n._materialDefines;if(o){var a=n.effect;if(a&&this._mesh){this._activeEffect=a,this.bindOnlyWorldMatrix(e),this._activeEffect.setMatrix("viewProjection",r.getTransformMatrix()),i.MaterialHelper.BindBonesParameters(t,this._activeEffect),this._mustRebind(r,a)&&(this.bumpTexture&&i.MaterialFlags.BumpTextureEnabled&&(this._activeEffect.setTexture("normalSampler",this.bumpTexture),this._activeEffect.setFloat2("vNormalInfos",this.bumpTexture.coordinatesIndex,this.bumpTexture.level),this._activeEffect.setMatrix("normalMatrix",this.bumpTexture.getTextureMatrix())),i.MaterialHelper.BindClipPlane(this._activeEffect,r),this.pointsCloud&&this._activeEffect.setFloat("pointSize",this.pointSize),r.bindEyePosition(a)),this._activeEffect.setColor4("vDiffuseColor",this.diffuseColor,this.alpha*t.visibility),o.SPECULARTERM&&this._activeEffect.setColor4("vSpecularColor",this.specularColor,this.specularPower),r.lightsEnabled&&!this.disableLighting&&i.MaterialHelper.BindLights(r,t,this._activeEffect,o,this.maxSimultaneousLights),r.fogEnabled&&t.applyFog&&r.fogMode!==i.Scene.FOGMODE_NONE&&this._activeEffect.setMatrix("view",r.getViewMatrix()),i.MaterialHelper.BindFogParameters(r,t,this._activeEffect),i.MaterialHelper.BindLogDepth(o,this._activeEffect,r),i.MaterialFlags.ReflectionTextureEnabled&&(this._activeEffect.setTexture("refractionSampler",this._refractionRTT),this._activeEffect.setTexture("reflectionSampler",this._reflectionRTT));var s=this._mesh.getWorldMatrix().multiply(this._reflectionTransform).multiply(r.getProjectionMatrix()),l=r.getEngine().getDeltaTime();l!==this._lastDeltaTime&&(this._lastDeltaTime=l,this._lastTime+=this._lastDeltaTime),this._activeEffect.setMatrix("worldReflectionViewProjection",s),this._activeEffect.setVector2("windDirection",this.windDirection),this._activeEffect.setFloat("waveLength",this.waveLength),this._activeEffect.setFloat("time",this._lastTime/1e5),this._activeEffect.setFloat("windForce",this.windForce),this._activeEffect.setFloat("waveHeight",this.waveHeight),this._activeEffect.setFloat("bumpHeight",this.bumpHeight),this._activeEffect.setColor4("waterColor",this.waterColor,1),this._activeEffect.setFloat("colorBlendFactor",this.colorBlendFactor),this._activeEffect.setColor4("waterColor2",this.waterColor2,1),this._activeEffect.setFloat("colorBlendFactor2",this.colorBlendFactor2),this._activeEffect.setFloat("waveSpeed",this.waveSpeed),this._activeEffect.setFloat("waveCount",this.waveCount),this._imageProcessingConfiguration&&!this._imageProcessingConfiguration.applyByPostProcess&&this._imageProcessingConfiguration.bind(this._activeEffect),this._afterBind(t,this._activeEffect)}}},t.prototype._createRenderTargets=function(e,t){var n,r=this;this._refractionRTT=new i.RenderTargetTexture(name+"_refraction",{width:t.x,height:t.y},e,!1,!0),this._refractionRTT.wrapU=i.Constants.TEXTURE_MIRROR_ADDRESSMODE,this._refractionRTT.wrapV=i.Constants.TEXTURE_MIRROR_ADDRESSMODE,this._refractionRTT.ignoreCameraViewport=!0,this._reflectionRTT=new i.RenderTargetTexture(name+"_reflection",{width:t.x,height:t.y},e,!1,!0),this._reflectionRTT.wrapU=i.Constants.TEXTURE_MIRROR_ADDRESSMODE,this._reflectionRTT.wrapV=i.Constants.TEXTURE_MIRROR_ADDRESSMODE,this._reflectionRTT.ignoreCameraViewport=!0;var o,a=null,s=i.Matrix.Zero();this._refractionRTT.onBeforeRender=function(){if(r._mesh&&(n=r._mesh.isVisible,r._mesh.isVisible=!1),!r.disableClipPlane){a=e.clipPlane;var t=r._mesh?r._mesh.position.y:0;e.clipPlane=i.Plane.FromPositionAndNormal(new i.Vector3(0,t+.05,0),new i.Vector3(0,1,0))}},this._refractionRTT.onAfterRender=function(){r._mesh&&(r._mesh.isVisible=n),r.disableClipPlane||(e.clipPlane=a)},this._reflectionRTT.onBeforeRender=function(){if(r._mesh&&(n=r._mesh.isVisible,r._mesh.isVisible=!1),!r.disableClipPlane){a=e.clipPlane;var t=r._mesh?r._mesh.position.y:0;e.clipPlane=i.Plane.FromPositionAndNormal(new i.Vector3(0,t-.05,0),new i.Vector3(0,-1,0)),i.Matrix.ReflectionToRef(e.clipPlane,s)}o=e.getViewMatrix(),s.multiplyToRef(o,r._reflectionTransform),e.setTransformMatrix(r._reflectionTransform,e.getProjectionMatrix()),e.getEngine().cullBackFaces=!1,e._mirroredCameraPosition=i.Vector3.TransformCoordinates(e.activeCamera.position,s)},this._reflectionRTT.onAfterRender=function(){r._mesh&&(r._mesh.isVisible=n),e.clipPlane=a,e.setTransformMatrix(o,e.getProjectionMatrix()),e.getEngine().cullBackFaces=null,e._mirroredCameraPosition=null}},t.prototype.getAnimatables=function(){var e=[];return this.bumpTexture&&this.bumpTexture.animations&&this.bumpTexture.animations.length>0&&e.push(this.bumpTexture),this._reflectionRTT&&this._reflectionRTT.animations&&this._reflectionRTT.animations.length>0&&e.push(this._reflectionRTT),this._refractionRTT&&this._refractionRTT.animations&&this._refractionRTT.animations.length>0&&e.push(this._refractionRTT),e},t.prototype.getActiveTextures=function(){var t=e.prototype.getActiveTextures.call(this);return this._bumpTexture&&t.push(this._bumpTexture),t},t.prototype.hasTexture=function(t){return!!e.prototype.hasTexture.call(this,t)||this._bumpTexture===t},t.prototype.dispose=function(t){this.bumpTexture&&this.bumpTexture.dispose();var n=this.getScene().customRenderTargets.indexOf(this._refractionRTT);-1!=n&&this.getScene().customRenderTargets.splice(n,1),n=-1,-1!=(n=this.getScene().customRenderTargets.indexOf(this._reflectionRTT))&&this.getScene().customRenderTargets.splice(n,1),this._reflectionRTT&&this._reflectionRTT.dispose(),this._refractionRTT&&this._refractionRTT.dispose(),this._imageProcessingConfiguration&&this._imageProcessingObserver&&this._imageProcessingConfiguration.onUpdateParameters.remove(this._imageProcessingObserver),e.prototype.dispose.call(this,t)},t.prototype.clone=function(e){var n=this;return i.SerializationHelper.Clone(function(){return new t(e,n.getScene())},this)},t.prototype.serialize=function(){var e=i.SerializationHelper.Serialize(this);if(e.customType="BABYLON.WaterMaterial",e.renderList=[],this._refractionRTT&&this._refractionRTT.renderList)for(var t=0;t<this._refractionRTT.renderList.length;t++)e.renderList.push(this._refractionRTT.renderList[t].id);return e},t.prototype.getClassName=function(){return"WaterMaterial"},t.Parse=function(e,n,r){var o=i.SerializationHelper.Parse(function(){return new t(e.name,n)},e,n,r);return o._waitingRenderList=e.renderList,o},t.CreateDefaultMesh=function(e,t){return Object(i.CreateGround)(e,{width:512,height:512,subdivisions:32,updatable:!1},t)},Object(r.__decorate)([Object(i.serializeAsTexture)("bumpTexture")],t.prototype,"_bumpTexture",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"bumpTexture",void 0),Object(r.__decorate)([Object(i.serializeAsColor3)()],t.prototype,"diffuseColor",void 0),Object(r.__decorate)([Object(i.serializeAsColor3)()],t.prototype,"specularColor",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"specularPower",void 0),Object(r.__decorate)([Object(i.serialize)("disableLighting")],t.prototype,"_disableLighting",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsLightsDirty")],t.prototype,"disableLighting",void 0),Object(r.__decorate)([Object(i.serialize)("maxSimultaneousLights")],t.prototype,"_maxSimultaneousLights",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsLightsDirty")],t.prototype,"maxSimultaneousLights",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"windForce",void 0),Object(r.__decorate)([Object(i.serializeAsVector2)()],t.prototype,"windDirection",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"waveHeight",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"bumpHeight",void 0),Object(r.__decorate)([Object(i.serialize)("bumpSuperimpose")],t.prototype,"_bumpSuperimpose",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsMiscDirty")],t.prototype,"bumpSuperimpose",void 0),Object(r.__decorate)([Object(i.serialize)("fresnelSeparate")],t.prototype,"_fresnelSeparate",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsMiscDirty")],t.prototype,"fresnelSeparate",void 0),Object(r.__decorate)([Object(i.serialize)("bumpAffectsReflection")],t.prototype,"_bumpAffectsReflection",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsMiscDirty")],t.prototype,"bumpAffectsReflection",void 0),Object(r.__decorate)([Object(i.serializeAsColor3)()],t.prototype,"waterColor",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"colorBlendFactor",void 0),Object(r.__decorate)([Object(i.serializeAsColor3)()],t.prototype,"waterColor2",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"colorBlendFactor2",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"waveLength",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"waveSpeed",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"waveCount",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"disableClipPlane",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"useLogarithmicDepth",null),t}(i.PushMaterial);Object(i.RegisterClass)("BABYLON.WaterMaterial",a)},"babylonjs/Misc/decorators":function(t,n){t.exports=e}})}),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("babylonjs")):"function"==typeof define&&define.amd?define("babylonjs-serializers",["babylonjs"],t):"object"==typeof exports?exports["babylonjs-serializers"]=t(require("babylonjs")):e.SERIALIZERS=t(e.BABYLON)}("undefined"!=typeof self?self:"undefined"!=typeof global?global:this,function(e){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./legacy/legacy-glTF2Serializer.ts")}({"../../node_modules/tslib/tslib.es6.js":function(e,t,n){"use strict";n.r(t),n.d(t,"__extends",function(){return i}),n.d(t,"__assign",function(){return o}),n.d(t,"__rest",function(){return a}),n.d(t,"__decorate",function(){return s}),n.d(t,"__param",function(){return l}),n.d(t,"__metadata",function(){return c}),n.d(t,"__awaiter",function(){return u}),n.d(t,"__generator",function(){return _}),n.d(t,"__createBinding",function(){return h}),n.d(t,"__exportStar",function(){return f}),n.d(t,"__values",function(){return d}),n.d(t,"__read",function(){return p}),n.d(t,"__spread",function(){return m}),n.d(t,"__spreadArrays",function(){return g}),n.d(t,"__spreadArray",function(){return v}),n.d(t,"__await",function(){return b}),n.d(t,"__asyncGenerator",function(){return y}),n.d(t,"__asyncDelegator",function(){return x}),n.d(t,"__asyncValues",function(){return T}),n.d(t,"__makeTemplateObject",function(){return O}),n.d(t,"__importStar",function(){return C}),n.d(t,"__importDefault",function(){return S}),n.d(t,"__classPrivateFieldGet",function(){return M}),n.d(t,"__classPrivateFieldSet",function(){return E});var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function a(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function s(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function l(e,t){return function(n,r){t(n,r,e)}}function c(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function u(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}l((r=r.apply(e,t||[])).next())})}function _(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var h=Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]};function f(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||h(t,e,n)}function d(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function p(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function m(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(p(arguments[t]));return e}function g(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}function v(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function b(e){return this instanceof b?(this.v=e,this):new b(e)}function y(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(e){i[e]&&(r[e]=function(t){return new Promise(function(n,r){o.push([e,t,n,r])>1||s(e,t)})})}function s(e,t){try{(n=i[e](t)).value instanceof b?Promise.resolve(n.value.v).then(l,c):u(o[0][2],n)}catch(e){u(o[0][3],e)}var n}function l(e){s("next",e)}function c(e){s("throw",e)}function u(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}}function x(e){var t,n;return t={},r("next"),r("throw",function(e){throw e}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:b(e[r](t)),done:"return"===r}:i?i(t):t}:i}}function T(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=d(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,i){(function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)})(r,i,(t=e[n](t)).done,t.value)})}}}function O(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var P=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function C(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&h(t,e,n);return P(t,e),t}function S(e){return e&&e.__esModule?e:{default:e}}function M(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function E(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n}},"../../node_modules/webpack/buildin/global.js":function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},"./glTF/2.0/Extensions/KHR_lights_punctual.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"KHR_lights_punctual",function(){return s});var r=n("babylonjs/Maths/math.vector"),i=n("./glTF/2.0/glTFExporter.ts"),o=n("./glTF/2.0/glTFUtilities.ts"),a="KHR_lights_punctual",s=function(){function e(e){this.name=a,this.enabled=!0,this.required=!1,this._exporter=e}return e.prototype.dispose=function(){this._lights=null},Object.defineProperty(e.prototype,"wasUsed",{get:function(){return!!this._lights},enumerable:!1,configurable:!0}),e.prototype.onExporting=function(){this._exporter._glTF.extensions[a]=this._lights},e.prototype.postExportNodeAsync=function(e,t,n,i){var s=this;return new Promise(function(l,c){if(t&&n instanceof r.ShadowLight){var u=n,_=void 0,h=u.getTypeID()==r.Light.LIGHTTYPEID_POINTLIGHT?"point":u.getTypeID()==r.Light.LIGHTTYPEID_DIRECTIONALLIGHT?"directional":u.getTypeID()==r.Light.LIGHTTYPEID_SPOTLIGHT?"spot":null;if(null==h)r.Logger.Warn(e+": Light "+u.name+" is not supported in "+a);else{var f=u.position.clone(),d=s._exporter._convertToRightHandedSystemMap[n.uniqueId];if(f.equals(r.Vector3.Zero())||(d&&o._GLTFUtilities._GetRightHandedPositionVector3FromRef(f),t.translation=f.asArray()),"point"!==h){var p=u.direction,m=-Math.atan2(p.z*(s._exporter._babylonScene.useRightHandedSystem?-1:1),p.x)+Math.PI/2,g=Math.sqrt(p.x*p.x+p.z*p.z),v=-Math.atan2(p.y,g),b=r.Quaternion.RotationYawPitchRoll(m,v,0);d&&o._GLTFUtilities._GetRightHandedQuaternionFromRef(b),b.equals(r.Quaternion.Identity())||(t.rotation=b.asArray())}if(u.falloffType!==r.Light.FALLOFF_GLTF&&r.Logger.Warn(e+": Light falloff for "+u.name+" does not match the "+a+" specification!"),_={type:h},u.diffuse.equals(r.Color3.White())||(_.color=u.diffuse.asArray()),1!==u.intensity&&(_.intensity=u.intensity),u.range!==Number.MAX_VALUE&&(_.range=u.range),"spot"===h){var y=u;y.angle!==Math.PI/2&&(null==_.spot&&(_.spot={}),_.spot.outerConeAngle=y.angle/2),0!==y.innerAngle&&(null==_.spot&&(_.spot={}),_.spot.innerConeAngle=y.innerAngle/2)}null==s._lights&&(s._lights={lights:[]}),s._lights.lights.push(_);var x={light:s._lights.lights.length-1},T=n.parent;if(T&&1==T.getChildren().length){var O=s._exporter._nodes[i[T.uniqueId]];if(O){var P=r.TmpVectors.Matrix[0],C=r.TmpVectors.Matrix[1],S=O.translation?new r.Vector3(O.translation[0],O.translation[1],O.translation[2]):r.Vector3.Zero(),M=O.rotation?new r.Quaternion(O.rotation[0],O.rotation[1],O.rotation[2],O.rotation[3]):r.Quaternion.Identity(),E=O.scale?new r.Vector3(O.scale[0],O.scale[1],O.scale[2]):r.Vector3.One();r.Matrix.ComposeToRef(E,M,S,P),P.invertToRef(C);var A=r.TmpVectors.Matrix[2],B=t.translation?new r.Vector3(t.translation[0],t.translation[1],t.translation[2]):r.Vector3.Zero();u instanceof r.DirectionalLight&&B.subtractInPlace(s._exporter._babylonScene.useRightHandedSystem?u.direction:o._GLTFUtilities._GetRightHandedPositionVector3(u.direction));var F=s._exporter._babylonScene.useRightHandedSystem?r.Quaternion.Identity():new r.Quaternion(0,1,0,0);t.rotation&&F.multiplyInPlace(new r.Quaternion(t.rotation[0],t.rotation[1],t.rotation[2],t.rotation[3]));var R=t.scale?new r.Vector3(t.scale[0],t.scale[1],t.scale[2]):r.Vector3.One();r.Matrix.ComposeToRef(R,F,B,A),A.multiplyToRef(C,A);var L=r.TmpVectors.Vector3[0],w=r.TmpVectors.Quaternion[0],I=r.TmpVectors.Vector3[1];return A.decompose(L,w,I),O.scale=L.asArray(),O.rotation=w.asArray(),O.translation=I.asArray(),null==O.extensions&&(O.extensions={}),O.extensions[a]=x,void l(null)}}null==t.extensions&&(t.extensions={}),t.extensions[a]=x}}l(t)})},e}();i._Exporter.RegisterExtension(a,function(e){return new s(e)})},"./glTF/2.0/Extensions/KHR_materials_clearcoat.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"KHR_materials_clearcoat",function(){return a});var r=n("./glTF/2.0/glTFExporter.ts"),i=n("babylonjs/Maths/math.vector"),o="KHR_materials_clearcoat",a=function(){function e(e){this.name=o,this.enabled=!0,this.required=!1,this._wasUsed=!1,this._exporter=e}return e.prototype.dispose=function(){},Object.defineProperty(e.prototype,"wasUsed",{get:function(){return this._wasUsed},enumerable:!1,configurable:!0}),e.prototype.postExportMaterialAdditionalTextures=function(e,t,n){var r=[];return n instanceof i.PBRBaseMaterial&&n.clearCoat.isEnabled?(n.clearCoat.texture&&r.push(n.clearCoat.texture),!n.clearCoat.useRoughnessFromMainTexture&&n.clearCoat.textureRoughness&&r.push(n.clearCoat.textureRoughness),n.clearCoat.bumpTexture&&r.push(n.clearCoat.bumpTexture),r):[]},e.prototype.postExportMaterialAsync=function(e,t,n){var r=this;return new Promise(function(e,a){if(n instanceof i.PBRBaseMaterial){if(!n.clearCoat.isEnabled)return void e(t);r._wasUsed=!0,t.extensions=t.extensions||{};var s=r._exporter._glTFMaterialExporter._getTextureInfo(n.clearCoat.texture),l=void 0;l=n.clearCoat.useRoughnessFromMainTexture?r._exporter._glTFMaterialExporter._getTextureInfo(n.clearCoat.texture):r._exporter._glTFMaterialExporter._getTextureInfo(n.clearCoat.textureRoughness),n.clearCoat.isTintEnabled&&i.Tools.Warn("Clear Color tint is not supported for glTF export. Ignoring for: "+n.name),n.clearCoat.remapF0OnInterfaceChange&&i.Tools.Warn("Clear Color F0 remapping is not supported for glTF export. Ignoring for: "+n.name);var c=r._exporter._glTFMaterialExporter._getTextureInfo(n.clearCoat.bumpTexture),u={clearcoatFactor:n.clearCoat.intensity,clearcoatTexture:null!=s?s:void 0,clearcoatRoughnessFactor:n.clearCoat.roughness,clearcoatRoughnessTexture:null!=l?l:void 0,clearcoatNormalTexture:null!=c?c:void 0,hasTextures:function(){return null!==u.clearcoatTexture||null!==u.clearcoatRoughnessTexture||null!==u.clearcoatRoughnessTexture}};t.extensions[o]=u}e(t)})},e}();r._Exporter.RegisterExtension(o,function(e){return new a(e)})},"./glTF/2.0/Extensions/KHR_materials_sheen.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"KHR_materials_sheen",function(){return a});var r=n("./glTF/2.0/glTFExporter.ts"),i=n("babylonjs/Maths/math.vector"),o="KHR_materials_sheen",a=function(){function e(e){this.name=o,this.enabled=!0,this.required=!1,this._wasUsed=!1,this._exporter=e}return e.prototype.dispose=function(){},Object.defineProperty(e.prototype,"wasUsed",{get:function(){return this._wasUsed},enumerable:!1,configurable:!0}),e.prototype.postExportMaterialAdditionalTextures=function(e,t,n){return n instanceof i.PBRMaterial&&n.sheen.isEnabled&&n.sheen.texture?[n.sheen.texture]:[]},e.prototype.postExportMaterialAsync=function(e,t,n){var r=this;return new Promise(function(e,a){var s,l,c,u;if(n instanceof i.PBRMaterial){if(!n.sheen.isEnabled)return void e(t);r._wasUsed=!0,null==t.extensions&&(t.extensions={});var _={sheenColorFactor:n.sheen.color.asArray(),sheenRoughnessFactor:null!==(s=n.sheen.roughness)&&void 0!==s?s:0,hasTextures:function(){return null!==_.sheenColorTexture||null!==_.sheenRoughnessTexture}};n.sheen.texture&&(_.sheenColorTexture=null!==(l=r._exporter._glTFMaterialExporter._getTextureInfo(n.sheen.texture))&&void 0!==l?l:void 0),n.sheen.textureRoughness&&!n.sheen.useRoughnessFromMainTexture?_.sheenRoughnessTexture=null!==(c=r._exporter._glTFMaterialExporter._getTextureInfo(n.sheen.textureRoughness))&&void 0!==c?c:void 0:n.sheen.texture&&n.sheen.useRoughnessFromMainTexture&&(_.sheenRoughnessTexture=null!==(u=r._exporter._glTFMaterialExporter._getTextureInfo(n.sheen.texture))&&void 0!==u?u:void 0),t.extensions[o]=_}e(t)})},e}();r._Exporter.RegisterExtension(o,function(e){return new a(e)})},"./glTF/2.0/Extensions/KHR_materials_unlit.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"KHR_materials_unlit",function(){return a});var r=n("./glTF/2.0/glTFExporter.ts"),i=n("babylonjs/Maths/math.vector"),o="KHR_materials_unlit",a=function(){function e(e){this.name=o,this.enabled=!0,this.required=!1,this._wasUsed=!1}return Object.defineProperty(e.prototype,"wasUsed",{get:function(){return this._wasUsed},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){},e.prototype.postExportMaterialAsync=function(e,t,n){var r=this;return new Promise(function(e,a){var s=!1;n instanceof i.PBRMaterial?s=n.unlit:n instanceof i.StandardMaterial&&(s=n.disableLighting),s&&(r._wasUsed=!0,null==t.extensions&&(t.extensions={}),t.extensions[o]={}),e(t)})},e}();r._Exporter.RegisterExtension(o,function(e){return new a(e)})},"./glTF/2.0/Extensions/KHR_texture_transform.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"KHR_texture_transform",function(){return a});var r=n("babylonjs/Maths/math.vector"),i=n("./glTF/2.0/glTFExporter.ts"),o=(n("./glTF/2.0/shaders/textureTransform.fragment.ts"),"KHR_texture_transform"),a=function(){function e(e){this._recordedTextures=[],this.name=o,this.enabled=!0,this.required=!1,this._wasUsed=!1}return e.prototype.dispose=function(){for(var e=0,t=this._recordedTextures;e<t.length;e++){t[e].dispose()}},Object.defineProperty(e.prototype,"wasUsed",{get:function(){return this._wasUsed},enumerable:!1,configurable:!0}),e.prototype.postExportTexture=function(e,t,n){if(n&&(0===n.uAng&&0===n.wAng&&0===n.vAng||0===n.uRotationCenter&&0===n.vRotationCenter)){var r={},i=!1;if(0===n.uOffset&&0===n.vOffset||(r.offset=[n.uOffset,n.vOffset],i=!0),1===n.uScale&&1===n.vScale||(r.scale=[n.uScale,n.vScale],i=!0),0!==n.wAng&&(r.rotation=n.wAng,i=!0),0!==n.coordinatesIndex&&(r.texCoord=n.coordinatesIndex,i=!0),!i)return;this._wasUsed=!0,t.extensions||(t.extensions={}),t.extensions[o]=r}},e.prototype.preExportTextureAsync=function(e,t,n){var r=this;return new Promise(function(n,i){var o=t.getScene();if(o){var a=!1;if(0===t.uAng&&0===t.wAng&&0===t.vAng||0===t.uRotationCenter&&0===t.vRotationCenter||(a=!0),1===t.uScale&&1===t.vScale||(a=!0),a)return r._textureTransformTextureAsync(t,o).then(function(e){n(e)}).catch(function(e){i(e)});n(t)}else i(e+': "scene" is not defined for Babylon texture '+t.name+"!")})},e.prototype._textureTransformTextureAsync=function(e,t){var n=this;return new Promise(function(i){var o=new r.ProceduralTexture(""+e.name,e.getSize(),"textureTransform",t);o||(r.Tools.Log("Cannot create procedural texture for "+e.name+"!"),i(e)),o.reservedDataStore={hidden:!0,source:e},n._recordedTextures.push(o),o.coordinatesIndex=e.coordinatesIndex,o.setTexture("textureSampler",e),o.setMatrix("textureTransformMat",e.getTextureMatrix()),o.isReady()?(o.render(),i(o)):o.getEffect().executeWhenCompiled(function(){o.render(),i(o)})})},e}();i._Exporter.RegisterExtension(o,function(e){return new a(e)})},"./glTF/2.0/Extensions/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./glTF/2.0/Extensions/KHR_texture_transform.ts");n.d(t,"KHR_texture_transform",function(){return r.KHR_texture_transform});var i=n("./glTF/2.0/Extensions/KHR_lights_punctual.ts");n.d(t,"KHR_lights_punctual",function(){return i.KHR_lights_punctual});var o=n("./glTF/2.0/Extensions/KHR_materials_clearcoat.ts");n.d(t,"KHR_materials_clearcoat",function(){return o.KHR_materials_clearcoat});var a=n("./glTF/2.0/Extensions/KHR_materials_sheen.ts");n.d(t,"KHR_materials_sheen",function(){return a.KHR_materials_sheen});var s=n("./glTF/2.0/Extensions/KHR_materials_unlit.ts");n.d(t,"KHR_materials_unlit",function(){return s.KHR_materials_unlit})},"./glTF/2.0/glTFAnimation.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"_GLTFAnimation",function(){return a});var r,i=n("babylonjs/Maths/math.vector"),o=n("./glTF/2.0/glTFUtilities.ts");!function(e){e[e.INTANGENT=0]="INTANGENT",e[e.OUTTANGENT=1]="OUTTANGENT"}(r||(r={}));var a=function(){function e(){}return e._CreateNodeAnimation=function(t,n,r,o,a,s){var l=[],c=[],u=n.getKeys(),_=e.calculateMinMaxKeyFrames(u),h=e._DeduceInterpolation(u,r,a),f=_.max-_.min,d=h.interpolationType,p=h.shouldBakeAnimation;return p?e._CreateBakedAnimation(t,n,r,_.min,_.max,n.framePerSecond,s,l,c,_,o,a):"LINEAR"===d||"STEP"===d?e._CreateLinearOrStepAnimation(t,n,r,f,l,c,o,a):"CUBICSPLINE"===d?e._CreateCubicSplineAnimation(t,n,r,f,l,c,o,a):e._CreateBakedAnimation(t,n,r,_.min,_.max,n.framePerSecond,s,l,c,_,o,a),l.length&&c.length?{inputs:l,outputs:c,samplerInterpolation:d,inputsMin:p?_.min:i.Tools.FloatRound(_.min/n.framePerSecond),inputsMax:p?_.max:i.Tools.FloatRound(_.max/n.framePerSecond)}:null},e._DeduceAnimationInfo=function(e){var t=null,n="VEC3",r=!1,o=e.targetProperty.split(".");switch(o[0]){case"scaling":t="scale";break;case"position":t="translation";break;case"rotation":n="VEC4",t="rotation";break;case"rotationQuaternion":n="VEC4",r=!0,t="rotation";break;case"influence":n="SCALAR",t="weights";break;default:i.Tools.Error("Unsupported animatable property "+o[0])}return t?{animationChannelTargetPath:t,dataAccessorType:n,useQuaternion:r}:(i.Tools.Error("animation channel target path and data accessor type could be deduced"),null)},e._CreateNodeAnimationFromNodeAnimations=function(t,n,r,o,a,s,l,c,u,_){var h;if(t instanceof i.TransformNode&&t.animations)for(var f=0,d=t.animations;f<d.length;f++){var p=d[f],m=e._DeduceAnimationInfo(p);m&&(h={name:p.name,samplers:[],channels:[]},e.AddAnimation(""+p.name,p.hasRunningRuntimeAnimations?n:h,t,p,m.dataAccessorType,m.animationChannelTargetPath,o,s,l,c,u,m.useQuaternion,_),h.samplers.length&&h.channels.length&&r.push(h))}},e._CreateMorphTargetAnimationFromMorphTargetAnimations=function(t,n,r,o,a,s,l,c,u,_){var h;if(t instanceof i.Mesh){var f=t.morphTargetManager;if(f)for(var d=0;d<f.numTargets;++d)for(var p=0,m=f.getTarget(d).animations;p<m.length;p++){for(var g=m[p],v=new i.Animation(""+g.name,"influence",g.framePerSecond,g.dataType,g.loopMode,g.enableBlending),b=[],y=g.getKeys(),x=0;x<y.length;++x)for(var T=y[x],O=0;O<f.numTargets;++O)O==d?b.push(T):b.push({frame:T.frame,value:0});v.setKeys(b);var P=e._DeduceAnimationInfo(v);P&&(h={name:v.name,samplers:[],channels:[]},e.AddAnimation(g.name,g.hasRunningRuntimeAnimations?n:h,t,v,P.dataAccessorType,P.animationChannelTargetPath,o,s,l,c,u,P.useQuaternion,_,f.numTargets),h.samplers.length&&h.channels.length&&r.push(h))}}},e._CreateNodeAndMorphAnimationFromAnimationGroups=function(t,n,r,o,a,s,l,c,u){var _,h;if(t.animationGroups)for(var f=function(o){var f=new Map,d=new Map,p=new Set,m=o.to-o.from;h={name:o.name,channels:[],samplers:[]};for(var g=function(n){var m=o.targetedAnimations[n],g=m.target,v=m.animation;if(g instanceof i.TransformNode||1===g.length&&g[0]instanceof i.TransformNode){if(x=e._DeduceAnimationInfo(m.animation)){var b=g instanceof i.TransformNode?g:g[0],y=c[b.uniqueId];e.AddAnimation(""+v.name,h,b,v,x.dataAccessorType,x.animationChannelTargetPath,r,a,s,l,y,x.useQuaternion,u)}}else if(g instanceof i.MorphTarget||1===g.length&&g[0]instanceof i.MorphTarget){var x;if(x=e._DeduceAnimationInfo(m.animation)){var T=g instanceof i.MorphTarget?g:g[0];if(T){var O=t.morphTargetManagers.find(function(e){for(var t=0;t<e.numTargets;++t)if(e.getTarget(t)===T)return!0;return!1});if(O){var P=t.meshes.find(function(e){return e.morphTargetManager===O});P&&(f.has(P)||f.set(P,new Map),null===(_=f.get(P))||void 0===_||_.set(T,v),p.add(P),d.set(P,v))}}}}},v=0;v<o.targetedAnimations.length;++v)g(v);p.forEach(function(t){for(var n=t.morphTargetManager,c=null,_=[],p=d.get(t).getKeys(),g=p.length,v=0;v<g;++v)for(var b=0;b<n.numTargets;++b){var y=n.getTarget(b),x=f.get(t);if(x){var T=x.get(y);T?(c||(c=new i.Animation(o.name+"_"+t.name+"_MorphWeightAnimation","influence",T.framePerSecond,i.Animation.ANIMATIONTYPE_FLOAT,T.loopMode,T.enableBlending)),_.push(T.getKeys()[v])):_.push({frame:o.from+m/g*v,value:y.influence,inTangent:p[0].inTangent?0:void 0,outTangent:p[0].outTangent?0:void 0})}}c.setKeys(_);var O=e._DeduceAnimationInfo(c);O&&e.AddAnimation(o.name+"_"+t.name+"_MorphWeightAnimation",h,t,c,O.dataAccessorType,O.animationChannelTargetPath,r,a,s,l,!1,O.useQuaternion,u,null==n?void 0:n.numTargets)}),h.channels.length&&h.samplers.length&&n.push(h)},d=0,p=t.animationGroups;d<p.length;d++){f(p[d])}},e.AddAnimation=function(t,n,r,i,a,s,l,c,u,_,h,f,d,p){var m,g,v,b,y,x,T,O=e._CreateNodeAnimation(r,i,s,h,f,d);if(O){if(p){for(var P=0,C=0,S=[];O.inputs.length>0;)C=O.inputs.shift(),P%p==0&&S.push(C),P++;O.inputs=S}var M=l[r.uniqueId],E=4*O.inputs.length;m=o._GLTFUtilities._CreateBufferView(0,c.getByteOffset(),E,void 0,t+"  keyframe data view"),u.push(m),O.inputs.forEach(function(e){c.setFloat32(e)}),g=o._GLTFUtilities._CreateAccessor(u.length-1,t+"  keyframes","SCALAR",5126,O.inputs.length,null,[O.inputsMin],[O.inputsMax]),_.push(g),v=_.length-1,y=O.outputs.length,E=4*o._GLTFUtilities._GetDataAccessorElementCount(a)*O.outputs.length,m=o._GLTFUtilities._CreateBufferView(0,c.getByteOffset(),E,void 0,t+"  data view"),u.push(m),O.outputs.forEach(function(e){e.forEach(function(e){c.setFloat32(e)})}),g=o._GLTFUtilities._CreateAccessor(u.length-1,t+"  data",a,5126,y,null,null,null),_.push(g),b=_.length-1,x={interpolation:O.samplerInterpolation,input:v,output:b},n.samplers.push(x),T={sampler:n.samplers.length-1,target:{node:M,path:s}},n.channels.push(T)}},e._CreateBakedAnimation=function(t,n,r,o,a,s,l,c,u,_,h,f){var d,p,m=i.Quaternion.Identity(),g=null,v=null,b=null,y=null,x=null,T=null;_.min=i.Tools.FloatRound(o/s);for(var O=n.getKeys(),P=0,C=O.length;P<C;++P){if(T=null,b=O[P],P+1<C)if(y=O[P+1],b.value.equals&&b.value.equals(y.value)||b.value===y.value){if(0!==P)continue;T=b.frame}else T=y.frame;else{if(x=O[P-1],b.value.equals&&b.value.equals(x.value)||b.value===x.value)continue;T=a}if(T)for(var S=b.frame;S<=T;S+=l)if((p=i.Tools.FloatRound(S/s))!==g){g=p,v=p;var M={key:0,repeatCount:0,loopMode:n.loopMode};d=n._interpolate(S,M),e._SetInterpolatedValue(t,d,p,n,r,m,c,u,h,f)}}v&&(_.max=v)},e._ConvertFactorToVector3OrQuaternion=function(t,n,r,o,a,s,l){var c,u,_=null,h=e._GetBasePositionRotationOrScale(n,a,s,l);if(o===i.Animation.ANIMATIONTYPE_FLOAT)switch(u=(c=r.targetProperty.split("."))?c[1]:"",_=l?i.Quaternion.FromArray(h).normalize():i.Vector3.FromArray(h),u){case"x":case"y":_[u]=s&&l&&"scale"!==a?-t:t;break;case"z":_[u]=s&&!l&&"scale"!==a?-t:t;break;case"w":_.w=t;break;default:i.Tools.Error('glTFAnimation: Unsupported component type "'+u+'" for scale animation!')}return _},e._SetInterpolatedValue=function(e,t,n,r,a,s,l,c,u,_){var h,f=r.dataType;l.push(n),"number"==typeof t&&e instanceof i.TransformNode&&(t=this._ConvertFactorToVector3OrQuaternion(t,e,r,f,a,u,_)),t&&("rotation"===a?(_?s=t:(h=t,i.Quaternion.RotationYawPitchRollToRef(h.y,h.x,h.z,s)),u&&(o._GLTFUtilities._GetRightHandedQuaternionFromRef(s),e.parent||(s=i.Quaternion.FromArray([0,1,0,0]).multiply(s))),c.push(s.asArray())):"weights"===a?c.push([t]):(h=t,u&&"scale"!==a&&(o._GLTFUtilities._GetRightHandedPositionVector3FromRef(h),e.parent||(h.x*=-1,h.z*=-1)),c.push(h.asArray())))},e._CreateLinearOrStepAnimation=function(t,n,r,i,o,a,s,l){for(var c=0,u=n.getKeys();c<u.length;c++){var _=u[c];o.push(_.frame/n.framePerSecond),e._AddKeyframeValue(_,n,a,r,t,s,l)}},e._CreateCubicSplineAnimation=function(t,n,i,o,a,s,l,c){n.getKeys().forEach(function(u){a.push(u.frame/n.framePerSecond),e.AddSplineTangent(t,r.INTANGENT,s,i,"CUBICSPLINE",u,o,c,l),e._AddKeyframeValue(u,n,s,i,t,l,c),e.AddSplineTangent(t,r.OUTTANGENT,s,i,"CUBICSPLINE",u,o,c,l)})},e._GetBasePositionRotationOrScale=function(e,t,n,r){var a;return"rotation"===t?r?e.rotationQuaternion?(a=e.rotationQuaternion.asArray(),n&&(o._GLTFUtilities._GetRightHandedQuaternionArrayFromRef(a),e.parent||(a=i.Quaternion.FromArray([0,1,0,0]).multiply(i.Quaternion.FromArray(a)).asArray()))):a=i.Quaternion.Identity().asArray():(a=e.rotation.asArray(),o._GLTFUtilities._GetRightHandedNormalArray3FromRef(a)):"translation"===t?(a=e.position.asArray(),n&&o._GLTFUtilities._GetRightHandedPositionArray3FromRef(a)):a=e.scaling.asArray(),a},e._AddKeyframeValue=function(e,t,n,r,a,s,l){var c,u,_=t.dataType;if(_===i.Animation.ANIMATIONTYPE_VECTOR3){if(c=e.value.asArray(),"rotation"===r){var h=i.Vector3.FromArray(c),f=i.Quaternion.RotationYawPitchRoll(h.y,h.x,h.z);s&&(o._GLTFUtilities._GetRightHandedQuaternionFromRef(f),a.parent||(f=i.Quaternion.FromArray([0,1,0,0]).multiply(f))),c=f.asArray()}else"translation"===r&&s&&(o._GLTFUtilities._GetRightHandedNormalArray3FromRef(c),a.parent||(c[0]*=-1,c[2]*=-1));n.push(c)}else if(_===i.Animation.ANIMATIONTYPE_FLOAT){if("weights"===r)n.push([e.value]);else if(u=this._ConvertFactorToVector3OrQuaternion(e.value,a,t,_,r,s,l)){if("rotation"===r){var d=l?u:i.Quaternion.RotationYawPitchRoll(u.y,u.x,u.z).normalize();s&&(o._GLTFUtilities._GetRightHandedQuaternionFromRef(d),a.parent||(d=i.Quaternion.FromArray([0,1,0,0]).multiply(d))),n.push(d.asArray())}else"translation"===r&&s&&(o._GLTFUtilities._GetRightHandedNormalVector3FromRef(u),a.parent||(u.x*=-1,u.z*=-1));n.push(u.asArray())}}else _===i.Animation.ANIMATIONTYPE_QUATERNION?(c=e.value.normalize().asArray(),s&&(o._GLTFUtilities._GetRightHandedQuaternionArrayFromRef(c),a.parent||(c=i.Quaternion.FromArray([0,1,0,0]).multiply(i.Quaternion.FromArray(c)).asArray())),n.push(c)):i.Tools.Error("glTFAnimation: Unsupported key frame values for animation!")},e._DeduceInterpolation=function(e,t,n){var r,o,a=!1;if("rotation"===t&&!n)return{interpolationType:"LINEAR",shouldBakeAnimation:!0};for(var s=0,l=e.length;s<l;++s)if((o=e[s]).inTangent||o.outTangent)if(r){if("CUBICSPLINE"!==r){r="LINEAR",a=!0;break}}else r="CUBICSPLINE";else if(r){if("CUBICSPLINE"===r||o.interpolation&&o.interpolation===i.AnimationKeyInterpolation.STEP&&"STEP"!==r){r="LINEAR",a=!0;break}}else r=o.interpolation&&o.interpolation===i.AnimationKeyInterpolation.STEP?"STEP":"LINEAR";return r||(r="LINEAR"),{interpolationType:r,shouldBakeAnimation:a}},e.AddSplineTangent=function(e,t,n,a,s,l,c,u,_){var h,f=t===r.INTANGENT?l.inTangent:l.outTangent;if("CUBICSPLINE"===s){if("rotation"===a)if(f){if(u)h=f.asArray();else{var d=f;h=i.Quaternion.RotationYawPitchRoll(d.y,d.x,d.z).asArray()}_&&(o._GLTFUtilities._GetRightHandedQuaternionArrayFromRef(h),e.parent||(h=i.Quaternion.FromArray([0,1,0,0]).multiply(i.Quaternion.FromArray(h)).asArray()))}else h=[0,0,0,0];else"weights"===a?h=f?[f]:[0]:f?(h=f.asArray(),_&&"translation"===a&&(o._GLTFUtilities._GetRightHandedPositionArray3FromRef(h),e.parent||(h[0]*=-1,h[2]*=-1))):h=[0,0,0];n.push(h)}},e.calculateMinMaxKeyFrames=function(e){var t=1/0,n=-1/0;return e.forEach(function(e){t=Math.min(t,e.frame),n=Math.max(n,e.frame)}),{min:t,max:n}},e}()},"./glTF/2.0/glTFData.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"GLTFData",function(){return r});var r=function(){function e(){this.glTFFiles={}}return e.prototype.downloadFiles=function(){function e(e,t){return-1!==e.indexOf(t,e.length-t.length)}for(var t in this.glTFFiles){var n=document.createElement("a");document.body.appendChild(n),n.setAttribute("type","hidden"),n.download=t;var r=this.glTFFiles[t],i=void 0;e(t,".glb")?i={type:"model/gltf-binary"}:e(t,".bin")?i={type:"application/octet-stream"}:e(t,".gltf")?i={type:"model/gltf+json"}:e(t,".jpeg")||e(t,".jpg")?i={type:"image/jpeg"}:e(t,".png")&&(i={type:"image/png"}),n.href=window.URL.createObjectURL(new Blob([r],i)),n.click()}},e}()},"./glTF/2.0/glTFExporter.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"_Exporter",function(){return c}),n.d(t,"_BinaryWriter",function(){return u});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Maths/math.vector"),o=n("./glTF/2.0/glTFMaterialExporter.ts"),a=n("./glTF/2.0/glTFUtilities.ts"),s=n("./glTF/2.0/glTFData.ts"),l=n("./glTF/2.0/glTFAnimation.ts"),c=function(){function e(e,t){this._includeCoordinateSystemConversionNodes=!1,this._extensions={},this._glTF={asset:{generator:"BabylonJS",version:"2.0"}},this._babylonScene=e,this._bufferViews=[],this._accessors=[],this._meshes=[],this._scenes=[],this._nodes=[],this._images=[],this._materials=[],this._materialMap=[],this._textures=[],this._samplers=[],this._skins=[],this._animations=[],this._imageData={},this._orderedImageData=[],this._options=t||{},this._animationSampleRate=t&&t.animationSampleRate?t.animationSampleRate:1/60,this._includeCoordinateSystemConversionNodes=!(!t||!t.includeCoordinateSystemConversionNodes),this._glTFMaterialExporter=new o._GLTFMaterialExporter(this),this._loadExtensions()}return e.prototype._applyExtension=function(e,t,n,r){var i=this;if(n>=t.length)return Promise.resolve(e);var o=r(t[n],e);return o?o.then(function(e){return i._applyExtension(e,t,n+1,r)}):this._applyExtension(e,t,n+1,r)},e.prototype._applyExtensions=function(t,n){for(var r=[],i=0,o=e._ExtensionNames;i<o.length;i++){var a=o[i];r.push(this._extensions[a])}return this._applyExtension(t,r,0,n)},e.prototype._extensionsPreExportTextureAsync=function(e,t,n){return this._applyExtensions(t,function(t,r){return t.preExportTextureAsync&&t.preExportTextureAsync(e,r,n)})},e.prototype._extensionsPostExportMeshPrimitiveAsync=function(e,t,n,r){return this._applyExtensions(t,function(t,i){return t.postExportMeshPrimitiveAsync&&t.postExportMeshPrimitiveAsync(e,i,n,r)})},e.prototype._extensionsPostExportNodeAsync=function(e,t,n,r){return this._applyExtensions(t,function(t,i){return t.postExportNodeAsync&&t.postExportNodeAsync(e,i,n,r)})},e.prototype._extensionsPostExportMaterialAsync=function(e,t,n){return this._applyExtensions(t,function(t,r){return t.postExportMaterialAsync&&t.postExportMaterialAsync(e,r,n)})},e.prototype._extensionsPostExportMaterialAdditionalTextures=function(t,n,r){for(var i=[],o=0,a=e._ExtensionNames;o<a.length;o++){var s=a[o],l=this._extensions[s];l.postExportMaterialAdditionalTextures&&i.push.apply(i,l.postExportMaterialAdditionalTextures(t,n,r))}return i},e.prototype._extensionsPostExportTextures=function(t,n,r){for(var i=0,o=e._ExtensionNames;i<o.length;i++){var a=o[i],s=this._extensions[a];s.postExportTexture&&s.postExportTexture(t,n,r)}},e.prototype._forEachExtensions=function(t){for(var n=0,r=e._ExtensionNames;n<r.length;n++){var i=r[n],o=this._extensions[i];o.enabled&&t(o)}},e.prototype._extensionsOnExporting=function(){var e=this;this._forEachExtensions(function(t){t.wasUsed&&(null==e._glTF.extensionsUsed&&(e._glTF.extensionsUsed=[]),-1===e._glTF.extensionsUsed.indexOf(t.name)&&e._glTF.extensionsUsed.push(t.name),t.required&&(null==e._glTF.extensionsRequired&&(e._glTF.extensionsRequired=[]),-1===e._glTF.extensionsRequired.indexOf(t.name)&&e._glTF.extensionsRequired.push(t.name)),null==e._glTF.extensions&&(e._glTF.extensions={}),t.onExporting&&t.onExporting())})},e.prototype._loadExtensions=function(){for(var t=0,n=e._ExtensionNames;t<n.length;t++){var r=n[t],i=e._ExtensionFactories[r](this);this._extensions[r]=i}},e.prototype.dispose=function(){for(var e in this._extensions){this._extensions[e].dispose()}},e.RegisterExtension=function(t,n){e.UnregisterExtension(t)&&i.Tools.Warn("Extension with the name "+t+" already exists"),e._ExtensionFactories[t]=n,e._ExtensionNames.push(t)},e.UnregisterExtension=function(t){if(!e._ExtensionFactories[t])return!1;delete e._ExtensionFactories[t];var n=e._ExtensionNames.indexOf(t);return-1!==n&&e._ExtensionNames.splice(n,1),!0},e.prototype.reorderIndicesBasedOnPrimitiveMode=function(e,t,n,r,o){switch(t){case i.Material.TriangleFillMode:r||(r=0);for(var a=e.indexStart,s=e.indexStart+e.indexCount;a<s;a+=3){var l=r+4*a,c=o.getUInt32(l+4),u=o.getUInt32(l+8);o.setUInt32(u,l+4),o.setUInt32(c,l+8)}break;case i.Material.TriangleFanDrawMode:a=e.indexStart+e.indexCount-1;for(var _=e.indexStart;a>=_;--a)o.setUInt32(n[a],r),r+=4;break;case i.Material.TriangleStripDrawMode:e.indexCount>=3&&(o.setUInt32(n[e.indexStart+2],r+4),o.setUInt32(n[e.indexStart+1],r+8))}},e.prototype.reorderVertexAttributeDataBasedOnPrimitiveMode=function(e,t,n,r,o,a,s,l){if(l&&n===i.Material.ClockWiseSideOrientation)switch(t){case i.Material.TriangleFillMode:this.reorderTriangleFillMode(e,t,n,r,o,a,s,l);break;case i.Material.TriangleStripDrawMode:this.reorderTriangleStripDrawMode(e,t,n,r,o,a,s,l);break;case i.Material.TriangleFanDrawMode:this.reorderTriangleFanMode(e,t,n,r,o,a,s,l)}},e.prototype.reorderTriangleFillMode=function(e,t,n,r,o,a,s,l){var c=this.getVertexBufferFromMesh(r,e.getMesh());if(c){var u=c.byteStride/i.VertexBuffer.GetTypeByteLength(c.type);if(e.verticesCount%3!=0)i.Tools.Error("The submesh vertices for the triangle fill mode is not divisible by 3!");else{var _=[],h=0;switch(r){case i.VertexBuffer.PositionKind:case i.VertexBuffer.NormalKind:for(var f=e.verticesStart;f<e.verticesStart+e.verticesCount;f+=3)h=f*u,_.push(i.Vector3.FromArray(o,h)),_.push(i.Vector3.FromArray(o,h+2*u)),_.push(i.Vector3.FromArray(o,h+u));break;case i.VertexBuffer.TangentKind:for(f=e.verticesStart;f<e.verticesStart+e.verticesCount;f+=3)h=f*u,_.push(i.Vector4.FromArray(o,h)),_.push(i.Vector4.FromArray(o,h+2*u)),_.push(i.Vector4.FromArray(o,h+u));break;case i.VertexBuffer.ColorKind:var d=c.getSize();for(f=e.verticesStart;f<e.verticesStart+e.verticesCount;f+=d)h=f*u,4===d?(_.push(i.Vector4.FromArray(o,h)),_.push(i.Vector4.FromArray(o,h+2*u)),_.push(i.Vector4.FromArray(o,h+u))):(_.push(i.Vector3.FromArray(o,h)),_.push(i.Vector3.FromArray(o,h+2*u)),_.push(i.Vector3.FromArray(o,h+u)));break;case i.VertexBuffer.UVKind:case i.VertexBuffer.UV2Kind:for(f=e.verticesStart;f<e.verticesStart+e.verticesCount;f+=3)h=f*u,_.push(i.Vector2.FromArray(o,h)),_.push(i.Vector2.FromArray(o,h+2*u)),_.push(i.Vector2.FromArray(o,h+u));break;default:i.Tools.Error("Unsupported Vertex Buffer type: "+r)}this.writeVertexAttributeData(_,a,r,o,s,l)}}else i.Tools.Warn("reorderTriangleFillMode: Vertex Buffer Kind "+r+" not present!")},e.prototype.reorderTriangleStripDrawMode=function(e,t,n,r,o,a,s,l){var c=this.getVertexBufferFromMesh(r,e.getMesh());if(c){var u=c.byteStride/i.VertexBuffer.GetTypeByteLength(c.type),_=[],h=0;switch(r){case i.VertexBuffer.PositionKind:case i.VertexBuffer.NormalKind:h=e.verticesStart,_.push(i.Vector3.FromArray(o,h+2*u)),_.push(i.Vector3.FromArray(o,h+u));break;case i.VertexBuffer.TangentKind:for(var f=e.verticesStart+e.verticesCount-1;f>=e.verticesStart;--f)h=f*u,_.push(i.Vector4.FromArray(o,h));break;case i.VertexBuffer.ColorKind:for(f=e.verticesStart+e.verticesCount-1;f>=e.verticesStart;--f)h=f*u,4===c.getSize()?_.push(i.Vector4.FromArray(o,h)):_.push(i.Vector3.FromArray(o,h));break;case i.VertexBuffer.UVKind:case i.VertexBuffer.UV2Kind:for(f=e.verticesStart+e.verticesCount-1;f>=e.verticesStart;--f)h=f*u,_.push(i.Vector2.FromArray(o,h));break;default:i.Tools.Error("Unsupported Vertex Buffer type: "+r)}this.writeVertexAttributeData(_,a+12,r,o,s,l)}else i.Tools.Warn("reorderTriangleStripDrawMode: Vertex buffer kind "+r+" not present!")},e.prototype.reorderTriangleFanMode=function(e,t,n,r,o,a,s,l){var c=this.getVertexBufferFromMesh(r,e.getMesh());if(c){var u=c.byteStride/i.VertexBuffer.GetTypeByteLength(c.type),_=[],h=0;switch(r){case i.VertexBuffer.PositionKind:case i.VertexBuffer.NormalKind:for(var f=e.verticesStart+e.verticesCount-1;f>=e.verticesStart;--f)h=f*u,_.push(i.Vector3.FromArray(o,h));break;case i.VertexBuffer.TangentKind:for(f=e.verticesStart+e.verticesCount-1;f>=e.verticesStart;--f)h=f*u,_.push(i.Vector4.FromArray(o,h));break;case i.VertexBuffer.ColorKind:for(f=e.verticesStart+e.verticesCount-1;f>=e.verticesStart;--f)h=f*u,_.push(i.Vector4.FromArray(o,h)),4===c.getSize()?_.push(i.Vector4.FromArray(o,h)):_.push(i.Vector3.FromArray(o,h));break;case i.VertexBuffer.UVKind:case i.VertexBuffer.UV2Kind:for(f=e.verticesStart+e.verticesCount-1;f>=e.verticesStart;--f)h=f*u,_.push(i.Vector2.FromArray(o,h));break;default:i.Tools.Error("Unsupported Vertex Buffer type: "+r)}this.writeVertexAttributeData(_,a,r,o,s,l)}else i.Tools.Warn("reorderTriangleFanMode: Vertex buffer kind "+r+" not present!")},e.prototype.writeVertexAttributeData=function(e,t,n,r,o,s){for(var l=0,c=e;l<c.length;l++){var u=c[l];!s||n===i.VertexBuffer.ColorKind||u instanceof i.Vector2||(u instanceof i.Vector3?n===i.VertexBuffer.NormalKind?a._GLTFUtilities._GetRightHandedNormalVector3FromRef(u):n===i.VertexBuffer.PositionKind?a._GLTFUtilities._GetRightHandedPositionVector3FromRef(u):i.Tools.Error("Unsupported vertex attribute kind!"):a._GLTFUtilities._GetRightHandedVector4FromRef(u)),n===i.VertexBuffer.NormalKind?u.normalize():n===i.VertexBuffer.TangentKind&&u instanceof i.Vector4&&a._GLTFUtilities._NormalizeTangentFromRef(u);for(var _=0,h=u.asArray();_<h.length;_++){var f=h[_];o.setFloat32(f,t),t+=4}}},e.prototype.writeAttributeData=function(e,t,n,r,o,s,l){var c,u,_=[];switch(e){case i.VertexBuffer.PositionKind:for(var h=0,f=n.length/r;h<f;++h){c=h*r;var d=i.Vector3.FromArray(n,c);s&&a._GLTFUtilities._GetRightHandedPositionVector3FromRef(d),_.push(d.asArray())}break;case i.VertexBuffer.NormalKind:h=0;for(var p=n.length/r;h<p;++h){c=h*r;d=i.Vector3.FromArray(n,c);s&&a._GLTFUtilities._GetRightHandedNormalVector3FromRef(d),d.normalize(),_.push(d.asArray())}break;case i.VertexBuffer.TangentKind:h=0;for(var m=n.length/r;h<m;++h){c=h*r;d=i.Vector4.FromArray(n,c);s&&a._GLTFUtilities._GetRightHandedVector4FromRef(d),a._GLTFUtilities._NormalizeTangentFromRef(d),_.push(d.asArray())}break;case i.VertexBuffer.ColorKind:for(var g=l.material,v=!g||"StandardMaterial"===g.getClassName(),b=(d=3===r?new i.Color3:new i.Color4,h=0,n.length/r);h<b;++h)c=h*r,3===r?(i.Color3.FromArrayToRef(n,c,d),v&&d.toLinearSpaceToRef(d)):(i.Color4.FromArrayToRef(n,c,d),v&&d.toLinearSpaceToRef(d)),_.push(d.asArray());break;case i.VertexBuffer.UVKind:case i.VertexBuffer.UV2Kind:h=0;for(var y=n.length/r;h<y;++h)c=h*r,_.push([n[c],n[c+1]]);break;case i.VertexBuffer.MatricesIndicesKind:case i.VertexBuffer.MatricesIndicesExtraKind:h=0;for(var x=n.length/r;h<x;++h){c=h*r;d=i.Vector4.FromArray(n,c);_.push(d.asArray())}break;case i.VertexBuffer.MatricesWeightsKind:case i.VertexBuffer.MatricesWeightsExtraKind:h=0;for(var T=n.length/r;h<T;++h){c=h*r;d=i.Vector4.FromArray(n,c);_.push(d.asArray())}break;default:i.Tools.Warn("Unsupported Vertex Buffer Type: "+e),_=[]}switch(t){case 5121:u=o.setUInt8.bind(o);break;case 5123:u=o.setUInt16.bind(o);break;case 5125:u=o.setUInt32.bind(o);case 5126:u=o.setFloat32.bind(o);break;default:return void i.Tools.Warn("Unsupported Attribute Component kind: "+t)}for(var O=0,P=_;O<P.length;O++)for(var C=0,S=P[O];C<S.length;C++){u(S[C])}},e.prototype.writeMorphTargetAttributeData=function(e,t,n,r,o,s,l,c,u,_){var h,f,d=[],p=new i.Vector3,m=new i.Vector4(0,0,0,0);switch(e){case i.VertexBuffer.PositionKind:for(var g=n.verticesStart;g<n.verticesCount;++g){h=n.indexStart+g*l;var v=i.Vector3.FromArray(o,h);p=(b=i.Vector3.FromArray(s,h)).subtractToRef(v,p),u&&a._GLTFUtilities._GetRightHandedPositionVector3FromRef(p),_&&(_.min.copyFromFloats(Math.min(p.x,_.min.x),Math.min(p.y,_.min.y),Math.min(p.z,_.min.z)),_.max.copyFromFloats(Math.max(p.x,_.max.x),Math.max(p.y,_.max.y),Math.max(p.z,_.max.z))),d.push(p.asArray())}break;case i.VertexBuffer.NormalKind:for(g=n.verticesStart;g<n.verticesCount;++g){h=n.indexStart+g*l,(v=i.Vector3.FromArray(o,h)).normalize(),(b=i.Vector3.FromArray(s,h)).normalize(),p=b.subtractToRef(v,p),u&&a._GLTFUtilities._GetRightHandedNormalVector3FromRef(p),d.push(p.asArray())}break;case i.VertexBuffer.TangentKind:for(g=n.verticesStart;g<n.verticesCount;++g){h=n.indexStart+g*(l+1);v=i.Vector4.FromArray(o,h);a._GLTFUtilities._NormalizeTangentFromRef(v);var b=i.Vector4.FromArray(s,h);a._GLTFUtilities._NormalizeTangentFromRef(b),m=b.subtractToRef(v,m),u&&a._GLTFUtilities._GetRightHandedVector4FromRef(m),d.push([m.x,m.y,m.z])}break;default:i.Tools.Warn("Unsupported Vertex Buffer Type: "+e),d=[]}switch(t){case 5121:f=c.setUInt8.bind(c);break;case 5123:f=c.setUInt16.bind(c);break;case 5125:f=c.setUInt32.bind(c);case 5126:f=c.setFloat32.bind(c);break;default:return void i.Tools.Warn("Unsupported Attribute Component kind: "+t)}for(var y=0,x=d;y<x.length;y++)for(var T=0,O=x[y];T<O.length;T++){f(O[T])}},e.prototype.generateJSON=function(e,t,n){var r,i,o,s=this,l={byteLength:this._totalByteLength},c=this._totalByteLength;l.byteLength&&(this._glTF.buffers=[l]),this._nodes&&this._nodes.length&&(this._glTF.nodes=this._nodes),this._meshes&&this._meshes.length&&(this._glTF.meshes=this._meshes),this._scenes&&this._scenes.length&&(this._glTF.scenes=this._scenes,this._glTF.scene=0),this._bufferViews&&this._bufferViews.length&&(this._glTF.bufferViews=this._bufferViews),this._accessors&&this._accessors.length&&(this._glTF.accessors=this._accessors),this._animations&&this._animations.length&&(this._glTF.animations=this._animations),this._materials&&this._materials.length&&(this._glTF.materials=this._materials),this._textures&&this._textures.length&&(this._glTF.textures=this._textures),this._samplers&&this._samplers.length&&(this._glTF.samplers=this._samplers),this._skins&&this._skins.length&&(this._glTF.skins=this._skins),this._images&&this._images.length&&(e?(this._glTF.images=[],this._images.forEach(function(e){e.uri&&(i=s._imageData[e.uri],s._orderedImageData.push(i),r=e.uri.split(".")[0]+" image",o=a._GLTFUtilities._CreateBufferView(0,c,i.data.length,void 0,r),c+=i.data.buffer.byteLength,s._bufferViews.push(o),e.bufferView=s._bufferViews.length-1,e.name=r,e.mimeType=i.mimeType,e.uri=void 0,s._glTF.images||(s._glTF.images=[]),s._glTF.images.push(e))}),l.byteLength=c):this._glTF.images=this._images),e||(l.uri=t+".bin");var u=n?JSON.stringify(this._glTF,null,2):JSON.stringify(this._glTF);return u=(u=u.replace(/"metallicFactor": 1,/g,'"metallicFactor": 1.0,')).replace(/"roughnessFactor": 1,/g,'"roughnessFactor": 1.0,')},e.prototype._generateGLTFAsync=function(e,t){var n=this;return void 0===t&&(t=!0),this._generateBinaryAsync().then(function(r){n._extensionsOnExporting();var i=n.generateJSON(!1,e,!0),o=new Blob([r],{type:"application/octet-stream"}),a=e+".gltf",l=e+".bin",c=new s.GLTFData;if(c.glTFFiles[a]=i,c.glTFFiles[l]=o,n._imageData)for(var u in n._imageData)c.glTFFiles[u]=new Blob([n._imageData[u].data],{type:n._imageData[u].mimeType});if(n._imageData&&n._options.exportTextureUrls&&n._options.rootUrl){var _=[],h="",f=n._options.rootUrl.endsWith("/")?"":"/";for(var u in n._imageData)n._imageData[u].url&&(h.length>0&&(h+="\n"),h+=u+";"+n._options.rootUrl+f+n._imageData[u].url,_.push(u));h.length>0&&(c.glTFFiles["TextureUrls.txt"]=new Blob([h],{type:"text/plain;charset=utf-8"})),_.length>0&&(c.serverImages=_)}return t&&n.dispose(),c})},e.prototype._generateBinaryAsync=function(){var e=this,t=new u(4);return this.createSceneAsync(this._babylonScene,t).then(function(){return e._localEngine&&e._localEngine.dispose(),t.getArrayBuffer()})},e.prototype._getPadding=function(e){var t=e%4;return 0===t?t:4-t},e.prototype._generateGLBAsync=function(e,t){var n=this;return void 0===t&&(t=!0),this._generateBinaryAsync().then(function(r){n._extensionsOnExporting();var i,o=n.generateJSON(!0),a=e+".glb",l=o.length,c=0;"undefined"!=typeof TextEncoder&&(l=(i=(new TextEncoder).encode(o)).length);for(var u=0;u<n._orderedImageData.length;++u)c+=n._orderedImageData[u].data.byteLength;var _=n._getPadding(l),h=n._getPadding(r.byteLength),f=n._getPadding(c),d=28+l+_+r.byteLength+h+c+f,p=new ArrayBuffer(12),m=new DataView(p);m.setUint32(0,1179937895,!0),m.setUint32(4,2,!0),m.setUint32(8,d,!0);var g=new ArrayBuffer(8+l+_),v=new DataView(g);v.setUint32(0,l+_,!0),v.setUint32(4,1313821514,!0);var b=new Uint8Array(g,8);if(i)b.set(i);else{var y="_".charCodeAt(0);for(u=0;u<l;++u){var x=o.charCodeAt(u);x!=o.codePointAt(u)?b[u]=y:b[u]=x}}var T=new Uint8Array(g,8+l);for(u=0;u<_;++u)T[u]=32;var O=new ArrayBuffer(8),P=new DataView(O);P.setUint32(0,r.byteLength+c+f,!0),P.setUint32(4,5130562,!0);var C=new ArrayBuffer(h),S=new Uint8Array(C);for(u=0;u<h;++u)S[u]=0;var M=new ArrayBuffer(f),E=new Uint8Array(M);for(u=0;u<f;++u)E[u]=0;var A=[p,g,O,r];for(u=0;u<n._orderedImageData.length;++u)A.push(n._orderedImageData[u].data.buffer);A.push(C),A.push(M);var B=new Blob(A,{type:"application/octet-stream"}),F=new s.GLTFData;return F.glTFFiles[a]=B,null!=n._localEngine&&n._localEngine.dispose(),t&&n.dispose(),F})},e.prototype.setNodeTransformation=function(e,t,n){t.getPivotPoint().equalsToFloats(0,0,0)||i.Tools.Warn("Pivot points are not supported in the glTF serializer"),t.position.equalsToFloats(0,0,0)||(e.translation=n?a._GLTFUtilities._GetRightHandedPositionVector3(t.position).asArray():t.position.asArray()),t.scaling.equalsToFloats(1,1,1)||(e.scale=t.scaling.asArray());var r=i.Quaternion.RotationYawPitchRoll(t.rotation.y,t.rotation.x,t.rotation.z);t.rotationQuaternion&&r.multiplyInPlace(t.rotationQuaternion),0===r.x&&0===r.y&&0===r.z&&1===r.w||(n&&a._GLTFUtilities._GetRightHandedQuaternionFromRef(r),e.rotation=r.normalize().asArray())},e.prototype.getVertexBufferFromMesh=function(e,t){if(t.isVerticesDataPresent(e)){var n=t.getVertexBuffer(e);if(n)return n}return null},e.prototype.createBufferViewKind=function(e,t,n,r,o,s){var l=n instanceof i.Mesh?n:n instanceof i.InstancedMesh?n.sourceMesh:null;if(l){var c=l.getVertexBuffer(e),u=l.getVerticesData(e);if(c&&u){var _=i.VertexBuffer.GetTypeByteLength(t),h=u.length*_,f=a._GLTFUtilities._CreateBufferView(0,r.getByteOffset(),h,o,e+" - "+l.name);this._bufferViews.push(f),this.writeAttributeData(e,t,u,o/_,r,s,n)}}},e.prototype.setMorphTargetAttributes=function(e,t,n,r,o){if(n){t.targets||(t.targets=[]);var s={};if(n.hasNormals){var l=e.getMesh().getVerticesData(i.VertexBuffer.NormalKind),c=n.getNormals(),u=(g=e.verticesCount)*(v=12),_=a._GLTFUtilities._CreateBufferView(0,r.getByteOffset(),u,v,n.name+"_NORMAL");this._bufferViews.push(_);var h=this._bufferViews.length-1,f=a._GLTFUtilities._CreateAccessor(h,n.name+" - NORMAL","VEC3",5126,g,0,null,null);this._accessors.push(f),s.NORMAL=this._accessors.length-1,this.writeMorphTargetAttributeData(i.VertexBuffer.NormalKind,5126,e,n,l,c,v/4,r,o)}if(n.hasPositions){var d=e.getMesh().getVerticesData(i.VertexBuffer.PositionKind),p=n.getPositions();u=(g=e.verticesCount)*(v=12),_=a._GLTFUtilities._CreateBufferView(0,r.getByteOffset(),u,v,n.name+"_POSITION");this._bufferViews.push(_);h=this._bufferViews.length-1;var m={min:new i.Vector3(1/0,1/0,1/0),max:new i.Vector3(-1/0,-1/0,-1/0)};f=a._GLTFUtilities._CreateAccessor(h,n.name+" - POSITION","VEC3",5126,g,0,null,null);this._accessors.push(f),s.POSITION=this._accessors.length-1,this.writeMorphTargetAttributeData(i.VertexBuffer.PositionKind,5126,e,n,d,p,v/4,r,o,m),f.min=m.min.asArray(),f.max=m.max.asArray()}if(n.hasTangents){var g,v,b=e.getMesh().getVerticesData(i.VertexBuffer.TangentKind),y=n.getTangents();u=(g=e.verticesCount)*(v=12),_=a._GLTFUtilities._CreateBufferView(0,r.getByteOffset(),u,v,n.name+"_NORMAL");this._bufferViews.push(_);h=this._bufferViews.length-1,f=a._GLTFUtilities._CreateAccessor(h,n.name+" - TANGENT","VEC3",5126,g,0,null,null);this._accessors.push(f),s.TANGENT=this._accessors.length-1,this.writeMorphTargetAttributeData(i.VertexBuffer.TangentKind,5126,e,n,b,y,v/4,r,o)}t.targets.push(s)}},e.prototype.getMeshPrimitiveMode=function(e){return e instanceof i.LinesMesh?i.Material.LineListDrawMode:e.material?e.material.fillMode:i.Material.TriangleFillMode},e.prototype.setPrimitiveMode=function(e,t){switch(t){case i.Material.TriangleFillMode:break;case i.Material.TriangleStripDrawMode:e.mode=5;break;case i.Material.TriangleFanDrawMode:e.mode=6;break;case i.Material.PointListDrawMode:e.mode=0;case i.Material.PointFillMode:e.mode=0;break;case i.Material.LineLoopDrawMode:e.mode=2;break;case i.Material.LineListDrawMode:e.mode=1;break;case i.Material.LineStripDrawMode:e.mode=3}},e.prototype.setAttributeKind=function(e,t){switch(t){case i.VertexBuffer.PositionKind:e.attributes.POSITION=this._accessors.length-1;break;case i.VertexBuffer.NormalKind:e.attributes.NORMAL=this._accessors.length-1;break;case i.VertexBuffer.ColorKind:e.attributes.COLOR_0=this._accessors.length-1;break;case i.VertexBuffer.TangentKind:e.attributes.TANGENT=this._accessors.length-1;break;case i.VertexBuffer.UVKind:e.attributes.TEXCOORD_0=this._accessors.length-1;break;case i.VertexBuffer.UV2Kind:e.attributes.TEXCOORD_1=this._accessors.length-1;break;case i.VertexBuffer.MatricesIndicesKind:e.attributes.JOINTS_0=this._accessors.length-1;break;case i.VertexBuffer.MatricesIndicesExtraKind:e.attributes.JOINTS_1=this._accessors.length-1;break;case i.VertexBuffer.MatricesWeightsKind:e.attributes.WEIGHTS_0=this._accessors.length-1;break;case i.VertexBuffer.MatricesWeightsExtraKind:e.attributes.WEIGHTS_1=this._accessors.length-1;break;default:i.Tools.Warn("Unsupported Vertex Buffer Type: "+t)}},e.prototype.setPrimitiveAttributesAsync=function(e,t,n,r){var o,s,l,c=[],u=null;t instanceof i.Mesh?u=t:t instanceof i.InstancedMesh&&(u=t.sourceMesh);var _=[{kind:i.VertexBuffer.PositionKind,accessorType:"VEC3",accessorComponentType:5126,byteStride:12},{kind:i.VertexBuffer.NormalKind,accessorType:"VEC3",accessorComponentType:5126,byteStride:12},{kind:i.VertexBuffer.ColorKind,accessorType:"VEC4",accessorComponentType:5126,byteStride:16},{kind:i.VertexBuffer.TangentKind,accessorType:"VEC4",accessorComponentType:5126,byteStride:16},{kind:i.VertexBuffer.UVKind,accessorType:"VEC2",accessorComponentType:5126,byteStride:8},{kind:i.VertexBuffer.UV2Kind,accessorType:"VEC2",accessorComponentType:5126,byteStride:8},{kind:i.VertexBuffer.MatricesIndicesKind,accessorType:"VEC4",accessorComponentType:5123,byteStride:8},{kind:i.VertexBuffer.MatricesIndicesExtraKind,accessorType:"VEC4",accessorComponentType:5123,byteStride:8},{kind:i.VertexBuffer.MatricesWeightsKind,accessorType:"VEC4",accessorComponentType:5126,byteStride:16},{kind:i.VertexBuffer.MatricesWeightsExtraKind,accessorType:"VEC4",accessorComponentType:5126,byteStride:16}];if(u){for(var h=null,f=this.getMeshPrimitiveMode(u),d={},p=u.morphTargetManager,m=0,g=_;m<g.length;m++){var v=(Q=g[m]).kind,b=Q.accessorComponentType;if(u.isVerticesDataPresent(v)){var y=this.getVertexBufferFromMesh(v,u);Q.byteStride=y?y.getSize()*i.VertexBuffer.GetTypeByteLength(Q.accessorComponentType):4*i.VertexBuffer.DeduceStride(v),12===Q.byteStride&&(Q.accessorType="VEC3"),this.createBufferViewKind(v,b,t,n,Q.byteStride,r),Q.bufferViewIndex=this._bufferViews.length-1,d[v]=Q.bufferViewIndex}}if(u.getTotalIndices()){var x=u.getIndices();if(x){var T=4*x.length;s=a._GLTFUtilities._CreateBufferView(0,n.getByteOffset(),T,void 0,"Indices - "+u.name),this._bufferViews.push(s),h=this._bufferViews.length-1;for(var O=0,P=x.length;O<P;++O)n.setUInt32(x[O])}}if(u.subMeshes)for(var C=0,S=u.subMeshes;C<S.length;C++){var M=S[C],E=M.getMaterial()||u.getScene().defaultMaterial,A=null;if(E)if(u instanceof i.LinesMesh){var B={name:u.name+" material"};(!u.color.equals(i.Color3.White())||u.alpha<1)&&(B.pbrMetallicRoughness={baseColorFactor:u.color.asArray().concat([u.alpha])}),this._materials.push(B),A=this._materials.length-1}else if("MultiMaterial"===E.getClassName()){var F=E.subMaterials[M.materialIndex];F&&(E=F,A=this._materialMap[E.uniqueId])}else A=this._materialMap[E.uniqueId];var R=null!=A?this._materials[A]:null,L={attributes:{}};this.setPrimitiveMode(L,f);for(var w=0,I=_;w<I.length;w++){if((v=(Q=I[w]).kind)!==i.VertexBuffer.UVKind&&v!==i.VertexBuffer.UV2Kind||this._options.exportUnusedUVs||!R||this._glTFMaterialExporter._hasTexturesPresent(R))if(U=u.getVerticesData(v))if(y=this.getVertexBufferFromMesh(v,u)){var D=y.getSize(),N=Q.bufferViewIndex;if(null!=N){l={min:null,max:null},v==i.VertexBuffer.PositionKind&&(l=a._GLTFUtilities._CalculateMinMaxPositions(U,0,U.length/D,r));var V=a._GLTFUtilities._CreateAccessor(N,v+" - "+t.name,Q.accessorType,Q.accessorComponentType,U.length/D,0,l.min,l.max);this._accessors.push(V),this.setAttributeKind(L,v)}}}if(h){V=a._GLTFUtilities._CreateAccessor(h,"indices - "+t.name,"SCALAR",5125,M.indexCount,4*M.indexStart,null,null);this._accessors.push(V),L.indices=this._accessors.length-1}if(null!=A&&Object.keys(L.attributes).length>0){var j=null!==u.overrideMaterialSideOrientation?u.overrideMaterialSideOrientation:E.sideOrientation;if(j==i.Material.ClockWiseSideOrientation&&this._babylonScene.useRightHandedSystem||j==i.Material.ClockWiseSideOrientation&&r&&u.overrideMaterialSideOrientation!==(null===(o=u.material)||void 0===o?void 0:o.sideOrientation)){var k=null!=h?this._bufferViews[h].byteOffset:null;null==k&&(k=0);var z=null;if(null!=h&&(z=u.getIndices()),z)this.reorderIndicesBasedOnPrimitiveMode(M,f,z,k,n);else for(var G=0,H=_;G<H.length;G++){var U,Q=H[G];if(U=u.getVerticesData(Q.kind)){var W=this._bufferViews[d[Q.kind]].byteOffset;W||(W=0),this.reorderVertexAttributeDataBasedOnPrimitiveMode(M,f,j,Q.kind,U,W,n,r)}}}L.material=A}if(p)for(var X=void 0,K=0;K<p.numTargets;++K)X=p.getTarget(K),this.setMorphTargetAttributes(M,L,X,n,r);e.primitives.push(L),this._extensionsPostExportMeshPrimitiveAsync("postExport",L,M,n),c.push()}}return Promise.all(c).then(function(){})},e.prototype.isBabylonCoordinateSystemConvertingNode=function(e){if(e instanceof i.TransformNode){if("__root__"!==e.name)return!1;for(var t=e.getWorldMatrix(),n=i.Matrix.Compose(this._convertToRightHandedSystem?new i.Vector3(-1,1,1):i.Vector3.One(),i.Quaternion.Identity(),i.Vector3.Zero()),r=t.multiply(n),o=i.Matrix.IdentityReadOnly,a=0;a<16;a++)if(Math.abs(r.m[a]-o.m[a])>i.Epsilon)return!1;return!(e instanceof i.Mesh&&null!==e.geometry||e instanceof i.InstancedMesh&&null!==e.sourceMesh.geometry)&&!this._includeCoordinateSystemConversionNodes}return!1},e.prototype.createSceneAsync=function(e,t){var n,o,a,s=this,l={nodes:[]},c=s._options.transformNodes?s._options.transformNodes:e.transformNodes,u=s._options.meshes?s._options.meshes:e.meshes,_=s._options.lights?s._options.lights:e.lights,h=s._options.materials?s._options.materials:e.materials,f=Object(r.__spreadArray)(Object(r.__spreadArray)(Object(r.__spreadArray)([],c,!0),u,!0),_,!0),d=[];return this._convertToRightHandedSystem=!e.useRightHandedSystem,this._convertToRightHandedSystemMap={},e.rootNodes.forEach(function(e){s._convertToRightHandedSystemMap[e.uniqueId]=s._convertToRightHandedSystem,e.getDescendants(!1).forEach(function(e){s._convertToRightHandedSystemMap[e.uniqueId]=s._convertToRightHandedSystem})}),e.rootNodes.forEach(function(e){if(s.isBabylonCoordinateSystemConvertingNode(e)){d.push(e);var t=f.indexOf(e);-1!==t&&f.splice(t,1),e.getDescendants(!1).forEach(function(e){s._convertToRightHandedSystemMap[e.uniqueId]=!1})}}),this._glTFMaterialExporter._convertMaterialsToGLTFAsync(h,"image/png",!0).then(function(){return s.createNodeMapAndAnimationsAsync(e,f,t).then(function(r){return s.createSkinsAsync(e,r,t).then(function(e){if(s._nodeMap=r,s._totalByteLength=t.getByteOffset(),null==s._totalByteLength)throw new Error("undefined byte length!");for(var c=0,u=f;c<u.length;c++){var _=u[c];if(void 0!==(n=s._nodeMap[_.uniqueId])){if(o=s._nodes[n],_.metadata&&(s._options.metadataSelector?o.extras=s._options.metadataSelector(_.metadata):_.metadata.gltf&&(o.extras=_.metadata.gltf.extras)),!_.parent||-1===f.indexOf(_.parent)||-1!==d.indexOf(_.parent))if(s._options.shouldExportNode&&!s._options.shouldExportNode(_))i.Tools.Log("Omitting "+_.name+" from scene.");else s._convertToRightHandedSystemMap[_.uniqueId]&&(o.translation&&(o.translation[2]*=-1,o.translation[0]*=-1),o.rotation=o.rotation?i.Quaternion.FromArray([0,1,0,0]).multiply(i.Quaternion.FromArray(o.rotation)).asArray():i.Quaternion.FromArray([0,1,0,0]).asArray()),l.nodes.push(n);if(_ instanceof i.Mesh){var h=_;h.skeleton&&(o.skin=e[h.skeleton.uniqueId])}if(a=_.getDescendants(!0),!o.children&&a&&a.length){for(var p=[],m=0,g=a;m<g.length;m++){var v=g[m];null!=s._nodeMap[v.uniqueId]&&p.push(s._nodeMap[v.uniqueId])}p.length&&(o.children=p)}}}l.nodes.length&&s._scenes.push(l)})})})},e.prototype.createNodeMapAndAnimationsAsync=function(e,t,n){for(var r,o=this,a=Promise.resolve(),s={},c={name:"runtime animations",channels:[],samplers:[]},u=[],_=function(t){!h._options.shouldExportNode||h._options.shouldExportNode(t)?a=a.then(function(){var a=o._convertToRightHandedSystemMap[t.uniqueId];return o.createNodeAsync(t,n,a,s).then(function(_){var h=o._extensionsPostExportNodeAsync("createNodeAsync",_,t,s);return null==h?(i.Tools.Warn("Not exporting node "+t.name),Promise.resolve()):h.then(function(i){i&&(o._nodes.push(i),r=o._nodes.length-1,s[t.uniqueId]=r,e.animationGroups.length||(l._GLTFAnimation._CreateMorphTargetAnimationFromMorphTargetAnimations(t,c,u,s,o._nodes,n,o._bufferViews,o._accessors,a,o._animationSampleRate),t.animations.length&&l._GLTFAnimation._CreateNodeAnimationFromNodeAnimations(t,c,u,s,o._nodes,n,o._bufferViews,o._accessors,a,o._animationSampleRate)))})})}):t.name},h=this,f=0,d=t;f<d.length;f++){_(d[f])}return a.then(function(){return c.channels.length&&c.samplers.length&&o._animations.push(c),u.forEach(function(e){e.channels.length&&e.samplers.length&&o._animations.push(e)}),e.animationGroups.length&&l._GLTFAnimation._CreateNodeAndMorphAnimationFromAnimationGroups(e,o._animations,s,o._nodes,n,o._bufferViews,o._accessors,o._convertToRightHandedSystemMap,o._animationSampleRate),s})},e.prototype.createNodeAsync=function(e,t,n,r){var o=this;return Promise.resolve().then(function(){var r={},a={primitives:[]};if(e.name&&(r.name=e.name),e instanceof i.TransformNode){if(o.setNodeTransformation(r,e,n),e instanceof i.Mesh){var s=e.morphTargetManager;if(s&&s.numTargets>0){a.weights=[];for(var l=0;l<s.numTargets;++l)a.weights.push(s.getTarget(l).influence)}}return o.setPrimitiveAttributesAsync(a,e,t,n).then(function(){return a.primitives.length&&(o._meshes.push(a),r.mesh=o._meshes.length-1),r})}return r})},e.prototype.createSkinsAsync=function(e,t,n){for(var r,o=Promise.resolve(),s={},l=0,c=e.skeletons;l<c.length;l++){for(var u=c[l],_={joints:[]},h=[],f={},d=-1,p=0;p<u.bones.length;++p){-1!==(m=null!==(r=(g=u.bones[p]).getIndex())&&void 0!==r?r:p)&&(f[m]=g,m>d&&(d=m))}for(var m=0;m<=d;++m){var g=f[m];h.push(g.getInvertedAbsoluteTransform());var v=g.getTransformNode();v?_.joints.push(t[v.uniqueId]):i.Tools.Warn("Exporting a bone without a linked transform node is currently unsupported")}var b=64*h.length,y=n.getByteOffset(),x=a._GLTFUtilities._CreateBufferView(0,y,b,void 0,"InverseBindMatrices - "+u.name);this._bufferViews.push(x);var T=this._bufferViews.length-1,O=a._GLTFUtilities._CreateAccessor(T,"InverseBindMatrices - "+u.name,"MAT4",5126,h.length,null,null,null),P=this._accessors.push(O)-1;_.inverseBindMatrices=P,this._skins.push(_),s[u.uniqueId]=this._skins.length-1,h.forEach(function(e){e.m.forEach(function(e){n.setFloat32(e)})})}return o.then(function(){return s})},e._ExtensionNames=new Array,e._ExtensionFactories={},e}(),u=function(){function e(e){this._arrayBuffer=new ArrayBuffer(e),this._dataView=new DataView(this._arrayBuffer),this._byteOffset=0}return e.prototype.resizeBuffer=function(e){for(var t=new ArrayBuffer(e),n=new Uint8Array(this._arrayBuffer),r=new Uint8Array(t),i=0,o=r.byteLength;i<o;++i)r[i]=n[i];return this._arrayBuffer=t,this._dataView=new DataView(this._arrayBuffer),t},e.prototype.getArrayBuffer=function(){return this.resizeBuffer(this.getByteOffset())},e.prototype.getByteOffset=function(){if(null==this._byteOffset)throw new Error("Byte offset is undefined!");return this._byteOffset},e.prototype.setUInt8=function(e,t){null!=t?t<this._byteOffset?this._dataView.setUint8(t,e):i.Tools.Error("BinaryWriter: byteoffset is greater than the current binary buffer length!"):(this._byteOffset+1>this._arrayBuffer.byteLength&&this.resizeBuffer(2*this._arrayBuffer.byteLength),this._dataView.setUint8(this._byteOffset,e),this._byteOffset+=1)},e.prototype.setUInt16=function(e,t){null!=t?t<this._byteOffset?this._dataView.setUint16(t,e,!0):i.Tools.Error("BinaryWriter: byteoffset is greater than the current binary buffer length!"):(this._byteOffset+2>this._arrayBuffer.byteLength&&this.resizeBuffer(2*this._arrayBuffer.byteLength),this._dataView.setUint16(this._byteOffset,e,!0),this._byteOffset+=2)},e.prototype.getUInt32=function(e){if(e<this._byteOffset)return this._dataView.getUint32(e,!0);throw i.Tools.Error("BinaryWriter: byteoffset is greater than the current binary buffer length!"),new Error("BinaryWriter: byteoffset is greater than the current binary buffer length!")},e.prototype.getVector3Float32FromRef=function(e,t){t+8>this._byteOffset?i.Tools.Error("BinaryWriter: byteoffset is greater than the current binary buffer length!"):(e.x=this._dataView.getFloat32(t,!0),e.y=this._dataView.getFloat32(t+4,!0),e.z=this._dataView.getFloat32(t+8,!0))},e.prototype.setVector3Float32FromRef=function(e,t){t+8>this._byteOffset?i.Tools.Error("BinaryWriter: byteoffset is greater than the current binary buffer length!"):(this._dataView.setFloat32(t,e.x,!0),this._dataView.setFloat32(t+4,e.y,!0),this._dataView.setFloat32(t+8,e.z,!0))},e.prototype.getVector4Float32FromRef=function(e,t){t+12>this._byteOffset?i.Tools.Error("BinaryWriter: byteoffset is greater than the current binary buffer length!"):(e.x=this._dataView.getFloat32(t,!0),e.y=this._dataView.getFloat32(t+4,!0),e.z=this._dataView.getFloat32(t+8,!0),e.w=this._dataView.getFloat32(t+12,!0))},e.prototype.setVector4Float32FromRef=function(e,t){t+12>this._byteOffset?i.Tools.Error("BinaryWriter: byteoffset is greater than the current binary buffer length!"):(this._dataView.setFloat32(t,e.x,!0),this._dataView.setFloat32(t+4,e.y,!0),this._dataView.setFloat32(t+8,e.z,!0),this._dataView.setFloat32(t+12,e.w,!0))},e.prototype.setFloat32=function(e,t){isNaN(e)&&i.Tools.Error("Invalid data being written!"),null!=t&&(t<this._byteOffset?this._dataView.setFloat32(t,e,!0):i.Tools.Error("BinaryWriter: byteoffset is greater than the current binary length!")),this._byteOffset+4>this._arrayBuffer.byteLength&&this.resizeBuffer(2*this._arrayBuffer.byteLength),this._dataView.setFloat32(this._byteOffset,e,!0),this._byteOffset+=4},e.prototype.setUInt32=function(e,t){null!=t?t<this._byteOffset?this._dataView.setUint32(t,e,!0):i.Tools.Error("BinaryWriter: byteoffset is greater than the current binary buffer length!"):(this._byteOffset+4>this._arrayBuffer.byteLength&&this.resizeBuffer(2*this._arrayBuffer.byteLength),this._dataView.setUint32(this._byteOffset,e,!0),this._byteOffset+=4)},e}()},"./glTF/2.0/glTFExporterExtension.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"__IGLTFExporterExtensionV2",function(){return r});var r=0},"./glTF/2.0/glTFMaterialExporter.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"_GLTFMaterialExporter",function(){return o});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Maths/math.vector"),o=function(){function e(e){this._textureMap={},this._textureMap={},this._exporter=e}return e.FuzzyEquals=function(e,t,n){return i.Scalar.WithinEpsilon(e.r,t.r,n)&&i.Scalar.WithinEpsilon(e.g,t.g,n)&&i.Scalar.WithinEpsilon(e.b,t.b,n)},e.prototype._convertMaterialsToGLTFAsync=function(e,t,n){for(var r=[],o=0,a=e;o<a.length;o++){var s=a[o];"StandardMaterial"===s.getClassName()?r.push(this._convertStandardMaterialAsync(s,t,n)):-1!==s.getClassName().indexOf("PBR")?r.push(this._convertPBRMaterialAsync(s,t,n)):i.Tools.Warn("Unsupported material type: "+s.name)}return Promise.all(r).then(function(){})},e.prototype._stripTexturesFromMaterial=function(e){var t={};if(e){t.name=e.name,t.doubleSided=e.doubleSided,t.alphaMode=e.alphaMode,t.alphaCutoff=e.alphaCutoff,t.emissiveFactor=e.emissiveFactor;var n=e.pbrMetallicRoughness;n&&(t.pbrMetallicRoughness={},t.pbrMetallicRoughness.baseColorFactor=n.baseColorFactor,t.pbrMetallicRoughness.metallicFactor=n.metallicFactor,t.pbrMetallicRoughness.roughnessFactor=n.roughnessFactor)}return t},e.prototype._hasTexturesPresent=function(e){var t;if(e.emissiveTexture||e.normalTexture||e.occlusionTexture)return!0;var n=e.pbrMetallicRoughness;if(n&&(n.baseColorTexture||n.metallicRoughnessTexture))return!0;if(e.extensions)for(var r in e.extensions){var i=e.extensions[r];if(i)return null===(t=i.hasTextures)||void 0===t?void 0:t.call(i)}return!1},e.prototype._getTextureInfo=function(e){if(e){var t=e.uid;if(t in this._textureMap)return this._textureMap[t]}return null},e.prototype._convertToGLTFPBRMetallicRoughness=function(t){var n=new i.Vector2(0,1),r=new i.Vector2(0,.1),o=new i.Vector2(0,.1),a=new i.Vector2(1300,.1);var s=t.diffuseColor.toLinearSpace().scale(.5),l=t.alpha,c=function(e){return function(e,t,n,r,i){return(1-e)*(1-e)*(1-e)*t+3*(1-e)*(1-e)*e*n+3*(1-e)*e*e*r+e*e*e*i}(Math.pow(e/a.x,.333333),n.y,r.y,o.y,a.y)}(i.Scalar.Clamp(t.specularPower,0,e._MaxSpecularPower));return{baseColorFactor:[s.r,s.g,s.b,l],metallicFactor:0,roughnessFactor:c}},e._SolveMetallic=function(e,t,n){if(t<this._DielectricSpecular.r)return this._DielectricSpecular,0;var r=this._DielectricSpecular.r,o=e*n/(1-this._DielectricSpecular.r)+t-2*this._DielectricSpecular.r,a=o*o-4*r*(this._DielectricSpecular.r-t);return i.Scalar.Clamp((-o+Math.sqrt(a))/(2*r),0,1)},e._SetAlphaMode=function(e,t){t.needAlphaBlending()?e.alphaMode="BLEND":t.needAlphaTesting()&&(e.alphaMode="MASK",e.alphaCutoff=t.alphaCutOff)},e.prototype._convertStandardMaterialAsync=function(t,n,r){var o=this._exporter._materialMap,a=this._exporter._materials,s=[],l=this._convertToGLTFPBRMetallicRoughness(t),c={name:t.name};return null==t.backFaceCulling||t.backFaceCulling||(t.twoSidedLighting||i.Tools.Warn(t.name+": Back-face culling enabled and two-sided lighting disabled is not supported in glTF."),c.doubleSided=!0),r&&(t.diffuseTexture&&s.push(this._exportTextureAsync(t.diffuseTexture,n).then(function(e){e&&(l.baseColorTexture=e)})),t.bumpTexture&&s.push(this._exportTextureAsync(t.bumpTexture,n).then(function(e){e&&(c.normalTexture=e,null!=t.bumpTexture&&1!==t.bumpTexture.level&&(c.normalTexture.scale=t.bumpTexture.level))})),t.emissiveTexture&&(c.emissiveFactor=[1,1,1],s.push(this._exportTextureAsync(t.emissiveTexture,n).then(function(e){e&&(c.emissiveTexture=e)}))),t.ambientTexture&&s.push(this._exportTextureAsync(t.ambientTexture,n).then(function(e){if(e){var t={index:e.index};c.occlusionTexture=t,t.strength=1}}))),(t.alpha<1||t.opacityTexture)&&(t.alphaMode===i.Constants.ALPHA_COMBINE?c.alphaMode="BLEND":i.Tools.Warn(t.name+": glTF 2.0 does not support alpha mode: "+t.alphaMode.toString())),t.emissiveColor&&!e.FuzzyEquals(t.emissiveColor,i.Color3.Black(),e._Epsilon)&&(c.emissiveFactor=t.emissiveColor.asArray()),c.pbrMetallicRoughness=l,e._SetAlphaMode(c,t),a.push(c),o[t.uniqueId]=a.length-1,this._finishMaterial(s,c,t,n)},e.prototype._finishMaterial=function(e,t,n,r){var i=this;return Promise.all(e).then(function(){for(var e=null,o=0,a=i._exporter._extensionsPostExportMaterialAdditionalTextures("exportMaterial",t,n);o<a.length;o++){var s=a[o];e||(e=[]),e.push(i._exportTextureAsync(s,r))}return e||(e=[Promise.resolve(null)]),Promise.all(e).then(function(){var e=i._exporter._extensionsPostExportMaterialAsync("exportMaterial",t,n);return e?e.then(function(){return t}):t})})},e.prototype._convertPBRMetallicRoughnessMaterialAsync=function(t,n,r){var o=this._exporter._materialMap,a=this._exporter._materials,s=[],l={};t.baseColor&&(l.baseColorFactor=[t.baseColor.r,t.baseColor.g,t.baseColor.b,t.alpha]),null!=t.metallic&&1!==t.metallic&&("string"==typeof t.metallic&&(t.metallic=parseFloat(t.metallic)),l.metallicFactor=t.metallic),null!=t.roughness&&1!==t.roughness&&("string"==typeof t.roughness&&(t.roughness=parseFloat(t.roughness)),l.roughnessFactor=t.roughness);var c={name:t.name};return t.doubleSided&&(c.doubleSided=t.doubleSided),e._SetAlphaMode(c,t),r&&(null!=t.baseTexture&&s.push(this._exportTextureAsync(t.baseTexture,n).then(function(e){e&&(l.baseColorTexture=e)})),t.normalTexture&&s.push(this._exportTextureAsync(t.normalTexture,n).then(function(e){e&&(c.normalTexture=e,1!==t.normalTexture.level&&(c.normalTexture.scale=t.normalTexture.level))})),t.occlusionTexture&&s.push(this._exportTextureAsync(t.occlusionTexture,n).then(function(e){e&&(c.occlusionTexture=e,null!=t.occlusionStrength&&(c.occlusionTexture.strength=t.occlusionStrength))})),t.emissiveTexture&&s.push(this._exportTextureAsync(t.emissiveTexture,n).then(function(e){e&&(c.emissiveTexture=e)})),t.metallicRoughnessTexture&&s.push(this._exportTextureAsync(t.metallicRoughnessTexture,n).then(function(e){e&&(l.metallicRoughnessTexture=e)}))),e.FuzzyEquals(t.emissiveColor,i.Color3.Black(),e._Epsilon)&&(c.emissiveFactor=t.emissiveColor.asArray()),c.pbrMetallicRoughness=l,a.push(c),o[t.uniqueId]=a.length-1,this._finishMaterial(s,c,t,n)},e.prototype._createBase64FromCanvasAsync=function(e,t,n,o){var a=this;return new Promise(function(s,l){return Object(r.__awaiter)(a,void 0,void 0,function(){var a,l,c,u,_,h;return Object(r.__generator)(this,function(r){var f=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!Window.MSStream||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1;navigator.userAgent.indexOf("Safari")>-1&&navigator.userAgent.indexOf("Chrome");switch(!0,r.label){case 0:return a=i.Constants.TEXTURETYPE_UNSIGNED_INT,l=this._exporter._babylonScene,c=l.getEngine(),u=c.createRawTexture(e,t,n,i.Constants.TEXTUREFORMAT_RGBA,!1,!0,i.Texture.NEAREST_SAMPLINGMODE,null,a),[4,i.TextureTools.ApplyPostProcess("pass",u,l,a,i.Constants.TEXTURE_NEAREST_SAMPLINGMODE,i.Constants.TEXTUREFORMAT_RGBA)];case 1:return r.sent(),[4,c._readTexturePixels(u,t,n)];case 2:return _=r.sent(),[4,i.Tools.DumpDataAsync(t,n,_,o,void 0,!0,!1)];case 3:return h=r.sent(),s(h),[2]}})})})},e.prototype._createWhiteTexture=function(e,t,n){for(var r=new Uint8Array(e*t*4),o=0;o<r.length;o+=4)r[o]=r[o+1]=r[o+2]=r[o+3]=255;return i.RawTexture.CreateRGBATexture(r,e,t,n)},e.prototype._resizeTexturesToSameDimensions=function(e,t,n){var r,o,a=e?e.getSize():{width:0,height:0},s=t?t.getSize():{width:0,height:0};return a.width<s.width?(r=e&&e instanceof i.Texture?i.TextureTools.CreateResizedCopy(e,s.width,s.height,!0):this._createWhiteTexture(s.width,s.height,n),o=t):a.width>s.width?(o=t&&t instanceof i.Texture?i.TextureTools.CreateResizedCopy(t,a.width,a.height,!0):this._createWhiteTexture(a.width,a.height,n),r=e):(r=e,o=t),{texture1:r,texture2:o}},e.prototype._convertPixelArrayToFloat32=function(e){if(e instanceof Uint8Array){for(var t=e.length,n=new Float32Array(e.length),r=0;r<t;++r)n[r]=e[r]/255;return n}if(e instanceof Float32Array)return e;throw new Error("Unsupported pixel format!")},e.prototype._convertSpecularGlossinessTexturesToMetallicRoughnessAsync=function(t,n,o,a){var s;return Object(r.__awaiter)(this,void 0,void 0,function(){var l,c,u,_,h,f,d,p,m,g,v,b,y,x,T,O,P,C,S,M,E,A,B,F,R,L,w,I,D,N,V,j;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return l=[],t||n?(c=t?t.getScene():n?n.getScene():null)?(u=this._resizeTexturesToSameDimensions(t,n,c),_=null===(s=u.texture1)||void 0===s?void 0:s.getSize(),h=void 0,f=void 0,d=_.width,p=_.height,[4,u.texture1.readPixels()]):[3,3]:[2,Promise.reject("_ConvertSpecularGlosinessTexturesToMetallicRoughness: diffuse and specular glossiness textures are not defined!")];case 1:return m=r.sent(),[4,u.texture2.readPixels()];case 2:if(g=r.sent(),!m)return[2,Promise.reject("Failed to retrieve pixels from diffuse texture!")];if(h=this._convertPixelArrayToFloat32(m),!g)return[2,Promise.reject("Failed to retrieve pixels from specular glossiness texture!")];for(f=this._convertPixelArrayToFloat32(g),v=f.byteLength,b=new Uint8Array(v),y=new Uint8Array(v),4,x=i.Color3.Black(),T=0,O=0,L=0;L<p;++L)for(w=0;w<d;++w)P=4*(d*L+w),C=new i.Color3(h[P],h[P+1],h[P+2]).toLinearSpace().multiply(o.diffuseColor),S=new i.Color3(f[P],f[P+1],f[P+2]).toLinearSpace().multiply(o.specularColor),M=f[P+3]*o.glossiness,E={diffuseColor:C,specularColor:S,glossiness:M},A=this._convertSpecularGlossinessToMetallicRoughness(E),x.r=Math.max(x.r,A.baseColor.r),x.g=Math.max(x.g,A.baseColor.g),x.b=Math.max(x.b,A.baseColor.b),T=Math.max(T,A.metallic),O=Math.max(O,A.roughness),y[P]=255*A.baseColor.r,y[P+1]=255*A.baseColor.g,y[P+2]=255*A.baseColor.b,y[P+3]=u.texture1.hasAlpha?255*h[P+3]:255,b[P]=0,b[P+1]=255*A.roughness,b[P+2]=255*A.metallic,b[P+3]=255;for(B={baseColor:x,metallic:T,roughness:O},F=!1,R=!1,L=0;L<p;++L)for(w=0;w<d;++w)y[I=4*(d*L+w)]/=B.baseColor.r>e._Epsilon?B.baseColor.r:1,y[I+1]/=B.baseColor.g>e._Epsilon?B.baseColor.g:1,y[I+2]/=B.baseColor.b>e._Epsilon?B.baseColor.b:1,D=i.Color3.FromInts(y[I],y[I+1],y[I+2]),N=D.toGammaSpace(),y[I]=255*N.r,y[I+1]=255*N.g,y[I+2]=255*N.b,e.FuzzyEquals(N,i.Color3.White(),e._Epsilon)||(R=!0),b[I+1]/=B.roughness>e._Epsilon?B.roughness:1,b[I+2]/=B.metallic>e._Epsilon?B.metallic:1,V=i.Color3.FromInts(255,b[I+1],b[I+2]),e.FuzzyEquals(V,i.Color3.White(),e._Epsilon)||(F=!0);return F&&(j=this._createBase64FromCanvasAsync(b,d,p,a).then(function(e){B.metallicRoughnessTextureBase64=e}),l.push(j)),R&&(j=this._createBase64FromCanvasAsync(y,d,p,a).then(function(e){B.baseColorTextureBase64=e}),l.push(j)),[2,Promise.all(l).then(function(){return B})];case 3:return[2,Promise.reject("_ConvertSpecularGlossinessTexturesToMetallicRoughness: Scene from textures is missing!")]}})})},e.prototype._convertSpecularGlossinessToMetallicRoughness=function(t){var n=this._getPerceivedBrightness(t.diffuseColor),r=this._getPerceivedBrightness(t.specularColor),o=1-this._getMaxComponent(t.specularColor),a=e._SolveMetallic(n,r,o),s=t.diffuseColor.scale(o/(1-e._DielectricSpecular.r)/Math.max(1-a,e._Epsilon)),l=t.specularColor.subtract(e._DielectricSpecular.scale(1-a)).scale(1/Math.max(a,e._Epsilon)),c=i.Color3.Lerp(s,l,a*a);return{baseColor:c=c.clampToRef(0,1,c),metallic:a,roughness:1-t.glossiness}},e.prototype._getPerceivedBrightness=function(e){return e?Math.sqrt(.299*e.r*e.r+.587*e.g*e.g+.114*e.b*e.b):0},e.prototype._getMaxComponent=function(e){return e?Math.max(e.r,Math.max(e.g,e.b)):0},e.prototype._convertMetalRoughFactorsToMetallicRoughnessAsync=function(e,t,n,r){var i=[],o={baseColor:e._albedoColor,metallic:e._metallic,roughness:e._roughness};if(r){e._albedoTexture&&i.push(this._exportTextureAsync(e._albedoTexture,t).then(function(e){e&&(n.baseColorTexture=e)}));var a=e._metallicTexture;a&&i.push(this._exportTextureAsync(a,t).then(function(e){e&&(n.metallicRoughnessTexture=e)}))}return Promise.all(i).then(function(){return o})},e.prototype._getGLTFTextureSampler=function(e){var t=this._getGLTFTextureWrapModesSampler(e),n=e instanceof i.Texture?e.samplingMode:null;if(null!=n)switch(n){case i.Texture.LINEAR_LINEAR:t.magFilter=9729,t.minFilter=9729;break;case i.Texture.LINEAR_NEAREST:t.magFilter=9729,t.minFilter=9728;break;case i.Texture.NEAREST_LINEAR:t.magFilter=9728,t.minFilter=9729;break;case i.Texture.NEAREST_LINEAR_MIPLINEAR:t.magFilter=9728,t.minFilter=9987;break;case i.Texture.NEAREST_NEAREST:t.magFilter=9728,t.minFilter=9728;break;case i.Texture.NEAREST_LINEAR_MIPNEAREST:t.magFilter=9728,t.minFilter=9985;break;case i.Texture.LINEAR_NEAREST_MIPNEAREST:t.magFilter=9729,t.minFilter=9984;break;case i.Texture.LINEAR_NEAREST_MIPLINEAR:t.magFilter=9729,t.minFilter=9986;break;case i.Texture.NEAREST_NEAREST_MIPLINEAR:t.magFilter=9728,t.minFilter=9986;break;case i.Texture.LINEAR_LINEAR_MIPLINEAR:t.magFilter=9729,t.minFilter=9987;break;case i.Texture.LINEAR_LINEAR_MIPNEAREST:t.magFilter=9729,t.minFilter=9985;break;case i.Texture.NEAREST_NEAREST_MIPNEAREST:t.magFilter=9728,t.minFilter=9984}return t},e.prototype._getGLTFTextureWrapMode=function(e){switch(e){case i.Texture.WRAP_ADDRESSMODE:return 10497;case i.Texture.CLAMP_ADDRESSMODE:return 33071;case i.Texture.MIRROR_ADDRESSMODE:return 33648;default:return i.Tools.Error("Unsupported Texture Wrap Mode "+e+"!"),10497}},e.prototype._getGLTFTextureWrapModesSampler=function(e){var t=this._getGLTFTextureWrapMode(e instanceof i.Texture?e.wrapU:i.Texture.WRAP_ADDRESSMODE),n=this._getGLTFTextureWrapMode(e instanceof i.Texture?e.wrapV:i.Texture.WRAP_ADDRESSMODE);return 10497===t&&10497===n?{}:{wrapS:t,wrapT:n}},e.prototype._convertSpecGlossFactorsToMetallicRoughnessAsync=function(e,t,n,r){var i=this;return Promise.resolve().then(function(){var o=i._exporter._samplers,a=i._exporter._textures,s={diffuseColor:e._albedoColor,specularColor:e._reflectivityColor,glossiness:e._microSurface},l=null,c=e._albedoTexture,u=e._reflectivityTexture;if(c){var _=i._getGLTFTextureSampler(c);null!=_.magFilter&&null!=_.minFilter&&null!=_.wrapS&&null!=_.wrapT&&(o.push(_),l=o.length-1)}var h=e._useMicroSurfaceFromReflectivityMapAlpha;return u&&!h?Promise.reject("_ConvertPBRMaterial: Glossiness values not included in the reflectivity texture are currently not supported"):(c||u)&&r?i._convertSpecularGlossinessTexturesToMetallicRoughnessAsync(c,u,s,t).then(function(e){if(e.baseColorTextureBase64){var r=i._getTextureInfoFromBase64(e.baseColorTextureBase64,"bjsBaseColorTexture_"+a.length+".png",t,c?c.coordinatesIndex:null,l);r&&(n.baseColorTexture=r)}if(e.metallicRoughnessTextureBase64){var o=i._getTextureInfoFromBase64(e.metallicRoughnessTextureBase64,"bjsMetallicRoughnessTexture_"+a.length+".png",t,u?u.coordinatesIndex:null,l);o&&(n.metallicRoughnessTexture=o)}return e}):i._convertSpecularGlossinessToMetallicRoughness(s)})},e.prototype._convertPBRMaterialAsync=function(e,t,n){var r=this,i={},o={name:e.name};if(e.isMetallicWorkflow()){var a=e._albedoColor,s=e.alpha;return a&&(i.baseColorFactor=[a.r,a.g,a.b,s]),this._convertMetalRoughFactorsToMetallicRoughnessAsync(e,t,i,n).then(function(a){return r.setMetallicRoughnessPbrMaterial(a,e,o,i,t,n)})}return this._convertSpecGlossFactorsToMetallicRoughnessAsync(e,t,i,n).then(function(a){return r.setMetallicRoughnessPbrMaterial(a,e,o,i,t,n)})},e.prototype.setMetallicRoughnessPbrMaterial=function(t,n,r,o,a,s){var l=this._exporter._materialMap,c=this._exporter._materials,u=[];if(t){if(e._SetAlphaMode(r,n),e.FuzzyEquals(t.baseColor,i.Color3.White(),e._Epsilon)&&n.alpha>=e._Epsilon||(o.baseColorFactor=[t.baseColor.r,t.baseColor.g,t.baseColor.b,n.alpha]),null!=t.metallic&&("string"==typeof t.metallic&&(t.metallic=parseFloat(t.metallic)),o.metallicFactor=t.metallic),null!=t.roughness&&("string"==typeof t.roughness&&(t.roughness=parseFloat(t.roughness)),o.roughnessFactor=t.roughness),null==n.backFaceCulling||n.backFaceCulling||(n._twoSidedLighting||i.Tools.Warn(n.name+": Back-face culling enabled and two-sided lighting disabled is not supported in glTF."),r.doubleSided=!0),s){var _=n._bumpTexture;if(_){var h=this._exportTextureAsync(_,a).then(function(e){e&&(r.normalTexture=e,1!==_.level&&(r.normalTexture.scale=_.level))});u.push(h)}var f=n._ambientTexture;if(f){h=this._exportTextureAsync(f,a).then(function(e){if(e){var t={index:e.index,texCoord:e.texCoord};r.occlusionTexture=t;var i=n._ambientTextureStrength;i&&(t.strength=i)}});u.push(h)}else if(n.metallicTexture&&n.useAmbientOcclusionFromMetallicTextureRed){h=this._exportTextureAsync(n.metallicTexture,a).then(function(e){if(e){var t={index:e.index};r.occlusionTexture=t,n.ambientTextureStrength&&(t.strength=n.ambientTextureStrength)}});u.push(h)}var d=n._emissiveTexture;if(d){h=this._exportTextureAsync(d,a).then(function(e){e&&(r.emissiveTexture=e)});u.push(h)}}var p=n._emissiveColor;e.FuzzyEquals(p,i.Color3.Black(),e._Epsilon)||(r.emissiveFactor=p.asArray()),r.pbrMetallicRoughness=o,c.push(r),l[n.uniqueId]=c.length-1}return this._finishMaterial(u,r,n,a)},e.prototype.getPixelsFromTexture=function(e){return e.textureType,i.Constants.TEXTURETYPE_UNSIGNED_INT,e.readPixels()},e.prototype._exportTextureAsync=function(e,t){var n=this,r=this._exporter._extensionsPreExportTextureAsync("exporter",e,t);return r?r.then(function(r){return r?n._exportTextureInfoAsync(r,t):n._exportTextureInfoAsync(e,t)}):this._exportTextureInfoAsync(e,t)},e.prototype._exportTextureInfoAsync=function(e,t){var n=this,i=void 0;return e instanceof BABYLON.ProceduralTexture||-1!==e.url.indexOf("blob:")||(i=e.url),Promise.resolve().then(function(){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,o,a,s,l,c,u,_,h,f=this;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return(n=e.uid)in this._textureMap?[2,this._textureMap[n]]:[3,1];case 1:return[4,this.getPixelsFromTexture(e)];case 2:if(!(o=r.sent()))return[2,null];for(a=this._exporter._samplers,s=this._getGLTFTextureSampler(e),l=null,c=null,u=0;u<a.length;++u)if((_=a[u]).minFilter===s.minFilter&&_.magFilter===s.magFilter&&_.wrapS===s.wrapS&&_.wrapT===s.wrapT){c=u;break}if(null==c?(a.push(s),l=a.length-1):l=c,h=e.getSize(),e.mimeType)switch(e.mimeType){case"image/jpeg":t="image/jpeg";break;case"image/png":t="image/png"}return[2,this._createBase64FromCanvasAsync(o,h.width,h.height,t).then(function(r){var o=e.name.replace(/[/\\?%*:|"<>]/g,"_");e.url&&-1===e.url.indexOf("blob:")||(o=BABYLON.Tools.RandomId());var a=f._getTextureInfoFromBase64(r,o,t,e.coordinatesIndex,l,i);return a&&(f._textureMap[n]=a,f._exporter._extensionsPostExportTextures("linkTextureInfo",a,e)),a})]}})})})},e.prototype._getTextureInfoFromBase64=function(e,t,n,r,o,a){var s=this._exporter._textures,l=this._exporter._images,c=this._exporter._imageData,u=null,_={source:l.length,name:t};null!=o&&(_.sampler=o);for(var h=atob(e.split(",")[1]),f=new ArrayBuffer(h.length),d=new Uint8Array(f),p=0,m=h.length;p<m;++p)d[p]=h.charCodeAt(p);var g={data:d,mimeType:n,url:a},v="image/jpeg"===n?".jpeg":".png",b=t+v,y=b;if(b in c&&(b=t+"_"+i.Tools.RandomId()+v),c[b]=g,"image/jpeg"===n||"image/png"===n){var x={name:t,uri:b},T=null;for(p=0;p<l.length;++p)if(l[p].uri===y){T=p;break}null==T?(l.push(x),_.source=l.length-1):(delete c[b],_.source=T),s.push(_),u={index:s.length-1},null!=r&&(u.texCoord=r)}else i.Tools.Error("Unsupported texture mime type "+n);return u},e._DielectricSpecular=new i.Color3(.04,.04,.04),e._MaxSpecularPower=1024,e._Epsilon=1e-6,e}()},"./glTF/2.0/glTFSerializer.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"GLTF2Export",function(){return i});var r=n("./glTF/2.0/glTFExporter.ts"),i=function(){function e(){}return e.GLTFAsync=function(e,t,n){return e.whenReadyAsync().then(function(){var i=t.replace(/\.[^/.]+$/,"");return new r._Exporter(e,n)._generateGLTFAsync(i)})},e._PreExportAsync=function(e,t){return Promise.resolve().then(function(){return t&&t.exportWithoutWaitingForScene?Promise.resolve():e.whenReadyAsync()})},e._PostExportAsync=function(e,t,n){return Promise.resolve().then(function(){return n&&n.exportWithoutWaitingForScene,t})},e.GLBAsync=function(e,t,n){var i=this;return this._PreExportAsync(e,n).then(function(){var o=t.replace(/\.[^/.]+$/,"");return new r._Exporter(e,n)._generateGLBAsync(o).then(function(t){return i._PostExportAsync(e,t,n)})})},e}()},"./glTF/2.0/glTFUtilities.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"_GLTFUtilities",function(){return i});var r=n("babylonjs/Maths/math.vector"),i=function(){function e(){}return e._CreateBufferView=function(e,t,n,r,i){var o={buffer:e,byteLength:n};return t&&(o.byteOffset=t),i&&(o.name=i),r&&(o.byteStride=r),o},e._CreateAccessor=function(e,t,n,r,i,o,a,s){var l={name:t,bufferView:e,componentType:r,count:i,type:n};return null!=a&&(l.min=a),null!=s&&(l.max=s),null!=o&&(l.byteOffset=o),l},e._CalculateMinMaxPositions=function(t,n,i,o){var a,s,l,c=[1/0,1/0,1/0],u=[-1/0,-1/0,-1/0];if(i)for(var _=n,h=n+i;_<h;++_){a=3*_,s=r.Vector3.FromArray(t,a),o&&e._GetRightHandedPositionVector3FromRef(s),l=s.asArray();for(var f=0;f<3;++f){var d=l[f];d<c[f]&&(c[f]=d),d>u[f]&&(u[f]=d),++a}}return{min:c,max:u}},e._GetRightHandedPositionVector3=function(e){return new r.Vector3(e.x,e.y,-e.z)},e._GetRightHandedPositionVector3FromRef=function(e){e.z*=-1},e._GetRightHandedPositionArray3FromRef=function(e){e[2]*=-1},e._GetRightHandedNormalVector3=function(e){return new r.Vector3(e.x,e.y,-e.z)},e._GetRightHandedNormalVector3FromRef=function(e){e.z*=-1},e._GetRightHandedNormalArray3FromRef=function(e){e[2]*=-1},e._GetRightHandedVector4FromRef=function(e){e.z*=-1,e.w*=-1},e._GetRightHandedArray4FromRef=function(e){e[2]*=-1,e[3]*=-1},e._GetRightHandedQuaternionFromRef=function(e){e.x*=-1,e.y*=-1},e._GetRightHandedQuaternionArrayFromRef=function(e){e[0]*=-1,e[1]*=-1},e._NormalizeTangentFromRef=function(e){var t=Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z);t>0&&(e.x/=t,e.y/=t,e.z/=t)},e._GetDataAccessorElementCount=function(e){switch(e){case"MAT2":return 4;case"MAT3":return 9;case"MAT4":return 16;case"SCALAR":return 1;case"VEC2":return 2;case"VEC3":return 3;case"VEC4":return 4}},e}()},"./glTF/2.0/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./glTF/2.0/glTFAnimation.ts");n.d(t,"_GLTFAnimation",function(){return r._GLTFAnimation});var i=n("./glTF/2.0/glTFData.ts");n.d(t,"GLTFData",function(){return i.GLTFData});var o=n("./glTF/2.0/glTFExporter.ts");n.d(t,"_Exporter",function(){return o._Exporter}),n.d(t,"_BinaryWriter",function(){return o._BinaryWriter});var a=n("./glTF/2.0/glTFExporterExtension.ts");n.d(t,"__IGLTFExporterExtensionV2",function(){return a.__IGLTFExporterExtensionV2});var s=n("./glTF/2.0/glTFMaterialExporter.ts");n.d(t,"_GLTFMaterialExporter",function(){return s._GLTFMaterialExporter});var l=n("./glTF/2.0/glTFSerializer.ts");n.d(t,"GLTF2Export",function(){return l.GLTF2Export});var c=n("./glTF/2.0/glTFUtilities.ts");n.d(t,"_GLTFUtilities",function(){return c._GLTFUtilities});var u=n("./glTF/2.0/Extensions/index.ts");n.d(t,"KHR_texture_transform",function(){return u.KHR_texture_transform}),n.d(t,"KHR_lights_punctual",function(){return u.KHR_lights_punctual}),n.d(t,"KHR_materials_clearcoat",function(){return u.KHR_materials_clearcoat}),n.d(t,"KHR_materials_sheen",function(){return u.KHR_materials_sheen}),n.d(t,"KHR_materials_unlit",function(){return u.KHR_materials_unlit})},"./glTF/2.0/shaders/textureTransform.fragment.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"textureTransformPixelShader",function(){return a});var r=n("babylonjs/Maths/math.vector"),i="textureTransformPixelShader",o="precision highp float;\nvarying vec2 vUV;\nuniform sampler2D textureSampler;\nuniform mat4 textureTransformMat;\nvoid main(void) {\nvec2 uvTransformed=(textureTransformMat*vec4(vUV.xy,1,1)).xy;\ngl_FragColor=texture2D(textureSampler,uvTransformed);\n}";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./glTF/glTFFileExporter.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"__IGLTFExporterExtension",function(){return r});var r=0},"./legacy/legacy-glTF2Serializer.ts":function(e,t,n){"use strict";n.r(t),function(e){var r=n("./glTF/glTFFileExporter.ts"),i=n("./glTF/2.0/glTFData.ts"),o=n("./glTF/2.0/glTFSerializer.ts"),a=n("./glTF/2.0/Extensions/index.ts"),s=n("./glTF/2.0/index.ts");n.d(t,"__IGLTFExporterExtension",function(){return r.__IGLTFExporterExtension}),n.d(t,"_GLTFAnimation",function(){return s._GLTFAnimation}),n.d(t,"GLTFData",function(){return s.GLTFData}),n.d(t,"_Exporter",function(){return s._Exporter}),n.d(t,"_BinaryWriter",function(){return s._BinaryWriter}),n.d(t,"__IGLTFExporterExtensionV2",function(){return s.__IGLTFExporterExtensionV2}),n.d(t,"_GLTFMaterialExporter",function(){return s._GLTFMaterialExporter}),n.d(t,"GLTF2Export",function(){return s.GLTF2Export}),n.d(t,"_GLTFUtilities",function(){return s._GLTFUtilities}),n.d(t,"KHR_texture_transform",function(){return s.KHR_texture_transform}),n.d(t,"KHR_lights_punctual",function(){return s.KHR_lights_punctual}),n.d(t,"KHR_materials_clearcoat",function(){return s.KHR_materials_clearcoat}),n.d(t,"KHR_materials_sheen",function(){return s.KHR_materials_sheen}),n.d(t,"KHR_materials_unlit",function(){return s.KHR_materials_unlit});var l=void 0!==e?e:"undefined"!=typeof window?window:void 0;if(void 0!==l){l.BABYLON=l.BABYLON||{};var c=l.BABYLON;c.GLTF2=c.GLTF2||{},c.GLTF2.Exporter=c.GLTF2.Exporter||{},c.GLTF2.Exporter.Extensions=c.GLTF2.Exporter.Extensions||{};var u=[];for(var _ in r)c[_]=r[_],u.push(_);for(var _ in i)c[_]=i[_],u.push(_);for(var _ in o)c[_]=o[_],u.push(_);for(var _ in a)c.GLTF2.Exporter.Extensions[_]=a[_],u.push(_);for(var _ in s)u.indexOf(_)>-1||(c.GLTF2.Exporter[_]=s[_])}}.call(this,n("../../node_modules/webpack/buildin/global.js"))},"babylonjs/Maths/math.vector":function(t,n){t.exports=e}})}),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("babylonjs")):"function"==typeof define&&define.amd?define("babylonjs-serializers",["babylonjs"],t):"object"==typeof exports?exports["babylonjs-serializers"]=t(require("babylonjs")):e.SERIALIZERS=t(e.BABYLON)}("undefined"!=typeof self?self:"undefined"!=typeof global?global:this,function(e){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./legacy/legacy-objSerializer.ts")}({"../../node_modules/webpack/buildin/global.js":function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},"./OBJ/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./OBJ/objSerializer.ts");n.d(t,"OBJExport",function(){return r.OBJExport})},"./OBJ/objSerializer.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"OBJExport",function(){return i});var r=n("babylonjs/Maths/math.vector"),i=function(){function e(){}return e.OBJ=function(e,t,n,i){var o=[],a=1,s=1;t&&(n||(n="mat"),o.push("mtllib "+n+".mtl"));for(var l=0;l<e.length;l++){o.push("g object"+l),o.push("o object_"+l);var c=null;if(i){var u=e[l].computeWorldMatrix(!0);c=new r.Matrix,u.invertToRef(c),e[l].bakeTransformIntoVertices(u)}if(t){var _=e[l].material;_&&o.push("usemtl "+_.id)}var h=e[l].geometry;if(h){var f=h.getVerticesData("position"),d=h.getVerticesData("normal"),p=h.getVerticesData("uv"),m=h.getIndices(),g=0,v=0;if(f&&m){for(var b=0;b<f.length;b+=3)e[0].getScene().useRightHandedSystem?o.push("v "+f[b]+" "+f[b+1]+" "+f[b+2]):o.push("v "+f[b]+" "+f[b+1]+" "+-f[b+2]),g++;if(null!=d)for(b=0;b<d.length;b+=3)o.push("vn "+d[b]+" "+d[b+1]+" "+d[b+2]);if(null!=p)for(b=0;b<p.length;b+=2)o.push("vt "+p[b]+" "+p[b+1]),v++;for(b=0;b<m.length;b+=3){var y=[String(m[b+2]+a),String(m[b+1]+a),String(m[b]+a)],x=[String(m[b+2]+s),String(m[b+1]+s),String(m[b]+s)],T=["","",""],O=y,P=null!=p?x:T,C=null!=d?y:T;o.push("f "+O[0]+"/"+P[0]+"/"+C[0]+" "+O[1]+"/"+P[1]+"/"+C[1]+" "+O[2]+"/"+P[2]+"/"+C[2])}i&&c&&e[l].bakeTransformIntoVertices(c),a+=g,s+=v}else r.Tools.Warn("There are no position vertices or indices on the mesh!")}else r.Tools.Warn("No geometry is present on the mesh")}return o.join("\n")},e.MTL=function(e){var t=[],n=e.material;t.push("newmtl mat1"),t.push("  Ns "+n.specularPower.toFixed(4)),t.push("  Ni 1.5000"),t.push("  d "+n.alpha.toFixed(4)),t.push("  Tr 0.0000"),t.push("  Tf 1.0000 1.0000 1.0000"),t.push("  illum 2"),t.push("  Ka "+n.ambientColor.r.toFixed(4)+" "+n.ambientColor.g.toFixed(4)+" "+n.ambientColor.b.toFixed(4)),t.push("  Kd "+n.diffuseColor.r.toFixed(4)+" "+n.diffuseColor.g.toFixed(4)+" "+n.diffuseColor.b.toFixed(4)),t.push("  Ks "+n.specularColor.r.toFixed(4)+" "+n.specularColor.g.toFixed(4)+" "+n.specularColor.b.toFixed(4)),t.push("  Ke "+n.emissiveColor.r.toFixed(4)+" "+n.emissiveColor.g.toFixed(4)+" "+n.emissiveColor.b.toFixed(4));return n.ambientTexture&&t.push("  map_Ka "+n.ambientTexture.name),n.diffuseTexture&&t.push("  map_Kd "+n.diffuseTexture.name),n.specularTexture&&t.push("  map_Ks "+n.specularTexture.name),n.bumpTexture&&t.push("  map_bump -imfchan z "+n.bumpTexture.name),n.opacityTexture&&t.push("  map_d "+n.opacityTexture.name),t.join("\n")},e}()},"./legacy/legacy-objSerializer.ts":function(e,t,n){"use strict";n.r(t),function(e){var r=n("./OBJ/index.ts");n.d(t,"OBJExport",function(){return r.OBJExport});var i=void 0!==e?e:"undefined"!=typeof window?window:void 0;if(void 0!==i)for(var o in r)i.BABYLON[o]=r[o]}.call(this,n("../../node_modules/webpack/buildin/global.js"))},"babylonjs/Maths/math.vector":function(t,n){t.exports=e}})}),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("babylonjs")):"function"==typeof define&&define.amd?define("babylonjs-gui",["babylonjs"],t):"object"==typeof exports?exports["babylonjs-gui"]=t(require("babylonjs")):(e.BABYLON=e.BABYLON||{},e.BABYLON.GUI=t(e.BABYLON))}("undefined"!=typeof self?self:"undefined"!=typeof global?global:this,function(e){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./legacy/legacy.ts")}({"../../node_modules/tslib/tslib.es6.js":function(e,t,n){"use strict";n.r(t),n.d(t,"__extends",function(){return i}),n.d(t,"__assign",function(){return o}),n.d(t,"__rest",function(){return a}),n.d(t,"__decorate",function(){return s}),n.d(t,"__param",function(){return l}),n.d(t,"__metadata",function(){return c}),n.d(t,"__awaiter",function(){return u}),n.d(t,"__generator",function(){return _}),n.d(t,"__createBinding",function(){return h}),n.d(t,"__exportStar",function(){return f}),n.d(t,"__values",function(){return d}),n.d(t,"__read",function(){return p}),n.d(t,"__spread",function(){return m}),n.d(t,"__spreadArrays",function(){return g}),n.d(t,"__spreadArray",function(){return v}),n.d(t,"__await",function(){return b}),n.d(t,"__asyncGenerator",function(){return y}),n.d(t,"__asyncDelegator",function(){return x}),n.d(t,"__asyncValues",function(){return T}),n.d(t,"__makeTemplateObject",function(){return O}),n.d(t,"__importStar",function(){return C}),n.d(t,"__importDefault",function(){return S}),n.d(t,"__classPrivateFieldGet",function(){return M}),n.d(t,"__classPrivateFieldSet",function(){return E});var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function a(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function s(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function l(e,t){return function(n,r){t(n,r,e)}}function c(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function u(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}l((r=r.apply(e,t||[])).next())})}function _(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var h=Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]};function f(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||h(t,e,n)}function d(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function p(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function m(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(p(arguments[t]));return e}function g(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}function v(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function b(e){return this instanceof b?(this.v=e,this):new b(e)}function y(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(e){i[e]&&(r[e]=function(t){return new Promise(function(n,r){o.push([e,t,n,r])>1||s(e,t)})})}function s(e,t){try{(n=i[e](t)).value instanceof b?Promise.resolve(n.value.v).then(l,c):u(o[0][2],n)}catch(e){u(o[0][3],e)}var n}function l(e){s("next",e)}function c(e){s("throw",e)}function u(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}}function x(e){var t,n;return t={},r("next"),r("throw",function(e){throw e}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:b(e[r](t)),done:"return"===r}:i?i(t):t}:i}}function T(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=d(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,i){(function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)})(r,i,(t=e[n](t)).done,t.value)})}}}function O(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var P=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function C(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&h(t,e,n);return P(t,e),t}function S(e){return e&&e.__esModule?e:{default:e}}function M(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function E(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n}},"../../node_modules/webpack/buildin/global.js":function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},"./2D/adtInstrumentation.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"AdvancedDynamicTextureInstrumentation",function(){return i});var r=n("babylonjs/Misc/perfCounter"),i=function(){function e(e){this.texture=e,this._captureRenderTime=!1,this._renderTime=new r.PerfCounter,this._captureLayoutTime=!1,this._layoutTime=new r.PerfCounter,this._onBeginRenderObserver=null,this._onEndRenderObserver=null,this._onBeginLayoutObserver=null,this._onEndLayoutObserver=null}return Object.defineProperty(e.prototype,"renderTimeCounter",{get:function(){return this._renderTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"layoutTimeCounter",{get:function(){return this._layoutTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"captureRenderTime",{get:function(){return this._captureRenderTime},set:function(e){var t=this;e!==this._captureRenderTime&&(this._captureRenderTime=e,e?(this._onBeginRenderObserver=this.texture.onBeginRenderObservable.add(function(){t._renderTime.beginMonitoring()}),this._onEndRenderObserver=this.texture.onEndRenderObservable.add(function(){t._renderTime.endMonitoring(!0)})):(this.texture.onBeginRenderObservable.remove(this._onBeginRenderObserver),this._onBeginRenderObserver=null,this.texture.onEndRenderObservable.remove(this._onEndRenderObserver),this._onEndRenderObserver=null))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"captureLayoutTime",{get:function(){return this._captureLayoutTime},set:function(e){var t=this;e!==this._captureLayoutTime&&(this._captureLayoutTime=e,e?(this._onBeginLayoutObserver=this.texture.onBeginLayoutObservable.add(function(){t._layoutTime.beginMonitoring()}),this._onEndLayoutObserver=this.texture.onEndLayoutObservable.add(function(){t._layoutTime.endMonitoring(!0)})):(this.texture.onBeginLayoutObservable.remove(this._onBeginLayoutObserver),this._onBeginLayoutObserver=null,this.texture.onEndLayoutObservable.remove(this._onEndLayoutObserver),this._onEndLayoutObserver=null))},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this.texture.onBeginRenderObservable.remove(this._onBeginRenderObserver),this._onBeginRenderObserver=null,this.texture.onEndRenderObservable.remove(this._onEndRenderObserver),this._onEndRenderObserver=null,this.texture.onBeginLayoutObservable.remove(this._onBeginLayoutObserver),this._onBeginLayoutObserver=null,this.texture.onEndLayoutObservable.remove(this._onEndLayoutObserver),this._onEndLayoutObserver=null,this.texture=null},e}()},"./2D/advancedDynamicTexture.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"AdvancedDynamicTexture",function(){return c});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=n("./2D/controls/container.ts"),a=n("./2D/controls/control.ts"),s=n("./2D/style.ts"),l=n("./2D/measure.ts"),c=function(e){function t(t,n,r,a,s,c,u){void 0===n&&(n=0),void 0===r&&(r=0),void 0===s&&(s=!1),void 0===c&&(c=i.Texture.NEAREST_SAMPLINGMODE),void 0===u&&(u=!0);var _=e.call(this,t,{width:n,height:r},a,s,c,i.Constants.TEXTUREFORMAT_RGBA,u)||this;return _._isDirty=!1,_._rootContainer=new o.Container("root"),_._lastControlOver={},_._lastControlDown={},_._capturingControl={},_._linkedControls=new Array,_._isFullscreen=!1,_._fullscreenViewport=new i.Viewport(0,0,1,1),_._idealWidth=0,_._idealHeight=0,_._useSmallestIdeal=!1,_._renderAtIdealSize=!1,_._blockNextFocusCheck=!1,_._renderScale=1,_._cursorChanged=!1,_._defaultMousePointerId=0,_._numLayoutCalls=0,_._numRenderCalls=0,_._clipboardData="",_.onClipboardObservable=new i.Observable,_.onControlPickedObservable=new i.Observable,_.onBeginLayoutObservable=new i.Observable,_.onEndLayoutObservable=new i.Observable,_.onBeginRenderObservable=new i.Observable,_.onEndRenderObservable=new i.Observable,_.premulAlpha=!1,_.applyYInversionOnUpdate=!0,_._useInvalidateRectOptimization=!0,_._invalidatedRectangle=null,_._clearMeasure=new l.Measure(0,0,0,0),_.onClipboardCopy=function(e){var t=e,n=new i.ClipboardInfo(i.ClipboardEventTypes.COPY,t);_.onClipboardObservable.notifyObservers(n),t.preventDefault()},_.onClipboardCut=function(e){var t=e,n=new i.ClipboardInfo(i.ClipboardEventTypes.CUT,t);_.onClipboardObservable.notifyObservers(n),t.preventDefault()},_.onClipboardPaste=function(e){var t=e,n=new i.ClipboardInfo(i.ClipboardEventTypes.PASTE,t);_.onClipboardObservable.notifyObservers(n),t.preventDefault()},(a=_.getScene())&&_._texture?(_.applyYInversionOnUpdate=u,_._rootElement=a.getEngine().getInputElement(),_._renderObserver=a.onBeforeCameraRenderObservable.add(function(e){return _._checkUpdate(e)}),_._preKeyboardObserver=a.onPreKeyboardObservable.add(function(e){_._focusedControl&&(e.type===i.KeyboardEventTypes.KEYDOWN&&_._focusedControl.processKeyboard(e.event),e.skipOnPointerObservable=!0)}),_._rootContainer._link(_),_.hasAlpha=!0,n&&r||(_._resizeObserver=a.getEngine().onResizeObservable.add(function(){return _._onResize()}),_._onResize()),_._texture.isReady=!0,_):_}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"numLayoutCalls",{get:function(){return this._numLayoutCalls},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"numRenderCalls",{get:function(){return this._numRenderCalls},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderScale",{get:function(){return this._renderScale},set:function(e){e!==this._renderScale&&(this._renderScale=e,this._onResize())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this._background},set:function(e){this._background!==e&&(this._background=e,this.markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"idealWidth",{get:function(){return this._idealWidth},set:function(e){this._idealWidth!==e&&(this._idealWidth=e,this.markAsDirty(),this._rootContainer._markAllAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"idealHeight",{get:function(){return this._idealHeight},set:function(e){this._idealHeight!==e&&(this._idealHeight=e,this.markAsDirty(),this._rootContainer._markAllAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"useSmallestIdeal",{get:function(){return this._useSmallestIdeal},set:function(e){this._useSmallestIdeal!==e&&(this._useSmallestIdeal=e,this.markAsDirty(),this._rootContainer._markAllAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderAtIdealSize",{get:function(){return this._renderAtIdealSize},set:function(e){this._renderAtIdealSize!==e&&(this._renderAtIdealSize=e,this._onResize())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"idealRatio",{get:function(){var e=0,t=0;return this._idealWidth&&(e=this.getSize().width/this._idealWidth),this._idealHeight&&(t=this.getSize().height/this._idealHeight),this._useSmallestIdeal&&this._idealWidth&&this._idealHeight?window.innerWidth<window.innerHeight?e:t:this._idealWidth?e:this._idealHeight?t:1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"layer",{get:function(){return this._layerToDispose},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rootContainer",{get:function(){return this._rootContainer},enumerable:!1,configurable:!0}),t.prototype.getChildren=function(){return[this._rootContainer]},t.prototype.getDescendants=function(e,t){return this._rootContainer.getDescendants(e,t)},t.prototype.getControlByName=function(e){return this._getControlByKey("name",e)},t.prototype._getControlByKey=function(e,t){return this._rootContainer.getDescendants().find(function(n){return n[e]===t})||null},Object.defineProperty(t.prototype,"focusedControl",{get:function(){return this._focusedControl},set:function(e){this._focusedControl!=e&&(this._focusedControl&&this._focusedControl.onBlur(),e&&e.onFocus(),this._focusedControl=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isForeground",{get:function(){return!this.layer||!this.layer.isBackground},set:function(e){this.layer&&this.layer.isBackground!==!e&&(this.layer.isBackground=!e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"clipboardData",{get:function(){return this._clipboardData},set:function(e){this._clipboardData=e},enumerable:!1,configurable:!0}),t.prototype.getClassName=function(){return"AdvancedDynamicTexture"},t.prototype.executeOnAllControls=function(e,t){t||(t=this._rootContainer),e(t);for(var n=0,r=t.children;n<r.length;n++){var i=r[n];i.children?this.executeOnAllControls(e,i):e(i)}},Object.defineProperty(t.prototype,"useInvalidateRectOptimization",{get:function(){return this._useInvalidateRectOptimization},set:function(e){this._useInvalidateRectOptimization=e},enumerable:!1,configurable:!0}),t.prototype.invalidateRect=function(e,t,n,r){if(this._useInvalidateRectOptimization)if(this._invalidatedRectangle){var i=Math.ceil(Math.max(this._invalidatedRectangle.left+this._invalidatedRectangle.width-1,n)),o=Math.ceil(Math.max(this._invalidatedRectangle.top+this._invalidatedRectangle.height-1,r));this._invalidatedRectangle.left=Math.floor(Math.min(this._invalidatedRectangle.left,e)),this._invalidatedRectangle.top=Math.floor(Math.min(this._invalidatedRectangle.top,t)),this._invalidatedRectangle.width=i-this._invalidatedRectangle.left+1,this._invalidatedRectangle.height=o-this._invalidatedRectangle.top+1}else this._invalidatedRectangle=new l.Measure(e,t,n-e+1,r-t+1)},t.prototype.markAsDirty=function(){this._isDirty=!0},t.prototype.createStyle=function(){return new s.Style(this)},t.prototype.addControl=function(e){return this._rootContainer.addControl(e),this},t.prototype.removeControl=function(e){return this._rootContainer.removeControl(e),this},t.prototype.dispose=function(){var t=this.getScene();t&&(this._rootElement=null,t.onBeforeCameraRenderObservable.remove(this._renderObserver),this._resizeObserver&&t.getEngine().onResizeObservable.remove(this._resizeObserver),this._pointerMoveObserver&&t.onPrePointerObservable.remove(this._pointerMoveObserver),this._pointerObserver&&t.onPointerObservable.remove(this._pointerObserver),this._preKeyboardObserver&&t.onPreKeyboardObservable.remove(this._preKeyboardObserver),this._canvasPointerOutObserver&&t.getEngine().onCanvasPointerOutObservable.remove(this._canvasPointerOutObserver),this._canvasBlurObserver&&t.getEngine().onCanvasBlurObservable.remove(this._canvasBlurObserver),this._layerToDispose&&(this._layerToDispose.texture=null,this._layerToDispose.dispose(),this._layerToDispose=null),this._rootContainer.dispose(),this.onClipboardObservable.clear(),this.onControlPickedObservable.clear(),this.onBeginRenderObservable.clear(),this.onEndRenderObservable.clear(),this.onBeginLayoutObservable.clear(),this.onEndLayoutObservable.clear(),e.prototype.dispose.call(this))},t.prototype._onResize=function(){var e=this.getScene();if(e){var t=e.getEngine(),n=this.getSize(),r=t.getRenderWidth()*this._renderScale,i=t.getRenderHeight()*this._renderScale;this._renderAtIdealSize&&(this._idealWidth?(i=i*this._idealWidth/r,r=this._idealWidth):this._idealHeight&&(r=r*this._idealHeight/i,i=this._idealHeight)),n.width===r&&n.height===i||(this.scaleTo(r,i),this.markAsDirty(),(this._idealWidth||this._idealHeight)&&this._rootContainer._markAllAsDirty()),this.invalidateRect(0,0,n.width-1,n.height-1)}},t.prototype._getGlobalViewport=function(){var e=this.getSize();return this._fullscreenViewport.toGlobal(e.width,e.height)},t.prototype.getProjectedPosition=function(e,t){var n=this.getProjectedPositionWithZ(e,t);return new i.Vector2(n.x,n.y)},t.prototype.getProjectedPositionWithZ=function(e,t){var n=this.getScene();if(!n)return i.Vector3.Zero();var r=this._getGlobalViewport(),o=i.Vector3.Project(e,t,n.getTransformMatrix(),r);return new i.Vector3(o.x,o.y,o.z)},t.prototype._checkUpdate=function(e){if(!this._layerToDispose||0!=(e.layerMask&this._layerToDispose.layerMask)){if(this._isFullscreen&&this._linkedControls.length){var t=this.getScene();if(!t)return;for(var n=this._getGlobalViewport(),r=function(e){if(!e.isVisible)return"continue";var r=e._linkedMesh;if(!r||r.isDisposed())return i.Tools.SetImmediate(function(){e.linkWithMesh(null)}),"continue";var o=r.getBoundingInfo?r.getBoundingInfo().boundingSphere.center:i.Vector3.ZeroReadOnly,a=i.Vector3.Project(o,r.getWorldMatrix(),t.getTransformMatrix(),n);if(a.z<0||a.z>1)return e.notRenderable=!0,"continue";e.notRenderable=!1,e._moveToProjectedPosition(a)},o=0,a=this._linkedControls;o<a.length;o++){r(a[o])}}(this._isDirty||this._rootContainer.isDirty)&&(this._isDirty=!1,this._render(),this.update(this.applyYInversionOnUpdate,this.premulAlpha))}},t.prototype._render=function(){var e=this.getSize(),t=e.width,n=e.height,r=this.getContext();r.font="18px Arial",r.strokeStyle="white",this.onBeginLayoutObservable.notifyObservers(this);var i=new l.Measure(0,0,t,n);this._numLayoutCalls=0,this._rootContainer._layout(i,r),this.onEndLayoutObservable.notifyObservers(this),this._isDirty=!1,this._invalidatedRectangle?this._clearMeasure.copyFrom(this._invalidatedRectangle):this._clearMeasure.copyFromFloats(0,0,t,n),r.clearRect(this._clearMeasure.left,this._clearMeasure.top,this._clearMeasure.width,this._clearMeasure.height),this._background&&(r.save(),r.fillStyle=this._background,r.fillRect(this._clearMeasure.left,this._clearMeasure.top,this._clearMeasure.width,this._clearMeasure.height),r.restore()),this.onBeginRenderObservable.notifyObservers(this),this._numRenderCalls=0,this._rootContainer._render(r,this._invalidatedRectangle),this.onEndRenderObservable.notifyObservers(this),this._invalidatedRectangle=null},t.prototype._changeCursor=function(e){this._rootElement&&(this._rootElement.style.cursor=e,this._cursorChanged=!0)},t.prototype._registerLastControlDown=function(e,t){this._lastControlDown[t]=e,this.onControlPickedObservable.notifyObservers(e)},t.prototype._doPicking=function(e,t,n,r,o,a,s,l){var c=this.getScene();if(c){var u=c.getEngine(),_=this.getSize();if(this._isFullscreen){var h=c.cameraToUseForPointers||c.activeCamera;if(!h)return;var f=h.viewport;e*=_.width/(u.getRenderWidth()*f.width),t*=_.height/(u.getRenderHeight()*f.height)}this._capturingControl[o]?this._capturingControl[o]._processObservables(r,e,t,n,o,a):(this._cursorChanged=!1,this._rootContainer._processPicking(e,t,n,r,o,a,s,l)||(c.doNotHandleCursors||this._changeCursor(""),r===i.PointerEventTypes.POINTERMOVE&&this._lastControlOver[o]&&(this._lastControlOver[o]._onPointerOut(this._lastControlOver[o],n),delete this._lastControlOver[o])),this._cursorChanged||c.doNotHandleCursors||this._changeCursor(""),this._manageFocus())}},t.prototype._cleanControlAfterRemovalFromList=function(e,t){for(var n in e){if(e.hasOwnProperty(n))e[n]===t&&delete e[n]}},t.prototype._cleanControlAfterRemoval=function(e){this._cleanControlAfterRemovalFromList(this._lastControlDown,e),this._cleanControlAfterRemovalFromList(this._lastControlOver,e)},t.prototype.attach=function(){var e=this,t=this.getScene();if(t){var n=new i.Viewport(0,0,0,0);this._pointerMoveObserver=t.onPrePointerObservable.add(function(r,o){if(!t.isPointerCaptured(r.event.pointerId)&&(r.type===i.PointerEventTypes.POINTERMOVE||r.type===i.PointerEventTypes.POINTERUP||r.type===i.PointerEventTypes.POINTERDOWN||r.type===i.PointerEventTypes.POINTERWHEEL)){r.type===i.PointerEventTypes.POINTERMOVE&&r.event.pointerId&&(e._defaultMousePointerId=r.event.pointerId);var a=t.cameraToUseForPointers||t.activeCamera,s=t.getEngine();a?a.viewport.toGlobalToRef(s.getRenderWidth(),s.getRenderHeight(),n):(n.x=0,n.y=0,n.width=s.getRenderWidth(),n.height=s.getRenderHeight());var l=t.pointerX/s.getHardwareScalingLevel()-n.x,c=t.pointerY/s.getHardwareScalingLevel()-(s.getRenderHeight()-n.y-n.height);e._shouldBlockPointer=!1;var u=r.event.pointerId||e._defaultMousePointerId;e._doPicking(l,c,r,r.type,u,r.event.button,r.event.deltaX,r.event.deltaY),e._shouldBlockPointer&&(r.skipOnPointerObservable=e._shouldBlockPointer)}}),this._attachToOnPointerOut(t),this._attachToOnBlur(t)}},t.prototype.registerClipboardEvents=function(){self.addEventListener("copy",this.onClipboardCopy,!1),self.addEventListener("cut",this.onClipboardCut,!1),self.addEventListener("paste",this.onClipboardPaste,!1)},t.prototype.unRegisterClipboardEvents=function(){self.removeEventListener("copy",this.onClipboardCopy),self.removeEventListener("cut",this.onClipboardCut),self.removeEventListener("paste",this.onClipboardPaste)},t.prototype.attachToMesh=function(e,t){var n=this;void 0===t&&(t=!0);var r=this.getScene();r&&(this._pointerObserver=r.onPointerObservable.add(function(t,r){if(t.type===i.PointerEventTypes.POINTERMOVE||t.type===i.PointerEventTypes.POINTERUP||t.type===i.PointerEventTypes.POINTERDOWN||t.type===i.PointerEventTypes.POINTERWHEEL){t.type===i.PointerEventTypes.POINTERMOVE&&t.event.pointerId&&(n._defaultMousePointerId=t.event.pointerId);var o=t.event.pointerId||n._defaultMousePointerId;if(t.pickInfo&&t.pickInfo.hit&&t.pickInfo.pickedMesh===e){var a=t.pickInfo.getTextureCoordinates();if(a){var s=n.getSize();n._doPicking(a.x*s.width,(n.applyYInversionOnUpdate?1-a.y:a.y)*s.height,t,t.type,o,t.event.button,t.event.deltaX,t.event.deltaY)}}else if(t.type===i.PointerEventTypes.POINTERUP){if(n._lastControlDown[o]&&n._lastControlDown[o]._forcePointerUp(o),delete n._lastControlDown[o],n.focusedControl){var l=n.focusedControl.keepsFocusWith(),c=!0;if(l)for(var u=0,_=l;u<_.length;u++){var h=_[u];if(n!==h._host){var f=h._host;if(f._lastControlOver[o]&&f._lastControlOver[o].isAscendant(h)){c=!1;break}}}c&&(n.focusedControl=null)}}else t.type===i.PointerEventTypes.POINTERMOVE&&(n._lastControlOver[o]&&n._lastControlOver[o]._onPointerOut(n._lastControlOver[o],t,!0),delete n._lastControlOver[o])}}),e.enablePointerMoveEvents=t,this._attachToOnPointerOut(r),this._attachToOnBlur(r))},t.prototype.moveFocusToControl=function(e){this.focusedControl=e,this._lastPickedControl=e,this._blockNextFocusCheck=!0},t.prototype._manageFocus=function(){if(this._blockNextFocusCheck)return this._blockNextFocusCheck=!1,void(this._lastPickedControl=this._focusedControl);if(this._focusedControl&&this._focusedControl!==this._lastPickedControl){if(this._lastPickedControl.isFocusInvisible)return;this.focusedControl=null}},t.prototype._attachToOnPointerOut=function(e){var t=this;this._canvasPointerOutObserver=e.getEngine().onCanvasPointerOutObservable.add(function(e){t._lastControlOver[e.pointerId]&&t._lastControlOver[e.pointerId]._onPointerOut(t._lastControlOver[e.pointerId],null),delete t._lastControlOver[e.pointerId],t._lastControlDown[e.pointerId]&&t._lastControlDown[e.pointerId]!==t._capturingControl[e.pointerId]&&(t._lastControlDown[e.pointerId]._forcePointerUp(),delete t._lastControlDown[e.pointerId])})},t.prototype._attachToOnBlur=function(e){var t=this;this._canvasBlurObserver=e.getEngine().onCanvasBlurObservable.add(function(e){Object.entries(t._lastControlDown).forEach(function(e){e[0];e[1]._onCanvasBlur()}),t.focusedControl=null,t._lastControlDown={}})},t.prototype.serializeContent=function(){var e=this.getSize(),t={root:{},width:e.width,height:e.height};return this._rootContainer.serialize(t.root),t},t.prototype.parseContent=function(e,t){if(this._rootContainer=a.Control.Parse(e.root,this),t){var n=e.width,r=e.height;"number"==typeof n&&"number"==typeof r&&n>=0&&r>=0&&this.scaleTo(n,r)}},t.prototype.parseFromSnippetAsync=function(e,n){var r=this;return"_BLANK"===e?Promise.resolve():new Promise(function(o,a){var s=new i.WebRequest;s.addEventListener("readystatechange",function(){if(4==s.readyState)if(200==s.status){var t=JSON.parse(JSON.parse(s.responseText).jsonPayload),i=JSON.parse(t.gui);r.parseContent(i,n),r.snippetId=e,o()}else a("Unable to load the snippet "+e)}),s.open("GET",t.SnippetUrl+"/"+e.replace(/#/g,"/")),s.send()})},t.prototype.parseFromURLAsync=function(e,t){var n=this;return""===e?Promise.resolve():new Promise(function(r,o){var a=new i.WebRequest;a.addEventListener("readystatechange",function(){if(4==a.readyState)if(200==a.status){var e=a.responseText,i=JSON.parse(e);n.parseContent(i,t),r()}else o("Unable to load")}),a.open("GET",e),a.send()})},t.CreateForMesh=function(e,n,r,o,a,s){void 0===n&&(n=1024),void 0===r&&(r=1024),void 0===o&&(o=!0),void 0===a&&(a=!1);var l=new t(e.name+" AdvancedDynamicTexture",n,r,e.getScene(),!0,i.Texture.TRILINEAR_SAMPLINGMODE,s),c=new i.StandardMaterial("AdvancedDynamicTextureMaterial",e.getScene());return c.backFaceCulling=!1,c.diffuseColor=i.Color3.Black(),c.specularColor=i.Color3.Black(),a?(c.diffuseTexture=l,c.emissiveTexture=l,l.hasAlpha=!0):(c.emissiveTexture=l,c.opacityTexture=l),e.material=c,l.attachToMesh(e,o),l},t.CreateForMeshTexture=function(e,n,r,o,a){void 0===n&&(n=1024),void 0===r&&(r=1024),void 0===o&&(o=!0);var s=new t(e.name+" AdvancedDynamicTexture",n,r,e.getScene(),!0,i.Texture.TRILINEAR_SAMPLINGMODE,a);return s.attachToMesh(e,o),s},t.CreateFullscreenUI=function(e,n,r,o){void 0===n&&(n=!0),void 0===r&&(r=null),void 0===o&&(o=i.Texture.BILINEAR_SAMPLINGMODE);var a=new t(e,0,0,r,!1,o),s=new i.Layer(e+"_layer",null,r,!n);return s.texture=a,a._layerToDispose=s,a._isFullscreen=!0,a.attach(),a},t.SnippetUrl="https://snippet.babylonjs.com",t}(i.DynamicTexture)},"./2D/controls/button.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"Button",function(){return c});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("./2D/controls/rectangle.ts"),o=n("./2D/controls/control.ts"),a=n("./2D/controls/textBlock.ts"),s=n("./2D/controls/image.ts"),l=n("babylonjs/Misc/perfCounter"),c=function(e){function t(t){var n=e.call(this,t)||this;n.name=t,n.delegatePickingToChildren=!1,n.thickness=1,n.isPointerBlocker=!0;var r=null;return n.pointerEnterAnimation=function(){r=n.alpha,n.alpha-=.1},n.pointerOutAnimation=function(){null!==r&&(n.alpha=r)},n.pointerDownAnimation=function(){n.scaleX-=.05,n.scaleY-=.05},n.pointerUpAnimation=function(){n.scaleX+=.05,n.scaleY+=.05},n}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"image",{get:function(){return this._image},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textBlock",{get:function(){return this._textBlock},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"Button"},t.prototype._processPicking=function(t,n,r,i,o,a,s,l){if(!this._isEnabled||!this.isHitTestVisible||!this.isVisible||this.notRenderable)return!1;if(!e.prototype.contains.call(this,t,n))return!1;if(this.delegatePickingToChildren){for(var c=!1,u=this._children.length-1;u>=0;u--){var _=this._children[u];if(_.isEnabled&&_.isHitTestVisible&&_.isVisible&&!_.notRenderable&&_.contains(t,n)){c=!0;break}}if(!c)return!1}return this._processObservables(i,t,n,r,o,a,s,l),!0},t.prototype._onPointerEnter=function(t,n){return!!e.prototype._onPointerEnter.call(this,t,n)&&(!this.isReadOnly&&this.pointerEnterAnimation&&this.pointerEnterAnimation(),!0)},t.prototype._onPointerOut=function(t,n,r){void 0===r&&(r=!1),!this.isReadOnly&&this.pointerOutAnimation&&this.pointerOutAnimation(),e.prototype._onPointerOut.call(this,t,n,r)},t.prototype._onPointerDown=function(t,n,r,i,o){return!!e.prototype._onPointerDown.call(this,t,n,r,i,o)&&(!this.isReadOnly&&this.pointerDownAnimation&&this.pointerDownAnimation(),!0)},t.prototype._onPointerUp=function(t,n,r,i,o,a){!this.isReadOnly&&this.pointerUpAnimation&&this.pointerUpAnimation(),e.prototype._onPointerUp.call(this,t,n,r,i,o,a)},t.CreateImageButton=function(e,t,n){var r=new this(e),i=new a.TextBlock(e+"_button",t);i.textWrapping=!0,i.textHorizontalAlignment=o.Control.HORIZONTAL_ALIGNMENT_CENTER,i.paddingLeft="20%",r.addControl(i);var l=new s.Image(e+"_icon",n);return l.width="20%",l.stretch=s.Image.STRETCH_UNIFORM,l.horizontalAlignment=o.Control.HORIZONTAL_ALIGNMENT_LEFT,r.addControl(l),r._image=l,r._textBlock=i,r},t.CreateImageOnlyButton=function(e,t){var n=new this(e),r=new s.Image(e+"_icon",t);return r.stretch=s.Image.STRETCH_FILL,r.horizontalAlignment=o.Control.HORIZONTAL_ALIGNMENT_LEFT,n.addControl(r),n._image=r,n},t.CreateSimpleButton=function(e,t){var n=new this(e),r=new a.TextBlock(e+"_button",t);return r.textWrapping=!0,r.textHorizontalAlignment=o.Control.HORIZONTAL_ALIGNMENT_CENTER,n.addControl(r),n._textBlock=r,n},t.CreateImageWithCenterTextButton=function(e,t,n){var r=new this(e),i=new s.Image(e+"_icon",n);i.stretch=s.Image.STRETCH_FILL,r.addControl(i);var l=new a.TextBlock(e+"_button",t);return l.textWrapping=!0,l.textHorizontalAlignment=o.Control.HORIZONTAL_ALIGNMENT_CENTER,r.addControl(l),r._image=i,r._textBlock=l,r},t}(i.Rectangle);Object(l.RegisterClass)("BABYLON.GUI.Button",c)},"./2D/controls/checkbox.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"Checkbox",function(){return l});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=n("./2D/controls/control.ts"),a=n("./2D/controls/stackPanel.ts"),s=n("./2D/controls/textBlock.ts"),l=function(e){function t(t){var n=e.call(this,t)||this;return n.name=t,n._isChecked=!1,n._background="black",n._checkSizeRatio=.8,n._thickness=1,n.onIsCheckedChangedObservable=new i.Observable,n.isPointerBlocker=!0,n}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"thickness",{get:function(){return this._thickness},set:function(e){this._thickness!==e&&(this._thickness=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"checkSizeRatio",{get:function(){return this._checkSizeRatio},set:function(e){e=Math.max(Math.min(1,e),0),this._checkSizeRatio!==e&&(this._checkSizeRatio=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this._background},set:function(e){this._background!==e&&(this._background=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isChecked",{get:function(){return this._isChecked},set:function(e){this._isChecked!==e&&(this._isChecked=e,this._markAsDirty(),this.onIsCheckedChangedObservable.notifyObservers(e))},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"Checkbox"},t.prototype._draw=function(e,t){e.save(),this._applyStates(e);var n=this._currentMeasure.width-this._thickness,r=this._currentMeasure.height-this._thickness;if((this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY),e.fillStyle=this._isEnabled?this._background:this._disabledColor,e.fillRect(this._currentMeasure.left+this._thickness/2,this._currentMeasure.top+this._thickness/2,n,r),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),this._isChecked){e.fillStyle=this._isEnabled?this.color:this._disabledColorItem;var i=n*this._checkSizeRatio,o=r*this._checkSizeRatio;e.fillRect(this._currentMeasure.left+this._thickness/2+(n-i)/2,this._currentMeasure.top+this._thickness/2+(r-o)/2,i,o)}e.strokeStyle=this.color,e.lineWidth=this._thickness,e.strokeRect(this._currentMeasure.left+this._thickness/2,this._currentMeasure.top+this._thickness/2,n,r),e.restore()},t.prototype._onPointerDown=function(t,n,r,i,o){return!!e.prototype._onPointerDown.call(this,t,n,r,i,o)&&(this.isReadOnly||(this.isChecked=!this.isChecked),!0)},t.AddCheckBoxWithHeader=function(e,n){var r=new a.StackPanel;r.isVertical=!1,r.height="30px";var i=new t;i.width="20px",i.height="20px",i.isChecked=!0,i.color="green",i.onIsCheckedChangedObservable.add(n),r.addControl(i);var l=new s.TextBlock;return l.text=e,l.width="180px",l.paddingLeft="5px",l.textHorizontalAlignment=o.Control.HORIZONTAL_ALIGNMENT_LEFT,l.color="white",r.addControl(l),r},Object(r.__decorate)([Object(i.serialize)()],t.prototype,"thickness",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"checkSizeRatio",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"background",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"isChecked",null),t}(o.Control);Object(i.RegisterClass)("BABYLON.GUI.Checkbox",l)},"./2D/controls/colorpicker.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"ColorPicker",function(){return _});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=n("./2D/controls/control.ts"),a=n("./2D/controls/inputText.ts"),s=n("./2D/controls/rectangle.ts"),l=n("./2D/controls/button.ts"),c=n("./2D/controls/grid.ts"),u=n("./2D/controls/textBlock.ts"),_=function(e){function t(t){var n=e.call(this,t)||this;return n.name=t,n._value=i.Color3.Red(),n._tmpColor=new i.Color3,n._pointerStartedOnSquare=!1,n._pointerStartedOnWheel=!1,n._squareLeft=0,n._squareTop=0,n._squareSize=0,n._h=360,n._s=1,n._v=1,n._lastPointerDownId=-1,n.onValueChangedObservable=new i.Observable,n._pointerIsDown=!1,n.value=new i.Color3(.88,.1,.1),n.size="200px",n.isPointerBlocker=!0,n}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){this._value.equals(e)||(this._value.copyFrom(e),this._value.toHSVToRef(this._tmpColor),this._h=this._tmpColor.r,this._s=Math.max(this._tmpColor.g,1e-5),this._v=Math.max(this._tmpColor.b,1e-5),this._markAsDirty(),this._value.r<=t._Epsilon&&(this._value.r=0),this._value.g<=t._Epsilon&&(this._value.g=0),this._value.b<=t._Epsilon&&(this._value.b=0),this._value.r>=1-t._Epsilon&&(this._value.r=1),this._value.g>=1-t._Epsilon&&(this._value.g=1),this._value.b>=1-t._Epsilon&&(this._value.b=1),this.onValueChangedObservable.notifyObservers(this._value))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width.toString(this._host)},set:function(e){this._width.toString(this._host)!==e&&this._width.fromString(e)&&(0===this._width.getValue(this._host)&&(e="1px",this._width.fromString(e)),this._height.fromString(e),this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height.toString(this._host)},set:function(e){this._height.toString(this._host)!==e&&this._height.fromString(e)&&(0===this._height.getValue(this._host)&&(e="1px",this._height.fromString(e)),this._width.fromString(e),this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.width},set:function(e){this.width=e},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"ColorPicker"},t.prototype._preMeasure=function(e,t){e.width<e.height?this._currentMeasure.height=e.width:this._currentMeasure.width=e.height},t.prototype._updateSquareProps=function(){var e=.5*Math.min(this._currentMeasure.width,this._currentMeasure.height),t=2*(e-.2*e)/Math.sqrt(2),n=e-.5*t;this._squareLeft=this._currentMeasure.left+n,this._squareTop=this._currentMeasure.top+n,this._squareSize=t},t.prototype._drawGradientSquare=function(e,t,n,r,i,o){var a=o.createLinearGradient(t,n,r+t,n);a.addColorStop(0,"#fff"),a.addColorStop(1,"hsl("+e+", 100%, 50%)"),o.fillStyle=a,o.fillRect(t,n,r,i);var s=o.createLinearGradient(t,n,t,i+n);s.addColorStop(0,"rgba(0,0,0,0)"),s.addColorStop(1,"#000"),o.fillStyle=s,o.fillRect(t,n,r,i)},t.prototype._drawCircle=function(e,t,n,r){r.beginPath(),r.arc(e,t,n+1,0,2*Math.PI,!1),r.lineWidth=3,r.strokeStyle="#333333",r.stroke(),r.beginPath(),r.arc(e,t,n,0,2*Math.PI,!1),r.lineWidth=3,r.strokeStyle="#ffffff",r.stroke()},t.prototype._createColorWheelCanvas=function(e,t){var n=i.Engine.LastCreatedEngine;if(!n)throw new Error("Invalid engine. Unable to create a canvas.");for(var r=n.createCanvas(2*e,2*e),o=r.getContext("2d"),a=o.getImageData(0,0,2*e,2*e),s=a.data,l=this._tmpColor,c=e*e,u=e-t,_=u*u,h=-e;h<e;h++)for(var f=-e;f<e;f++){var d=h*h+f*f;if(!(d>c||d<_)){var p=Math.sqrt(d),m=Math.atan2(f,h);i.Color3.HSVtoRGBToRef(180*m/Math.PI+180,p/e,1,l);var g=4*(h+e+2*(f+e)*e);s[g]=255*l.r,s[g+1]=255*l.g,s[g+2]=255*l.b;var v=.2;v=e<50?.2:e>150?.04:-.16*(e-50)/100+.2;var b=(p-u)/(e-u);s[g+3]=b<v?b/v*255:b>1-v?255*(1-(b-(1-v))/v):255}}return o.putImageData(a,0,0),r},t.prototype._draw=function(e){e.save(),this._applyStates(e);var t=.5*Math.min(this._currentMeasure.width,this._currentMeasure.height),n=.2*t,r=this._currentMeasure.left,i=this._currentMeasure.top;this._colorWheelCanvas&&this._colorWheelCanvas.width==2*t||(this._colorWheelCanvas=this._createColorWheelCanvas(t,n)),this._updateSquareProps(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY,e.fillRect(this._squareLeft,this._squareTop,this._squareSize,this._squareSize)),e.drawImage(this._colorWheelCanvas,r,i),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),this._drawGradientSquare(this._h,this._squareLeft,this._squareTop,this._squareSize,this._squareSize,e);var o=this._squareLeft+this._squareSize*this._s,a=this._squareTop+this._squareSize*(1-this._v);this._drawCircle(o,a,.04*t,e);var s=t-.5*n;o=r+t+Math.cos((this._h-180)*Math.PI/180)*s,a=i+t+Math.sin((this._h-180)*Math.PI/180)*s,this._drawCircle(o,a,.35*n,e),e.restore()},t.prototype._updateValueFromPointer=function(e,n){if(this._pointerStartedOnWheel){var r=.5*Math.min(this._currentMeasure.width,this._currentMeasure.height),o=r+this._currentMeasure.left,a=r+this._currentMeasure.top;this._h=180*Math.atan2(n-a,e-o)/Math.PI+180}else this._pointerStartedOnSquare&&(this._updateSquareProps(),this._s=(e-this._squareLeft)/this._squareSize,this._v=1-(n-this._squareTop)/this._squareSize,this._s=Math.min(this._s,1),this._s=Math.max(this._s,t._Epsilon),this._v=Math.min(this._v,1),this._v=Math.max(this._v,t._Epsilon));i.Color3.HSVtoRGBToRef(this._h,this._s,this._v,this._tmpColor),this.value=this._tmpColor},t.prototype._isPointOnSquare=function(e,t){this._updateSquareProps();var n=this._squareLeft,r=this._squareTop,i=this._squareSize;return e>=n&&e<=n+i&&t>=r&&t<=r+i},t.prototype._isPointOnWheel=function(e,t){var n=.5*Math.min(this._currentMeasure.width,this._currentMeasure.height),r=n-.2*n,i=e-(n+this._currentMeasure.left),o=t-(n+this._currentMeasure.top),a=i*i+o*o;return a<=n*n&&a>=r*r},t.prototype._onPointerDown=function(t,n,r,i,o){if(!e.prototype._onPointerDown.call(this,t,n,r,i,o))return!1;if(this.isReadOnly)return!0;this._pointerIsDown=!0,this._pointerStartedOnSquare=!1,this._pointerStartedOnWheel=!1,this._invertTransformMatrix.transformCoordinates(n.x,n.y,this._transformedPosition);var a=this._transformedPosition.x,s=this._transformedPosition.y;return this._isPointOnSquare(a,s)?this._pointerStartedOnSquare=!0:this._isPointOnWheel(a,s)&&(this._pointerStartedOnWheel=!0),this._updateValueFromPointer(a,s),this._host._capturingControl[r]=this,this._lastPointerDownId=r,!0},t.prototype._onPointerMove=function(t,n,r,i){if(r==this._lastPointerDownId){if(!this.isReadOnly){this._invertTransformMatrix.transformCoordinates(n.x,n.y,this._transformedPosition);var o=this._transformedPosition.x,a=this._transformedPosition.y;this._pointerIsDown&&this._updateValueFromPointer(o,a)}e.prototype._onPointerMove.call(this,t,n,r,i)}},t.prototype._onPointerUp=function(t,n,r,i,o,a){this._pointerIsDown=!1,delete this._host._capturingControl[r],e.prototype._onPointerUp.call(this,t,n,r,i,o,a)},t.prototype._onCanvasBlur=function(){this._forcePointerUp(),e.prototype._onCanvasBlur.call(this)},t.ShowPickerDialogAsync=function(e,n){return new Promise(function(r,_){n.pickerWidth=n.pickerWidth||"640px",n.pickerHeight=n.pickerHeight||"400px",n.headerHeight=n.headerHeight||"35px",n.lastColor=n.lastColor||"#000000",n.swatchLimit=n.swatchLimit||20,n.numSwatchesPerLine=n.numSwatchesPerLine||10;var h,f,d,p,m,g,v,b,y,x,T,O,P,C,S,M,E,A,B,F=n.swatchLimit/n.numSwatchesPerLine,R=parseFloat(n.pickerWidth)/n.numSwatchesPerLine,L=Math.floor(.25*R),w=L*(n.numSwatchesPerLine+1),I=Math.floor((parseFloat(n.pickerWidth)-w)/n.numSwatchesPerLine),D=I*F+L*(F+1),N=(parseInt(n.pickerHeight)+D+Math.floor(.25*I)).toString()+"px",V="#c0c0c0",j="#535353",k="#414141",z="515151",G="#555555",H="#454545",U=i.Color3.FromHexString("#dddddd"),Q=U.r+U.g+U.b,W="#aaaaaa",X="#ffffff",K=["R","G","B"],Y=!1;function q(e,t){B=t;var n=e.toHexString();if(E.background=n,x.name!=B&&(x.text=Math.floor(255*e.r).toString()),T.name!=B&&(T.text=Math.floor(255*e.g).toString()),O.name!=B&&(O.text=Math.floor(255*e.b).toString()),P.name!=B&&(P.text=e.r.toString()),C.name!=B&&(C.text=e.g.toString()),S.name!=B&&(S.text=e.b.toString()),M.name!=B){var r=n.split("#");M.text=r[1]}y.name!=B&&(y.value=e)}function Z(e,t){var n=e.text;if(/[^0-9]/g.test(n))e.text=A;else if(""!=n&&(Math.floor(parseInt(n))<0?n="0":Math.floor(parseInt(n))>255?n="255":isNaN(parseInt(n))&&(n="0")),B==e.name&&(A=n),""!=n){n=parseInt(n).toString(),e.text=n;var r=i.Color3.FromHexString(E.background);B==e.name&&q("r"==t?new i.Color3(parseInt(n)/255,r.g,r.b):"g"==t?new i.Color3(r.r,parseInt(n)/255,r.b):new i.Color3(r.r,r.g,parseInt(n)/255),e.name)}}function J(e,t){var n=e.text;if(/[^0-9\.]/g.test(n))e.text=A;else{""!=n&&"."!=n&&0!=parseFloat(n)&&(parseFloat(n)<0?n="0.0":parseFloat(n)>1?n="1.0":isNaN(parseFloat(n))&&(n="0.0")),B==e.name&&(A=n),""!=n&&"."!=n&&0!=parseFloat(n)?(n=parseFloat(n).toString(),e.text=n):n="0.0";var r=i.Color3.FromHexString(E.background);B==e.name&&q("r"==t?new i.Color3(parseFloat(n),r.g,r.b):"g"==t?new i.Color3(r.r,parseFloat(n),r.b):new i.Color3(r.r,r.g,parseFloat(n)),e.name)}}function $(){if(n.savedColors&&n.savedColors[v]){if(Y)var e="b";else e="";var t=l.Button.CreateSimpleButton("Swatch_"+v,e);t.fontFamily="BabylonJSglyphs";var r=i.Color3.FromHexString(n.savedColors[v]),a=r.r+r.g+r.b;t.color=a>Q?W:X,t.fontSize=Math.floor(.7*I),t.textBlock.verticalAlignment=o.Control.VERTICAL_ALIGNMENT_CENTER,t.height=t.width=I.toString()+"px",t.background=n.savedColors[v],t.thickness=2;var s=v;return t.pointerDownAnimation=function(){t.thickness=4},t.pointerUpAnimation=function(){t.thickness=3},t.pointerEnterAnimation=function(){t.thickness=3},t.pointerOutAnimation=function(){t.thickness=2},t.onPointerClickObservable.add(function(){var e;Y?(e=s,n.savedColors&&n.savedColors.splice(e,1),n.savedColors&&0==n.savedColors.length&&(ne(!1),Y=!1),te("",De)):n.savedColors&&q(i.Color3.FromHexString(n.savedColors[s]),t.name)}),t}return null}function ee(e){if(void 0!==e&&(Y=e),Y){for(var t=0;t<b.children.length;t++){b.children[t].textBlock.text="b"}void 0!==d&&(d.textBlock.text="Done")}else{for(t=0;t<b.children.length;t++){b.children[t].textBlock.text=""}void 0!==d&&(d.textBlock.text="Edit")}}function te(e,t){if(n.savedColors){""!=e&&n.savedColors.push(e),v=0,b.clearControls();var r=Math.ceil(n.savedColors.length/n.numSwatchesPerLine);if(0==r)var i=0;else i=r+1;if(b.rowCount!=r+i){for(var o=b.rowCount,a=0;a<o;a++)b.removeRowDefinition(0);for(a=0;a<r+i;a++)a%2?b.addRowDefinition(I,!0):b.addRowDefinition(L,!0)}b.height=(I*r+i*L).toString()+"px";for(var s=1,l=1;s<r+i;s+=2,l++){if(n.savedColors.length>l*n.numSwatchesPerLine)var c=n.numSwatchesPerLine;else c=n.savedColors.length-(l-1)*n.numSwatchesPerLine;for(var u=Math.min(Math.max(c,0),n.numSwatchesPerLine),_=0,h=1;_<u;_++)if(!(_>n.numSwatchesPerLine)){var f=$();null!=f&&(b.addControl(f,s,h),h+=2,v++)}}n.savedColors.length>=n.swatchLimit?re(t,!0):re(t,!1)}}function ne(e){e?((d=l.Button.CreateSimpleButton("butEdit","Edit")).width=p,d.height=m,d.left=Math.floor(.1*parseInt(p)).toString()+"px",d.top=(-1*parseFloat(d.left)).toString()+"px",d.verticalAlignment=o.Control.VERTICAL_ALIGNMENT_BOTTOM,d.horizontalAlignment=o.Control.HORIZONTAL_ALIGNMENT_LEFT,d.thickness=2,d.color=V,d.fontSize=f,d.background=j,d.onPointerEnterObservable.add(function(){d.background=k}),d.onPointerOutObservable.add(function(){d.background=j}),d.pointerDownAnimation=function(){d.background=z},d.pointerUpAnimation=function(){d.background=k},d.onPointerClickObservable.add(function(){Y=!Y,ee()}),ve.addControl(d,1,0)):ve.removeControl(d)}function re(e,t){t?(e.color=G,e.background=H):(e.color=V,e.background=j)}function ie(t){n.savedColors&&n.savedColors.length>0?r({savedColors:n.savedColors,pickedColor:t}):r({pickedColor:t}),e.removeControl(oe)}var oe=new c.Grid;if(oe.name="Dialog Container",oe.width=n.pickerWidth,n.savedColors){oe.height=N;var ae=parseInt(n.pickerHeight)/parseInt(N);oe.addRowDefinition(ae,!1),oe.addRowDefinition(1-ae,!1)}else oe.height=n.pickerHeight,oe.addRowDefinition(1,!1);if(e.addControl(oe),n.savedColors){(b=new c.Grid).name="Swatch Drawer",b.verticalAlignment=o.Control.VERTICAL_ALIGNMENT_TOP,b.background=j,b.width=n.pickerWidth;var se=n.savedColors.length/n.numSwatchesPerLine;if(0==se)var le=0;else le=se+1;b.height=(I*se+le*L).toString()+"px",b.top=Math.floor(.25*I).toString()+"px";for(var ce=0;ce<2*Math.ceil(n.savedColors.length/n.numSwatchesPerLine)+1;ce++)ce%2!=0?b.addRowDefinition(I,!0):b.addRowDefinition(L,!0);for(ce=0;ce<2*n.numSwatchesPerLine+1;ce++)ce%2!=0?b.addColumnDefinition(I,!0):b.addColumnDefinition(L,!0);oe.addControl(b,1,0)}var ue=new c.Grid;ue.name="Picker Panel",ue.height=n.pickerHeight;var _e=parseInt(n.headerHeight)/parseInt(n.pickerHeight),he=[_e,1-_e];ue.addRowDefinition(he[0],!1),ue.addRowDefinition(he[1],!1),oe.addControl(ue,0,0);var fe=new s.Rectangle;fe.name="Dialogue Header Bar",fe.background="#cccccc",fe.thickness=0,ue.addControl(fe,0,0);var de=l.Button.CreateSimpleButton("closeButton","a");de.fontFamily="BabylonJSglyphs";var pe=i.Color3.FromHexString(fe.background);h=new i.Color3(1-pe.r,1-pe.g,1-pe.b),de.color=h.toHexString(),de.fontSize=Math.floor(.6*parseInt(n.headerHeight)),de.textBlock.textVerticalAlignment=o.Control.VERTICAL_ALIGNMENT_CENTER,de.horizontalAlignment=o.Control.HORIZONTAL_ALIGNMENT_RIGHT,de.height=de.width=n.headerHeight,de.background=fe.background,de.thickness=0,de.pointerDownAnimation=function(){},de.pointerUpAnimation=function(){de.background=fe.background},de.pointerEnterAnimation=function(){de.color=fe.background,de.background="red"},de.pointerOutAnimation=function(){de.color=h.toHexString(),de.background=fe.background},de.onPointerClickObservable.add(function(){ie(Be.background)}),ue.addControl(de,0,0);var me=new c.Grid;me.name="Dialogue Body",me.background=j;var ge=[.4375,.5625];me.addRowDefinition(1,!1),me.addColumnDefinition(ge[0],!1),me.addColumnDefinition(ge[1],!1),ue.addControl(me,1,0);var ve=new c.Grid;ve.name="Picker Grid",ve.addRowDefinition(.85,!1),ve.addRowDefinition(.15,!1),me.addControl(ve,0,0),(y=new t).name="GUI Color Picker",n.pickerHeight<n.pickerWidth?y.width=.89:y.height=.89,y.value=i.Color3.FromHexString(n.lastColor),y.horizontalAlignment=o.Control.HORIZONTAL_ALIGNMENT_CENTER,y.verticalAlignment=o.Control.VERTICAL_ALIGNMENT_CENTER,y.onPointerDownObservable.add(function(){B=y.name,A="",ee(!1)}),y.onValueChangedObservable.add(function(e){B==y.name&&q(e,y.name)}),ve.addControl(y,0,0);var be=new c.Grid;be.name="Dialogue Right Half",be.horizontalAlignment=o.Control.HORIZONTAL_ALIGNMENT_LEFT;var ye=[.514,.486];be.addRowDefinition(ye[0],!1),be.addRowDefinition(ye[1],!1),me.addControl(be,1,1);var xe=new c.Grid;xe.name="Swatches and Buttons";var Te=[.417,.583];xe.addRowDefinition(1,!1),xe.addColumnDefinition(Te[0],!1),xe.addColumnDefinition(Te[1],!1),be.addControl(xe,0,0);var Oe=new c.Grid;Oe.name="New and Current Swatches";var Pe=[.04,.16,.64,.16];Oe.addRowDefinition(Pe[0],!1),Oe.addRowDefinition(Pe[1],!1),Oe.addRowDefinition(Pe[2],!1),Oe.addRowDefinition(Pe[3],!1),xe.addControl(Oe,0,0);var Ce=new c.Grid;Ce.name="Active Swatches",Ce.width=.67,Ce.addRowDefinition(.5,!1),Ce.addRowDefinition(.5,!1),Oe.addControl(Ce,2,0);var Se=Math.floor(parseInt(n.pickerWidth)*ge[1]*Te[0]*.11),Me=Math.floor(parseInt(n.pickerHeight)*he[1]*ye[0]*Pe[1]*.5);if(n.pickerWidth>n.pickerHeight)var Ee=Me;else Ee=Se;var Ae=new u.TextBlock;Ae.text="new",Ae.name="New Color Label",Ae.color=V,Ae.fontSize=Ee,Oe.addControl(Ae,1,0),(E=new s.Rectangle).name="New Color Swatch",E.background=n.lastColor,E.thickness=0,Ce.addControl(E,0,0);var Be=l.Button.CreateSimpleButton("currentSwatch","");Be.background=n.lastColor,Be.thickness=0,Be.onPointerClickObservable.add(function(){q(i.Color3.FromHexString(Be.background),Be.name),ee(!1)}),Be.pointerDownAnimation=function(){},Be.pointerUpAnimation=function(){},Be.pointerEnterAnimation=function(){},Be.pointerOutAnimation=function(){},Ce.addControl(Be,1,0);var Fe=new s.Rectangle;Fe.name="Swatch Outline",Fe.width=.67,Fe.thickness=2,Fe.color="#404040",Fe.isHitTestVisible=!1,Oe.addControl(Fe,2,0);var Re=new u.TextBlock;Re.name="Current Color Label",Re.text="current",Re.color=V,Re.fontSize=Ee,Oe.addControl(Re,3,0);var Le=new c.Grid;Le.name="Button Grid",Le.height=.8;Le.addRowDefinition(1/3,!1),Le.addRowDefinition(1/3,!1),Le.addRowDefinition(1/3,!1),xe.addControl(Le,0,1),p=Math.floor(parseInt(n.pickerWidth)*ge[1]*Te[1]*.67).toString()+"px",m=Math.floor(parseInt(n.pickerHeight)*he[1]*ye[0]*(parseFloat(Le.height.toString())/100)*(1/3)*.7).toString()+"px",f=parseFloat(p)>parseFloat(m)?Math.floor(.45*parseFloat(m)):Math.floor(.11*parseFloat(p));var we=l.Button.CreateSimpleButton("butOK","OK");we.width=p,we.height=m,we.verticalAlignment=o.Control.VERTICAL_ALIGNMENT_CENTER,we.thickness=2,we.color=V,we.fontSize=f,we.background=j,we.onPointerEnterObservable.add(function(){we.background=k}),we.onPointerOutObservable.add(function(){we.background=j}),we.pointerDownAnimation=function(){we.background=z},we.pointerUpAnimation=function(){we.background=k},we.onPointerClickObservable.add(function(){ee(!1),ie(E.background)}),Le.addControl(we,0,0);var Ie=l.Button.CreateSimpleButton("butCancel","Cancel");if(Ie.width=p,Ie.height=m,Ie.verticalAlignment=o.Control.VERTICAL_ALIGNMENT_CENTER,Ie.thickness=2,Ie.color=V,Ie.fontSize=f,Ie.background=j,Ie.onPointerEnterObservable.add(function(){Ie.background=k}),Ie.onPointerOutObservable.add(function(){Ie.background=j}),Ie.pointerDownAnimation=function(){Ie.background=z},Ie.pointerUpAnimation=function(){Ie.background=k},Ie.onPointerClickObservable.add(function(){ee(!1),ie(Be.background)}),Le.addControl(Ie,1,0),n.savedColors){var De=l.Button.CreateSimpleButton("butSave","Save");De.width=p,De.height=m,De.verticalAlignment=o.Control.VERTICAL_ALIGNMENT_CENTER,De.thickness=2,De.fontSize=f,n.savedColors.length<n.swatchLimit?(De.color=V,De.background=j):re(De,!0),De.onPointerEnterObservable.add(function(){n.savedColors&&n.savedColors.length<n.swatchLimit&&(De.background=k)}),De.onPointerOutObservable.add(function(){n.savedColors&&n.savedColors.length<n.swatchLimit&&(De.background=j)}),De.pointerDownAnimation=function(){n.savedColors&&n.savedColors.length<n.swatchLimit&&(De.background=z)},De.pointerUpAnimation=function(){n.savedColors&&n.savedColors.length<n.swatchLimit&&(De.background=k)},De.onPointerClickObservable.add(function(){n.savedColors&&(0==n.savedColors.length&&ne(!0),n.savedColors.length<n.swatchLimit&&te(E.background,De),ee(!1))}),n.savedColors.length>0&&ne(!0),Le.addControl(De,2,0)}var Ne=new c.Grid;Ne.name="Dialog Lower Right",Ne.addRowDefinition(.02,!1),Ne.addRowDefinition(.63,!1),Ne.addRowDefinition(.21,!1),Ne.addRowDefinition(.14,!1),be.addControl(Ne,1,0),g=i.Color3.FromHexString(n.lastColor);var Ve=new c.Grid;Ve.name="RGB Values",Ve.width=.82,Ve.verticalAlignment=o.Control.VERTICAL_ALIGNMENT_CENTER,Ve.addRowDefinition(1/3,!1),Ve.addRowDefinition(1/3,!1),Ve.addRowDefinition(1/3,!1),Ve.addColumnDefinition(.1,!1),Ve.addColumnDefinition(.2,!1),Ve.addColumnDefinition(.7,!1),Ne.addControl(Ve,1,0);for(ce=0;ce<K.length;ce++){(je=new u.TextBlock).text=K[ce],je.color=V,je.fontSize=f,Ve.addControl(je,ce,0)}(x=new a.InputText).width=.83,x.height=.72,x.name="rIntField",x.fontSize=f,x.text=(255*g.r).toString(),x.color="#f0f0f0",x.background="#454545",x.onFocusObservable.add(function(){B=x.name,A=x.text,ee(!1)}),x.onBlurObservable.add(function(){""==x.text&&(x.text="0"),Z(x,"r"),B==x.name&&(B="")}),x.onTextChangedObservable.add(function(){B==x.name&&Z(x,"r")}),Ve.addControl(x,0,1),(T=new a.InputText).width=.83,T.height=.72,T.name="gIntField",T.fontSize=f,T.text=(255*g.g).toString(),T.color="#f0f0f0",T.background="#454545",T.onFocusObservable.add(function(){B=T.name,A=T.text,ee(!1)}),T.onBlurObservable.add(function(){""==T.text&&(T.text="0"),Z(T,"g"),B==T.name&&(B="")}),T.onTextChangedObservable.add(function(){B==T.name&&Z(T,"g")}),Ve.addControl(T,1,1),(O=new a.InputText).width=.83,O.height=.72,O.name="bIntField",O.fontSize=f,O.text=(255*g.b).toString(),O.color="#f0f0f0",O.background="#454545",O.onFocusObservable.add(function(){B=O.name,A=O.text,ee(!1)}),O.onBlurObservable.add(function(){""==O.text&&(O.text="0"),Z(O,"b"),B==O.name&&(B="")}),O.onTextChangedObservable.add(function(){B==O.name&&Z(O,"b")}),Ve.addControl(O,2,1),(P=new a.InputText).width=.95,P.height=.72,P.name="rDecField",P.fontSize=f,P.text=g.r.toString(),P.color="#f0f0f0",P.background="#454545",P.onFocusObservable.add(function(){B=P.name,A=P.text,ee(!1)}),P.onBlurObservable.add(function(){0!=parseFloat(P.text)&&""!=P.text||(P.text="0",J(P,"r")),B==P.name&&(B="")}),P.onTextChangedObservable.add(function(){B==P.name&&J(P,"r")}),Ve.addControl(P,0,2),(C=new a.InputText).width=.95,C.height=.72,C.name="gDecField",C.fontSize=f,C.text=g.g.toString(),C.color="#f0f0f0",C.background="#454545",C.onFocusObservable.add(function(){B=C.name,A=C.text,ee(!1)}),C.onBlurObservable.add(function(){0!=parseFloat(C.text)&&""!=C.text||(C.text="0",J(C,"g")),B==C.name&&(B="")}),C.onTextChangedObservable.add(function(){B==C.name&&J(C,"g")}),Ve.addControl(C,1,2),(S=new a.InputText).width=.95,S.height=.72,S.name="bDecField",S.fontSize=f,S.text=g.b.toString(),S.color="#f0f0f0",S.background="#454545",S.onFocusObservable.add(function(){B=S.name,A=S.text,ee(!1)}),S.onBlurObservable.add(function(){0!=parseFloat(S.text)&&""!=S.text||(S.text="0",J(S,"b")),B==S.name&&(B="")}),S.onTextChangedObservable.add(function(){B==S.name&&J(S,"b")}),Ve.addControl(S,2,2);var je,ke=new c.Grid;ke.name="Hex Value",ke.width=.82,ke.addRowDefinition(1,!1),ke.addColumnDefinition(.1,!1),ke.addColumnDefinition(.9,!1),Ne.addControl(ke,2,0),(je=new u.TextBlock).text="#",je.color=V,je.fontSize=f,ke.addControl(je,0,0),(M=new a.InputText).width=.96,M.height=.72,M.name="hexField",M.horizontalAlignment=o.Control.HORIZONTAL_ALIGNMENT_CENTER,M.fontSize=f;var ze=n.lastColor.split("#");M.text=ze[1],M.color="#f0f0f0",M.background="#454545",M.onFocusObservable.add(function(){B=M.name,A=M.text,ee(!1)}),M.onBlurObservable.add(function(){if(3==M.text.length){var e=M.text.split("");M.text=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]}""==M.text&&(M.text="000000",q(i.Color3.FromHexString(M.text),"b")),B==M.name&&(B="")}),M.onTextChangedObservable.add(function(){var e=M.text,t=/[^0-9A-F]/i.test(e);if((M.text.length>6||t)&&B==M.name)M.text=A;else{if(M.text.length<6)for(var n=6-M.text.length,r=0;r<n;r++)e="0"+e;if(3==M.text.length){var o=M.text.split("");e=o[0]+o[0]+o[1]+o[1]+o[2]+o[2]}e="#"+e,B==M.name&&(A=M.text,q(i.Color3.FromHexString(e),M.name))}}),ke.addControl(M,0,1),n.savedColors&&n.savedColors.length>0&&te("",De)})},t._Epsilon=1e-6,Object(r.__decorate)([Object(i.serialize)()],t.prototype,"value",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"width",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"height",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"size",null),t}(o.Control);Object(i.RegisterClass)("BABYLON.GUI.ColorPicker",_)},"./2D/controls/container.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"Container",function(){return s});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=n("./2D/controls/control.ts"),a=n("./2D/measure.ts"),s=function(e){function t(t){var n=e.call(this,t)||this;return n.name=t,n._children=new Array,n._measureForChildren=a.Measure.Empty(),n._background="",n._adaptWidthToChildren=!1,n._adaptHeightToChildren=!1,n._renderToIntermediateTexture=!1,n._intermediateTexture=null,n.logLayoutCycleErrors=!1,n.maxLayoutCycle=3,n}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"renderToIntermediateTexture",{get:function(){return this._renderToIntermediateTexture},set:function(e){this._renderToIntermediateTexture!==e&&(this._renderToIntermediateTexture=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"adaptHeightToChildren",{get:function(){return this._adaptHeightToChildren},set:function(e){this._adaptHeightToChildren!==e&&(this._adaptHeightToChildren=e,e&&(this.height="100%"),this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"adaptWidthToChildren",{get:function(){return this._adaptWidthToChildren},set:function(e){this._adaptWidthToChildren!==e&&(this._adaptWidthToChildren=e,e&&(this.width="100%"),this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this._background},set:function(e){this._background!==e&&(this._background=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"children",{get:function(){return this._children},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isReadOnly",{get:function(){return this._isReadOnly},set:function(e){this._isReadOnly=e;for(var t=0,n=this._children;t<n.length;t++){n[t].isReadOnly=e}},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"Container"},t.prototype._flagDescendantsAsMatrixDirty=function(){for(var e=0,t=this.children;e<t.length;e++){t[e]._markMatrixAsDirty()}},t.prototype.getChildByName=function(e){for(var t=0,n=this.children;t<n.length;t++){var r=n[t];if(r.name===e)return r}return null},t.prototype.getChildByType=function(e,t){for(var n=0,r=this.children;n<r.length;n++){var i=r[n];if(i.typeName===t)return i}return null},t.prototype.containsControl=function(e){return-1!==this.children.indexOf(e)},t.prototype.addControl=function(e){return e?-1!==this._children.indexOf(e)?this:(e._link(this._host),e._markAllAsDirty(),this._reOrderControl(e),this._markAsDirty(),this):this},t.prototype.clearControls=function(){for(var e=0,t=this.children.slice();e<t.length;e++){var n=t[e];this.removeControl(n)}return this},t.prototype.removeControl=function(e){var t=this._children.indexOf(e);return-1!==t&&(this._children.splice(t,1),e.parent=null),e.linkWithMesh(null),this._host&&this._host._cleanControlAfterRemoval(e),this._markAsDirty(),this},t.prototype._reOrderControl=function(e){this.removeControl(e);for(var t=!1,n=0;n<this._children.length;n++)if(this._children[n].zIndex>e.zIndex){this._children.splice(n,0,e),t=!0;break}t||this._children.push(e),e.parent=this,this._markAsDirty()},t.prototype._offsetLeft=function(t){e.prototype._offsetLeft.call(this,t);for(var n=0,r=this._children;n<r.length;n++){r[n]._offsetLeft(t)}},t.prototype._offsetTop=function(t){e.prototype._offsetTop.call(this,t);for(var n=0,r=this._children;n<r.length;n++){r[n]._offsetTop(t)}},t.prototype._markAllAsDirty=function(){e.prototype._markAllAsDirty.call(this);for(var t=0;t<this._children.length;t++)this._children[t]._markAllAsDirty()},t.prototype._localDraw=function(e){this._background&&(e.save(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY),e.fillStyle=this._background,e.fillRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height),e.restore())},t.prototype._link=function(t){e.prototype._link.call(this,t);for(var n=0,r=this._children;n<r.length;n++){r[n]._link(t)}},t.prototype._beforeLayout=function(){},t.prototype._processMeasures=function(t,n){!this._isDirty&&this._cachedParentMeasure.isEqualsTo(t)||(e.prototype._processMeasures.call(this,t,n),this._evaluateClippingState(t),this._renderToIntermediateTexture&&(this._intermediateTexture&&this._host.getScene()!=this._intermediateTexture.getScene()&&(this._intermediateTexture.dispose(),this._intermediateTexture=null),this._intermediateTexture?this._intermediateTexture.scaleTo(this._currentMeasure.width,this._currentMeasure.height):(this._intermediateTexture=new i.DynamicTexture("",{width:this._currentMeasure.width,height:this._currentMeasure.height},this._host.getScene(),!1,i.Texture.NEAREST_SAMPLINGMODE,i.Constants.TEXTUREFORMAT_RGBA,!1),this._intermediateTexture.hasAlpha=!0)))},t.prototype._layout=function(e,t){var n,r;if(!this.isDirty&&(!this.isVisible||this.notRenderable))return!1;this.host._numLayoutCalls++,this._isDirty&&this._currentMeasure.transformToRef(this._transformMatrix,this._prevCurrentMeasureTransformedIntoGlobalSpace);var o=0;t.save(),this._applyStates(t),this._beforeLayout();do{var a=-1,s=-1;if(this._rebuildLayout=!1,this._processMeasures(e,t),!this._isClipped){for(var l=0,c=this._children;l<c.length;l++){var u=c[l];u._tempParentMeasure.copyFrom(this._measureForChildren),u._layout(this._measureForChildren,t)&&(this.adaptWidthToChildren&&u._width.isPixel&&(a=Math.max(a,u._currentMeasure.width+u.paddingLeftInPixels+u.paddingRightInPixels)),this.adaptHeightToChildren&&u._height.isPixel&&(s=Math.max(s,u._currentMeasure.height+u.paddingTopInPixels+u.paddingBottomInPixels)))}this.adaptWidthToChildren&&a>=0&&(a+=this.paddingLeftInPixels+this.paddingRightInPixels,this.width!==a+"px"&&(null===(n=this.parent)||void 0===n||n._markAsDirty(),this.width=a+"px",this._rebuildLayout=!0)),this.adaptHeightToChildren&&s>=0&&(s+=this.paddingTopInPixels+this.paddingBottomInPixels,this.height!==s+"px"&&(null===(r=this.parent)||void 0===r||r._markAsDirty(),this.height=s+"px",this._rebuildLayout=!0)),this._postMeasure()}o++}while(this._rebuildLayout&&o<this.maxLayoutCycle);return o>=3&&this.logLayoutCycleErrors&&i.Logger.Error("Layout cycle detected in GUI (Container name="+this.name+", uniqueId="+this.uniqueId+")"),t.restore(),this._isDirty&&(this.invalidateRect(),this._isDirty=!1),!0},t.prototype._postMeasure=function(){},t.prototype._draw=function(e,t){var n=this._renderToIntermediateTexture&&this._intermediateTexture,r=n?this._intermediateTexture.getContext():e;n&&(r.save(),r.translate(-this._currentMeasure.left,-this._currentMeasure.top),t?r.clearRect(t.left,t.top,t.width,t.height):r.clearRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height)),this._localDraw(r),e.save(),this.clipChildren&&this._clipForChildren(r);for(var i=0,o=this._children;i<o.length;i++){var a=o[i];t&&!a._intersectsRect(t)||a._render(r,t)}n&&(r.restore(),e.save(),e.globalAlpha=this.alpha,e.drawImage(r.canvas,this._currentMeasure.left,this._currentMeasure.top),e.restore()),e.restore()},t.prototype.getDescendantsToRef=function(e,t,n){if(void 0===t&&(t=!1),this.children)for(var r=0;r<this.children.length;r++){var i=this.children[r];n&&!n(i)||e.push(i),t||i.getDescendantsToRef(e,!1,n)}},t.prototype._processPicking=function(t,n,r,i,o,a,s,l){if(!this._isEnabled||!this.isVisible||this.notRenderable)return!1;if(!e.prototype.contains.call(this,t,n))return!1;for(var c=this._children.length-1;c>=0;c--){var u=this._children[c];if(u._processPicking(t,n,r,i,o,a,s,l))return u.hoverCursor&&this._host._changeCursor(u.hoverCursor),!0}return!!this.isHitTestVisible&&this._processObservables(i,t,n,r,o,a,s,l)},t.prototype._additionalProcessing=function(t,n){e.prototype._additionalProcessing.call(this,t,n),this._measureForChildren.copyFrom(this._currentMeasure)},t.prototype.serialize=function(t){if(e.prototype.serialize.call(this,t),this.children.length){t.children=[];for(var n=0,r=this.children;n<r.length;n++){var i={};r[n].serialize(i),t.children.push(i)}}},t.prototype.dispose=function(){var t;e.prototype.dispose.call(this);for(var n=this.children.length-1;n>=0;n--)this.children[n].dispose();null===(t=this._intermediateTexture)||void 0===t||t.dispose()},t.prototype._parseFromContent=function(t,n){if(e.prototype._parseFromContent.call(this,t,n),this._link(n),t.children)for(var r=0,i=t.children;r<i.length;r++){var a=i[r];this.addControl(o.Control.Parse(a,n))}},Object(r.__decorate)([Object(i.serialize)()],t.prototype,"renderToIntermediateTexture",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"maxLayoutCycle",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"adaptHeightToChildren",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"adaptWidthToChildren",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"background",null),t}(o.Control);Object(i.RegisterClass)("BABYLON.GUI.Container",s)},"./2D/controls/control.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"Control",function(){return l});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=n("./2D/valueAndUnit.ts"),a=n("./2D/measure.ts"),s=n("./2D/math2D.ts"),l=function(){function e(t){this.name=t,this._alpha=1,this._alphaSet=!1,this._zIndex=0,this._currentMeasure=a.Measure.Empty(),this._fontFamily="Arial",this._fontStyle="",this._fontWeight="",this._fontSize=new o.ValueAndUnit(18,o.ValueAndUnit.UNITMODE_PIXEL,!1),this._width=new o.ValueAndUnit(1,o.ValueAndUnit.UNITMODE_PERCENTAGE,!1),this._height=new o.ValueAndUnit(1,o.ValueAndUnit.UNITMODE_PERCENTAGE,!1),this._color="",this._style=null,this._horizontalAlignment=e.HORIZONTAL_ALIGNMENT_CENTER,this._verticalAlignment=e.VERTICAL_ALIGNMENT_CENTER,this._isDirty=!0,this._wasDirty=!1,this._tempParentMeasure=a.Measure.Empty(),this._prevCurrentMeasureTransformedIntoGlobalSpace=a.Measure.Empty(),this._cachedParentMeasure=a.Measure.Empty(),this._paddingLeft=new o.ValueAndUnit(0),this._paddingRight=new o.ValueAndUnit(0),this._paddingTop=new o.ValueAndUnit(0),this._paddingBottom=new o.ValueAndUnit(0),this._left=new o.ValueAndUnit(0),this._top=new o.ValueAndUnit(0),this._scaleX=1,this._scaleY=1,this._rotation=0,this._transformCenterX=.5,this._transformCenterY=.5,this._transformMatrix=s.Matrix2D.Identity(),this._invertTransformMatrix=s.Matrix2D.Identity(),this._transformedPosition=i.Vector2.Zero(),this._isMatrixDirty=!0,this._isVisible=!0,this._isHighlighted=!1,this._highlightColor="#4affff",this._highlightLineWidth=2,this._fontSet=!1,this._dummyVector2=i.Vector2.Zero(),this._downCount=0,this._enterCount=-1,this._doNotRender=!1,this._downPointerIds={},this._isEnabled=!0,this._disabledColor="#9a9a9a",this._disabledColorItem="#6a6a6a",this._isReadOnly=!1,this._rebuildLayout=!1,this._customData={},this._isClipped=!1,this._automaticSize=!1,this.metadata=null,this.isHitTestVisible=!0,this.isPointerBlocker=!1,this.isFocusInvisible=!1,this.clipChildren=!0,this.clipContent=!0,this.useBitmapCache=!1,this._shadowOffsetX=0,this._shadowOffsetY=0,this._shadowBlur=0,this._previousShadowBlur=0,this._shadowColor="black",this.hoverCursor="",this._linkOffsetX=new o.ValueAndUnit(0),this._linkOffsetY=new o.ValueAndUnit(0),this.onWheelObservable=new i.Observable,this.onPointerMoveObservable=new i.Observable,this.onPointerOutObservable=new i.Observable,this.onPointerDownObservable=new i.Observable,this.onPointerUpObservable=new i.Observable,this.onPointerClickObservable=new i.Observable,this.onPointerEnterObservable=new i.Observable,this.onDirtyObservable=new i.Observable,this.onBeforeDrawObservable=new i.Observable,this.onAfterDrawObservable=new i.Observable,this.onDisposeObservable=new i.Observable,this.fixedRatio=0,this._fixedRatioMasterIsWidth=!0,this._tmpMeasureA=new a.Measure(0,0,0,0)}return Object.defineProperty(e.prototype,"isReadOnly",{get:function(){return this._isReadOnly},set:function(e){this._isReadOnly=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shadowOffsetX",{get:function(){return this._shadowOffsetX},set:function(e){this._shadowOffsetX!==e&&(this._shadowOffsetX=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shadowOffsetY",{get:function(){return this._shadowOffsetY},set:function(e){this._shadowOffsetY!==e&&(this._shadowOffsetY=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shadowBlur",{get:function(){return this._shadowBlur},set:function(e){this._shadowBlur!==e&&(this._previousShadowBlur=this._shadowBlur,this._shadowBlur=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shadowColor",{get:function(){return this._shadowColor},set:function(e){this._shadowColor!==e&&(this._shadowColor=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"typeName",{get:function(){return this._getTypeName()},enumerable:!1,configurable:!0}),e.prototype.getClassName=function(){return this._getTypeName()},Object.defineProperty(e.prototype,"host",{get:function(){return this._host},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontOffset",{get:function(){return this._fontOffset},set:function(e){this._fontOffset=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(e){this._alpha!==e&&(this._alphaSet=!0,this._alpha=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"highlightLineWidth",{get:function(){return this._highlightLineWidth},set:function(e){this._highlightLineWidth!==e&&(this._highlightLineWidth=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHighlighted",{get:function(){return this._isHighlighted},set:function(e){this._isHighlighted!==e&&(this._isHighlighted=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"highlightColor",{get:function(){return this._highlightColor},set:function(e){this._highlightColor!==e&&(this._highlightColor=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleX",{get:function(){return this._scaleX},set:function(e){this._scaleX!==e&&(this._scaleX=e,this._markAsDirty(),this._markMatrixAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleY",{get:function(){return this._scaleY},set:function(e){this._scaleY!==e&&(this._scaleY=e,this._markAsDirty(),this._markMatrixAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this._rotation},set:function(e){this._rotation!==e&&(this._rotation=e,this._markAsDirty(),this._markMatrixAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"transformCenterY",{get:function(){return this._transformCenterY},set:function(e){this._transformCenterY!==e&&(this._transformCenterY=e,this._markAsDirty(),this._markMatrixAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"transformCenterX",{get:function(){return this._transformCenterX},set:function(e){this._transformCenterX!==e&&(this._transformCenterX=e,this._markAsDirty(),this._markMatrixAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"horizontalAlignment",{get:function(){return this._horizontalAlignment},set:function(e){this._horizontalAlignment!==e&&(this._horizontalAlignment=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"verticalAlignment",{get:function(){return this._verticalAlignment},set:function(e){this._verticalAlignment!==e&&(this._verticalAlignment=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width.toString(this._host)},set:function(e){this._fixedRatioMasterIsWidth=!0,this._width.toString(this._host)!==e&&this._width.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"widthInPixels",{get:function(){return this._width.getValueInPixel(this._host,this._cachedParentMeasure.width)},set:function(e){isNaN(e)||(this._fixedRatioMasterIsWidth=!0,this.width=e+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height.toString(this._host)},set:function(e){this._fixedRatioMasterIsWidth=!1,this._height.toString(this._host)!==e&&this._height.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"heightInPixels",{get:function(){return this._height.getValueInPixel(this._host,this._cachedParentMeasure.height)},set:function(e){isNaN(e)||(this._fixedRatioMasterIsWidth=!1,this.height=e+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(e){this._fontFamily!==e&&(this._fontFamily=e,this._resetFontCache())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(e){this._fontStyle!==e&&(this._fontStyle=e,this._resetFontCache())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(e){this._fontWeight!==e&&(this._fontWeight=e,this._resetFontCache())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"style",{get:function(){return this._style},set:function(e){var t=this;this._style&&(this._style.onChangedObservable.remove(this._styleObserver),this._styleObserver=null),this._style=e,this._style&&(this._styleObserver=this._style.onChangedObservable.add(function(){t._markAsDirty(),t._resetFontCache()})),this._markAsDirty(),this._resetFontCache()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_isFontSizeInPercentage",{get:function(){return this._fontSize.isPercentage},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontSizeInPixels",{get:function(){var e=this._style?this._style._fontSize:this._fontSize;return e.isPixel?e.getValue(this._host):e.getValueInPixel(this._host,this._tempParentMeasure.height||this._cachedParentMeasure.height)},set:function(e){isNaN(e)||(this.fontSize=e+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return this._fontSize.toString(this._host)},set:function(e){this._fontSize.toString(this._host)!==e&&this._fontSize.fromString(e)&&(this._markAsDirty(),this._resetFontCache())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(e){this._color!==e&&(this._color=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"zIndex",{get:function(){return this._zIndex},set:function(e){this.zIndex!==e&&(this._zIndex=e,this.parent&&this.parent._reOrderControl(this))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"notRenderable",{get:function(){return this._doNotRender},set:function(e){this._doNotRender!==e&&(this._doNotRender=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isVisible",{get:function(){return this._isVisible},set:function(e){this._isVisible!==e&&(this._isVisible=e,this._markAsDirty(!0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDirty",{get:function(){return this._isDirty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"linkedMesh",{get:function(){return this._linkedMesh},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paddingLeft",{get:function(){return this._paddingLeft.toString(this._host)},set:function(e){this._paddingLeft.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paddingLeftInPixels",{get:function(){return this._paddingLeft.getValueInPixel(this._host,this._cachedParentMeasure.width)},set:function(e){isNaN(e)||(this.paddingLeft=e+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paddingRight",{get:function(){return this._paddingRight.toString(this._host)},set:function(e){this._paddingRight.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paddingRightInPixels",{get:function(){return this._paddingRight.getValueInPixel(this._host,this._cachedParentMeasure.width)},set:function(e){isNaN(e)||(this.paddingRight=e+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paddingTop",{get:function(){return this._paddingTop.toString(this._host)},set:function(e){this._paddingTop.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paddingTopInPixels",{get:function(){return this._paddingTop.getValueInPixel(this._host,this._cachedParentMeasure.height)},set:function(e){isNaN(e)||(this.paddingTop=e+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paddingBottom",{get:function(){return this._paddingBottom.toString(this._host)},set:function(e){this._paddingBottom.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paddingBottomInPixels",{get:function(){return this._paddingBottom.getValueInPixel(this._host,this._cachedParentMeasure.height)},set:function(e){isNaN(e)||(this.paddingBottom=e+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this._left.toString(this._host)},set:function(e){this._left.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"leftInPixels",{get:function(){return this._left.getValueInPixel(this._host,this._cachedParentMeasure.width)},set:function(e){isNaN(e)||(this.left=e+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this._top.toString(this._host)},set:function(e){this._top.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"topInPixels",{get:function(){return this._top.getValueInPixel(this._host,this._cachedParentMeasure.height)},set:function(e){isNaN(e)||(this.top=e+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"linkOffsetX",{get:function(){return this._linkOffsetX.toString(this._host)},set:function(e){this._linkOffsetX.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"linkOffsetXInPixels",{get:function(){return this._linkOffsetX.getValueInPixel(this._host,this._cachedParentMeasure.width)},set:function(e){isNaN(e)||(this.linkOffsetX=e+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"linkOffsetY",{get:function(){return this._linkOffsetY.toString(this._host)},set:function(e){this._linkOffsetY.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"linkOffsetYInPixels",{get:function(){return this._linkOffsetY.getValueInPixel(this._host,this._cachedParentMeasure.height)},set:function(e){isNaN(e)||(this.linkOffsetY=e+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"centerX",{get:function(){return this._currentMeasure.left+this._currentMeasure.width/2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"centerY",{get:function(){return this._currentMeasure.top+this._currentMeasure.height/2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isEnabled",{get:function(){return this._isEnabled},set:function(e){this._isEnabled!==e&&(this._isEnabled=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"disabledColor",{get:function(){return this._disabledColor},set:function(e){this._disabledColor!==e&&(this._disabledColor=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"disabledColorItem",{get:function(){return this._disabledColorItem},set:function(e){this._disabledColorItem!==e&&(this._disabledColorItem=e,this._markAsDirty())},enumerable:!1,configurable:!0}),e.prototype._getTypeName=function(){return"Control"},e.prototype.getAscendantOfClass=function(e){return this.parent?this.parent.getClassName()===e?this.parent:this.parent.getAscendantOfClass(e):null},e.prototype._resetFontCache=function(){this._fontSet=!0,this._markAsDirty()},e.prototype.isAscendant=function(e){return!!this.parent&&(this.parent===e||this.parent.isAscendant(e))},e.prototype.getLocalCoordinates=function(e){var t=i.Vector2.Zero();return this.getLocalCoordinatesToRef(e,t),t},e.prototype.getLocalCoordinatesToRef=function(e,t){return t.x=e.x-this._currentMeasure.left,t.y=e.y-this._currentMeasure.top,this},e.prototype.getParentLocalCoordinates=function(e){var t=i.Vector2.Zero();return t.x=e.x-this._cachedParentMeasure.left,t.y=e.y-this._cachedParentMeasure.top,t},e.prototype.moveToVector3=function(t,n){if(this._host&&this.parent===this._host._rootContainer){this.horizontalAlignment=e.HORIZONTAL_ALIGNMENT_LEFT,this.verticalAlignment=e.VERTICAL_ALIGNMENT_TOP;var r=this._host._getGlobalViewport(),o=i.Vector3.Project(t,i.Matrix.Identity(),n.getTransformMatrix(),r);this._moveToProjectedPosition(o),o.z<0||o.z>1?this.notRenderable=!0:this.notRenderable=!1}else i.Tools.Error("Cannot move a control to a vector3 if the control is not at root level")},e.prototype.getDescendantsToRef=function(e,t,n){void 0===t&&(t=!1)},e.prototype.getDescendants=function(e,t){var n=new Array;return this.getDescendantsToRef(n,e,t),n},e.prototype.linkWithMesh=function(t){if(!this._host||this.parent&&this.parent!==this._host._rootContainer)t&&i.Tools.Error("Cannot link a control to a mesh if the control is not at root level");else{var n=this._host._linkedControls.indexOf(this);if(-1!==n)return this._linkedMesh=t,void(t||this._host._linkedControls.splice(n,1));t&&(this.horizontalAlignment=e.HORIZONTAL_ALIGNMENT_LEFT,this.verticalAlignment=e.VERTICAL_ALIGNMENT_TOP,this._linkedMesh=t,this._host._linkedControls.push(this))}},e.prototype.setPadding=function(e,t,n,r){var i=e,o=null!=t?t:i,a=null!=n?n:i,s=null!=r?r:o;this.paddingTop=i,this.paddingRight=o,this.paddingBottom=a,this.paddingLeft=s},e.prototype.setPaddingInPixels=function(e,t,n,r){var i=e,o=null!=t?t:i,a=null!=n?n:i,s=null!=r?r:o;this.paddingTopInPixels=i,this.paddingRightInPixels=o,this.paddingBottomInPixels=a,this.paddingLeftInPixels=s},e.prototype._moveToProjectedPosition=function(e){var t,n=this._left.getValue(this._host),r=this._top.getValue(this._host);if(0===this._currentMeasure.width&&0===this._currentMeasure.height){var i=null===(t=this.parent)||void 0===t?void 0:t._currentMeasure;i&&this._processMeasures(i,this._host.getContext())}var o=e.x+this._linkOffsetX.getValue(this._host)-this._currentMeasure.width/2,a=e.y+this._linkOffsetY.getValue(this._host)-this._currentMeasure.height/2;this._left.ignoreAdaptiveScaling&&this._top.ignoreAdaptiveScaling&&(Math.abs(o-n)<.5&&(o=n),Math.abs(a-r)<.5&&(a=r)),this.left=o+"px",this.top=a+"px",this._left.ignoreAdaptiveScaling=!0,this._top.ignoreAdaptiveScaling=!0,this._markAsDirty()},e.prototype._offsetLeft=function(e){this._isDirty=!0,this._currentMeasure.left+=e},e.prototype._offsetTop=function(e){this._isDirty=!0,this._currentMeasure.top+=e},e.prototype._markMatrixAsDirty=function(){this._isMatrixDirty=!0,this._flagDescendantsAsMatrixDirty()},e.prototype._flagDescendantsAsMatrixDirty=function(){},e.prototype._intersectsRect=function(e){return this._currentMeasure.transformToRef(this._transformMatrix,this._tmpMeasureA),!(this._tmpMeasureA.left>=e.left+e.width)&&(!(this._tmpMeasureA.top>=e.top+e.height)&&(!(this._tmpMeasureA.left+this._tmpMeasureA.width<=e.left)&&!(this._tmpMeasureA.top+this._tmpMeasureA.height<=e.top)))},e.prototype._computeAdditionnalOffsetX=function(){return 0},e.prototype._computeAdditionnalOffsetY=function(){return 0},e.prototype.invalidateRect=function(){if(this._transform(),this.host&&this.host.useInvalidateRectOptimization){this._currentMeasure.transformToRef(this._transformMatrix,this._tmpMeasureA),a.Measure.CombineToRef(this._tmpMeasureA,this._prevCurrentMeasureTransformedIntoGlobalSpace,this._tmpMeasureA);var e=this.shadowOffsetX,t=this.shadowOffsetY,n=Math.max(this._previousShadowBlur,this.shadowBlur),r=Math.min(Math.min(e,0)-2*n,0),i=Math.max(Math.max(e,0)+2*n,0),o=Math.min(Math.min(t,0)-2*n,0),s=Math.max(Math.max(t,0)+2*n,0),l=this._computeAdditionnalOffsetX(),c=this._computeAdditionnalOffsetY();this.host.invalidateRect(Math.floor(this._tmpMeasureA.left+r-l),Math.floor(this._tmpMeasureA.top+o-c),Math.ceil(this._tmpMeasureA.left+this._tmpMeasureA.width+i+l),Math.ceil(this._tmpMeasureA.top+this._tmpMeasureA.height+s+c))}},e.prototype._markAsDirty=function(e){void 0===e&&(e=!1),(this._isVisible||e)&&(this._isDirty=!0,this._host&&this._host.markAsDirty())},e.prototype._markAllAsDirty=function(){this._markAsDirty(),this._font&&this._prepareFont()},e.prototype._link=function(e){this._host=e,this._host&&(this.uniqueId=this._host.getScene().getUniqueId())},e.prototype._transform=function(e){if(this._isMatrixDirty||1!==this._scaleX||1!==this._scaleY||0!==this._rotation){var t=this._currentMeasure.width*this._transformCenterX+this._currentMeasure.left,n=this._currentMeasure.height*this._transformCenterY+this._currentMeasure.top;e&&(e.translate(t,n),e.rotate(this._rotation),e.scale(this._scaleX,this._scaleY),e.translate(-t,-n)),(this._isMatrixDirty||this._cachedOffsetX!==t||this._cachedOffsetY!==n)&&(this._cachedOffsetX=t,this._cachedOffsetY=n,this._isMatrixDirty=!1,this._flagDescendantsAsMatrixDirty(),s.Matrix2D.ComposeToRef(-t,-n,this._rotation,this._scaleX,this._scaleY,this.parent?this.parent._transformMatrix:null,this._transformMatrix),this._transformMatrix.invertToRef(this._invertTransformMatrix))}},e.prototype._renderHighlight=function(e){this.isHighlighted&&(e.save(),e.strokeStyle=this._highlightColor,e.lineWidth=this._highlightLineWidth,this._renderHighlightSpecific(e),e.restore())},e.prototype._renderHighlightSpecific=function(e){e.strokeRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height)},e.prototype._applyStates=function(t){this._isFontSizeInPercentage&&(this._fontSet=!0),this._fontSet&&(this._prepareFont(),this._fontSet=!1),this._font&&(t.font=this._font),this._color&&(t.fillStyle=this._color),e.AllowAlphaInheritance?t.globalAlpha*=this._alpha:this._alphaSet&&(t.globalAlpha=this.parent&&!this.parent.renderToIntermediateTexture?this.parent.alpha*this._alpha:this._alpha)},e.prototype._layout=function(e,t){if(!this.isDirty&&(!this.isVisible||this.notRenderable))return!1;if(this._isDirty||!this._cachedParentMeasure.isEqualsTo(e)){this.host._numLayoutCalls++,this._currentMeasure.addAndTransformToRef(this._transformMatrix,0|-this.paddingLeftInPixels,0|-this.paddingTopInPixels,0|this.paddingRightInPixels,0|this.paddingBottomInPixels,this._prevCurrentMeasureTransformedIntoGlobalSpace),t.save(),this._applyStates(t);var n=0;do{this._rebuildLayout=!1,this._processMeasures(e,t),n++}while(this._rebuildLayout&&n<3);n>=3&&i.Logger.Error("Layout cycle detected in GUI (Control name="+this.name+", uniqueId="+this.uniqueId+")"),t.restore(),this.invalidateRect(),this._evaluateClippingState(e)}return this._wasDirty=this._isDirty,this._isDirty=!1,!0},e.prototype._processMeasures=function(e,t){this._currentMeasure.copyFrom(e),this._preMeasure(e,t),this._measure(),this._computeAlignment(e,t),this._currentMeasure.left=0|this._currentMeasure.left,this._currentMeasure.top=0|this._currentMeasure.top,this._currentMeasure.width=0|this._currentMeasure.width,this._currentMeasure.height=0|this._currentMeasure.height,this._additionalProcessing(e,t),this._cachedParentMeasure.copyFrom(e),this.onDirtyObservable.hasObservers()&&this.onDirtyObservable.notifyObservers(this)},e.prototype._evaluateClippingState=function(e){if(this.parent&&this.parent.clipChildren){if(this._currentMeasure.left>e.left+e.width)return void(this._isClipped=!0);if(this._currentMeasure.left+this._currentMeasure.width<e.left)return void(this._isClipped=!0);if(this._currentMeasure.top>e.top+e.height)return void(this._isClipped=!0);if(this._currentMeasure.top+this._currentMeasure.height<e.top)return void(this._isClipped=!0)}this._isClipped=!1},e.prototype._measure=function(){this._width.isPixel?this._currentMeasure.width=this._width.getValue(this._host):this._currentMeasure.width*=this._width.getValue(this._host),this._height.isPixel?this._currentMeasure.height=this._height.getValue(this._host):this._currentMeasure.height*=this._height.getValue(this._host),0!==this.fixedRatio&&(this._fixedRatioMasterIsWidth?this._currentMeasure.height=this._currentMeasure.width*this.fixedRatio:this._currentMeasure.width=this._currentMeasure.height*this.fixedRatio)},e.prototype._computeAlignment=function(t,n){var r=this._currentMeasure.width,i=this._currentMeasure.height,o=t.width,a=t.height,s=0,l=0;switch(this.horizontalAlignment){case e.HORIZONTAL_ALIGNMENT_LEFT:s=0;break;case e.HORIZONTAL_ALIGNMENT_RIGHT:s=o-r;break;case e.HORIZONTAL_ALIGNMENT_CENTER:s=(o-r)/2}switch(this.verticalAlignment){case e.VERTICAL_ALIGNMENT_TOP:l=0;break;case e.VERTICAL_ALIGNMENT_BOTTOM:l=a-i;break;case e.VERTICAL_ALIGNMENT_CENTER:l=(a-i)/2}this._paddingLeft.isPixel?(this._currentMeasure.left+=this._paddingLeft.getValue(this._host),this._currentMeasure.width-=this._paddingLeft.getValue(this._host)):(this._currentMeasure.left+=o*this._paddingLeft.getValue(this._host),this._currentMeasure.width-=o*this._paddingLeft.getValue(this._host)),this._paddingRight.isPixel?this._currentMeasure.width-=this._paddingRight.getValue(this._host):this._currentMeasure.width-=o*this._paddingRight.getValue(this._host),this._paddingTop.isPixel?(this._currentMeasure.top+=this._paddingTop.getValue(this._host),this._currentMeasure.height-=this._paddingTop.getValue(this._host)):(this._currentMeasure.top+=a*this._paddingTop.getValue(this._host),this._currentMeasure.height-=a*this._paddingTop.getValue(this._host)),this._paddingBottom.isPixel?this._currentMeasure.height-=this._paddingBottom.getValue(this._host):this._currentMeasure.height-=a*this._paddingBottom.getValue(this._host),this._left.isPixel?this._currentMeasure.left+=this._left.getValue(this._host):this._currentMeasure.left+=o*this._left.getValue(this._host),this._top.isPixel?this._currentMeasure.top+=this._top.getValue(this._host):this._currentMeasure.top+=a*this._top.getValue(this._host),this._currentMeasure.left+=s,this._currentMeasure.top+=l},e.prototype._preMeasure=function(e,t){},e.prototype._additionalProcessing=function(e,t){},e.prototype._clipForChildren=function(e){},e.prototype._clip=function(t,n){if(t.beginPath(),e._ClipMeasure.copyFrom(this._currentMeasure),n){n.transformToRef(this._invertTransformMatrix,this._tmpMeasureA);var r=new a.Measure(0,0,0,0);r.left=Math.max(this._tmpMeasureA.left,this._currentMeasure.left),r.top=Math.max(this._tmpMeasureA.top,this._currentMeasure.top),r.width=Math.min(this._tmpMeasureA.left+this._tmpMeasureA.width,this._currentMeasure.left+this._currentMeasure.width)-r.left,r.height=Math.min(this._tmpMeasureA.top+this._tmpMeasureA.height,this._currentMeasure.top+this._currentMeasure.height)-r.top,e._ClipMeasure.copyFrom(r)}if(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY){var i=this.shadowOffsetX,o=this.shadowOffsetY,s=this.shadowBlur,l=Math.min(Math.min(i,0)-2*s,0),c=Math.max(Math.max(i,0)+2*s,0),u=Math.min(Math.min(o,0)-2*s,0),_=Math.max(Math.max(o,0)+2*s,0);t.rect(e._ClipMeasure.left+l,e._ClipMeasure.top+u,e._ClipMeasure.width+c-l,e._ClipMeasure.height+_-u)}else t.rect(e._ClipMeasure.left,e._ClipMeasure.top,e._ClipMeasure.width,e._ClipMeasure.height);t.clip()},e.prototype._render=function(e,t){return!this.isVisible||this.notRenderable||this._isClipped?(this._isDirty=!1,!1):(this.host._numRenderCalls++,e.save(),this._applyStates(e),this._transform(e),this.clipContent&&this._clip(e,t),this.onBeforeDrawObservable.hasObservers()&&this.onBeforeDrawObservable.notifyObservers(this),this.useBitmapCache&&!this._wasDirty&&this._cacheData?e.putImageData(this._cacheData,this._currentMeasure.left,this._currentMeasure.top):this._draw(e,t),this.useBitmapCache&&this._wasDirty&&(this._cacheData=e.getImageData(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height)),this._renderHighlight(e),this.onAfterDrawObservable.hasObservers()&&this.onAfterDrawObservable.notifyObservers(this),e.restore(),!0)},e.prototype._draw=function(e,t){},e.prototype.contains=function(e,t){return this._invertTransformMatrix.transformCoordinates(e,t,this._transformedPosition),e=this._transformedPosition.x,t=this._transformedPosition.y,!(e<this._currentMeasure.left)&&(!(e>this._currentMeasure.left+this._currentMeasure.width)&&(!(t<this._currentMeasure.top)&&(!(t>this._currentMeasure.top+this._currentMeasure.height)&&(this.isPointerBlocker&&(this._host._shouldBlockPointer=!0),!0))))},e.prototype._processPicking=function(e,t,n,r,i,o,a,s){return!!this._isEnabled&&(!(!this.isHitTestVisible||!this.isVisible||this._doNotRender)&&(!!this.contains(e,t)&&(this._processObservables(r,e,t,n,i,o,a,s),!0)))},e.prototype._onPointerMove=function(e,t,n,r){this.onPointerMoveObservable.notifyObservers(t,-1,e,this,r)&&null!=this.parent&&this.parent._onPointerMove(e,t,n,r)},e.prototype._onPointerEnter=function(e,t){return!!this._isEnabled&&(!(this._enterCount>0)&&(-1===this._enterCount&&(this._enterCount=0),this._enterCount++,this.onPointerEnterObservable.notifyObservers(this,-1,e,this,t)&&null!=this.parent&&this.parent._onPointerEnter(e,t),!0))},e.prototype._onPointerOut=function(e,t,n){if(void 0===n&&(n=!1),n||this._isEnabled&&e!==this){this._enterCount=0;var r=!0;e.isAscendant(this)||(r=this.onPointerOutObservable.notifyObservers(this,-1,e,this,t)),r&&null!=this.parent&&this.parent._onPointerOut(e,t,n)}},e.prototype._onPointerDown=function(e,t,n,r,i){return this._onPointerEnter(this,i),0===this._downCount&&(this._downCount++,this._downPointerIds[n]=!0,this.onPointerDownObservable.notifyObservers(new s.Vector2WithInfo(t,r),-1,e,this,i)&&null!=this.parent&&this.parent._onPointerDown(e,t,n,r,i),!0)},e.prototype._onPointerUp=function(e,t,n,r,i,o){if(this._isEnabled){this._downCount=0,delete this._downPointerIds[n];var a=i;i&&(this._enterCount>0||-1===this._enterCount)&&(a=this.onPointerClickObservable.notifyObservers(new s.Vector2WithInfo(t,r),-1,e,this,o)),this.onPointerUpObservable.notifyObservers(new s.Vector2WithInfo(t,r),-1,e,this,o)&&null!=this.parent&&this.parent._onPointerUp(e,t,n,r,a,o)}},e.prototype._forcePointerUp=function(e){if(void 0===e&&(e=null),null!==e)this._onPointerUp(this,i.Vector2.Zero(),e,0,!0);else for(var t in this._downPointerIds)this._onPointerUp(this,i.Vector2.Zero(),+t,0,!0)},e.prototype._onWheelScroll=function(e,t){this._isEnabled&&(this.onWheelObservable.notifyObservers(new i.Vector2(e,t))&&null!=this.parent&&this.parent._onWheelScroll(e,t))},e.prototype._onCanvasBlur=function(){},e.prototype._processObservables=function(e,t,n,r,o,a,s,l){if(!this._isEnabled)return!1;if(this._dummyVector2.copyFromFloats(t,n),e===i.PointerEventTypes.POINTERMOVE){this._onPointerMove(this,this._dummyVector2,o,r);var c=this._host._lastControlOver[o];return c&&c!==this&&c._onPointerOut(this,r),c!==this&&this._onPointerEnter(this,r),this._host._lastControlOver[o]=this,!0}return e===i.PointerEventTypes.POINTERDOWN?(this._onPointerDown(this,this._dummyVector2,o,a,r),this._host._registerLastControlDown(this,o),this._host._lastPickedControl=this,!0):e===i.PointerEventTypes.POINTERUP?(this._host._lastControlDown[o]&&this._host._lastControlDown[o]._onPointerUp(this,this._dummyVector2,o,a,!0,r),delete this._host._lastControlDown[o],!0):!(e!==i.PointerEventTypes.POINTERWHEEL||!this._host._lastControlOver[o])&&(this._host._lastControlOver[o]._onWheelScroll(s,l),!0)},e.prototype._prepareFont=function(){(this._font||this._fontSet)&&(this._style?this._font=this._style.fontStyle+" "+this._style.fontWeight+" "+this.fontSizeInPixels+"px "+this._style.fontFamily:this._font=this._fontStyle+" "+this._fontWeight+" "+this.fontSizeInPixels+"px "+this._fontFamily,this._fontOffset=e._GetFontOffset(this._font))},e.prototype.serialize=function(e){i.SerializationHelper.Serialize(this,e),e.name=this.name,e.className=this.getClassName(),this._font&&(e.fontFamily=this._fontFamily,e.fontSize=this.fontSize,e.fontWeight=this.fontWeight,e.fontStyle=this.fontStyle)},e.prototype._parseFromContent=function(e,t){e.fontFamily&&(this.fontFamily=e.fontFamily),e.fontSize&&(this.fontSize=e.fontSize),e.fontWeight&&(this.fontWeight=e.fontWeight),e.fontStyle&&(this.fontStyle=e.fontStyle)},e.prototype.dispose=function(){(this.onDirtyObservable.clear(),this.onBeforeDrawObservable.clear(),this.onAfterDrawObservable.clear(),this.onPointerDownObservable.clear(),this.onPointerEnterObservable.clear(),this.onPointerMoveObservable.clear(),this.onPointerOutObservable.clear(),this.onPointerUpObservable.clear(),this.onPointerClickObservable.clear(),this.onWheelObservable.clear(),this._styleObserver&&this._style&&(this._style.onChangedObservable.remove(this._styleObserver),this._styleObserver=null),this.parent&&(this.parent.removeControl(this),this.parent=null),this._host)&&(this._host._linkedControls.indexOf(this)>-1&&this.linkWithMesh(null));this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear()},Object.defineProperty(e,"HORIZONTAL_ALIGNMENT_LEFT",{get:function(){return e._HORIZONTAL_ALIGNMENT_LEFT},enumerable:!1,configurable:!0}),Object.defineProperty(e,"HORIZONTAL_ALIGNMENT_RIGHT",{get:function(){return e._HORIZONTAL_ALIGNMENT_RIGHT},enumerable:!1,configurable:!0}),Object.defineProperty(e,"HORIZONTAL_ALIGNMENT_CENTER",{get:function(){return e._HORIZONTAL_ALIGNMENT_CENTER},enumerable:!1,configurable:!0}),Object.defineProperty(e,"VERTICAL_ALIGNMENT_TOP",{get:function(){return e._VERTICAL_ALIGNMENT_TOP},enumerable:!1,configurable:!0}),Object.defineProperty(e,"VERTICAL_ALIGNMENT_BOTTOM",{get:function(){return e._VERTICAL_ALIGNMENT_BOTTOM},enumerable:!1,configurable:!0}),Object.defineProperty(e,"VERTICAL_ALIGNMENT_CENTER",{get:function(){return e._VERTICAL_ALIGNMENT_CENTER},enumerable:!1,configurable:!0}),e._GetFontOffset=function(t){if(e._FontHeightSizes[t])return e._FontHeightSizes[t];var n=i.Engine.LastCreatedEngine;if(!n)throw new Error("Invalid engine. Unable to create a canvas.");var r=n.getFontOffset(t);return e._FontHeightSizes[t]=r,r},e.Parse=function(e,t){var n=i.Tools.Instantiate("BABYLON.GUI."+e.className),r=i.SerializationHelper.Parse(function(){return new n},e,null);return r.name=e.name,r._parseFromContent(e,t),r},e.drawEllipse=function(e,t,n,r,i){i.translate(e,t),i.scale(n,r),i.beginPath(),i.arc(0,0,1,0,2*Math.PI),i.closePath(),i.scale(1/n,1/r),i.translate(-e,-t)},e.AllowAlphaInheritance=!1,e._ClipMeasure=new a.Measure(0,0,0,0),e._HORIZONTAL_ALIGNMENT_LEFT=0,e._HORIZONTAL_ALIGNMENT_RIGHT=1,e._HORIZONTAL_ALIGNMENT_CENTER=2,e._VERTICAL_ALIGNMENT_TOP=0,e._VERTICAL_ALIGNMENT_BOTTOM=1,e._VERTICAL_ALIGNMENT_CENTER=2,e._FontHeightSizes={},e.AddHeader=function(){},Object(r.__decorate)([Object(i.serialize)()],e.prototype,"metadata",void 0),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"isHitTestVisible",void 0),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"isPointerBlocker",void 0),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"isFocusInvisible",void 0),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"clipChildren",void 0),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"clipContent",void 0),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"useBitmapCache",void 0),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"shadowOffsetX",null),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"shadowOffsetY",null),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"shadowBlur",null),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"shadowColor",null),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"hoverCursor",void 0),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"fontOffset",null),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"alpha",null),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"scaleX",null),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"scaleY",null),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"rotation",null),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"transformCenterY",null),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"transformCenterX",null),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"horizontalAlignment",null),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"verticalAlignment",null),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"fixedRatio",void 0),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"width",null),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"height",null),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"style",null),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"color",null),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"zIndex",null),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"notRenderable",null),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"isVisible",null),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"paddingLeft",null),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"paddingRight",null),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"paddingTop",null),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"paddingBottom",null),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"left",null),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"top",null),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"linkOffsetX",null),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"linkOffsetY",null),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"isEnabled",null),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"disabledColor",null),Object(r.__decorate)([Object(i.serialize)()],e.prototype,"disabledColorItem",null),e}();Object(i.RegisterClass)("BABYLON.GUI.Control",l)},"./2D/controls/displayGrid.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"DisplayGrid",function(){return a});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("./2D/controls/control.ts"),o=n("babylonjs/Misc/perfCounter"),a=function(e){function t(t){var n=e.call(this,t)||this;return n.name=t,n._cellWidth=20,n._cellHeight=20,n._minorLineTickness=1,n._minorLineColor="DarkGray",n._majorLineTickness=2,n._majorLineColor="White",n._majorLineFrequency=5,n._background="Black",n._displayMajorLines=!0,n._displayMinorLines=!0,n}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"displayMinorLines",{get:function(){return this._displayMinorLines},set:function(e){this._displayMinorLines!==e&&(this._displayMinorLines=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"displayMajorLines",{get:function(){return this._displayMajorLines},set:function(e){this._displayMajorLines!==e&&(this._displayMajorLines=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this._background},set:function(e){this._background!==e&&(this._background=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cellWidth",{get:function(){return this._cellWidth},set:function(e){this._cellWidth=e,this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cellHeight",{get:function(){return this._cellHeight},set:function(e){this._cellHeight=e,this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minorLineTickness",{get:function(){return this._minorLineTickness},set:function(e){this._minorLineTickness=e,this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minorLineColor",{get:function(){return this._minorLineColor},set:function(e){this._minorLineColor=e,this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"majorLineTickness",{get:function(){return this._majorLineTickness},set:function(e){this._majorLineTickness=e,this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"majorLineColor",{get:function(){return this._majorLineColor},set:function(e){this._majorLineColor=e,this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"majorLineFrequency",{get:function(){return this._majorLineFrequency},set:function(e){this._majorLineFrequency=e,this._markAsDirty()},enumerable:!1,configurable:!0}),t.prototype._draw=function(e,t){if(e.save(),this._applyStates(e),this._isEnabled){this._background&&(e.fillStyle=this._background,e.fillRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height));var n=this._currentMeasure.width/this._cellWidth,r=this._currentMeasure.height/this._cellHeight,i=this._currentMeasure.left+this._currentMeasure.width/2,o=this._currentMeasure.top+this._currentMeasure.height/2;if(this._displayMinorLines){e.strokeStyle=this._minorLineColor,e.lineWidth=this._minorLineTickness;for(var a=-n/2+1;a<n/2;a++){var s=i+a*this.cellWidth;e.beginPath(),e.moveTo(s,this._currentMeasure.top),e.lineTo(s,this._currentMeasure.top+this._currentMeasure.height),e.stroke()}for(var l=-r/2+1;l<r/2;l++){var c=o+l*this.cellHeight;e.beginPath(),e.moveTo(this._currentMeasure.left,c),e.lineTo(this._currentMeasure.left+this._currentMeasure.width,c),e.stroke()}}if(this._displayMajorLines){e.strokeStyle=this._majorLineColor,e.lineWidth=this._majorLineTickness;for(a=-n/2+this._majorLineFrequency;a<n/2;a+=this._majorLineFrequency){s=i+a*this.cellWidth;e.beginPath(),e.moveTo(s,this._currentMeasure.top),e.lineTo(s,this._currentMeasure.top+this._currentMeasure.height),e.stroke()}for(l=-r/2+this._majorLineFrequency;l<r/2;l+=this._majorLineFrequency){c=o+l*this.cellHeight;e.moveTo(this._currentMeasure.left,c),e.lineTo(this._currentMeasure.left+this._currentMeasure.width,c),e.closePath(),e.stroke()}}}e.restore()},t.prototype._getTypeName=function(){return"DisplayGrid"},Object(r.__decorate)([Object(o.serialize)()],t.prototype,"displayMinorLines",null),Object(r.__decorate)([Object(o.serialize)()],t.prototype,"displayMajorLines",null),Object(r.__decorate)([Object(o.serialize)()],t.prototype,"background",null),Object(r.__decorate)([Object(o.serialize)()],t.prototype,"cellWidth",null),Object(r.__decorate)([Object(o.serialize)()],t.prototype,"cellHeight",null),Object(r.__decorate)([Object(o.serialize)()],t.prototype,"minorLineTickness",null),Object(r.__decorate)([Object(o.serialize)()],t.prototype,"minorLineColor",null),Object(r.__decorate)([Object(o.serialize)()],t.prototype,"majorLineTickness",null),Object(r.__decorate)([Object(o.serialize)()],t.prototype,"majorLineColor",null),Object(r.__decorate)([Object(o.serialize)()],t.prototype,"majorLineFrequency",null),t}(i.Control);Object(o.RegisterClass)("BABYLON.GUI.DisplayGrid",a)},"./2D/controls/ellipse.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"Ellipse",function(){return s});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("./2D/controls/container.ts"),o=n("./2D/controls/control.ts"),a=n("babylonjs/Misc/perfCounter"),s=function(e){function t(t){var n=e.call(this,t)||this;return n.name=t,n._thickness=1,n}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"thickness",{get:function(){return this._thickness},set:function(e){this._thickness!==e&&(this._thickness=e,this._markAsDirty())},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"Ellipse"},t.prototype._localDraw=function(e){e.save(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY),o.Control.drawEllipse(this._currentMeasure.left+this._currentMeasure.width/2,this._currentMeasure.top+this._currentMeasure.height/2,this._currentMeasure.width/2-this._thickness/2,this._currentMeasure.height/2-this._thickness/2,e),this._background&&(e.fillStyle=this._background,e.fill()),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),this._thickness&&(this.color&&(e.strokeStyle=this.color),e.lineWidth=this._thickness,e.stroke()),e.restore()},t.prototype._additionalProcessing=function(t,n){e.prototype._additionalProcessing.call(this,t,n),this._measureForChildren.width-=2*this._thickness,this._measureForChildren.height-=2*this._thickness,this._measureForChildren.left+=this._thickness,this._measureForChildren.top+=this._thickness},t.prototype._clipForChildren=function(e){o.Control.drawEllipse(this._currentMeasure.left+this._currentMeasure.width/2,this._currentMeasure.top+this._currentMeasure.height/2,this._currentMeasure.width/2,this._currentMeasure.height/2,e),e.clip()},t.prototype._renderHighlightSpecific=function(e){o.Control.drawEllipse(this._currentMeasure.left+this._currentMeasure.width/2,this._currentMeasure.top+this._currentMeasure.height/2,this._currentMeasure.width/2-this._highlightLineWidth/2,this._currentMeasure.height/2-this._highlightLineWidth/2,e),e.stroke()},Object(r.__decorate)([Object(a.serialize)()],t.prototype,"thickness",null),t}(i.Container);Object(a.RegisterClass)("BABYLON.GUI.Ellipse",s)},"./2D/controls/focusableButton.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"FocusableButton",function(){return a});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("./2D/controls/button.ts"),o=n("babylonjs/Misc/perfCounter"),a=function(e){function t(t){var n=e.call(this,t)||this;return n.name=t,n.focusedColor=null,n._isFocused=!1,n._unfocusedColor=null,n.onFocusObservable=new o.Observable,n.onBlurObservable=new o.Observable,n.onKeyboardEventProcessedObservable=new o.Observable,n._unfocusedColor=n.color,n}return Object(r.__extends)(t,e),t.prototype.onBlur=function(){this._isFocused&&(this._isFocused=!1,this.focusedColor&&null!=this._unfocusedColor&&(this.color=this._unfocusedColor),this.onBlurObservable.notifyObservers(this))},t.prototype.onFocus=function(){this._isFocused=!0,this.focusedColor&&(this._unfocusedColor=this.color,this.color=this.focusedColor),this.onFocusObservable.notifyObservers(this)},t.prototype.keepsFocusWith=function(){return null},t.prototype.focus=function(){this._host.moveFocusToControl(this)},t.prototype.blur=function(){this._host.focusedControl=null},t.prototype.processKeyboard=function(e){this.onKeyboardEventProcessedObservable.notifyObservers(e,-1,this)},t.prototype._onPointerDown=function(t,n,r,i,o){return this.isReadOnly||this.focus(),e.prototype._onPointerDown.call(this,t,n,r,i,o)},t.prototype.displose=function(){e.prototype.dispose.call(this),this.onBlurObservable.clear(),this.onFocusObservable.clear(),this.onKeyboardEventProcessedObservable.clear()},t}(i.Button);Object(o.RegisterClass)("BABYLON.GUI.FocusableButton",a)},"./2D/controls/grid.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"Grid",function(){return l});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("./2D/controls/container.ts"),o=n("./2D/valueAndUnit.ts"),a=n("./2D/controls/control.ts"),s=n("babylonjs/Misc/perfCounter"),l=function(e){function t(t){var n=e.call(this,t)||this;return n.name=t,n._rowDefinitions=new Array,n._columnDefinitions=new Array,n._cells={},n._childControls=new Array,n}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"columnCount",{get:function(){return this._columnDefinitions.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rowCount",{get:function(){return this._rowDefinitions.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"children",{get:function(){return this._childControls},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cells",{get:function(){return this._cells},enumerable:!1,configurable:!0}),t.prototype.getRowDefinition=function(e){return e<0||e>=this._rowDefinitions.length?null:this._rowDefinitions[e]},t.prototype.getColumnDefinition=function(e){return e<0||e>=this._columnDefinitions.length?null:this._columnDefinitions[e]},t.prototype.addRowDefinition=function(e,t){return void 0===t&&(t=!1),this._rowDefinitions.push(new o.ValueAndUnit(e,t?o.ValueAndUnit.UNITMODE_PIXEL:o.ValueAndUnit.UNITMODE_PERCENTAGE)),this._markAsDirty(),this},t.prototype.addColumnDefinition=function(e,t){return void 0===t&&(t=!1),this._columnDefinitions.push(new o.ValueAndUnit(e,t?o.ValueAndUnit.UNITMODE_PIXEL:o.ValueAndUnit.UNITMODE_PERCENTAGE)),this._markAsDirty(),this},t.prototype.setRowDefinition=function(e,t,n){if(void 0===n&&(n=!1),e<0||e>=this._rowDefinitions.length)return this;var r=this._rowDefinitions[e];return r&&r.isPixel===n&&r.internalValue===t?this:(this._rowDefinitions[e]=new o.ValueAndUnit(t,n?o.ValueAndUnit.UNITMODE_PIXEL:o.ValueAndUnit.UNITMODE_PERCENTAGE),this._markAsDirty(),this)},t.prototype.setColumnDefinition=function(e,t,n){if(void 0===n&&(n=!1),e<0||e>=this._columnDefinitions.length)return this;var r=this._columnDefinitions[e];return r&&r.isPixel===n&&r.internalValue===t?this:(this._columnDefinitions[e]=new o.ValueAndUnit(t,n?o.ValueAndUnit.UNITMODE_PIXEL:o.ValueAndUnit.UNITMODE_PERCENTAGE),this._markAsDirty(),this)},t.prototype.getChildrenAt=function(e,t){var n=this._cells[e+":"+t];return n?n.children:null},t.prototype.getChildCellInfo=function(e){return e._tag},t.prototype._removeCell=function(t,n){if(t){e.prototype.removeControl.call(this,t);for(var r=0,i=t.children;r<i.length;r++){var o=i[r],a=this._childControls.indexOf(o);-1!==a&&this._childControls.splice(a,1)}delete this._cells[n]}},t.prototype._offsetCell=function(e,t){if(this._cells[t]){this._cells[e]=this._cells[t];for(var n=0,r=this._cells[e].children;n<r.length;n++){r[n]._tag=e}delete this._cells[t]}},t.prototype.removeColumnDefinition=function(e){if(e<0||e>=this._columnDefinitions.length)return this;for(var t=0;t<this._rowDefinitions.length;t++){var n=t+":"+e,r=this._cells[n];this._removeCell(r,n)}for(t=0;t<this._rowDefinitions.length;t++)for(var i=e+1;i<this._columnDefinitions.length;i++){var o=t+":"+(i-1);n=t+":"+i;this._offsetCell(o,n)}return this._columnDefinitions.splice(e,1),this._markAsDirty(),this},t.prototype.removeRowDefinition=function(e){if(e<0||e>=this._rowDefinitions.length)return this;for(var t=0;t<this._columnDefinitions.length;t++){var n=e+":"+t,r=this._cells[n];this._removeCell(r,n)}for(t=0;t<this._columnDefinitions.length;t++)for(var i=e+1;i<this._rowDefinitions.length;i++){var o=i-1+":"+t;n=i+":"+t;this._offsetCell(o,n)}return this._rowDefinitions.splice(e,1),this._markAsDirty(),this},t.prototype.addControl=function(t,n,r){if(void 0===n&&(n=0),void 0===r&&(r=0),0===this._rowDefinitions.length&&this.addRowDefinition(1,!1),0===this._columnDefinitions.length&&this.addColumnDefinition(1,!1),-1!==this._childControls.indexOf(t))return s.Tools.Warn("Control (Name:"+t.name+", UniqueId:"+t.uniqueId+") is already associated with this grid. You must remove it before reattaching it"),this;var o=Math.min(n,this._rowDefinitions.length-1)+":"+Math.min(r,this._columnDefinitions.length-1),l=this._cells[o];return l||(l=new i.Container(o),this._cells[o]=l,l.horizontalAlignment=a.Control.HORIZONTAL_ALIGNMENT_LEFT,l.verticalAlignment=a.Control.VERTICAL_ALIGNMENT_TOP,e.prototype.addControl.call(this,l)),l.addControl(t),this._childControls.push(t),t._tag=o,t.parent=this,this._markAsDirty(),this},t.prototype.removeControl=function(e){var t=this._childControls.indexOf(e);-1!==t&&this._childControls.splice(t,1);var n=this._cells[e._tag];return n&&(n.removeControl(e),e._tag=null),this._markAsDirty(),this},t.prototype._getTypeName=function(){return"Grid"},t.prototype._getGridDefinitions=function(e){for(var t=[],n=[],r=[],i=[],o=this._currentMeasure.width,a=0,s=this._currentMeasure.height,l=0,c=0,u=0,_=this._rowDefinitions;u<_.length;u++){if((m=_[u]).isPixel)s-=p=m.getValue(this._host),n[c]=p;else l+=m.internalValue;c++}var h=0;c=0;for(var f=0,d=this._rowDefinitions;f<d.length;f++){var p,m=d[f];if(i.push(h),m.isPixel)h+=m.getValue(this._host);else h+=p=m.internalValue/l*s,n[c]=p;c++}c=0;for(var g=0,v=this._columnDefinitions;g<v.length;g++){if((m=v[g]).isPixel)o-=T=m.getValue(this._host),t[c]=T;else a+=m.internalValue;c++}var b=0;c=0;for(var y=0,x=this._columnDefinitions;y<x.length;y++){var T;m=x[y];if(r.push(b),m.isPixel)b+=m.getValue(this._host);else b+=T=m.internalValue/a*o,t[c]=T;c++}e(r,i,t,n)},t.prototype._additionalProcessing=function(t,n){var r=this;this._getGridDefinitions(function(e,t,n,i){for(var o in r._cells)if(r._cells.hasOwnProperty(o)){var a=o.split(":"),s=parseInt(a[0]),l=parseInt(a[1]),c=r._cells[o];c.left=e[l]+"px",c.top=t[s]+"px",c.width=n[l]+"px",c.height=i[s]+"px",c._left.ignoreAdaptiveScaling=!0,c._top.ignoreAdaptiveScaling=!0,c._width.ignoreAdaptiveScaling=!0,c._height.ignoreAdaptiveScaling=!0}}),e.prototype._additionalProcessing.call(this,t,n)},t.prototype._flagDescendantsAsMatrixDirty=function(){for(var e in this._cells){if(this._cells.hasOwnProperty(e))this._cells[e]._markMatrixAsDirty()}},t.prototype._renderHighlightSpecific=function(t){var n=this;e.prototype._renderHighlightSpecific.call(this,t),this._getGridDefinitions(function(e,r,i,o){for(var a=0;a<e.length;a++){var s=n._currentMeasure.left+e[a]+i[a];t.beginPath(),t.moveTo(s,n._currentMeasure.top),t.lineTo(s,n._currentMeasure.top+n._currentMeasure.height),t.stroke()}for(a=0;a<r.length;a++){var l=n._currentMeasure.top+r[a]+o[a];t.beginPath(),t.moveTo(n._currentMeasure.left,l),t.lineTo(n._currentMeasure.left+n._currentMeasure.width,l),t.stroke()}}),t.restore()},t.prototype.dispose=function(){e.prototype.dispose.call(this);for(var t=0,n=this._childControls;t<n.length;t++){n[t].dispose()}this._childControls=[]},t.prototype.serialize=function(t){e.prototype.serialize.call(this,t),t.columnCount=this.columnCount,t.rowCount=this.rowCount,t.columns=[],t.rows=[],t.tags=[];for(var n=0;n<this.columnCount;++n){var r=this.getColumnDefinition(n),i={value:null==r?void 0:r.getValue(this.host),unit:null==r?void 0:r.unit};t.columns.push(i)}for(n=0;n<this.rowCount;++n){var o=this.getRowDefinition(n);i={value:null==o?void 0:o.getValue(this.host),unit:null==o?void 0:o.unit};t.rows.push(i)}this.children.forEach(function(e){t.tags.push(e._tag)})},t.prototype._parseFromContent=function(t,n){e.prototype._parseFromContent.call(this,t,n);var r=[];this.children.forEach(function(e){r.push(e)}),this.removeRowDefinition(0),this.removeColumnDefinition(0);for(var i=0;i<t.columnCount;++i){var o=t.columns[i].value,a=t.columns[i].unit;this.addColumnDefinition(o,1===a)}for(i=0;i<t.rowCount;++i){var s=t.rows[i].value;a=t.rows[i].unit;this.addRowDefinition(s,1===a)}for(i=0;i<r.length;++i){var l=t.tags[i],c=parseInt(l.substring(0,l.search(":")));isNaN(c)&&(c=0);var u=parseInt(l.substring(l.search(":")+1));isNaN(u)&&(u=0),this.addControl(r[i],c,u)}},t}(i.Container);Object(s.RegisterClass)("BABYLON.GUI.Grid",l)},"./2D/controls/image.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"Image",function(){return o});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=function(e){function t(n,r){void 0===r&&(r=null);var o=e.call(this,n)||this;return o.name=n,o._workingCanvas=null,o._loaded=!1,o._stretch=t.STRETCH_FILL,o._autoScale=!1,o._sourceLeft=0,o._sourceTop=0,o._sourceWidth=0,o._sourceHeight=0,o._svgAttributesComputationCompleted=!1,o._isSVG=!1,o._cellWidth=0,o._cellHeight=0,o._cellId=-1,o._populateNinePatchSlicesFromImage=!1,o._imageDataCache={data:null,key:""},o.onImageLoadedObservable=new i.Observable,o.onSVGAttributesComputedObservable=new i.Observable,o.source=r,o}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"isLoaded",{get:function(){return this._loaded},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"detectPointerOnOpaqueOnly",{get:function(){return this._detectPointerOnOpaqueOnly},set:function(e){this._detectPointerOnOpaqueOnly!==e&&(this._detectPointerOnOpaqueOnly=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sliceLeft",{get:function(){return this._sliceLeft},set:function(e){this._sliceLeft!==e&&(this._sliceLeft=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sliceRight",{get:function(){return this._sliceRight},set:function(e){this._sliceRight!==e&&(this._sliceRight=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sliceTop",{get:function(){return this._sliceTop},set:function(e){this._sliceTop!==e&&(this._sliceTop=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sliceBottom",{get:function(){return this._sliceBottom},set:function(e){this._sliceBottom!==e&&(this._sliceBottom=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sourceLeft",{get:function(){return this._sourceLeft},set:function(e){this._sourceLeft!==e&&(this._sourceLeft=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sourceTop",{get:function(){return this._sourceTop},set:function(e){this._sourceTop!==e&&(this._sourceTop=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sourceWidth",{get:function(){return this._sourceWidth},set:function(e){this._sourceWidth!==e&&(this._sourceWidth=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sourceHeight",{get:function(){return this._sourceHeight},set:function(e){this._sourceHeight!==e&&(this._sourceHeight=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"imageWidth",{get:function(){return this._imageWidth},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"imageHeight",{get:function(){return this._imageHeight},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"populateNinePatchSlicesFromImage",{get:function(){return this._populateNinePatchSlicesFromImage},set:function(e){this._populateNinePatchSlicesFromImage!==e&&(this._populateNinePatchSlicesFromImage=e,this._populateNinePatchSlicesFromImage&&this._loaded&&this._extractNinePatchSliceDataFromImage())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSVG",{get:function(){return this._isSVG},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"svgAttributesComputationCompleted",{get:function(){return this._svgAttributesComputationCompleted},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"autoScale",{get:function(){return this._autoScale},set:function(e){this._autoScale!==e&&(this._autoScale=e,e&&this._loaded&&this.synchronizeSizeWithContent())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stretch",{get:function(){return this._stretch},set:function(e){this._stretch!==e&&(this._stretch=e,this._markAsDirty())},enumerable:!1,configurable:!0}),t.prototype._rotate90=function(e,n){var r,o;void 0===n&&(n=!1);var a=this._domImage.width,s=this._domImage.height,l=(null===(o=null===(r=this._host)||void 0===r?void 0:r.getScene())||void 0===o?void 0:o.getEngine())||i.Engine.LastCreatedEngine;if(!l)throw new Error("Invalid engine. Unable to create a canvas.");var c=l.createCanvas(s,a),u=c.getContext("2d");u.translate(c.width/2,c.height/2),u.rotate(e*Math.PI/2),u.drawImage(this._domImage,0,0,a,s,-a/2,-s/2,a,s);var _=c.toDataURL("image/jpg"),h=new t(this.name+"rotated",_);return n&&(h._stretch=this._stretch,h._autoScale=this._autoScale,h._cellId=this._cellId,h._cellWidth=e%1?this._cellHeight:this._cellWidth,h._cellHeight=e%1?this._cellWidth:this._cellHeight),this._handleRotationForSVGImage(this,h,e),this._imageDataCache.data=null,h},t.prototype._handleRotationForSVGImage=function(e,t,n){var r=this;e._isSVG&&(e._svgAttributesComputationCompleted?(this._rotate90SourceProperties(e,t,n),this._markAsDirty()):e.onSVGAttributesComputedObservable.addOnce(function(){r._rotate90SourceProperties(e,t,n),r._markAsDirty()}))},t.prototype._rotate90SourceProperties=function(e,t,n){var r,i,o=e.sourceLeft,a=e.sourceTop,s=e.domImage.width,l=e.domImage.height,c=o,u=a,_=e.sourceWidth,h=e.sourceHeight;if(0!=n){var f=n<0?-1:1;n%=4;for(var d=0;d<Math.abs(n);++d)c=-(a-l/2)*f+l/2,u=(o-s/2)*f+s/2,_=(r=[h,_])[0],h=r[1],n<0?u-=h:c-=_,o=c,a=u,s=(i=[l,s])[0],l=i[1]}t.sourceLeft=c,t.sourceTop=u,t.sourceWidth=_,t.sourceHeight=h},t.prototype._extractNinePatchSliceDataFromImage=function(){var e,t,n=this._domImage.width,r=this._domImage.height;if(!this._workingCanvas){var o=(null===(t=null===(e=this._host)||void 0===e?void 0:e.getScene())||void 0===t?void 0:t.getEngine())||i.Engine.LastCreatedEngine;if(!o)throw new Error("Invalid engine. Unable to create a canvas.");this._workingCanvas=o.createCanvas(n,r)}var a=this._workingCanvas.getContext("2d");a.drawImage(this._domImage,0,0,n,r);var s=a.getImageData(0,0,n,r);this._sliceLeft=-1,this._sliceRight=-1;for(var l=0;l<n;l++){if((u=s.data[4*l+3])>127&&-1===this._sliceLeft)this._sliceLeft=l;else if(u<127&&this._sliceLeft>-1){this._sliceRight=l;break}}this._sliceTop=-1,this._sliceBottom=-1;for(var c=0;c<r;c++){var u;if((u=s.data[c*n*4+3])>127&&-1===this._sliceTop)this._sliceTop=c;else if(u<127&&this._sliceTop>-1){this._sliceBottom=c;break}}},Object.defineProperty(t.prototype,"domImage",{get:function(){return this._domImage},set:function(e){var t=this;this._domImage=e,this._loaded=!1,this._imageDataCache.data=null,this._domImage.width?this._onImageLoaded():this._domImage.onload=function(){t._onImageLoaded()}},enumerable:!1,configurable:!0}),t.prototype._onImageLoaded=function(){this._imageDataCache.data=null,this._imageWidth=this._domImage.width,this._imageHeight=this._domImage.height,this._loaded=!0,this._populateNinePatchSlicesFromImage&&this._extractNinePatchSliceDataFromImage(),this._autoScale&&this.synchronizeSizeWithContent(),this.onImageLoadedObservable.notifyObservers(this),this._markAsDirty()},Object.defineProperty(t.prototype,"source",{get:function(){return this._source},set:function(e){var t,n,r=this;if(this._source!==e){this._loaded=!1,this._source=e,this._imageDataCache.data=null,e&&(e=this._svgCheck(e));var o=(null===(n=null===(t=this._host)||void 0===t?void 0:t.getScene())||void 0===n?void 0:n.getEngine())||i.Engine.LastCreatedEngine;if(!o)throw new Error("Invalid engine. Unable to create a canvas.");this._domImage=o.createCanvasImage(),this._domImage.onload=function(){r._onImageLoaded()},e&&(i.Tools.SetCorsBehavior(e,this._domImage),this._domImage.src=e)}},enumerable:!1,configurable:!0}),t.prototype._svgCheck=function(e){var t=this;if(window.SVGSVGElement&&-1!==e.search(/.svg#/gi)&&e.indexOf("#")===e.lastIndexOf("#")){this._isSVG=!0;var n=e.split("#")[0],r=e.split("#")[1],i=document.body.querySelector('object[data="'+n+'"]');if(i){var o=i.contentDocument;if(o&&o.documentElement){var a=o.documentElement.getAttribute("viewBox"),s=Number(o.documentElement.getAttribute("width")),l=Number(o.documentElement.getAttribute("height"));if(o.getElementById(r)&&a&&s&&l)return this._getSVGAttribs(i,r),e}i.addEventListener("load",function(){t._getSVGAttribs(i,r)})}else{var c=document.createElement("object");c.data=n,c.type="image/svg+xml",c.width="0%",c.height="0%",document.body.appendChild(c),c.onload=function(){var e=document.body.querySelector('object[data="'+n+'"]');e&&t._getSVGAttribs(e,r)}}return n}return e},t.prototype._getSVGAttribs=function(e,t){var n=e.contentDocument;if(n&&n.documentElement){var r=n.documentElement.getAttribute("viewBox"),i=Number(n.documentElement.getAttribute("width")),o=Number(n.documentElement.getAttribute("height")),a=n.getElementById(t);if(r&&i&&o&&a){var s=Number(r.split(" ")[2]),l=Number(r.split(" ")[3]),c=a.getBBox(),u=1,_=1,h=0,f=0,d=a.transform.baseVal.consolidate().matrix;a.transform&&a.transform.baseVal.consolidate()&&(u=d.a,_=d.d,h=d.e,f=d.f),this.sourceLeft=(u*c.x+h)*i/s,this.sourceTop=(_*c.y+f)*o/l,this.sourceWidth=c.width*u*(i/s),this.sourceHeight=c.height*_*(o/l),this._svgAttributesComputationCompleted=!0,this.onSVGAttributesComputedObservable.notifyObservers(this)}}},Object.defineProperty(t.prototype,"cellWidth",{get:function(){return this._cellWidth},set:function(e){this._cellWidth!==e&&(this._cellWidth=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cellHeight",{get:function(){return this._cellHeight},set:function(e){this._cellHeight!==e&&(this._cellHeight=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cellId",{get:function(){return this._cellId},set:function(e){this._cellId!==e&&(this._cellId=e,this._markAsDirty())},enumerable:!1,configurable:!0}),t.prototype.contains=function(t,n){if(!e.prototype.contains.call(this,t,n))return!1;if(!this._detectPointerOnOpaqueOnly||!this._workingCanvas)return!0;var r=0|this._currentMeasure.width,i=0|this._currentMeasure.height,o=r+"_"+i,a=this._imageDataCache.data;if(!a||this._imageDataCache.key!==o){var s=this._workingCanvas.getContext("2d");this._imageDataCache.data=a=s.getImageData(0,0,r,i).data,this._imageDataCache.key=o}return a[4*((t=t-this._currentMeasure.left|0)+(n=n-this._currentMeasure.top|0)*r)+3]>0},t.prototype._getTypeName=function(){return"Image"},t.prototype.synchronizeSizeWithContent=function(){this._loaded&&(this.width=this._domImage.width+"px",this.height=this._domImage.height+"px")},t.prototype._processMeasures=function(n,r){if(this._loaded)switch(this._stretch){case t.STRETCH_NONE:case t.STRETCH_FILL:case t.STRETCH_UNIFORM:case t.STRETCH_NINE_PATCH:break;case t.STRETCH_EXTEND:this._autoScale&&this.synchronizeSizeWithContent(),this.parent&&this.parent.parent&&(this.parent.adaptWidthToChildren=!0,this.parent.adaptHeightToChildren=!0)}e.prototype._processMeasures.call(this,n,r)},t.prototype._prepareWorkingCanvasForOpaqueDetection=function(){var e,t;if(this._detectPointerOnOpaqueOnly){var n=this._currentMeasure.width,r=this._currentMeasure.height;if(!this._workingCanvas){var o=(null===(t=null===(e=this._host)||void 0===e?void 0:e.getScene())||void 0===t?void 0:t.getEngine())||i.Engine.LastCreatedEngine;if(!o)throw new Error("Invalid engine. Unable to create a canvas.");this._workingCanvas=o.createCanvas(n,r)}this._workingCanvas.getContext("2d").clearRect(0,0,n,r)}},t.prototype._drawImage=function(e,t,n,r,i,o,a,s,l){(e.drawImage(this._domImage,t,n,r,i,o,a,s,l),this._detectPointerOnOpaqueOnly)&&(e=this._workingCanvas.getContext("2d")).drawImage(this._domImage,t,n,r,i,o-this._currentMeasure.left,a-this._currentMeasure.top,s,l)},t.prototype._draw=function(e){var n,r,i,o;if(e.save(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY),-1==this.cellId)n=this._sourceLeft,r=this._sourceTop,i=this._sourceWidth?this._sourceWidth:this._imageWidth,o=this._sourceHeight?this._sourceHeight:this._imageHeight;else{var a=this._domImage.naturalWidth/this.cellWidth,s=this.cellId/a>>0,l=this.cellId%a;n=this.cellWidth*l,r=this.cellHeight*s,i=this.cellWidth,o=this.cellHeight}if(this._prepareWorkingCanvasForOpaqueDetection(),this._applyStates(e),this._loaded)switch(this._stretch){case t.STRETCH_NONE:case t.STRETCH_FILL:this._drawImage(e,n,r,i,o,this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height);break;case t.STRETCH_UNIFORM:var c=this._currentMeasure.width/i,u=this._currentMeasure.height/o,_=Math.min(c,u),h=(this._currentMeasure.width-i*_)/2,f=(this._currentMeasure.height-o*_)/2;this._drawImage(e,n,r,i,o,this._currentMeasure.left+h,this._currentMeasure.top+f,i*_,o*_);break;case t.STRETCH_EXTEND:this._drawImage(e,n,r,i,o,this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height);break;case t.STRETCH_NINE_PATCH:this._renderNinePatch(e)}e.restore()},t.prototype._renderNinePatch=function(e){var t=this._sliceLeft,n=this._sliceTop,r=this._imageHeight-this._sliceBottom,i=this._imageWidth-this._sliceRight,o=this._sliceRight-this._sliceLeft,a=this._sliceBottom-this._sliceTop,s=this._currentMeasure.width-i-t+2,l=this._currentMeasure.height-r-n+2,c=this._currentMeasure.left+t-1,u=this._currentMeasure.top+n-1,_=this._currentMeasure.left+this._currentMeasure.width-i,h=this._currentMeasure.top+this._currentMeasure.height-r;this._drawImage(e,0,0,t,n,this._currentMeasure.left,this._currentMeasure.top,t,n),this._drawImage(e,this._sliceLeft,0,o,n,c,this._currentMeasure.top,s,n),this._drawImage(e,this.sliceRight,0,i,n,_,this._currentMeasure.top,i,n),this._drawImage(e,0,this._sliceTop,t,a,this._currentMeasure.left,u,t,l),this._drawImage(e,this._sliceLeft,this._sliceTop,o,a,c,u,s,l),this._drawImage(e,this._sliceRight,this._sliceTop,i,a,_,u,i,l),this._drawImage(e,0,this._sliceBottom,t,r,this._currentMeasure.left,h,t,r),this._drawImage(e,this.sliceLeft,this._sliceBottom,o,r,c,h,s,r),this._drawImage(e,this._sliceRight,this._sliceBottom,i,r,_,h,i,r)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.onImageLoadedObservable.clear(),this.onSVGAttributesComputedObservable.clear()},t.STRETCH_NONE=0,t.STRETCH_FILL=1,t.STRETCH_UNIFORM=2,t.STRETCH_EXTEND=3,t.STRETCH_NINE_PATCH=4,Object(r.__decorate)([Object(i.serialize)()],t.prototype,"detectPointerOnOpaqueOnly",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"sliceLeft",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"sliceRight",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"sliceTop",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"sliceBottom",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"sourceLeft",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"sourceTop",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"sourceWidth",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"sourceHeight",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"populateNinePatchSlicesFromImage",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"autoScale",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"stretch",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"source",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"cellWidth",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"cellHeight",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"cellId",null),t}(n("./2D/controls/control.ts").Control);Object(i.RegisterClass)("BABYLON.GUI.Image",o)},"./2D/controls/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./2D/controls/button.ts");n.d(t,"Button",function(){return r.Button});var i=n("./2D/controls/checkbox.ts");n.d(t,"Checkbox",function(){return i.Checkbox});var o=n("./2D/controls/colorpicker.ts");n.d(t,"ColorPicker",function(){return o.ColorPicker});var a=n("./2D/controls/container.ts");n.d(t,"Container",function(){return a.Container});var s=n("./2D/controls/control.ts");n.d(t,"Control",function(){return s.Control});var l=n("./2D/controls/ellipse.ts");n.d(t,"Ellipse",function(){return l.Ellipse});var c=n("./2D/controls/focusableButton.ts");n.d(t,"FocusableButton",function(){return c.FocusableButton});var u=n("./2D/controls/grid.ts");n.d(t,"Grid",function(){return u.Grid});var _=n("./2D/controls/image.ts");n.d(t,"Image",function(){return _.Image});var h=n("./2D/controls/inputText.ts");n.d(t,"InputText",function(){return h.InputText});var f=n("./2D/controls/inputPassword.ts");n.d(t,"InputPassword",function(){return f.InputPassword});var d=n("./2D/controls/line.ts");n.d(t,"Line",function(){return d.Line});var p=n("./2D/controls/multiLine.ts");n.d(t,"MultiLine",function(){return p.MultiLine});var m=n("./2D/controls/radioButton.ts");n.d(t,"RadioButton",function(){return m.RadioButton});var g=n("./2D/controls/stackPanel.ts");n.d(t,"StackPanel",function(){return g.StackPanel});var v=n("./2D/controls/selector.ts");n.d(t,"SelectorGroup",function(){return v.SelectorGroup}),n.d(t,"CheckboxGroup",function(){return v.CheckboxGroup}),n.d(t,"RadioGroup",function(){return v.RadioGroup}),n.d(t,"SliderGroup",function(){return v.SliderGroup}),n.d(t,"SelectionPanel",function(){return v.SelectionPanel});var b=n("./2D/controls/scrollViewers/scrollViewer.ts");n.d(t,"ScrollViewer",function(){return b.ScrollViewer});var y=n("./2D/controls/textBlock.ts");n.d(t,"TextWrapping",function(){return y.TextWrapping}),n.d(t,"TextBlock",function(){return y.TextBlock});var x=n("./2D/controls/textWrapper.ts");n.d(t,"TextWrapper",function(){return x.TextWrapper});var T=n("./2D/controls/toggleButton.ts");n.d(t,"ToggleButton",function(){return T.ToggleButton});var O=n("./2D/controls/virtualKeyboard.ts");n.d(t,"KeyPropertySet",function(){return O.KeyPropertySet}),n.d(t,"VirtualKeyboard",function(){return O.VirtualKeyboard});var P=n("./2D/controls/rectangle.ts");n.d(t,"Rectangle",function(){return P.Rectangle});var C=n("./2D/controls/displayGrid.ts");n.d(t,"DisplayGrid",function(){return C.DisplayGrid});var S=n("./2D/controls/sliders/baseSlider.ts");n.d(t,"BaseSlider",function(){return S.BaseSlider});var M=n("./2D/controls/sliders/slider.ts");n.d(t,"Slider",function(){return M.Slider});var E=n("./2D/controls/sliders/imageBasedSlider.ts");n.d(t,"ImageBasedSlider",function(){return E.ImageBasedSlider});var A=n("./2D/controls/sliders/scrollBar.ts");n.d(t,"ScrollBar",function(){return A.ScrollBar});var B=n("./2D/controls/sliders/imageScrollBar.ts");n.d(t,"ImageScrollBar",function(){return B.ImageScrollBar});var F=n("./2D/controls/statics.ts");n.d(t,"name",function(){return F.name})},"./2D/controls/inputPassword.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"InputPassword",function(){return s});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("./2D/controls/inputText.ts"),o=n("babylonjs/Misc/perfCounter"),a=n("./2D/controls/textWrapper.ts"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype._beforeRenderText=function(e){for(var t=new a.TextWrapper,n="",r=0;r<e.length;r++)n+="";return t.text=n,t},t}(i.InputText);Object(o.RegisterClass)("BABYLON.GUI.InputPassword",s)},"./2D/controls/inputText.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"InputText",function(){return l});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=n("./2D/controls/control.ts"),a=n("./2D/valueAndUnit.ts"),s=n("./2D/controls/textWrapper.ts"),l=function(e){function t(t,n){void 0===n&&(n="");var r=e.call(this,t)||this;return r.name=t,r._placeholderText="",r._background="#222222",r._focusedBackground="#000000",r._focusedColor="white",r._placeholderColor="gray",r._thickness=1,r._margin=new a.ValueAndUnit(10,a.ValueAndUnit.UNITMODE_PIXEL),r._autoStretchWidth=!0,r._maxWidth=new a.ValueAndUnit(1,a.ValueAndUnit.UNITMODE_PERCENTAGE,!1),r._isFocused=!1,r._blinkIsEven=!1,r._cursorOffset=0,r._deadKey=!1,r._addKey=!0,r._currentKey="",r._isTextHighlightOn=!1,r._textHighlightColor="#d5e0ff",r._highligherOpacity=.4,r._highlightedText="",r._startHighlightIndex=0,r._endHighlightIndex=0,r._cursorIndex=-1,r._onFocusSelectAll=!1,r._isPointerDown=!1,r.promptMessage="Please enter text:",r.disableMobilePrompt=!1,r.onTextChangedObservable=new i.Observable,r.onBeforeKeyAddObservable=new i.Observable,r.onFocusObservable=new i.Observable,r.onBlurObservable=new i.Observable,r.onTextHighlightObservable=new i.Observable,r.onTextCopyObservable=new i.Observable,r.onTextCutObservable=new i.Observable,r.onTextPasteObservable=new i.Observable,r.onKeyboardEventProcessedObservable=new i.Observable,r.text=n,r.isPointerBlocker=!0,r}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"maxWidth",{get:function(){return this._maxWidth.toString(this._host)},set:function(e){this._maxWidth.toString(this._host)!==e&&this._maxWidth.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxWidthInPixels",{get:function(){return this._maxWidth.getValueInPixel(this._host,this._cachedParentMeasure.width)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"highligherOpacity",{get:function(){return this._highligherOpacity},set:function(e){this._highligherOpacity!==e&&(this._highligherOpacity=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onFocusSelectAll",{get:function(){return this._onFocusSelectAll},set:function(e){this._onFocusSelectAll!==e&&(this._onFocusSelectAll=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textHighlightColor",{get:function(){return this._textHighlightColor},set:function(e){this._textHighlightColor!==e&&(this._textHighlightColor=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"margin",{get:function(){return this._margin.toString(this._host)},set:function(e){this._margin.toString(this._host)!==e&&this._margin.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"marginInPixels",{get:function(){return this._margin.getValueInPixel(this._host,this._cachedParentMeasure.width)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"autoStretchWidth",{get:function(){return this._autoStretchWidth},set:function(e){this._autoStretchWidth!==e&&(this._autoStretchWidth=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thickness",{get:function(){return this._thickness},set:function(e){this._thickness!==e&&(this._thickness=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"focusedBackground",{get:function(){return this._focusedBackground},set:function(e){this._focusedBackground!==e&&(this._focusedBackground=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"focusedColor",{get:function(){return this._focusedColor},set:function(e){this._focusedColor!==e&&(this._focusedColor=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this._background},set:function(e){this._background!==e&&(this._background=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"placeholderColor",{get:function(){return this._placeholderColor},set:function(e){this._placeholderColor!==e&&(this._placeholderColor=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"placeholderText",{get:function(){return this._placeholderText},set:function(e){this._placeholderText!==e&&(this._placeholderText=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"deadKey",{get:function(){return this._deadKey},set:function(e){this._deadKey=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"highlightedText",{get:function(){return this._highlightedText},set:function(e){this._highlightedText!==e&&(this._highlightedText=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"addKey",{get:function(){return this._addKey},set:function(e){this._addKey=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentKey",{get:function(){return this._currentKey},set:function(e){this._currentKey=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._textWrapper.text},set:function(e){var t=e.toString();this._textWrapper||(this._textWrapper=new s.TextWrapper),this._textWrapper.text!==t&&(this._textWrapper.text=t,this._textHasChanged())},enumerable:!1,configurable:!0}),t.prototype._textHasChanged=function(){this._markAsDirty(),this.onTextChangedObservable.notifyObservers(this)},Object.defineProperty(t.prototype,"width",{get:function(){return this._width.toString(this._host)},set:function(e){this._width.toString(this._host)!==e&&(this._width.fromString(e)&&this._markAsDirty(),this.autoStretchWidth=!1)},enumerable:!1,configurable:!0}),t.prototype.onBlur=function(){this._isFocused=!1,this._scrollLeft=null,this._cursorOffset=0,clearTimeout(this._blinkTimeout),this._markAsDirty(),this.onBlurObservable.notifyObservers(this),this._host.unRegisterClipboardEvents(),this._onClipboardObserver&&this._host.onClipboardObservable.remove(this._onClipboardObserver);var e=this._host.getScene();this._onPointerDblTapObserver&&e&&e.onPointerObservable.remove(this._onPointerDblTapObserver)},t.prototype.onFocus=function(){var e=this;if(this._isEnabled){if(this._scrollLeft=null,this._isFocused=!0,this._blinkIsEven=!1,this._cursorOffset=0,this._markAsDirty(),this.onFocusObservable.notifyObservers(this),-1!==navigator.userAgent.indexOf("Mobile")&&!this.disableMobilePrompt){var t=prompt(this.promptMessage);return null!==t&&(this.text=t),void(this._host.focusedControl=null)}this._host.registerClipboardEvents(),this._onClipboardObserver=this._host.onClipboardObservable.add(function(t){switch(t.type){case i.ClipboardEventTypes.COPY:e._onCopyText(t.event),e.onTextCopyObservable.notifyObservers(e);break;case i.ClipboardEventTypes.CUT:e._onCutText(t.event),e.onTextCutObservable.notifyObservers(e);break;case i.ClipboardEventTypes.PASTE:e._onPasteText(t.event),e.onTextPasteObservable.notifyObservers(e);break;default:return}});var n=this._host.getScene();n&&(this._onPointerDblTapObserver=n.onPointerObservable.add(function(t){e._isFocused&&t.type===i.PointerEventTypes.POINTERDOUBLETAP&&e._processDblClick(t)})),this._onFocusSelectAll&&this._selectAllText()}},t.prototype.focus=function(){this._host.moveFocusToControl(this)},t.prototype.blur=function(){this._host.focusedControl=null},t.prototype._getTypeName=function(){return"InputText"},t.prototype.keepsFocusWith=function(){return this._connectedVirtualKeyboard?[this._connectedVirtualKeyboard]:null},t.prototype.processKey=function(e,t,n){if(!this.isReadOnly&&(!n||!n.ctrlKey&&!n.metaKey||67!==e&&86!==e&&88!==e)){if(n&&(n.ctrlKey||n.metaKey)&&65===e)return this._selectAllText(),void n.preventDefault();switch(e){case 32:t=" ";break;case 191:n&&n.preventDefault();break;case 8:if(this._textWrapper.text&&this._textWrapper.length>0){if(this._isTextHighlightOn)return this._textWrapper.removePart(this._startHighlightIndex,this._endHighlightIndex),this._textHasChanged(),this._isTextHighlightOn=!1,this._cursorOffset=this._textWrapper.length-this._startHighlightIndex,this._blinkIsEven=!1,void(n&&n.preventDefault());if(0===this._cursorOffset)this.text=this._textWrapper.substr(0,this._textWrapper.length-1);else(r=this._textWrapper.length-this._cursorOffset)>0&&(this._textWrapper.removePart(r-1,r),this._textHasChanged())}return void(n&&n.preventDefault());case 46:if(this._isTextHighlightOn)return this._textWrapper.removePart(this._startHighlightIndex,this._endHighlightIndex),this._textHasChanged(),this._isTextHighlightOn=!1,this._cursorOffset=this._textWrapper.length-this._startHighlightIndex,void(n&&n.preventDefault());if(this._textWrapper.text&&this._textWrapper.length>0&&this._cursorOffset>0){var r=this._textWrapper.length-this._cursorOffset;this._textWrapper.removePart(r,r+1),this._textHasChanged(),this._cursorOffset--}return void(n&&n.preventDefault());case 13:return this._host.focusedControl=null,void(this._isTextHighlightOn=!1);case 35:return this._cursorOffset=0,this._blinkIsEven=!1,this._isTextHighlightOn=!1,void this._markAsDirty();case 36:return this._cursorOffset=this._textWrapper.length,this._blinkIsEven=!1,this._isTextHighlightOn=!1,void this._markAsDirty();case 37:if(this._cursorOffset++,this._cursorOffset>this._textWrapper.length&&(this._cursorOffset=this._textWrapper.length),n&&n.shiftKey){if(this._blinkIsEven=!1,n.ctrlKey||n.metaKey){if(!this._isTextHighlightOn){if(this._textWrapper.length===this._cursorOffset)return;this._endHighlightIndex=this._textWrapper.length-this._cursorOffset+1}return this._startHighlightIndex=0,this._cursorIndex=this._textWrapper.length-this._endHighlightIndex,this._cursorOffset=this._textWrapper.length,this._isTextHighlightOn=!0,void this._markAsDirty()}return this._isTextHighlightOn?-1===this._cursorIndex&&(this._cursorIndex=this._textWrapper.length-this._endHighlightIndex,this._cursorOffset=0===this._startHighlightIndex?this._textWrapper.length:this._textWrapper.length-this._startHighlightIndex+1):(this._isTextHighlightOn=!0,this._cursorIndex=this._cursorOffset>=this._textWrapper.length?this._textWrapper.length:this._cursorOffset-1),this._cursorIndex<this._cursorOffset?(this._endHighlightIndex=this._textWrapper.length-this._cursorIndex,this._startHighlightIndex=this._textWrapper.length-this._cursorOffset):this._cursorIndex>this._cursorOffset?(this._endHighlightIndex=this._textWrapper.length-this._cursorOffset,this._startHighlightIndex=this._textWrapper.length-this._cursorIndex):this._isTextHighlightOn=!1,void this._markAsDirty()}return this._isTextHighlightOn&&(this._cursorOffset=this._textWrapper.length-this._startHighlightIndex,this._isTextHighlightOn=!1),n&&(n.ctrlKey||n.metaKey)&&(this._cursorOffset=this._textWrapper.length,n.preventDefault()),this._blinkIsEven=!1,this._isTextHighlightOn=!1,this._cursorIndex=-1,void this._markAsDirty();case 39:if(this._cursorOffset--,this._cursorOffset<0&&(this._cursorOffset=0),n&&n.shiftKey){if(this._blinkIsEven=!1,n.ctrlKey||n.metaKey){if(!this._isTextHighlightOn){if(0===this._cursorOffset)return;this._startHighlightIndex=this._textWrapper.length-this._cursorOffset-1}return this._endHighlightIndex=this._textWrapper.length,this._isTextHighlightOn=!0,this._cursorIndex=this._textWrapper.length-this._startHighlightIndex,this._cursorOffset=0,void this._markAsDirty()}return this._isTextHighlightOn?-1===this._cursorIndex&&(this._cursorIndex=this._textWrapper.length-this._startHighlightIndex,this._cursorOffset=this._textWrapper.length===this._endHighlightIndex?0:this._textWrapper.length-this._endHighlightIndex-1):(this._isTextHighlightOn=!0,this._cursorIndex=this._cursorOffset<=0?0:this._cursorOffset+1),this._cursorIndex<this._cursorOffset?(this._endHighlightIndex=this._textWrapper.length-this._cursorIndex,this._startHighlightIndex=this._textWrapper.length-this._cursorOffset):this._cursorIndex>this._cursorOffset?(this._endHighlightIndex=this._textWrapper.length-this._cursorOffset,this._startHighlightIndex=this._textWrapper.length-this._cursorIndex):this._isTextHighlightOn=!1,void this._markAsDirty()}return this._isTextHighlightOn&&(this._cursorOffset=this._textWrapper.length-this._endHighlightIndex,this._isTextHighlightOn=!1),n&&(n.ctrlKey||n.metaKey)&&(this._cursorOffset=0,n.preventDefault()),this._blinkIsEven=!1,this._isTextHighlightOn=!1,this._cursorIndex=-1,void this._markAsDirty();case 222:n?"Quote"==n.code?n.shiftKey?(e=34,t='"'):(e=39,t="'"):(n.preventDefault(),this._cursorIndex=-1,this.deadKey=!0):(this._cursorIndex=-1,this.deadKey=!0)}if(t&&(-1===e||32===e||34===e||39===e||e>47&&e<64||e>64&&e<91||e>159&&e<193||e>218&&e<223||e>95&&e<112)&&(this._currentKey=t,this.onBeforeKeyAddObservable.notifyObservers(this),t=this._currentKey,this._addKey))if(this._isTextHighlightOn)this._textWrapper.removePart(this._startHighlightIndex,this._endHighlightIndex,t),this._textHasChanged(),this._cursorOffset=this._textWrapper.length-(this._startHighlightIndex+1),this._isTextHighlightOn=!1,this._blinkIsEven=!1,this._markAsDirty();else if(0===this._cursorOffset)this.text+=t;else{var i=this._textWrapper.length-this._cursorOffset;this._textWrapper.removePart(i,i,t),this._textHasChanged()}}},t.prototype._updateValueFromCursorIndex=function(e){if(this._blinkIsEven=!1,-1===this._cursorIndex)this._cursorIndex=e;else if(this._cursorIndex<this._cursorOffset)this._endHighlightIndex=this._textWrapper.length-this._cursorIndex,this._startHighlightIndex=this._textWrapper.length-this._cursorOffset;else{if(!(this._cursorIndex>this._cursorOffset))return this._isTextHighlightOn=!1,void this._markAsDirty();this._endHighlightIndex=this._textWrapper.length-this._cursorOffset,this._startHighlightIndex=this._textWrapper.length-this._cursorIndex}this._isTextHighlightOn=!0,this._markAsDirty()},t.prototype._processDblClick=function(e){var t,n;this._startHighlightIndex=this._textWrapper.length-this._cursorOffset,this._endHighlightIndex=this._startHighlightIndex;do{n=this._endHighlightIndex<this._textWrapper.length&&this._textWrapper.isWord(this._endHighlightIndex)?++this._endHighlightIndex:0,t=this._startHighlightIndex>0&&this._textWrapper.isWord(this._startHighlightIndex-1)?--this._startHighlightIndex:0}while(t||n);this._cursorOffset=this._textWrapper.length-this._startHighlightIndex,this.onTextHighlightObservable.notifyObservers(this),this._isTextHighlightOn=!0,this._clickedCoordinate=null,this._blinkIsEven=!0,this._cursorIndex=-1,this._markAsDirty()},t.prototype._selectAllText=function(){this._blinkIsEven=!0,this._isTextHighlightOn=!0,this._startHighlightIndex=0,this._endHighlightIndex=this._textWrapper.length,this._cursorOffset=this._textWrapper.length,this._cursorIndex=-1,this._markAsDirty()},t.prototype.processKeyboard=function(e){this.processKey(e.keyCode,e.key,e),this.onKeyboardEventProcessedObservable.notifyObservers(e)},t.prototype._onCopyText=function(e){this._isTextHighlightOn=!1;try{e.clipboardData&&e.clipboardData.setData("text/plain",this._highlightedText)}catch(e){}this._host.clipboardData=this._highlightedText},t.prototype._onCutText=function(e){if(this._highlightedText){this._textWrapper.removePart(this._startHighlightIndex,this._endHighlightIndex),this._textHasChanged(),this._isTextHighlightOn=!1,this._cursorOffset=this._textWrapper.length-this._startHighlightIndex;try{e.clipboardData&&e.clipboardData.setData("text/plain",this._highlightedText)}catch(e){}this._host.clipboardData=this._highlightedText,this._highlightedText=""}},t.prototype._onPasteText=function(e){var t="";t=e.clipboardData&&-1!==e.clipboardData.types.indexOf("text/plain")?e.clipboardData.getData("text/plain"):this._host.clipboardData;var n=this._textWrapper.length-this._cursorOffset;this._textWrapper.removePart(n,n,t),this._textHasChanged()},t.prototype._draw=function(e,t){var n=this;e.save(),this._applyStates(e),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY),this._isFocused?this._focusedBackground&&(e.fillStyle=this._isEnabled?this._focusedBackground:this._disabledColor,e.fillRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height)):this._background&&(e.fillStyle=this._isEnabled?this._background:this._disabledColor,e.fillRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height)),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),this._fontOffset||(this._fontOffset=o.Control._GetFontOffset(e.font));var r=this._currentMeasure.left+this._margin.getValueInPixel(this._host,this._tempParentMeasure.width);this.color&&(e.fillStyle=this.color);var i=this._beforeRenderText(this._textWrapper);this._isFocused||this._textWrapper.text||!this._placeholderText||((i=new s.TextWrapper).text=this._placeholderText,this._placeholderColor&&(e.fillStyle=this._placeholderColor)),this._textWidth=e.measureText(i.text).width;var a=2*this._margin.getValueInPixel(this._host,this._tempParentMeasure.width);this._autoStretchWidth&&(this.width=Math.min(this._maxWidth.getValueInPixel(this._host,this._tempParentMeasure.width),this._textWidth+a)+"px",this._autoStretchWidth=!0);var l=this._fontOffset.ascent+(this._currentMeasure.height-this._fontOffset.height)/2,c=this._width.getValueInPixel(this._host,this._tempParentMeasure.width)-a;if(e.save(),e.beginPath(),e.rect(r,this._currentMeasure.top+(this._currentMeasure.height-this._fontOffset.height)/2,c+2,this._currentMeasure.height),e.clip(),this._isFocused&&this._textWidth>c){var u=r-this._textWidth+c;this._scrollLeft||(this._scrollLeft=u)}else this._scrollLeft=r;if(e.fillText(i.text,this._scrollLeft,this._currentMeasure.top+l),this._isFocused){if(this._clickedCoordinate){var _=this._scrollLeft+this._textWidth-this._clickedCoordinate,h=0;this._cursorOffset=0;var f=0;do{this._cursorOffset&&(f=Math.abs(_-h)),this._cursorOffset++,h=e.measureText(i.substr(i.length-this._cursorOffset,this._cursorOffset)).width}while(h<_&&i.length>=this._cursorOffset);Math.abs(_-h)>f&&this._cursorOffset--,this._blinkIsEven=!1,this._clickedCoordinate=null}if(!this._blinkIsEven){var d=i.substr(i.length-this._cursorOffset),p=e.measureText(d).width,m=this._scrollLeft+this._textWidth-p;m<r?(this._scrollLeft+=r-m,m=r,this._markAsDirty()):m>r+c&&(this._scrollLeft+=r+c-m,m=r+c,this._markAsDirty()),this._isTextHighlightOn||e.fillRect(m,this._currentMeasure.top+(this._currentMeasure.height-this._fontOffset.height)/2,2,this._fontOffset.height)}if(clearTimeout(this._blinkTimeout),this._blinkTimeout=setTimeout(function(){n._blinkIsEven=!n._blinkIsEven,n._markAsDirty()},500),this._isTextHighlightOn){clearTimeout(this._blinkTimeout);var g=e.measureText(i.substring(this._startHighlightIndex)).width,v=this._scrollLeft+this._textWidth-g;this._highlightedText=i.substring(this._startHighlightIndex,this._endHighlightIndex);var b=e.measureText(i.substring(this._startHighlightIndex,this._endHighlightIndex)).width;v<r&&((b-=r-v)||(b=e.measureText(i.charAt(i.length-this._cursorOffset)).width),v=r),e.globalAlpha=this._highligherOpacity,e.fillStyle=this._textHighlightColor,e.fillRect(v,this._currentMeasure.top+(this._currentMeasure.height-this._fontOffset.height)/2,b,this._fontOffset.height),e.globalAlpha=1}}e.restore(),this._thickness&&(this._isFocused?this.focusedColor&&(e.strokeStyle=this.focusedColor):this.color&&(e.strokeStyle=this.color),e.lineWidth=this._thickness,e.strokeRect(this._currentMeasure.left+this._thickness/2,this._currentMeasure.top+this._thickness/2,this._currentMeasure.width-this._thickness,this._currentMeasure.height-this._thickness)),e.restore()},t.prototype._onPointerDown=function(t,n,r,i,o){return!!e.prototype._onPointerDown.call(this,t,n,r,i,o)&&(!!this.isReadOnly||(this._clickedCoordinate=n.x,this._isTextHighlightOn=!1,this._highlightedText="",this._cursorIndex=-1,this._isPointerDown=!0,this._host._capturingControl[r]=this,this._host.focusedControl===this?(clearTimeout(this._blinkTimeout),this._markAsDirty(),!0):!!this._isEnabled&&(this._host.focusedControl=this,!0)))},t.prototype._onPointerMove=function(t,n,r,i){this._host.focusedControl===this&&this._isPointerDown&&!this.isReadOnly&&(this._clickedCoordinate=n.x,this._markAsDirty(),this._updateValueFromCursorIndex(this._cursorOffset)),e.prototype._onPointerMove.call(this,t,n,r,i)},t.prototype._onPointerUp=function(t,n,r,i,o){this._isPointerDown=!1,delete this._host._capturingControl[r],e.prototype._onPointerUp.call(this,t,n,r,i,o)},t.prototype._beforeRenderText=function(e){return e},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.onBlurObservable.clear(),this.onFocusObservable.clear(),this.onTextChangedObservable.clear(),this.onTextCopyObservable.clear(),this.onTextCutObservable.clear(),this.onTextPasteObservable.clear(),this.onTextHighlightObservable.clear(),this.onKeyboardEventProcessedObservable.clear()},Object(r.__decorate)([Object(i.serialize)()],t.prototype,"promptMessage",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"disableMobilePrompt",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"maxWidth",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"highligherOpacity",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"onFocusSelectAll",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"textHighlightColor",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"margin",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"autoStretchWidth",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"thickness",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"focusedBackground",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"focusedColor",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"background",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"placeholderColor",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"placeholderText",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"deadKey",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"text",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"width",null),t}(o.Control);Object(i.RegisterClass)("BABYLON.GUI.InputText",l)},"./2D/controls/line.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"Line",function(){return s});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=n("./2D/controls/control.ts"),a=n("./2D/valueAndUnit.ts"),s=function(e){function t(t){var n=e.call(this,t)||this;return n.name=t,n._lineWidth=1,n._x1=new a.ValueAndUnit(0),n._y1=new a.ValueAndUnit(0),n._x2=new a.ValueAndUnit(0),n._y2=new a.ValueAndUnit(0),n._dash=new Array,n._automaticSize=!0,n.isHitTestVisible=!1,n._horizontalAlignment=o.Control.HORIZONTAL_ALIGNMENT_LEFT,n._verticalAlignment=o.Control.VERTICAL_ALIGNMENT_TOP,n}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"dash",{get:function(){return this._dash},set:function(e){this._dash!==e&&(this._dash=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"connectedControl",{get:function(){return this._connectedControl},set:function(e){var t=this;this._connectedControl!==e&&(this._connectedControlDirtyObserver&&this._connectedControl&&(this._connectedControl.onDirtyObservable.remove(this._connectedControlDirtyObserver),this._connectedControlDirtyObserver=null),e&&(this._connectedControlDirtyObserver=e.onDirtyObservable.add(function(){return t._markAsDirty()})),this._connectedControl=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"x1",{get:function(){return this._x1.toString(this._host)},set:function(e){this._x1.toString(this._host)!==e&&this._x1.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y1",{get:function(){return this._y1.toString(this._host)},set:function(e){this._y1.toString(this._host)!==e&&this._y1.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"x2",{get:function(){return this._x2.toString(this._host)},set:function(e){this._x2.toString(this._host)!==e&&this._x2.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y2",{get:function(){return this._y2.toString(this._host)},set:function(e){this._y2.toString(this._host)!==e&&this._y2.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineWidth",{get:function(){return this._lineWidth},set:function(e){this._lineWidth!==e&&(this._lineWidth=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"horizontalAlignment",{set:function(e){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticalAlignment",{set:function(e){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_effectiveX2",{get:function(){return(this._connectedControl?this._connectedControl.centerX:0)+this._x2.getValue(this._host)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_effectiveY2",{get:function(){return(this._connectedControl?this._connectedControl.centerY:0)+this._y2.getValue(this._host)},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"Line"},t.prototype._draw=function(e){e.save(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY),this._applyStates(e),e.strokeStyle=this.color,e.lineWidth=this._lineWidth,e.setLineDash(this._dash),e.beginPath(),e.moveTo(this._cachedParentMeasure.left+this._x1.getValue(this._host),this._cachedParentMeasure.top+this._y1.getValue(this._host)),e.lineTo(this._cachedParentMeasure.left+this._effectiveX2,this._cachedParentMeasure.top+this._effectiveY2),e.stroke(),e.restore()},t.prototype._measure=function(){this._currentMeasure.width=Math.abs(this._x1.getValue(this._host)-this._effectiveX2)+this._lineWidth,this._currentMeasure.height=Math.abs(this._y1.getValue(this._host)-this._effectiveY2)+this._lineWidth},t.prototype._computeAlignment=function(e,t){this._currentMeasure.left=e.left+Math.min(this._x1.getValue(this._host),this._effectiveX2)-this._lineWidth/2,this._currentMeasure.top=e.top+Math.min(this._y1.getValue(this._host),this._effectiveY2)-this._lineWidth/2},t.prototype.moveToVector3=function(e,t,n){if(void 0===n&&(n=!1),this._host&&this.parent===this._host._rootContainer){var r=this._host._getGlobalViewport(),o=i.Vector3.Project(e,i.Matrix.Identity(),t.getTransformMatrix(),r);this._moveToProjectedPosition(o,n),o.z<0||o.z>1?this.notRenderable=!0:this.notRenderable=!1}else i.Tools.Error("Cannot move a control to a vector3 if the control is not at root level")},t.prototype._moveToProjectedPosition=function(e,t){void 0===t&&(t=!1);var n=e.x+this._linkOffsetX.getValue(this._host)+"px",r=e.y+this._linkOffsetY.getValue(this._host)+"px";t?(this.x2=n,this.y2=r,this._x2.ignoreAdaptiveScaling=!0,this._y2.ignoreAdaptiveScaling=!0):(this.x1=n,this.y1=r,this._x1.ignoreAdaptiveScaling=!0,this._y1.ignoreAdaptiveScaling=!0)},Object(r.__decorate)([Object(i.serialize)()],t.prototype,"dash",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"x1",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"y1",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"x2",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"y2",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"lineWidth",null),t}(o.Control);Object(i.RegisterClass)("BABYLON.GUI.Line",s)},"./2D/controls/multiLine.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"MultiLine",function(){return s});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=n("./2D/controls/control.ts"),a=n("./2D/multiLinePoint.ts"),s=function(e){function t(t){var n=e.call(this,t)||this;return n.name=t,n._lineWidth=1,n.onPointUpdate=function(){n._markAsDirty()},n._automaticSize=!0,n.isHitTestVisible=!1,n._horizontalAlignment=o.Control.HORIZONTAL_ALIGNMENT_LEFT,n._verticalAlignment=o.Control.VERTICAL_ALIGNMENT_TOP,n._dash=[],n._points=[],n}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"dash",{get:function(){return this._dash},set:function(e){this._dash!==e&&(this._dash=e,this._markAsDirty())},enumerable:!1,configurable:!0}),t.prototype.getAt=function(e){return this._points[e]||(this._points[e]=new a.MultiLinePoint(this)),this._points[e]},t.prototype.add=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.map(function(t){return e.push(t)})},t.prototype.push=function(e){var t=this.getAt(this._points.length);return null==e?t:(e instanceof i.AbstractMesh?t.mesh=e:e instanceof o.Control?t.control=e:null!=e.x&&null!=e.y&&(t.x=e.x,t.y=e.y),t)},t.prototype.remove=function(e){var t;if(e instanceof a.MultiLinePoint){if(-1===(t=this._points.indexOf(e)))return}else t=e;var n=this._points[t];n&&(n.dispose(),this._points.splice(t,1))},t.prototype.reset=function(){for(;this._points.length>0;)this.remove(this._points.length-1)},t.prototype.resetLinks=function(){this._points.forEach(function(e){null!=e&&e.resetLinks()})},Object.defineProperty(t.prototype,"lineWidth",{get:function(){return this._lineWidth},set:function(e){this._lineWidth!==e&&(this._lineWidth=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"horizontalAlignment",{set:function(e){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticalAlignment",{set:function(e){},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"MultiLine"},t.prototype._draw=function(e,t){e.save(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY),this._applyStates(e),e.strokeStyle=this.color,e.lineWidth=this._lineWidth,e.setLineDash(this._dash),e.beginPath();var n,r=!0;this._points.forEach(function(t){t&&(r?(e.moveTo(t._point.x,t._point.y),r=!1):t._point.z<1&&n.z<1?e.lineTo(t._point.x,t._point.y):e.moveTo(t._point.x,t._point.y),n=t._point)}),e.stroke(),e.restore()},t.prototype._additionalProcessing=function(e,t){var n=this;this._minX=null,this._minY=null,this._maxX=null,this._maxY=null,this._points.forEach(function(e,t){e&&(e.translate(),(null==n._minX||e._point.x<n._minX)&&(n._minX=e._point.x),(null==n._minY||e._point.y<n._minY)&&(n._minY=e._point.y),(null==n._maxX||e._point.x>n._maxX)&&(n._maxX=e._point.x),(null==n._maxY||e._point.y>n._maxY)&&(n._maxY=e._point.y))}),null==this._minX&&(this._minX=0),null==this._minY&&(this._minY=0),null==this._maxX&&(this._maxX=0),null==this._maxY&&(this._maxY=0)},t.prototype._measure=function(){null!=this._minX&&null!=this._maxX&&null!=this._minY&&null!=this._maxY&&(this._currentMeasure.width=Math.abs(this._maxX-this._minX)+this._lineWidth,this._currentMeasure.height=Math.abs(this._maxY-this._minY)+this._lineWidth)},t.prototype._computeAlignment=function(e,t){null!=this._minX&&null!=this._minY&&(this._currentMeasure.left=this._minX-this._lineWidth/2,this._currentMeasure.top=this._minY-this._lineWidth/2)},t.prototype.dispose=function(){this.reset(),e.prototype.dispose.call(this)},Object(r.__decorate)([Object(i.serialize)()],t.prototype,"dash",null),t}(o.Control);Object(i.RegisterClass)("BABYLON.GUI.MultiLine",s)},"./2D/controls/radioButton.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"RadioButton",function(){return l});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=n("./2D/controls/control.ts"),a=n("./2D/controls/stackPanel.ts"),s=n("./2D/controls/textBlock.ts"),l=function(e){function t(t){var n=e.call(this,t)||this;return n.name=t,n._isChecked=!1,n._background="black",n._checkSizeRatio=.8,n._thickness=1,n.group="",n.onIsCheckedChangedObservable=new i.Observable,n.isPointerBlocker=!0,n}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"thickness",{get:function(){return this._thickness},set:function(e){this._thickness!==e&&(this._thickness=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"checkSizeRatio",{get:function(){return this._checkSizeRatio},set:function(e){e=Math.max(Math.min(1,e),0),this._checkSizeRatio!==e&&(this._checkSizeRatio=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this._background},set:function(e){this._background!==e&&(this._background=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isChecked",{get:function(){return this._isChecked},set:function(e){var t=this;this._isChecked!==e&&(this._isChecked=e,this._markAsDirty(),this.onIsCheckedChangedObservable.notifyObservers(e),this._isChecked&&this._host&&this._host.executeOnAllControls(function(e){if(e!==t&&void 0!==e.group){var n=e;n.group===t.group&&(n.isChecked=!1)}}))},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"RadioButton"},t.prototype._draw=function(e){e.save(),this._applyStates(e);var t=this._currentMeasure.width-this._thickness,n=this._currentMeasure.height-this._thickness;if((this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY),o.Control.drawEllipse(this._currentMeasure.left+this._currentMeasure.width/2,this._currentMeasure.top+this._currentMeasure.height/2,this._currentMeasure.width/2-this._thickness/2,this._currentMeasure.height/2-this._thickness/2,e),e.fillStyle=this._isEnabled?this._background:this._disabledColor,e.fill(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),e.strokeStyle=this.color,e.lineWidth=this._thickness,e.stroke(),this._isChecked){e.fillStyle=this._isEnabled?this.color:this._disabledColor;var r=t*this._checkSizeRatio,i=n*this._checkSizeRatio;o.Control.drawEllipse(this._currentMeasure.left+this._currentMeasure.width/2,this._currentMeasure.top+this._currentMeasure.height/2,r/2-this._thickness/2,i/2-this._thickness/2,e),e.fill()}e.restore()},t.prototype._onPointerDown=function(t,n,r,i,o){return!!e.prototype._onPointerDown.call(this,t,n,r,i,o)&&(!!this.isReadOnly||(this.isChecked||(this.isChecked=!0),!0))},t.AddRadioButtonWithHeader=function(e,n,r,i){var l=new a.StackPanel;l.isVertical=!1,l.height="30px";var c=new t;c.width="20px",c.height="20px",c.isChecked=r,c.color="green",c.group=n,c.onIsCheckedChangedObservable.add(function(e){return i(c,e)}),l.addControl(c);var u=new s.TextBlock;return u.text=e,u.width="180px",u.paddingLeft="5px",u.textHorizontalAlignment=o.Control.HORIZONTAL_ALIGNMENT_LEFT,u.color="white",l.addControl(u),l},Object(r.__decorate)([Object(i.serialize)()],t.prototype,"thickness",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"group",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"checkSizeRatio",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"background",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"isChecked",null),t}(o.Control);Object(i.RegisterClass)("BABYLON.GUI.RadioButton",l)},"./2D/controls/rectangle.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"Rectangle",function(){return a});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("./2D/controls/container.ts"),o=n("babylonjs/Misc/perfCounter"),a=function(e){function t(t){var n=e.call(this,t)||this;return n.name=t,n._thickness=1,n._cornerRadius=0,n}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"thickness",{get:function(){return this._thickness},set:function(e){this._thickness!==e&&(this._thickness=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cornerRadius",{get:function(){return this._cornerRadius},set:function(e){e<0&&(e=0),this._cornerRadius!==e&&(this._cornerRadius=e,this._markAsDirty())},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"Rectangle"},t.prototype._computeAdditionnalOffsetX=function(){return this._cornerRadius?1:0},t.prototype._computeAdditionnalOffsetY=function(){return this._cornerRadius?1:0},t.prototype._localDraw=function(e){e.save(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY),this._background&&(e.fillStyle="Button"===this.typeName?this.isEnabled?this._background:this.disabledColor:this._background,this._cornerRadius?(this._drawRoundedRect(e,this._thickness/2),e.fill()):e.fillRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height)),this._thickness&&((this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),this.color&&(e.strokeStyle=this.color),e.lineWidth=this._thickness,this._cornerRadius?(this._drawRoundedRect(e,this._thickness/2),e.stroke()):e.strokeRect(this._currentMeasure.left+this._thickness/2,this._currentMeasure.top+this._thickness/2,this._currentMeasure.width-this._thickness,this._currentMeasure.height-this._thickness)),e.restore()},t.prototype._additionalProcessing=function(t,n){e.prototype._additionalProcessing.call(this,t,n),this._measureForChildren.width-=2*this._thickness,this._measureForChildren.height-=2*this._thickness,this._measureForChildren.left+=this._thickness,this._measureForChildren.top+=this._thickness},t.prototype._drawRoundedRect=function(e,t){void 0===t&&(t=0);var n=this._currentMeasure.left+t,r=this._currentMeasure.top+t,i=this._currentMeasure.width-2*t,o=this._currentMeasure.height-2*t,a=Math.min(o/2-2,Math.min(i/2-2,this._cornerRadius));e.beginPath(),e.moveTo(n+a,r),e.lineTo(n+i-a,r),e.quadraticCurveTo(n+i,r,n+i,r+a),e.lineTo(n+i,r+o-a),e.quadraticCurveTo(n+i,r+o,n+i-a,r+o),e.lineTo(n+a,r+o),e.quadraticCurveTo(n,r+o,n,r+o-a),e.lineTo(n,r+a),e.quadraticCurveTo(n,r,n+a,r),e.closePath()},t.prototype._clipForChildren=function(e){this._cornerRadius&&(this._drawRoundedRect(e,this._thickness),e.clip())},Object(r.__decorate)([Object(o.serialize)()],t.prototype,"thickness",null),Object(r.__decorate)([Object(o.serialize)()],t.prototype,"cornerRadius",null),t}(i.Container);Object(o.RegisterClass)("BABYLON.GUI.Rectangle",a)},"./2D/controls/scrollViewers/scrollViewer.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"ScrollViewer",function(){return _});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("./2D/controls/rectangle.ts"),o=n("./2D/controls/grid.ts"),a=n("./2D/controls/control.ts"),s=n("./2D/controls/scrollViewers/scrollViewerWindow.ts"),l=n("./2D/controls/sliders/scrollBar.ts"),c=n("./2D/controls/sliders/imageScrollBar.ts"),u=n("babylonjs/Misc/perfCounter"),_=function(e){function t(t,n){var r=e.call(this,t)||this;return r._barSize=20,r._pointerIsOver=!1,r._wheelPrecision=.05,r._thumbLength=.5,r._thumbHeight=1,r._barImageHeight=1,r._horizontalBarImageHeight=1,r._verticalBarImageHeight=1,r._oldWindowContentsWidth=0,r._oldWindowContentsHeight=0,r._forceHorizontalBar=!1,r._forceVerticalBar=!1,r._useImageBar=n||!1,r.onDirtyObservable.add(function(){r._horizontalBarSpace.color=r.color,r._verticalBarSpace.color=r.color,r._dragSpace.color=r.color}),r.onPointerEnterObservable.add(function(){r._pointerIsOver=!0}),r.onPointerOutObservable.add(function(){r._pointerIsOver=!1}),r._grid=new o.Grid,r._useImageBar?(r._horizontalBar=new c.ImageScrollBar,r._verticalBar=new c.ImageScrollBar):(r._horizontalBar=new l.ScrollBar,r._verticalBar=new l.ScrollBar),r._window=new s._ScrollViewerWindow("scrollViewer_window"),r._window.horizontalAlignment=a.Control.HORIZONTAL_ALIGNMENT_LEFT,r._window.verticalAlignment=a.Control.VERTICAL_ALIGNMENT_TOP,r._grid.addColumnDefinition(1),r._grid.addColumnDefinition(0,!0),r._grid.addRowDefinition(1),r._grid.addRowDefinition(0,!0),e.prototype.addControl.call(r,r._grid),r._grid.addControl(r._window,0,0),r._verticalBarSpace=new i.Rectangle,r._verticalBarSpace.horizontalAlignment=a.Control.HORIZONTAL_ALIGNMENT_LEFT,r._verticalBarSpace.verticalAlignment=a.Control.VERTICAL_ALIGNMENT_TOP,r._verticalBarSpace.thickness=1,r._grid.addControl(r._verticalBarSpace,0,1),r._addBar(r._verticalBar,r._verticalBarSpace,!0,Math.PI),r._horizontalBarSpace=new i.Rectangle,r._horizontalBarSpace.horizontalAlignment=a.Control.HORIZONTAL_ALIGNMENT_LEFT,r._horizontalBarSpace.verticalAlignment=a.Control.VERTICAL_ALIGNMENT_TOP,r._horizontalBarSpace.thickness=1,r._grid.addControl(r._horizontalBarSpace,1,0),r._addBar(r._horizontalBar,r._horizontalBarSpace,!1,0),r._dragSpace=new i.Rectangle,r._dragSpace.thickness=1,r._grid.addControl(r._dragSpace,1,1),r._useImageBar||(r.barColor="grey",r.barBackground="transparent"),r}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"horizontalBar",{get:function(){return this._horizontalBar},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticalBar",{get:function(){return this._verticalBar},enumerable:!1,configurable:!0}),t.prototype.addControl=function(e){return e?(this._window.addControl(e),this):this},t.prototype.removeControl=function(e){return this._window.removeControl(e),this},Object.defineProperty(t.prototype,"children",{get:function(){return this._window.children},enumerable:!1,configurable:!0}),t.prototype._flagDescendantsAsMatrixDirty=function(){for(var e=0,t=this._children;e<t.length;e++){t[e]._markMatrixAsDirty()}},Object.defineProperty(t.prototype,"freezeControls",{get:function(){return this._window.freezeControls},set:function(e){this._window.freezeControls=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucketWidth",{get:function(){return this._window.bucketWidth},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucketHeight",{get:function(){return this._window.bucketHeight},enumerable:!1,configurable:!0}),t.prototype.setBucketSizes=function(e,t){this._window.setBucketSizes(e,t)},Object.defineProperty(t.prototype,"forceHorizontalBar",{get:function(){return this._forceHorizontalBar},set:function(e){this._grid.setRowDefinition(1,e?this._barSize:0,!0),this._horizontalBar.isVisible=e,this._forceHorizontalBar=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"forceVerticalBar",{get:function(){return this._forceVerticalBar},set:function(e){this._grid.setColumnDefinition(1,e?this._barSize:0,!0),this._verticalBar.isVisible=e,this._forceVerticalBar=e},enumerable:!1,configurable:!0}),t.prototype.resetWindow=function(){this._window.width="100%",this._window.height="100%"},t.prototype._getTypeName=function(){return"ScrollViewer"},t.prototype._buildClientSizes=function(){var e=this.host.idealRatio;this._window.parentClientWidth=this._currentMeasure.width-(this._verticalBar.isVisible||this.forceVerticalBar?this._barSize*e:0)-2*this.thickness,this._window.parentClientHeight=this._currentMeasure.height-(this._horizontalBar.isVisible||this.forceHorizontalBar?this._barSize*e:0)-2*this.thickness,this._clientWidth=this._window.parentClientWidth,this._clientHeight=this._window.parentClientHeight},t.prototype._additionalProcessing=function(t,n){e.prototype._additionalProcessing.call(this,t,n),this._buildClientSizes()},t.prototype._postMeasure=function(){e.prototype._postMeasure.call(this),this._updateScroller(),this._setWindowPosition(!1)},Object.defineProperty(t.prototype,"wheelPrecision",{get:function(){return this._wheelPrecision},set:function(e){this._wheelPrecision!==e&&(e<0&&(e=0),e>1&&(e=1),this._wheelPrecision=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scrollBackground",{get:function(){return this._horizontalBarSpace.background},set:function(e){this._horizontalBarSpace.background!==e&&(this._horizontalBarSpace.background=e,this._verticalBarSpace.background=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"barColor",{get:function(){return this._barColor},set:function(e){this._barColor!==e&&(this._barColor=e,this._horizontalBar.color=e,this._verticalBar.color=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thumbImage",{get:function(){return this._barImage},set:function(e){if(this._barImage!==e){this._barImage=e;var t=this._horizontalBar,n=this._verticalBar;t.thumbImage=e,n.thumbImage=e}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"horizontalThumbImage",{get:function(){return this._horizontalBarImage},set:function(e){this._horizontalBarImage!==e&&(this._horizontalBarImage=e,this._horizontalBar.thumbImage=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticalThumbImage",{get:function(){return this._verticalBarImage},set:function(e){this._verticalBarImage!==e&&(this._verticalBarImage=e,this._verticalBar.thumbImage=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"barSize",{get:function(){return this._barSize},set:function(e){this._barSize!==e&&(this._barSize=e,this._markAsDirty(),this._horizontalBar.isVisible&&this._grid.setRowDefinition(1,this._barSize,!0),this._verticalBar.isVisible&&this._grid.setColumnDefinition(1,this._barSize,!0))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thumbLength",{get:function(){return this._thumbLength},set:function(e){if(this._thumbLength!==e){e<=0&&(e=.1),e>1&&(e=1),this._thumbLength=e;var t=this._horizontalBar,n=this._verticalBar;t.thumbLength=e,n.thumbLength=e,this._markAsDirty()}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thumbHeight",{get:function(){return this._thumbHeight},set:function(e){if(this._thumbHeight!==e){e<=0&&(e=.1),e>1&&(e=1),this._thumbHeight=e;var t=this._horizontalBar,n=this._verticalBar;t.thumbHeight=e,n.thumbHeight=e,this._markAsDirty()}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"barImageHeight",{get:function(){return this._barImageHeight},set:function(e){if(this._barImageHeight!==e){e<=0&&(e=.1),e>1&&(e=1),this._barImageHeight=e;var t=this._horizontalBar,n=this._verticalBar;t.barImageHeight=e,n.barImageHeight=e,this._markAsDirty()}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"horizontalBarImageHeight",{get:function(){return this._horizontalBarImageHeight},set:function(e){this._horizontalBarImageHeight!==e&&(e<=0&&(e=.1),e>1&&(e=1),this._horizontalBarImageHeight=e,this._horizontalBar.barImageHeight=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticalBarImageHeight",{get:function(){return this._verticalBarImageHeight},set:function(e){this._verticalBarImageHeight!==e&&(e<=0&&(e=.1),e>1&&(e=1),this._verticalBarImageHeight=e,this._verticalBar.barImageHeight=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"barBackground",{get:function(){return this._barBackground},set:function(e){if(this._barBackground!==e){this._barBackground=e;var t=this._horizontalBar,n=this._verticalBar;t.background=e,n.background=e,this._dragSpace.background=e}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"barImage",{get:function(){return this._barBackgroundImage},set:function(e){this._barBackgroundImage,this._barBackgroundImage=e;var t=this._horizontalBar,n=this._verticalBar;t.backgroundImage=e,n.backgroundImage=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"horizontalBarImage",{get:function(){return this._horizontalBarBackgroundImage},set:function(e){this._horizontalBarBackgroundImage,this._horizontalBarBackgroundImage=e,this._horizontalBar.backgroundImage=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticalBarImage",{get:function(){return this._verticalBarBackgroundImage},set:function(e){this._verticalBarBackgroundImage,this._verticalBarBackgroundImage=e,this._verticalBar.backgroundImage=e},enumerable:!1,configurable:!0}),t.prototype._setWindowPosition=function(e){void 0===e&&(e=!0);var t=this.host.idealRatio,n=this._window._currentMeasure.width,r=this._window._currentMeasure.height;if(e||this._oldWindowContentsWidth!==n||this._oldWindowContentsHeight!==r){this._oldWindowContentsWidth=n,this._oldWindowContentsHeight=r;var i=this._clientWidth-n,o=this._clientHeight-r,a=this._horizontalBar.value/t*i+"px",s=this._verticalBar.value/t*o+"px";a!==this._window.left&&(this._window.left=a,this.freezeControls||(this._rebuildLayout=!0)),s!==this._window.top&&(this._window.top=s,this.freezeControls||(this._rebuildLayout=!0))}},t.prototype._updateScroller=function(){var e=this._window._currentMeasure.width,t=this._window._currentMeasure.height;this._horizontalBar.isVisible&&e<=this._clientWidth&&!this.forceHorizontalBar?(this._grid.setRowDefinition(1,0,!0),this._horizontalBar.isVisible=!1,this._horizontalBar.value=0,this._rebuildLayout=!0):!this._horizontalBar.isVisible&&(e>this._clientWidth||this.forceHorizontalBar)&&(this._grid.setRowDefinition(1,this._barSize,!0),this._horizontalBar.isVisible=!0,this._rebuildLayout=!0),this._verticalBar.isVisible&&t<=this._clientHeight&&!this.forceVerticalBar?(this._grid.setColumnDefinition(1,0,!0),this._verticalBar.isVisible=!1,this._verticalBar.value=0,this._rebuildLayout=!0):!this._verticalBar.isVisible&&(t>this._clientHeight||this.forceVerticalBar)&&(this._grid.setColumnDefinition(1,this._barSize,!0),this._verticalBar.isVisible=!0,this._rebuildLayout=!0),this._buildClientSizes();var n=this.host.idealRatio;this._horizontalBar.thumbWidth=.9*this._thumbLength*(this._clientWidth/n)+"px",this._verticalBar.thumbWidth=.9*this._thumbLength*(this._clientHeight/n)+"px"},t.prototype._link=function(t){e.prototype._link.call(this,t),this._attachWheel()},t.prototype._addBar=function(e,t,n,r){var i=this;e.paddingLeft=0,e.width="100%",e.height="100%",e.barOffset=0,e.value=0,e.maximum=1,e.horizontalAlignment=a.Control.HORIZONTAL_ALIGNMENT_CENTER,e.verticalAlignment=a.Control.VERTICAL_ALIGNMENT_CENTER,e.isVertical=n,e.rotation=r,e.isVisible=!1,t.addControl(e),e.onValueChangedObservable.add(function(e){i._setWindowPosition()})},t.prototype._attachWheel=function(){var e=this;this._host&&!this._onWheelObserver&&(this._onWheelObserver=this.onWheelObservable.add(function(t){e._pointerIsOver&&!e.isReadOnly&&(1==e._verticalBar.isVisible&&(t.y<0&&e._verticalBar.value>0?e._verticalBar.value-=e._wheelPrecision:t.y>0&&e._verticalBar.value<e._verticalBar.maximum&&(e._verticalBar.value+=e._wheelPrecision)),1==e._horizontalBar.isVisible&&(t.x<0&&e._horizontalBar.value<e._horizontalBar.maximum?e._horizontalBar.value+=e._wheelPrecision:t.x>0&&e._horizontalBar.value>0&&(e._horizontalBar.value-=e._wheelPrecision)))}))},t.prototype._renderHighlightSpecific=function(t){this.isHighlighted&&(e.prototype._renderHighlightSpecific.call(this,t),this._grid._renderHighlightSpecific(t),t.restore())},t.prototype.dispose=function(){this.onWheelObservable.remove(this._onWheelObserver),this._onWheelObserver=null,e.prototype.dispose.call(this)},t}(i.Rectangle);Object(u.RegisterClass)("BABYLON.GUI.ScrollViewer",_)},"./2D/controls/scrollViewers/scrollViewerWindow.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"_ScrollViewerWindow",function(){return l});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("./2D/measure.ts"),o=n("./2D/controls/container.ts"),a=n("./2D/valueAndUnit.ts"),s=n("./2D/controls/control.ts"),l=function(e){function t(t){var n=e.call(this,t)||this;return n._freezeControls=!1,n._bucketWidth=0,n._bucketHeight=0,n._buckets={},n}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"freezeControls",{get:function(){return this._freezeControls},set:function(e){if(this._freezeControls!==e){e||this._restoreMeasures(),this._freezeControls=!1;var t=this.host.getSize(),n=t.width,r=t.height,o=this.host.getContext(),a=new i.Measure(0,0,n,r);this.host._numLayoutCalls=0,this.host._rootContainer._layout(a,o),e&&(this._updateMeasures(),this._useBuckets()&&this._makeBuckets()),this._freezeControls=e,this.host.markAsDirty()}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucketWidth",{get:function(){return this._bucketWidth},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucketHeight",{get:function(){return this._bucketHeight},enumerable:!1,configurable:!0}),t.prototype.setBucketSizes=function(e,t){this._bucketWidth=e,this._bucketHeight=t,this._useBuckets()?this._freezeControls&&this._makeBuckets():this._buckets={}},t.prototype._useBuckets=function(){return this._bucketWidth>0&&this._bucketHeight>0},t.prototype._makeBuckets=function(){this._buckets={},this._bucketLen=Math.ceil(this.widthInPixels/this._bucketWidth),this._dispatchInBuckets(this._children),this._oldLeft=null,this._oldTop=null},t.prototype._dispatchInBuckets=function(e){for(var t=0;t<e.length;++t){for(var n=e[t],r=Math.max(0,Math.floor((n._customData._origLeft-this._customData.origLeft)/this._bucketWidth)),i=Math.floor((n._customData._origLeft-this._customData.origLeft+n._currentMeasure.width-1)/this._bucketWidth),a=Math.max(0,Math.floor((n._customData._origTop-this._customData.origTop)/this._bucketHeight)),s=Math.floor((n._customData._origTop-this._customData.origTop+n._currentMeasure.height-1)/this._bucketHeight);a<=s;){for(var l=r;l<=i;++l){var c=a*this._bucketLen+l,u=this._buckets[c];u||(u=[],this._buckets[c]=u),u.push(n)}a++}n instanceof o.Container&&n._children.length>0&&this._dispatchInBuckets(n._children)}},t.prototype._updateMeasures=function(){var e=0|this.leftInPixels,t=0|this.topInPixels;this._measureForChildren.left-=e,this._measureForChildren.top-=t,this._currentMeasure.left-=e,this._currentMeasure.top-=t,this._customData.origLeftForChildren=this._measureForChildren.left,this._customData.origTopForChildren=this._measureForChildren.top,this._customData.origLeft=this._currentMeasure.left,this._customData.origTop=this._currentMeasure.top,this._updateChildrenMeasures(this._children,e,t)},t.prototype._updateChildrenMeasures=function(e,t,n){for(var r=0;r<e.length;++r){var i=e[r];i._currentMeasure.left-=t,i._currentMeasure.top-=n,i._customData._origLeft=i._currentMeasure.left,i._customData._origTop=i._currentMeasure.top,i instanceof o.Container&&i._children.length>0&&this._updateChildrenMeasures(i._children,t,n)}},t.prototype._restoreMeasures=function(){var e=0|this.leftInPixels,t=0|this.topInPixels;this._measureForChildren.left=this._customData.origLeftForChildren+e,this._measureForChildren.top=this._customData.origTopForChildren+t,this._currentMeasure.left=this._customData.origLeft+e,this._currentMeasure.top=this._customData.origTop+t},t.prototype._getTypeName=function(){return"ScrollViewerWindow"},t.prototype._additionalProcessing=function(t,n){e.prototype._additionalProcessing.call(this,t,n),this._parentMeasure=t,this._measureForChildren.left=this._currentMeasure.left,this._measureForChildren.top=this._currentMeasure.top,this._measureForChildren.width=t.width,this._measureForChildren.height=t.height},t.prototype._layout=function(t,n){return this._freezeControls?(this.invalidateRect(),!1):e.prototype._layout.call(this,t,n)},t.prototype._scrollChildren=function(e,t,n){for(var r=0;r<e.length;++r){var i=e[r];i._currentMeasure.left=i._customData._origLeft+t,i._currentMeasure.top=i._customData._origTop+n,i._isClipped=!1,i instanceof o.Container&&i._children.length>0&&this._scrollChildren(i._children,t,n)}},t.prototype._scrollChildrenWithBuckets=function(e,t,n,r){for(var i=Math.max(0,Math.floor(-e/this._bucketWidth)),o=Math.floor((-e+this._parentMeasure.width-1)/this._bucketWidth),a=Math.max(0,Math.floor(-t/this._bucketHeight)),s=Math.floor((-t+this._parentMeasure.height-1)/this._bucketHeight);a<=s;){for(var l=i;l<=o;++l){var c=a*this._bucketLen+l,u=this._buckets[c];if(u)for(var _=0;_<u.length;++_){var h=u[_];h._currentMeasure.left=h._customData._origLeft+n,h._currentMeasure.top=h._customData._origTop+r,h._isClipped=!1}}a++}},t.prototype._draw=function(t,n){if(this._freezeControls){this._localDraw(t),this.clipChildren&&this._clipForChildren(t);var r=0|this.leftInPixels,i=0|this.topInPixels;this._useBuckets()&&null!==this._oldLeft&&null!==this._oldTop?(this._scrollChildrenWithBuckets(this._oldLeft,this._oldTop,r,i),this._scrollChildrenWithBuckets(r,i,r,i)):this._scrollChildren(this._children,r,i),this._oldLeft=r,this._oldTop=i;for(var o=0,a=this._children;o<a.length;o++){var s=a[o];s._intersectsRect(this._parentMeasure)&&s._render(t,this._parentMeasure)}}else e.prototype._draw.call(this,t,n)},t.prototype._postMeasure=function(){if(this._freezeControls)e.prototype._postMeasure.call(this);else{for(var t=this.parentClientWidth,n=this.parentClientHeight,r=0,i=this.children;r<i.length;r++){var o=i[r];o.isVisible&&!o.notRenderable&&(o.horizontalAlignment===s.Control.HORIZONTAL_ALIGNMENT_CENTER&&o._offsetLeft(this._currentMeasure.left-o._currentMeasure.left),o.verticalAlignment===s.Control.VERTICAL_ALIGNMENT_CENTER&&o._offsetTop(this._currentMeasure.top-o._currentMeasure.top),t=Math.max(t,o._currentMeasure.left-this._currentMeasure.left+o._currentMeasure.width+o.paddingRightInPixels),n=Math.max(n,o._currentMeasure.top-this._currentMeasure.top+o._currentMeasure.height+o.paddingBottomInPixels))}this._currentMeasure.width!==t&&(this._width.updateInPlace(t,a.ValueAndUnit.UNITMODE_PIXEL),this._currentMeasure.width=t,this._rebuildLayout=!0,this._isDirty=!0),this._currentMeasure.height!==n&&(this._height.updateInPlace(n,a.ValueAndUnit.UNITMODE_PIXEL),this._currentMeasure.height=n,this._rebuildLayout=!0,this._isDirty=!0),e.prototype._postMeasure.call(this)}},t}(o.Container)},"./2D/controls/selector.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"SelectorGroup",function(){return h}),n.d(t,"CheckboxGroup",function(){return f}),n.d(t,"RadioGroup",function(){return d}),n.d(t,"SliderGroup",function(){return p}),n.d(t,"SelectionPanel",function(){return m});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("./2D/controls/rectangle.ts"),o=n("./2D/controls/stackPanel.ts"),a=n("./2D/controls/control.ts"),s=n("./2D/controls/textBlock.ts"),l=n("./2D/controls/checkbox.ts"),c=n("./2D/controls/radioButton.ts"),u=n("./2D/controls/sliders/slider.ts"),_=n("./2D/controls/container.ts"),h=function(){function e(e){this.name=e,this._groupPanel=new o.StackPanel,this._selectors=new Array,this._groupPanel.verticalAlignment=a.Control.VERTICAL_ALIGNMENT_TOP,this._groupPanel.horizontalAlignment=a.Control.HORIZONTAL_ALIGNMENT_LEFT,this._groupHeader=this._addGroupHeader(e)}return Object.defineProperty(e.prototype,"groupPanel",{get:function(){return this._groupPanel},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectors",{get:function(){return this._selectors},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"header",{get:function(){return this._groupHeader.text},set:function(e){"label"!==this._groupHeader.text&&(this._groupHeader.text=e)},enumerable:!1,configurable:!0}),e.prototype._addGroupHeader=function(e){var t=new s.TextBlock("groupHead",e);return t.width=.9,t.height="30px",t.textWrapping=!0,t.color="black",t.horizontalAlignment=a.Control.HORIZONTAL_ALIGNMENT_LEFT,t.textHorizontalAlignment=a.Control.HORIZONTAL_ALIGNMENT_LEFT,t.left="2px",this._groupPanel.addControl(t),t},e.prototype._getSelector=function(e){if(!(e<0||e>=this._selectors.length))return this._selectors[e]},e.prototype.removeSelector=function(e){e<0||e>=this._selectors.length||(this._groupPanel.removeControl(this._selectors[e]),this._selectors.splice(e,1))},e}(),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.addCheckbox=function(e,t,n){void 0===t&&(t=function(e){}),void 0===n&&(n=!1);n=n||!1;var r=new l.Checkbox;r.width="20px",r.height="20px",r.color="#364249",r.background="#CCCCCC",r.horizontalAlignment=a.Control.HORIZONTAL_ALIGNMENT_LEFT,r.onIsCheckedChangedObservable.add(function(e){t(e)});var i=a.Control.AddHeader(r,e,"200px",{isHorizontal:!0,controlFirst:!0});i.height="30px",i.horizontalAlignment=a.Control.HORIZONTAL_ALIGNMENT_LEFT,i.left="4px",this.groupPanel.addControl(i),this.selectors.push(i),r.isChecked=n,this.groupPanel.parent&&this.groupPanel.parent.parent&&(r.color=this.groupPanel.parent.parent.buttonColor,r.background=this.groupPanel.parent.parent.buttonBackground)},t.prototype._setSelectorLabel=function(e,t){this.selectors[e].children[1].text=t},t.prototype._setSelectorLabelColor=function(e,t){this.selectors[e].children[1].color=t},t.prototype._setSelectorButtonColor=function(e,t){this.selectors[e].children[0].color=t},t.prototype._setSelectorButtonBackground=function(e,t){this.selectors[e].children[0].background=t},t}(h),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._selectNb=0,t}return Object(r.__extends)(t,e),t.prototype.addRadio=function(e,t,n){void 0===t&&(t=function(e){}),void 0===n&&(n=!1);var r=this._selectNb++,i=new c.RadioButton;i.name=e,i.width="20px",i.height="20px",i.color="#364249",i.background="#CCCCCC",i.group=this.name,i.horizontalAlignment=a.Control.HORIZONTAL_ALIGNMENT_LEFT,i.onIsCheckedChangedObservable.add(function(e){e&&t(r)});var o=a.Control.AddHeader(i,e,"200px",{isHorizontal:!0,controlFirst:!0});o.height="30px",o.horizontalAlignment=a.Control.HORIZONTAL_ALIGNMENT_LEFT,o.left="4px",this.groupPanel.addControl(o),this.selectors.push(o),i.isChecked=n,this.groupPanel.parent&&this.groupPanel.parent.parent&&(i.color=this.groupPanel.parent.parent.buttonColor,i.background=this.groupPanel.parent.parent.buttonBackground)},t.prototype._setSelectorLabel=function(e,t){this.selectors[e].children[1].text=t},t.prototype._setSelectorLabelColor=function(e,t){this.selectors[e].children[1].color=t},t.prototype._setSelectorButtonColor=function(e,t){this.selectors[e].children[0].color=t},t.prototype._setSelectorButtonBackground=function(e,t){this.selectors[e].children[0].background=t},t}(h),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.addSlider=function(e,t,n,r,i,o,s){void 0===t&&(t=function(e){}),void 0===n&&(n="Units"),void 0===r&&(r=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=function(e){return 0|e});var l=new u.Slider;l.name=n,l.value=o,l.minimum=r,l.maximum=i,l.width=.9,l.height="20px",l.color="#364249",l.background="#CCCCCC",l.borderColor="black",l.horizontalAlignment=a.Control.HORIZONTAL_ALIGNMENT_LEFT,l.left="4px",l.paddingBottom="4px",l.onValueChangedObservable.add(function(e){l.parent.children[0].text=l.parent.children[0].name+": "+s(e)+" "+l.name,t(e)});var c=a.Control.AddHeader(l,e+": "+s(o)+" "+n,"30px",{isHorizontal:!1,controlFirst:!1});c.height="60px",c.horizontalAlignment=a.Control.HORIZONTAL_ALIGNMENT_LEFT,c.left="4px",c.children[0].name=e,this.groupPanel.addControl(c),this.selectors.push(c),this.groupPanel.parent&&this.groupPanel.parent.parent&&(l.color=this.groupPanel.parent.parent.buttonColor,l.background=this.groupPanel.parent.parent.buttonBackground)},t.prototype._setSelectorLabel=function(e,t){this.selectors[e].children[0].name=t,this.selectors[e].children[0].text=t+": "+this.selectors[e].children[1].value+" "+this.selectors[e].children[1].name},t.prototype._setSelectorLabelColor=function(e,t){this.selectors[e].children[0].color=t},t.prototype._setSelectorButtonColor=function(e,t){this.selectors[e].children[1].color=t},t.prototype._setSelectorButtonBackground=function(e,t){this.selectors[e].children[1].background=t},t}(h),m=function(e){function t(t,n){void 0===n&&(n=[]);var r=e.call(this,t)||this;if(r.name=t,r.groups=n,r._buttonColor="#364249",r._buttonBackground="#CCCCCC",r._headerColor="black",r._barColor="white",r._barHeight="2px",r._spacerHeight="20px",r._bars=new Array,r._groups=n,r.thickness=2,r._panel=new o.StackPanel,r._panel.verticalAlignment=a.Control.VERTICAL_ALIGNMENT_TOP,r._panel.horizontalAlignment=a.Control.HORIZONTAL_ALIGNMENT_LEFT,r._panel.top=5,r._panel.left=5,r._panel.width=.95,n.length>0){for(var i=0;i<n.length-1;i++)r._panel.addControl(n[i].groupPanel),r._addSpacer();r._panel.addControl(n[n.length-1].groupPanel)}return r.addControl(r._panel),r}return Object(r.__extends)(t,e),t.prototype._getTypeName=function(){return"SelectionPanel"},Object.defineProperty(t.prototype,"panel",{get:function(){return this._panel},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"headerColor",{get:function(){return this._headerColor},set:function(e){this._headerColor!==e&&(this._headerColor=e,this._setHeaderColor())},enumerable:!1,configurable:!0}),t.prototype._setHeaderColor=function(){for(var e=0;e<this._groups.length;e++)this._groups[e].groupPanel.children[0].color=this._headerColor},Object.defineProperty(t.prototype,"buttonColor",{get:function(){return this._buttonColor},set:function(e){this._buttonColor!==e&&(this._buttonColor=e,this._setbuttonColor())},enumerable:!1,configurable:!0}),t.prototype._setbuttonColor=function(){for(var e=0;e<this._groups.length;e++)for(var t=0;t<this._groups[e].selectors.length;t++)this._groups[e]._setSelectorButtonColor(t,this._buttonColor)},Object.defineProperty(t.prototype,"labelColor",{get:function(){return this._labelColor},set:function(e){this._labelColor!==e&&(this._labelColor=e,this._setLabelColor())},enumerable:!1,configurable:!0}),t.prototype._setLabelColor=function(){for(var e=0;e<this._groups.length;e++)for(var t=0;t<this._groups[e].selectors.length;t++)this._groups[e]._setSelectorLabelColor(t,this._labelColor)},Object.defineProperty(t.prototype,"buttonBackground",{get:function(){return this._buttonBackground},set:function(e){this._buttonBackground!==e&&(this._buttonBackground=e,this._setButtonBackground())},enumerable:!1,configurable:!0}),t.prototype._setButtonBackground=function(){for(var e=0;e<this._groups.length;e++)for(var t=0;t<this._groups[e].selectors.length;t++)this._groups[e]._setSelectorButtonBackground(t,this._buttonBackground)},Object.defineProperty(t.prototype,"barColor",{get:function(){return this._barColor},set:function(e){this._barColor!==e&&(this._barColor=e,this._setBarColor())},enumerable:!1,configurable:!0}),t.prototype._setBarColor=function(){for(var e=0;e<this._bars.length;e++)this._bars[e].children[0].background=this._barColor},Object.defineProperty(t.prototype,"barHeight",{get:function(){return this._barHeight},set:function(e){this._barHeight!==e&&(this._barHeight=e,this._setBarHeight())},enumerable:!1,configurable:!0}),t.prototype._setBarHeight=function(){for(var e=0;e<this._bars.length;e++)this._bars[e].children[0].height=this._barHeight},Object.defineProperty(t.prototype,"spacerHeight",{get:function(){return this._spacerHeight},set:function(e){this._spacerHeight!==e&&(this._spacerHeight=e,this._setSpacerHeight())},enumerable:!1,configurable:!0}),t.prototype._setSpacerHeight=function(){for(var e=0;e<this._bars.length;e++)this._bars[e].height=this._spacerHeight},t.prototype._addSpacer=function(){var e=new _.Container;e.width=1,e.height=this._spacerHeight,e.horizontalAlignment=a.Control.HORIZONTAL_ALIGNMENT_LEFT;var t=new i.Rectangle;t.width=1,t.height=this._barHeight,t.horizontalAlignment=a.Control.HORIZONTAL_ALIGNMENT_LEFT,t.verticalAlignment=a.Control.VERTICAL_ALIGNMENT_CENTER,t.background=this._barColor,t.color="transparent",e.addControl(t),this._panel.addControl(e),this._bars.push(e)},t.prototype.addGroup=function(e){this._groups.length>0&&this._addSpacer(),this._panel.addControl(e.groupPanel),this._groups.push(e),e.groupPanel.children[0].color=this._headerColor;for(var t=0;t<e.selectors.length;t++)e._setSelectorButtonColor(t,this._buttonColor),e._setSelectorButtonBackground(t,this._buttonBackground)},t.prototype.removeGroup=function(e){if(!(e<0||e>=this._groups.length)){var t=this._groups[e];this._panel.removeControl(t.groupPanel),this._groups.splice(e,1),e<this._bars.length&&(this._panel.removeControl(this._bars[e]),this._bars.splice(e,1))}},t.prototype.setHeaderName=function(e,t){t<0||t>=this._groups.length||(this._groups[t].groupPanel.children[0].text=e)},t.prototype.relabel=function(e,t,n){if(!(t<0||t>=this._groups.length)){var r=this._groups[t];n<0||n>=r.selectors.length||r._setSelectorLabel(n,e)}},t.prototype.removeFromGroupSelector=function(e,t){if(!(e<0||e>=this._groups.length)){var n=this._groups[e];t<0||t>=n.selectors.length||n.removeSelector(t)}},t.prototype.addToGroupCheckbox=function(e,t,n,r){(void 0===n&&(n=function(){}),void 0===r&&(r=!1),e<0||e>=this._groups.length)||this._groups[e].addCheckbox(t,n,r)},t.prototype.addToGroupRadio=function(e,t,n,r){(void 0===n&&(n=function(){}),void 0===r&&(r=!1),e<0||e>=this._groups.length)||this._groups[e].addRadio(t,n,r)},t.prototype.addToGroupSlider=function(e,t,n,r,i,o,a,s){(void 0===n&&(n=function(){}),void 0===r&&(r="Units"),void 0===i&&(i=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===s&&(s=function(e){return 0|e}),e<0||e>=this._groups.length)||this._groups[e].addSlider(t,n,r,i,o,a,s)},t}(i.Rectangle)},"./2D/controls/sliders/baseSlider.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"BaseSlider",function(){return s});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=n("./2D/controls/control.ts"),a=n("./2D/valueAndUnit.ts"),s=function(e){function t(t){var n=e.call(this,t)||this;return n.name=t,n._thumbWidth=new a.ValueAndUnit(20,a.ValueAndUnit.UNITMODE_PIXEL,!1),n._minimum=0,n._maximum=100,n._value=50,n._isVertical=!1,n._barOffset=new a.ValueAndUnit(5,a.ValueAndUnit.UNITMODE_PIXEL,!1),n._isThumbClamped=!1,n._displayThumb=!0,n._step=0,n._lastPointerDownId=-1,n._effectiveBarOffset=0,n.onValueChangedObservable=new i.Observable,n._pointerIsDown=!1,n.isPointerBlocker=!0,n}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"displayThumb",{get:function(){return this._displayThumb},set:function(e){this._displayThumb!==e&&(this._displayThumb=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"step",{get:function(){return this._step},set:function(e){this._step!==e&&(this._step=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"barOffset",{get:function(){return this._barOffset.toString(this._host)},set:function(e){this._barOffset.toString(this._host)!==e&&this._barOffset.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"barOffsetInPixels",{get:function(){return this._barOffset.getValueInPixel(this._host,this._cachedParentMeasure.width)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thumbWidth",{get:function(){return this._thumbWidth.toString(this._host)},set:function(e){this._thumbWidth.toString(this._host)!==e&&this._thumbWidth.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thumbWidthInPixels",{get:function(){return this._thumbWidth.getValueInPixel(this._host,this._cachedParentMeasure.width)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minimum",{get:function(){return this._minimum},set:function(e){this._minimum!==e&&(this._minimum=e,this._markAsDirty(),this.value=Math.max(Math.min(this.value,this._maximum),this._minimum))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maximum",{get:function(){return this._maximum},set:function(e){this._maximum!==e&&(this._maximum=e,this._markAsDirty(),this.value=Math.max(Math.min(this.value,this._maximum),this._minimum))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){e=Math.max(Math.min(e,this._maximum),this._minimum),this._value!==e&&(this._value=e,this._markAsDirty(),this.onValueChangedObservable.notifyObservers(this._value))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isVertical",{get:function(){return this._isVertical},set:function(e){this._isVertical!==e&&(this._isVertical=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isThumbClamped",{get:function(){return this._isThumbClamped},set:function(e){this._isThumbClamped!==e&&(this._isThumbClamped=e,this._markAsDirty())},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"BaseSlider"},t.prototype._getThumbPosition=function(){return this.isVertical?(this.maximum-this.value)/(this.maximum-this.minimum)*this._backgroundBoxLength:(this.value-this.minimum)/(this.maximum-this.minimum)*this._backgroundBoxLength},t.prototype._getThumbThickness=function(e){var t=0;switch(e){case"circle":t=this._thumbWidth.isPixel?Math.max(this._thumbWidth.getValue(this._host),this._backgroundBoxThickness):this._backgroundBoxThickness*this._thumbWidth.getValue(this._host);break;case"rectangle":t=this._thumbWidth.isPixel?Math.min(this._thumbWidth.getValue(this._host),this._backgroundBoxThickness):this._backgroundBoxThickness*this._thumbWidth.getValue(this._host)}return t},t.prototype._prepareRenderingData=function(e){this._effectiveBarOffset=0,this._renderLeft=this._currentMeasure.left,this._renderTop=this._currentMeasure.top,this._renderWidth=this._currentMeasure.width,this._renderHeight=this._currentMeasure.height,this._backgroundBoxLength=Math.max(this._currentMeasure.width,this._currentMeasure.height),this._backgroundBoxThickness=Math.min(this._currentMeasure.width,this._currentMeasure.height),this._effectiveThumbThickness=this._getThumbThickness(e),this.displayThumb&&(this._backgroundBoxLength-=this._effectiveThumbThickness),this.isVertical&&this._currentMeasure.height<this._currentMeasure.width?console.error("Height should be greater than width"):(this._barOffset.isPixel?this._effectiveBarOffset=Math.min(this._barOffset.getValue(this._host),this._backgroundBoxThickness):this._effectiveBarOffset=this._backgroundBoxThickness*this._barOffset.getValue(this._host),this._backgroundBoxThickness-=2*this._effectiveBarOffset,this.isVertical?(this._renderLeft+=this._effectiveBarOffset,!this.isThumbClamped&&this.displayThumb&&(this._renderTop+=this._effectiveThumbThickness/2),this._renderHeight=this._backgroundBoxLength,this._renderWidth=this._backgroundBoxThickness):(this._renderTop+=this._effectiveBarOffset,!this.isThumbClamped&&this.displayThumb&&(this._renderLeft+=this._effectiveThumbThickness/2),this._renderHeight=this._backgroundBoxThickness,this._renderWidth=this._backgroundBoxLength))},t.prototype._updateValueFromPointer=function(e,t){var n;0!=this.rotation&&(this._invertTransformMatrix.transformCoordinates(e,t,this._transformedPosition),e=this._transformedPosition.x,t=this._transformedPosition.y),n=this._isVertical?this._minimum+(1-(t-this._currentMeasure.top)/this._currentMeasure.height)*(this._maximum-this._minimum):this._minimum+(e-this._currentMeasure.left)/this._currentMeasure.width*(this._maximum-this._minimum),this.value=this._step?(n/this._step|0)*this._step:n},t.prototype._onPointerDown=function(t,n,r,i,o){return!!e.prototype._onPointerDown.call(this,t,n,r,i,o)&&(!!this.isReadOnly||(this._pointerIsDown=!0,this._updateValueFromPointer(n.x,n.y),this._host._capturingControl[r]=this,this._lastPointerDownId=r,!0))},t.prototype._onPointerMove=function(t,n,r,i){r==this._lastPointerDownId&&(this._pointerIsDown&&!this.isReadOnly&&this._updateValueFromPointer(n.x,n.y),e.prototype._onPointerMove.call(this,t,n,r,i))},t.prototype._onPointerUp=function(t,n,r,i,o){this._pointerIsDown=!1,delete this._host._capturingControl[r],e.prototype._onPointerUp.call(this,t,n,r,i,o)},t.prototype._onCanvasBlur=function(){this._forcePointerUp(),e.prototype._onCanvasBlur.call(this)},Object(r.__decorate)([Object(i.serialize)()],t.prototype,"displayThumb",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"step",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"barOffset",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"thumbWidth",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"minimum",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"maximum",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"value",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"isVertical",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"isThumbClamped",null),t}(o.Control)},"./2D/controls/sliders/imageBasedSlider.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"ImageBasedSlider",function(){return l});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("./2D/controls/sliders/baseSlider.ts"),o=n("./2D/measure.ts"),a=n("./2D/controls/image.ts"),s=n("babylonjs/Misc/perfCounter"),l=function(e){function t(t){var n=e.call(this,t)||this;return n.name=t,n._tempMeasure=new o.Measure(0,0,0,0),n}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"displayThumb",{get:function(){return this._displayThumb&&null!=this.thumbImage},set:function(e){this._displayThumb!==e&&(this._displayThumb=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"backgroundImage",{get:function(){return this._backgroundImage},set:function(e){var t=this;this._backgroundImage!==e&&(this._backgroundImage=e,e&&!e.isLoaded&&e.onImageLoadedObservable.addOnce(function(){return t._markAsDirty()}),this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"valueBarImage",{get:function(){return this._valueBarImage},set:function(e){var t=this;this._valueBarImage!==e&&(this._valueBarImage=e,e&&!e.isLoaded&&e.onImageLoadedObservable.addOnce(function(){return t._markAsDirty()}),this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thumbImage",{get:function(){return this._thumbImage},set:function(e){var t=this;this._thumbImage!==e&&(this._thumbImage=e,e&&!e.isLoaded&&e.onImageLoadedObservable.addOnce(function(){return t._markAsDirty()}),this._markAsDirty())},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"ImageBasedSlider"},t.prototype._draw=function(e,t){e.save(),this._applyStates(e),this._prepareRenderingData("rectangle");var n=this._getThumbPosition(),r=this._renderLeft,i=this._renderTop,o=this._renderWidth,a=this._renderHeight;this._backgroundImage&&(this._tempMeasure.copyFromFloats(r,i,o,a),this.isThumbClamped&&this.displayThumb&&(this.isVertical?this._tempMeasure.height+=this._effectiveThumbThickness:this._tempMeasure.width+=this._effectiveThumbThickness),this._backgroundImage._currentMeasure.copyFrom(this._tempMeasure),this._backgroundImage._draw(e)),this._valueBarImage&&(this.isVertical?this.isThumbClamped&&this.displayThumb?this._tempMeasure.copyFromFloats(r,i+n,o,a-n+this._effectiveThumbThickness):this._tempMeasure.copyFromFloats(r,i+n,o,a-n):this.isThumbClamped&&this.displayThumb?this._tempMeasure.copyFromFloats(r,i,n+this._effectiveThumbThickness/2,a):this._tempMeasure.copyFromFloats(r,i,n,a),this._valueBarImage._currentMeasure.copyFrom(this._tempMeasure),this._valueBarImage._draw(e)),this.displayThumb&&(this.isVertical?this._tempMeasure.copyFromFloats(r-this._effectiveBarOffset,this._currentMeasure.top+n,this._currentMeasure.width,this._effectiveThumbThickness):this._tempMeasure.copyFromFloats(this._currentMeasure.left+n,this._currentMeasure.top,this._effectiveThumbThickness,this._currentMeasure.height),this._thumbImage._currentMeasure.copyFrom(this._tempMeasure),this._thumbImage._draw(e)),e.restore()},t.prototype.serialize=function(t){e.prototype.serialize.call(this,t);var n={},r={},i={};this.backgroundImage.serialize(n),this.thumbImage.serialize(r),this.valueBarImage.serialize(i),t.backgroundImage=n,t.thumbImage=r,t.valueBarImage=i},t.prototype._parseFromContent=function(t,n){e.prototype._parseFromContent.call(this,t,n),this.backgroundImage=a.Image.Parse(t.backgroundImage,n),this.thumbImage=a.Image.Parse(t.thumbImage,n),this.valueBarImage=a.Image.Parse(t.valueBarImage,n)},Object(r.__decorate)([Object(s.serialize)()],t.prototype,"displayThumb",null),t}(i.BaseSlider);Object(s.RegisterClass)("BABYLON.GUI.ImageBasedSlider",l)},"./2D/controls/sliders/imageScrollBar.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"ImageScrollBar",function(){return s});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("./2D/controls/sliders/baseSlider.ts"),o=n("./2D/measure.ts"),a=n("babylonjs/Misc/perfCounter"),s=function(e){function t(t){var n=e.call(this,t)||this;return n.name=t,n._thumbLength=.5,n._thumbHeight=1,n._barImageHeight=1,n._tempMeasure=new o.Measure(0,0,0,0),n.num90RotationInVerticalMode=1,n}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"backgroundImage",{get:function(){return this._backgroundBaseImage},set:function(e){var t=this;this._backgroundBaseImage!==e&&(this._backgroundBaseImage=e,this.isVertical&&0!==this.num90RotationInVerticalMode?e.isLoaded?(this._backgroundImage=e._rotate90(this.num90RotationInVerticalMode,!0),this._markAsDirty()):e.onImageLoadedObservable.addOnce(function(){var n=e._rotate90(t.num90RotationInVerticalMode,!0);t._backgroundImage=n,n.isLoaded||n.onImageLoadedObservable.addOnce(function(){t._markAsDirty()}),t._markAsDirty()}):(this._backgroundImage=e,e&&!e.isLoaded&&e.onImageLoadedObservable.addOnce(function(){t._markAsDirty()}),this._markAsDirty()))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thumbImage",{get:function(){return this._thumbBaseImage},set:function(e){var t=this;this._thumbBaseImage!==e&&(this._thumbBaseImage=e,this.isVertical&&0!==this.num90RotationInVerticalMode?e.isLoaded?(this._thumbImage=e._rotate90(-this.num90RotationInVerticalMode,!0),this._markAsDirty()):e.onImageLoadedObservable.addOnce(function(){var n=e._rotate90(-t.num90RotationInVerticalMode,!0);t._thumbImage=n,n.isLoaded||n.onImageLoadedObservable.addOnce(function(){t._markAsDirty()}),t._markAsDirty()}):(this._thumbImage=e,e&&!e.isLoaded&&e.onImageLoadedObservable.addOnce(function(){t._markAsDirty()}),this._markAsDirty()))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thumbLength",{get:function(){return this._thumbLength},set:function(e){this._thumbLength!==e&&(this._thumbLength=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thumbHeight",{get:function(){return this._thumbHeight},set:function(e){this._thumbLength!==e&&(this._thumbHeight=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"barImageHeight",{get:function(){return this._barImageHeight},set:function(e){this._barImageHeight!==e&&(this._barImageHeight=e,this._markAsDirty())},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"ImageScrollBar"},t.prototype._getThumbThickness=function(){return this._thumbWidth.isPixel?this._thumbWidth.getValue(this._host):this._backgroundBoxThickness*this._thumbWidth.getValue(this._host)},t.prototype._draw=function(e){e.save(),this._applyStates(e),this._prepareRenderingData("rectangle");var t=this._getThumbPosition(),n=this._renderLeft,r=this._renderTop,i=this._renderWidth,o=this._renderHeight;this._backgroundImage&&(this._tempMeasure.copyFromFloats(n,r,i,o),this.isVertical?(this._tempMeasure.copyFromFloats(n+i*(1-this._barImageHeight)*.5,this._currentMeasure.top,i*this._barImageHeight,o),this._tempMeasure.height+=this._effectiveThumbThickness,this._backgroundImage._currentMeasure.copyFrom(this._tempMeasure)):(this._tempMeasure.copyFromFloats(this._currentMeasure.left,r+o*(1-this._barImageHeight)*.5,i,o*this._barImageHeight),this._tempMeasure.width+=this._effectiveThumbThickness,this._backgroundImage._currentMeasure.copyFrom(this._tempMeasure)),this._backgroundImage._draw(e)),this.isVertical?this._tempMeasure.copyFromFloats(n-this._effectiveBarOffset+this._currentMeasure.width*(1-this._thumbHeight)*.5,this._currentMeasure.top+t,this._currentMeasure.width*this._thumbHeight,this._effectiveThumbThickness):this._tempMeasure.copyFromFloats(this._currentMeasure.left+t,this._currentMeasure.top+this._currentMeasure.height*(1-this._thumbHeight)*.5,this._effectiveThumbThickness,this._currentMeasure.height*this._thumbHeight),this._thumbImage&&(this._thumbImage._currentMeasure.copyFrom(this._tempMeasure),this._thumbImage._draw(e)),e.restore()},t.prototype._updateValueFromPointer=function(e,t){0!=this.rotation&&(this._invertTransformMatrix.transformCoordinates(e,t,this._transformedPosition),e=this._transformedPosition.x,t=this._transformedPosition.y),this._first&&(this._first=!1,this._originX=e,this._originY=t,(e<this._tempMeasure.left||e>this._tempMeasure.left+this._tempMeasure.width||t<this._tempMeasure.top||t>this._tempMeasure.top+this._tempMeasure.height)&&(this.isVertical?this.value=this.minimum+(1-(t-this._currentMeasure.top)/this._currentMeasure.height)*(this.maximum-this.minimum):this.value=this.minimum+(e-this._currentMeasure.left)/this._currentMeasure.width*(this.maximum-this.minimum)));var n=0;n=this.isVertical?-(t-this._originY)/(this._currentMeasure.height-this._effectiveThumbThickness):(e-this._originX)/(this._currentMeasure.width-this._effectiveThumbThickness),this.value+=n*(this.maximum-this.minimum),this._originX=e,this._originY=t},t.prototype._onPointerDown=function(t,n,r,i,o){return this._first=!0,e.prototype._onPointerDown.call(this,t,n,r,i,o)},Object(r.__decorate)([Object(a.serialize)()],t.prototype,"num90RotationInVerticalMode",void 0),t}(i.BaseSlider)},"./2D/controls/sliders/scrollBar.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"ScrollBar",function(){return s});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("./2D/controls/sliders/baseSlider.ts"),o=n("./2D/measure.ts"),a=n("babylonjs/Misc/perfCounter"),s=function(e){function t(t){var n=e.call(this,t)||this;return n.name=t,n._background="black",n._borderColor="white",n._tempMeasure=new o.Measure(0,0,0,0),n}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"borderColor",{get:function(){return this._borderColor},set:function(e){this._borderColor!==e&&(this._borderColor=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this._background},set:function(e){this._background!==e&&(this._background=e,this._markAsDirty())},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"Scrollbar"},t.prototype._getThumbThickness=function(){return this._thumbWidth.isPixel?this._thumbWidth.getValue(this._host):this._backgroundBoxThickness*this._thumbWidth.getValue(this._host)},t.prototype._draw=function(e){e.save(),this._applyStates(e),this._prepareRenderingData("rectangle");var t=this._renderLeft,n=this._getThumbPosition();e.fillStyle=this._background,e.fillRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height),e.fillStyle=this.color,this.isVertical?(this._tempMeasure.left=t-this._effectiveBarOffset,this._tempMeasure.top=this._currentMeasure.top+n,this._tempMeasure.width=this._currentMeasure.width,this._tempMeasure.height=this._effectiveThumbThickness):(this._tempMeasure.left=this._currentMeasure.left+n,this._tempMeasure.top=this._currentMeasure.top,this._tempMeasure.width=this._effectiveThumbThickness,this._tempMeasure.height=this._currentMeasure.height),e.fillRect(this._tempMeasure.left,this._tempMeasure.top,this._tempMeasure.width,this._tempMeasure.height),e.restore()},t.prototype._updateValueFromPointer=function(e,t){0!=this.rotation&&(this._invertTransformMatrix.transformCoordinates(e,t,this._transformedPosition),e=this._transformedPosition.x,t=this._transformedPosition.y),this._first&&(this._first=!1,this._originX=e,this._originY=t,(e<this._tempMeasure.left||e>this._tempMeasure.left+this._tempMeasure.width||t<this._tempMeasure.top||t>this._tempMeasure.top+this._tempMeasure.height)&&(this.isVertical?this.value=this.minimum+(1-(t-this._currentMeasure.top)/this._currentMeasure.height)*(this.maximum-this.minimum):this.value=this.minimum+(e-this._currentMeasure.left)/this._currentMeasure.width*(this.maximum-this.minimum)));var n=0;n=this.isVertical?-(t-this._originY)/(this._currentMeasure.height-this._effectiveThumbThickness):(e-this._originX)/(this._currentMeasure.width-this._effectiveThumbThickness),this.value+=n*(this.maximum-this.minimum),this._originX=e,this._originY=t},t.prototype._onPointerDown=function(t,n,r,i,o){return this._first=!0,e.prototype._onPointerDown.call(this,t,n,r,i,o)},Object(r.__decorate)([Object(a.serialize)()],t.prototype,"borderColor",null),Object(r.__decorate)([Object(a.serialize)()],t.prototype,"background",null),t}(i.BaseSlider)},"./2D/controls/sliders/slider.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"Slider",function(){return a});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("./2D/controls/sliders/baseSlider.ts"),o=n("babylonjs/Misc/perfCounter"),a=function(e){function t(t){var n=e.call(this,t)||this;return n.name=t,n._background="black",n._borderColor="white",n._thumbColor="",n._isThumbCircle=!1,n._displayValueBar=!0,n}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"displayValueBar",{get:function(){return this._displayValueBar},set:function(e){this._displayValueBar!==e&&(this._displayValueBar=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"borderColor",{get:function(){return this._borderColor},set:function(e){this._borderColor!==e&&(this._borderColor=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this._background},set:function(e){this._background!==e&&(this._background=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thumbColor",{get:function(){return this._thumbColor},set:function(e){this._thumbColor!==e&&(this._thumbColor=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isThumbCircle",{get:function(){return this._isThumbCircle},set:function(e){this._isThumbCircle!==e&&(this._isThumbCircle=e,this._markAsDirty())},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"Slider"},t.prototype._draw=function(e,t){e.save(),this._applyStates(e),this._prepareRenderingData(this.isThumbCircle?"circle":"rectangle");var n=this._renderLeft,r=this._renderTop,i=this._renderWidth,o=this._renderHeight,a=0;this.isThumbClamped&&this.isThumbCircle?(this.isVertical?r+=this._effectiveThumbThickness/2:n+=this._effectiveThumbThickness/2,a=this._backgroundBoxThickness/2):a=(this._effectiveThumbThickness-this._effectiveBarOffset)/2,(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY);var s=this._getThumbPosition();e.fillStyle=this._background,this.isVertical?this.isThumbClamped?this.isThumbCircle?(e.beginPath(),e.arc(n+this._backgroundBoxThickness/2,r,a,Math.PI,2*Math.PI),e.fill(),e.fillRect(n,r,i,o)):e.fillRect(n,r,i,o+this._effectiveThumbThickness):e.fillRect(n,r,i,o):this.isThumbClamped?this.isThumbCircle?(e.beginPath(),e.arc(n+this._backgroundBoxLength,r+this._backgroundBoxThickness/2,a,0,2*Math.PI),e.fill(),e.fillRect(n,r,i,o)):e.fillRect(n,r,i+this._effectiveThumbThickness,o):e.fillRect(n,r,i,o),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),e.fillStyle=this.color,this._displayValueBar&&(this.isVertical?this.isThumbClamped?this.isThumbCircle?(e.beginPath(),e.arc(n+this._backgroundBoxThickness/2,r+this._backgroundBoxLength,a,0,2*Math.PI),e.fill(),e.fillRect(n,r+s,i,o-s)):e.fillRect(n,r+s,i,o-s+this._effectiveThumbThickness):e.fillRect(n,r+s,i,o-s):this.isThumbClamped&&this.isThumbCircle?(e.beginPath(),e.arc(n,r+this._backgroundBoxThickness/2,a,0,2*Math.PI),e.fill(),e.fillRect(n,r,s,o)):e.fillRect(n,r,s,o)),e.fillStyle=this._thumbColor||this.color,this.displayThumb&&((this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY),this._isThumbCircle?(e.beginPath(),this.isVertical?e.arc(n+this._backgroundBoxThickness/2,r+s,a,0,2*Math.PI):e.arc(n+s,r+this._backgroundBoxThickness/2,a,0,2*Math.PI),e.fill(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),e.strokeStyle=this._borderColor,e.stroke()):(this.isVertical?e.fillRect(n-this._effectiveBarOffset,this._currentMeasure.top+s,this._currentMeasure.width,this._effectiveThumbThickness):e.fillRect(this._currentMeasure.left+s,this._currentMeasure.top,this._effectiveThumbThickness,this._currentMeasure.height),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),e.strokeStyle=this._borderColor,this.isVertical?e.strokeRect(n-this._effectiveBarOffset,this._currentMeasure.top+s,this._currentMeasure.width,this._effectiveThumbThickness):e.strokeRect(this._currentMeasure.left+s,this._currentMeasure.top,this._effectiveThumbThickness,this._currentMeasure.height))),e.restore()},Object(r.__decorate)([Object(o.serialize)()],t.prototype,"displayValueBar",null),Object(r.__decorate)([Object(o.serialize)()],t.prototype,"borderColor",null),Object(r.__decorate)([Object(o.serialize)()],t.prototype,"background",null),Object(r.__decorate)([Object(o.serialize)()],t.prototype,"thumbColor",null),Object(r.__decorate)([Object(o.serialize)()],t.prototype,"isThumbCircle",null),t}(i.BaseSlider);Object(o.RegisterClass)("BABYLON.GUI.Slider",a)},"./2D/controls/stackPanel.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"StackPanel",function(){return s});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=n("./2D/controls/container.ts"),a=n("./2D/controls/control.ts"),s=function(e){function t(t){var n=e.call(this,t)||this;return n.name=t,n._isVertical=!0,n._manualWidth=!1,n._manualHeight=!1,n._doNotTrackManualChanges=!1,n.ignoreLayoutWarnings=!1,n}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"isVertical",{get:function(){return this._isVertical},set:function(e){this._isVertical!==e&&(this._isVertical=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width.toString(this._host)},set:function(e){this._doNotTrackManualChanges||(this._manualWidth=!0),this._width.toString(this._host)!==e&&this._width.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height.toString(this._host)},set:function(e){this._doNotTrackManualChanges||(this._manualHeight=!0),this._height.toString(this._host)!==e&&this._height.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"StackPanel"},t.prototype._preMeasure=function(t,n){for(var r=0,i=this._children;r<i.length;r++){var o=i[r];this._isVertical?o.verticalAlignment=a.Control.VERTICAL_ALIGNMENT_TOP:o.horizontalAlignment=a.Control.HORIZONTAL_ALIGNMENT_LEFT}e.prototype._preMeasure.call(this,t,n)},t.prototype._additionalProcessing=function(t,n){e.prototype._additionalProcessing.call(this,t,n),this._measureForChildren.copyFrom(t),this._measureForChildren.left=this._currentMeasure.left,this._measureForChildren.top=this._currentMeasure.top,this.isVertical&&!this._manualWidth||(this._measureForChildren.width=this._currentMeasure.width),(this.isVertical||this._manualHeight)&&(this._measureForChildren.height=this._currentMeasure.height)},t.prototype._postMeasure=function(){for(var t=0,n=0,r=0,o=this._children;r<o.length;r++){var a=o[r];a.isVisible&&!a.notRenderable&&(this._isVertical?(a.top!==n+"px"&&(a.top=n+"px",this._rebuildLayout=!0,a._top.ignoreAdaptiveScaling=!0),a._height.isPercentage&&!a._automaticSize?this.ignoreLayoutWarnings||i.Tools.Warn("Control (Name:"+a.name+", UniqueId:"+a.uniqueId+") is using height in percentage mode inside a vertical StackPanel"):n+=a._currentMeasure.height+a.paddingTopInPixels+a.paddingBottomInPixels):(a.left!==t+"px"&&(a.left=t+"px",this._rebuildLayout=!0,a._left.ignoreAdaptiveScaling=!0),a._width.isPercentage&&!a._automaticSize?this.ignoreLayoutWarnings||i.Tools.Warn("Control (Name:"+a.name+", UniqueId:"+a.uniqueId+") is using width in percentage mode inside a horizontal StackPanel"):t+=a._currentMeasure.width+a.paddingLeftInPixels+a.paddingRightInPixels))}t+=this.paddingLeftInPixels+this.paddingRightInPixels,n+=this.paddingTopInPixels+this.paddingBottomInPixels,this._doNotTrackManualChanges=!0;var s=!1,l=!1;if(!this._manualHeight&&this._isVertical){var c=this.height;this.height=n+"px",l=c!==this.height||!this._height.ignoreAdaptiveScaling}if(!this._manualWidth&&!this._isVertical){var u=this.width;this.width=t+"px",s=u!==this.width||!this._width.ignoreAdaptiveScaling}l&&(this._height.ignoreAdaptiveScaling=!0),s&&(this._width.ignoreAdaptiveScaling=!0),this._doNotTrackManualChanges=!1,(s||l)&&(this._rebuildLayout=!0),e.prototype._postMeasure.call(this)},t.prototype.serialize=function(t){e.prototype.serialize.call(this,t),t.manualWidth=this._manualWidth,t.manualHeight=this._manualHeight},t.prototype._parseFromContent=function(t,n){this._manualWidth=t.manualWidth,this._manualHeight=t.manualHeight,e.prototype._parseFromContent.call(this,t,n)},Object(r.__decorate)([Object(i.serialize)()],t.prototype,"ignoreLayoutWarnings",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"isVertical",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"width",null),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"height",null),t}(o.Container);Object(i.RegisterClass)("BABYLON.GUI.StackPanel",s)},"./2D/controls/statics.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"name",function(){return a});var r=n("./2D/controls/control.ts"),i=n("./2D/controls/stackPanel.ts"),o=n("./2D/controls/textBlock.ts"),a="Statics";r.Control.AddHeader=function(e,t,n,a){var s=new i.StackPanel("panel"),l=!a||a.isHorizontal,c=!a||a.controlFirst;s.isVertical=!l;var u=new o.TextBlock("header");return u.text=t,u.textHorizontalAlignment=r.Control.HORIZONTAL_ALIGNMENT_LEFT,l?u.width=n:u.height=n,c?(s.addControl(e),s.addControl(u),u.paddingLeft="5px"):(s.addControl(u),s.addControl(e),u.paddingRight="5px"),u.shadowBlur=e.shadowBlur,u.shadowColor=e.shadowColor,u.shadowOffsetX=e.shadowOffsetX,u.shadowOffsetY=e.shadowOffsetY,s}},"./2D/controls/textBlock.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"TextWrapping",function(){return r}),n.d(t,"TextBlock",function(){return l});var r,i=n("../../node_modules/tslib/tslib.es6.js"),o=n("babylonjs/Misc/perfCounter"),a=n("./2D/valueAndUnit.ts"),s=n("./2D/controls/control.ts");!function(e){e[e.Clip=0]="Clip",e[e.WordWrap=1]="WordWrap",e[e.Ellipsis=2]="Ellipsis"}(r||(r={}));var l=function(e){function t(t,n){void 0===n&&(n="");var i=e.call(this,t)||this;return i.name=t,i._text="",i._textWrapping=r.Clip,i._textHorizontalAlignment=s.Control.HORIZONTAL_ALIGNMENT_CENTER,i._textVerticalAlignment=s.Control.VERTICAL_ALIGNMENT_CENTER,i._resizeToFit=!1,i._lineSpacing=new a.ValueAndUnit(0),i._outlineWidth=0,i._outlineColor="white",i._underline=!1,i._lineThrough=!1,i.onTextChangedObservable=new o.Observable,i.onLinesReadyObservable=new o.Observable,i.text=n,i}return Object(i.__extends)(t,e),Object.defineProperty(t.prototype,"lines",{get:function(){return this._lines},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resizeToFit",{get:function(){return this._resizeToFit},set:function(e){this._resizeToFit!==e&&(this._resizeToFit=e,this._resizeToFit&&(this._width.ignoreAdaptiveScaling=!0,this._height.ignoreAdaptiveScaling=!0),this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textWrapping",{get:function(){return this._textWrapping},set:function(e){this._textWrapping!==e&&(this._textWrapping=+e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){this._text!==e&&(this._text=e+"",this._markAsDirty(),this.onTextChangedObservable.notifyObservers(this))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textHorizontalAlignment",{get:function(){return this._textHorizontalAlignment},set:function(e){this._textHorizontalAlignment!==e&&(this._textHorizontalAlignment=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textVerticalAlignment",{get:function(){return this._textVerticalAlignment},set:function(e){this._textVerticalAlignment!==e&&(this._textVerticalAlignment=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineSpacing",{get:function(){return this._lineSpacing.toString(this._host)},set:function(e){this._lineSpacing.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outlineWidth",{get:function(){return this._outlineWidth},set:function(e){this._outlineWidth!==e&&(this._outlineWidth=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underline",{get:function(){return this._underline},set:function(e){this._underline!==e&&(this._underline=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineThrough",{get:function(){return this._lineThrough},set:function(e){this._lineThrough!==e&&(this._lineThrough=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outlineColor",{get:function(){return this._outlineColor},set:function(e){this._outlineColor!==e&&(this._outlineColor=e,this._markAsDirty())},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"TextBlock"},t.prototype._processMeasures=function(t,n){this._fontOffset||(this._fontOffset=s.Control._GetFontOffset(n.font)),e.prototype._processMeasures.call(this,t,n),this._lines=this._breakLines(this._currentMeasure.width,n),this.onLinesReadyObservable.notifyObservers(this);for(var i=0,o=0;o<this._lines.length;o++){var l=this._lines[o];l.width>i&&(i=l.width)}if(this._resizeToFit){if(this._textWrapping===r.Clip){var c=this.paddingLeftInPixels+this.paddingRightInPixels+i|0;c!==this._width.internalValue&&(this._width.updateInPlace(c,a.ValueAndUnit.UNITMODE_PIXEL),this._rebuildLayout=!0)}var u=this.paddingTopInPixels+this.paddingBottomInPixels+this._fontOffset.height*this._lines.length|0;if(this._lines.length>0&&0!==this._lineSpacing.internalValue){var _=0;_=this._lineSpacing.isPixel?this._lineSpacing.getValue(this._host):this._lineSpacing.getValue(this._host)*this._height.getValueInPixel(this._host,this._cachedParentMeasure.height),u+=(this._lines.length-1)*_}u!==this._height.internalValue&&(this._height.updateInPlace(u,a.ValueAndUnit.UNITMODE_PIXEL),this._rebuildLayout=!0)}},t.prototype._drawText=function(e,t,n,r){var i=this._currentMeasure.width,o=0;switch(this._textHorizontalAlignment){case s.Control.HORIZONTAL_ALIGNMENT_LEFT:o=0;break;case s.Control.HORIZONTAL_ALIGNMENT_RIGHT:o=i-t;break;case s.Control.HORIZONTAL_ALIGNMENT_CENTER:o=(i-t)/2}(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(r.shadowColor=this.shadowColor,r.shadowBlur=this.shadowBlur,r.shadowOffsetX=this.shadowOffsetX,r.shadowOffsetY=this.shadowOffsetY),this.outlineWidth&&r.strokeText(e,this._currentMeasure.left+o,n),r.fillText(e,this._currentMeasure.left+o,n),this._underline&&(r.beginPath(),r.lineWidth=Math.round(.05*this.fontSizeInPixels),r.moveTo(this._currentMeasure.left+o,n+3),r.lineTo(this._currentMeasure.left+o+t,n+3),r.stroke(),r.closePath()),this._lineThrough&&(r.beginPath(),r.lineWidth=Math.round(.05*this.fontSizeInPixels),r.moveTo(this._currentMeasure.left+o,n-this.fontSizeInPixels/3),r.lineTo(this._currentMeasure.left+o+t,n-this.fontSizeInPixels/3),r.stroke(),r.closePath())},t.prototype._draw=function(e,t){e.save(),this._applyStates(e),this._renderLines(e),e.restore()},t.prototype._applyStates=function(t){e.prototype._applyStates.call(this,t),this.outlineWidth&&(t.lineWidth=this.outlineWidth,t.strokeStyle=this.outlineColor,t.lineJoin="miter",t.miterLimit=2)},t.prototype._breakLines=function(e,t){var n=[],i=this.text.split("\n");if(this._textWrapping===r.Ellipsis)for(var o=0,a=i;o<a.length;o++){var s=a[o];n.push(this._parseLineEllipsis(s,e,t))}else if(this._textWrapping===r.WordWrap)for(var l=0,c=i;l<c.length;l++){s=c[l];n.push.apply(n,this._parseLineWordWrap(s,e,t))}else for(var u=0,_=i;u<_.length;u++){s=_[u];n.push(this._parseLine(s,t))}return n},t.prototype._parseLine=function(e,t){void 0===e&&(e="");var n=t.measureText(e);return{text:e,width:Math.abs(n.actualBoundingBoxLeft)+Math.abs(n.actualBoundingBoxRight)}},t.prototype._parseLineEllipsis=function(e,t,n){void 0===e&&(e="");var r=n.measureText(e),i=Math.abs(r.actualBoundingBoxLeft)+Math.abs(r.actualBoundingBoxRight);i>t&&(e+="");var o=Array.from&&Array.from(e);if(o)for(;o.length&&i>t;)o.pop(),e=o.join("")+"...",r=n.measureText(e),i=Math.abs(r.actualBoundingBoxLeft)+Math.abs(r.actualBoundingBoxRight);else for(;e.length>2&&i>t;)e=e.slice(0,-2)+"",r=n.measureText(e),i=Math.abs(r.actualBoundingBoxLeft)+Math.abs(r.actualBoundingBoxRight);return{text:e,width:i}},t.prototype._parseLineWordWrap=function(e,t,n){void 0===e&&(e="");for(var r=[],i=this.wordSplittingFunction?this.wordSplittingFunction(e):e.split(" "),o=n.measureText(e),a=Math.abs(o.actualBoundingBoxLeft)+Math.abs(o.actualBoundingBoxRight),s=0;s<i.length;s++){var l=s>0?e+" "+i[s]:i[0],c=n.measureText(l),u=Math.abs(c.actualBoundingBoxLeft)+Math.abs(c.actualBoundingBoxRight);u>t&&s>0?(r.push({text:e,width:a}),e=i[s],o=n.measureText(e),a=Math.abs(o.actualBoundingBoxLeft)+Math.abs(o.actualBoundingBoxRight)):(a=u,e=l)}return r.push({text:e,width:a}),r},t.prototype._renderLines=function(e){var t=this._currentMeasure.height,n=0;switch(this._textVerticalAlignment){case s.Control.VERTICAL_ALIGNMENT_TOP:n=this._fontOffset.ascent;break;case s.Control.VERTICAL_ALIGNMENT_BOTTOM:n=t-this._fontOffset.height*(this._lines.length-1)-this._fontOffset.descent;break;case s.Control.VERTICAL_ALIGNMENT_CENTER:n=this._fontOffset.ascent+(t-this._fontOffset.height*this._lines.length)/2}n+=this._currentMeasure.top;for(var r=0;r<this._lines.length;r++){var i=this._lines[r];0!==r&&0!==this._lineSpacing.internalValue&&(this._lineSpacing.isPixel?n+=this._lineSpacing.getValue(this._host):n+=this._lineSpacing.getValue(this._host)*this._height.getValueInPixel(this._host,this._cachedParentMeasure.height)),this._drawText(i.text,i.width,n,e),n+=this._fontOffset.height}},t.prototype.computeExpectedHeight=function(){var e;if(this.text&&this.widthInPixels){var t=null===(e=o.Engine.LastCreatedEngine)||void 0===e?void 0:e.createCanvas(0,0).getContext("2d");if(t){this._applyStates(t),this._fontOffset||(this._fontOffset=s.Control._GetFontOffset(t.font));var n=this._lines?this._lines:this._breakLines(this.widthInPixels-this.paddingLeftInPixels-this.paddingRightInPixels,t),r=this.paddingTopInPixels+this.paddingBottomInPixels+this._fontOffset.height*n.length;if(n.length>0&&0!==this._lineSpacing.internalValue){var i=0;i=this._lineSpacing.isPixel?this._lineSpacing.getValue(this._host):this._lineSpacing.getValue(this._host)*this._height.getValueInPixel(this._host,this._cachedParentMeasure.height),r+=(n.length-1)*i}return r}}return 0},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.onTextChangedObservable.clear()},Object(i.__decorate)([Object(o.serialize)()],t.prototype,"resizeToFit",null),Object(i.__decorate)([Object(o.serialize)()],t.prototype,"textWrapping",null),Object(i.__decorate)([Object(o.serialize)()],t.prototype,"text",null),Object(i.__decorate)([Object(o.serialize)()],t.prototype,"textHorizontalAlignment",null),Object(i.__decorate)([Object(o.serialize)()],t.prototype,"textVerticalAlignment",null),Object(i.__decorate)([Object(o.serialize)()],t.prototype,"lineSpacing",null),Object(i.__decorate)([Object(o.serialize)()],t.prototype,"outlineWidth",null),Object(i.__decorate)([Object(o.serialize)()],t.prototype,"underline",null),Object(i.__decorate)([Object(o.serialize)()],t.prototype,"lineThrough",null),Object(i.__decorate)([Object(o.serialize)()],t.prototype,"outlineColor",null),t}(s.Control);Object(o.RegisterClass)("BABYLON.GUI.TextBlock",l)},"./2D/controls/textWrapper.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"TextWrapper",function(){return i});var r=n("../../node_modules/tslib/tslib.es6.js"),i=function(){function e(){}return Object.defineProperty(e.prototype,"text",{get:function(){return this._characters?this._characters.join(""):this._text},set:function(e){this._text=e,this._characters=Array.from&&Array.from(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._characters?this._characters.length:this._text.length},enumerable:!1,configurable:!0}),e.prototype.removePart=function(e,t,n){var i;if(this._text=this._text.slice(0,e)+(n||"")+this._text.slice(t),this._characters){var o=n?Array.from(n):[];(i=this._characters).splice.apply(i,Object(r.__spreadArray)([e,t-e],o,!1))}},e.prototype.charAt=function(e){return this._characters?this._characters[e]:this._text.charAt(e)},e.prototype.substr=function(e,t){if(this._characters){e=isNaN(e)?0:e>=0?Math.min(e,this._characters.length):this._characters.length+Math.max(e,-this._characters.length),void 0===t?t=this._characters.length-e:isNaN(t)?t=0:t<0&&(t=0);for(var n=[];--t>=0;)n[t]=this._characters[e+t];return n.join("")}return this._text.substr(e,t)},e.prototype.substring=function(e,t){if(this._characters){isNaN(e)?e=0:e>this._characters.length?e=this._characters.length:e<0&&(e=0),void 0===t?t=this._characters.length:isNaN(t)?t=0:t>this._characters.length?t=this._characters.length:t<0&&(t=0);for(var n=[],r=0;e<t;)n[r++]=this._characters[e++];return n.join("")}return this._text.substring(e,t)},e.prototype.isWord=function(e){var t=/\w/g;return this._characters?-1!==this._characters[e].search(t):-1!==this._text.search(t)},e}()},"./2D/controls/toggleButton.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"ToggleButton",function(){return o});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=function(e){function t(t,n){var r=e.call(this,t)||this;r.name=t,r.onIsActiveChangedObservable=new i.Observable,r.delegatePickingToChildren=!1,r._isActive=!1,r.group=null!=n?n:"",r.thickness=0,r.isPointerBlocker=!0;var o=null;return r.toActiveAnimation=function(){r.thickness=1},r.toInactiveAnimation=function(){r.thickness=0},r.pointerEnterActiveAnimation=function(){o=r.alpha,r.alpha-=.1},r.pointerOutActiveAnimation=function(){null!==o&&(r.alpha=o)},r.pointerDownActiveAnimation=function(){r.scaleX-=.05,r.scaleY-=.05},r.pointerUpActiveAnimation=function(){r.scaleX+=.05,r.scaleY+=.05},r.pointerEnterInactiveAnimation=function(){o=r.alpha,r.alpha-=.1},r.pointerOutInactiveAnimation=function(){null!==o&&(r.alpha=o)},r.pointerDownInactiveAnimation=function(){r.scaleX-=.05,r.scaleY-=.05},r.pointerUpInactiveAnimation=function(){r.scaleX+=.05,r.scaleY+=.05},r}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"group",{get:function(){return this._group},set:function(e){this._group!==e&&(this._group=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isActive",{get:function(){return this._isActive},set:function(e){var t,n,r=this;this._isActive!==e&&(this._isActive=e,this._isActive?null===(t=this.toActiveAnimation)||void 0===t||t.call(this):null===(n=this.toInactiveAnimation)||void 0===n||n.call(this),this._markAsDirty(),this.onIsActiveChangedObservable.notifyObservers(e),this._isActive&&this._host&&this._group&&this._host.executeOnAllControls(function(e){if("ToggleButton"===e.typeName){if(e===r)return;var t=e;t.group===r.group&&(t.isActive=!1)}}))},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"ToggleButton"},t.prototype._processPicking=function(t,n,r,i,o,a,s,l){if(!this._isEnabled||!this.isHitTestVisible||!this.isVisible||this.notRenderable)return!1;if(!e.prototype.contains.call(this,t,n))return!1;if(this.delegatePickingToChildren){for(var c=!1,u=this._children.length-1;u>=0;u--){var _=this._children[u];if(_.isEnabled&&_.isHitTestVisible&&_.isVisible&&!_.notRenderable&&_.contains(t,n)){c=!0;break}}if(!c)return!1}return this._processObservables(i,t,n,r,o,a,s,l),!0},t.prototype._onPointerEnter=function(t,n){return!!e.prototype._onPointerEnter.call(this,t,n)&&(!!this.isReadOnly||(this._isActive?this.pointerEnterActiveAnimation&&this.pointerEnterActiveAnimation():this.pointerEnterInactiveAnimation&&this.pointerEnterInactiveAnimation(),!0))},t.prototype._onPointerOut=function(t,n,r){void 0===r&&(r=!1),this.isReadOnly||(this._isActive?this.pointerOutActiveAnimation&&this.pointerOutActiveAnimation():this.pointerOutInactiveAnimation&&this.pointerOutInactiveAnimation()),e.prototype._onPointerOut.call(this,t,n,r)},t.prototype._onPointerDown=function(t,n,r,i,o){return!!e.prototype._onPointerDown.call(this,t,n,r,i,o)&&(!!this.isReadOnly||(this._isActive?this.pointerDownActiveAnimation&&this.pointerDownActiveAnimation():this.pointerDownInactiveAnimation&&this.pointerDownInactiveAnimation(),!0))},t.prototype._onPointerUp=function(t,n,r,i,o,a){this.isReadOnly||(this._isActive?this.pointerUpActiveAnimation&&this.pointerUpActiveAnimation():this.pointerUpInactiveAnimation&&this.pointerUpInactiveAnimation()),e.prototype._onPointerUp.call(this,t,n,r,i,o,a)},t}(n("./2D/controls/rectangle.ts").Rectangle);Object(i.RegisterClass)("BABYLON.GUI.ToggleButton",o)},"./2D/controls/virtualKeyboard.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"KeyPropertySet",function(){return s}),n.d(t,"VirtualKeyboard",function(){return l});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=n("./2D/controls/stackPanel.ts"),a=n("./2D/controls/button.ts"),s=function(){return function(){}}(),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onKeyPressObservable=new i.Observable,t.defaultButtonWidth="40px",t.defaultButtonHeight="40px",t.defaultButtonPaddingLeft="2px",t.defaultButtonPaddingRight="2px",t.defaultButtonPaddingTop="2px",t.defaultButtonPaddingBottom="2px",t.defaultButtonColor="#DDD",t.defaultButtonBackground="#070707",t.shiftButtonColor="#7799FF",t.selectedShiftThickness=1,t.shiftState=0,t._currentlyConnectedInputText=null,t._connectedInputTexts=[],t._onKeyPressObserver=null,t}return Object(r.__extends)(t,e),t.prototype._getTypeName=function(){return"VirtualKeyboard"},t.prototype._createKey=function(e,t){var n=this,r=a.Button.CreateSimpleButton(e,e);return r.width=t&&t.width?t.width:this.defaultButtonWidth,r.height=t&&t.height?t.height:this.defaultButtonHeight,r.color=t&&t.color?t.color:this.defaultButtonColor,r.background=t&&t.background?t.background:this.defaultButtonBackground,r.paddingLeft=t&&t.paddingLeft?t.paddingLeft:this.defaultButtonPaddingLeft,r.paddingRight=t&&t.paddingRight?t.paddingRight:this.defaultButtonPaddingRight,r.paddingTop=t&&t.paddingTop?t.paddingTop:this.defaultButtonPaddingTop,r.paddingBottom=t&&t.paddingBottom?t.paddingBottom:this.defaultButtonPaddingBottom,r.thickness=0,r.isFocusInvisible=!0,r.shadowColor=this.shadowColor,r.shadowBlur=this.shadowBlur,r.shadowOffsetX=this.shadowOffsetX,r.shadowOffsetY=this.shadowOffsetY,r.onPointerUpObservable.add(function(){n.onKeyPressObservable.notifyObservers(e)}),r},t.prototype.addKeysRow=function(e,t){var n=new o.StackPanel;n.isVertical=!1,n.isFocusInvisible=!0;for(var r=null,i=0;i<e.length;i++){var a=null;t&&t.length===e.length&&(a=t[i]);var s=this._createKey(e[i],a);(!r||s.heightInPixels>r.heightInPixels)&&(r=s),n.addControl(s)}n.height=r?r.height:this.defaultButtonHeight,this.addControl(n)},t.prototype.applyShiftState=function(e){if(this.children)for(var t=0;t<this.children.length;t++){var n=this.children[t];if(n&&n.children)for(var r=n,i=0;i<r.children.length;i++){var o=r.children[i];if(o&&o.children[0]){var a=o.children[0];""===a.text&&(o.color=e?this.shiftButtonColor:this.defaultButtonColor,o.thickness=e>1?this.selectedShiftThickness:0),a.text=e>0?a.text.toUpperCase():a.text.toLowerCase()}}}},Object.defineProperty(t.prototype,"connectedInputText",{get:function(){return this._currentlyConnectedInputText},enumerable:!1,configurable:!0}),t.prototype.connect=function(e){var t=this;if(!this._connectedInputTexts.some(function(t){return t.input===e})){null===this._onKeyPressObserver&&(this._onKeyPressObserver=this.onKeyPressObservable.add(function(e){if(t._currentlyConnectedInputText){switch(t._currentlyConnectedInputText._host.focusedControl=t._currentlyConnectedInputText,e){case"":return t.shiftState++,t.shiftState>2&&(t.shiftState=0),void t.applyShiftState(t.shiftState);case"":return void t._currentlyConnectedInputText.processKey(8);case"":return void t._currentlyConnectedInputText.processKey(13)}t._currentlyConnectedInputText.processKey(-1,t.shiftState?e.toUpperCase():e),1===t.shiftState&&(t.shiftState=0,t.applyShiftState(t.shiftState))}})),this.isVisible=!1,this._currentlyConnectedInputText=e,e._connectedVirtualKeyboard=this;var n=e.onFocusObservable.add(function(){t._currentlyConnectedInputText=e,e._connectedVirtualKeyboard=t,t.isVisible=!0}),r=e.onBlurObservable.add(function(){e._connectedVirtualKeyboard=null,t._currentlyConnectedInputText=null,t.isVisible=!1});this._connectedInputTexts.push({input:e,onBlurObserver:r,onFocusObserver:n})}},t.prototype.disconnect=function(e){var t=this;if(e){var n=this._connectedInputTexts.filter(function(t){return t.input===e});1===n.length&&(this._removeConnectedInputObservables(n[0]),this._connectedInputTexts=this._connectedInputTexts.filter(function(t){return t.input!==e}),this._currentlyConnectedInputText===e&&(this._currentlyConnectedInputText=null))}else this._connectedInputTexts.forEach(function(e){t._removeConnectedInputObservables(e)}),this._connectedInputTexts=[];0===this._connectedInputTexts.length&&(this._currentlyConnectedInputText=null,this.onKeyPressObservable.remove(this._onKeyPressObserver),this._onKeyPressObserver=null)},t.prototype._removeConnectedInputObservables=function(e){e.input._connectedVirtualKeyboard=null,e.input.onFocusObservable.remove(e.onFocusObserver),e.input.onBlurObservable.remove(e.onBlurObserver)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.disconnect()},t.CreateDefaultLayout=function(e){var n=new t(e);return n.addKeysRow(["1","2","3","4","5","6","7","8","9","0",""]),n.addKeysRow(["q","w","e","r","t","y","u","i","o","p"]),n.addKeysRow(["a","s","d","f","g","h","j","k","l",";","'",""]),n.addKeysRow(["","z","x","c","v","b","n","m",",",".","/"]),n.addKeysRow([" "],[{width:"200px"}]),n},t}(o.StackPanel);Object(i.RegisterClass)("BABYLON.GUI.VirtualKeyboard",l)},"./2D/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./2D/controls/index.ts");n.d(t,"Button",function(){return r.Button}),n.d(t,"Checkbox",function(){return r.Checkbox}),n.d(t,"ColorPicker",function(){return r.ColorPicker}),n.d(t,"Container",function(){return r.Container}),n.d(t,"Control",function(){return r.Control}),n.d(t,"Ellipse",function(){return r.Ellipse}),n.d(t,"FocusableButton",function(){return r.FocusableButton}),n.d(t,"Grid",function(){return r.Grid}),n.d(t,"Image",function(){return r.Image}),n.d(t,"InputText",function(){return r.InputText}),n.d(t,"InputPassword",function(){return r.InputPassword}),n.d(t,"Line",function(){return r.Line}),n.d(t,"MultiLine",function(){return r.MultiLine}),n.d(t,"RadioButton",function(){return r.RadioButton}),n.d(t,"StackPanel",function(){return r.StackPanel}),n.d(t,"SelectorGroup",function(){return r.SelectorGroup}),n.d(t,"CheckboxGroup",function(){return r.CheckboxGroup}),n.d(t,"RadioGroup",function(){return r.RadioGroup}),n.d(t,"SliderGroup",function(){return r.SliderGroup}),n.d(t,"SelectionPanel",function(){return r.SelectionPanel}),n.d(t,"ScrollViewer",function(){return r.ScrollViewer}),n.d(t,"TextWrapping",function(){return r.TextWrapping}),n.d(t,"TextBlock",function(){return r.TextBlock}),n.d(t,"TextWrapper",function(){return r.TextWrapper}),n.d(t,"ToggleButton",function(){return r.ToggleButton}),n.d(t,"KeyPropertySet",function(){return r.KeyPropertySet}),n.d(t,"VirtualKeyboard",function(){return r.VirtualKeyboard}),n.d(t,"Rectangle",function(){return r.Rectangle}),n.d(t,"DisplayGrid",function(){return r.DisplayGrid}),n.d(t,"BaseSlider",function(){return r.BaseSlider}),n.d(t,"Slider",function(){return r.Slider}),n.d(t,"ImageBasedSlider",function(){return r.ImageBasedSlider}),n.d(t,"ScrollBar",function(){return r.ScrollBar}),n.d(t,"ImageScrollBar",function(){return r.ImageScrollBar}),n.d(t,"name",function(){return r.name});var i=n("./2D/advancedDynamicTexture.ts");n.d(t,"AdvancedDynamicTexture",function(){return i.AdvancedDynamicTexture});var o=n("./2D/adtInstrumentation.ts");n.d(t,"AdvancedDynamicTextureInstrumentation",function(){return o.AdvancedDynamicTextureInstrumentation});var a=n("./2D/math2D.ts");n.d(t,"Vector2WithInfo",function(){return a.Vector2WithInfo}),n.d(t,"Matrix2D",function(){return a.Matrix2D});var s=n("./2D/measure.ts");n.d(t,"Measure",function(){return s.Measure});var l=n("./2D/multiLinePoint.ts");n.d(t,"MultiLinePoint",function(){return l.MultiLinePoint});var c=n("./2D/style.ts");n.d(t,"Style",function(){return c.Style});var u=n("./2D/valueAndUnit.ts");n.d(t,"ValueAndUnit",function(){return u.ValueAndUnit});var _=n("./2D/xmlLoader.ts");n.d(t,"XmlLoader",function(){return _.XmlLoader})},"./2D/math2D.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"Vector2WithInfo",function(){return o}),n.d(t,"Matrix2D",function(){return a});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=function(e){function t(t,n){void 0===n&&(n=0);var r=e.call(this,t.x,t.y)||this;return r.buttonIndex=n,r}return Object(r.__extends)(t,e),t}(i.Vector2),a=function(){function e(e,t,n,r,i,o){this.m=new Float32Array(6),this.fromValues(e,t,n,r,i,o)}return e.prototype.fromValues=function(e,t,n,r,i,o){return this.m[0]=e,this.m[1]=t,this.m[2]=n,this.m[3]=r,this.m[4]=i,this.m[5]=o,this},e.prototype.determinant=function(){return this.m[0]*this.m[3]-this.m[1]*this.m[2]},e.prototype.invertToRef=function(e){var t=this.m[0],n=this.m[1],r=this.m[2],o=this.m[3],a=this.m[4],s=this.m[5],l=this.determinant();if(l<i.Epsilon*i.Epsilon)return e.m[0]=0,e.m[1]=0,e.m[2]=0,e.m[3]=0,e.m[4]=0,e.m[5]=0,this;var c=1/l,u=r*s-o*a,_=n*a-t*s;return e.m[0]=o*c,e.m[1]=-n*c,e.m[2]=-r*c,e.m[3]=t*c,e.m[4]=u*c,e.m[5]=_*c,this},e.prototype.multiplyToRef=function(e,t){var n=this.m[0],r=this.m[1],i=this.m[2],o=this.m[3],a=this.m[4],s=this.m[5],l=e.m[0],c=e.m[1],u=e.m[2],_=e.m[3],h=e.m[4],f=e.m[5];return t.m[0]=n*l+r*u,t.m[1]=n*c+r*_,t.m[2]=i*l+o*u,t.m[3]=i*c+o*_,t.m[4]=a*l+s*u+h,t.m[5]=a*c+s*_+f,this},e.prototype.transformCoordinates=function(e,t,n){return n.x=e*this.m[0]+t*this.m[2]+this.m[4],n.y=e*this.m[1]+t*this.m[3]+this.m[5],this},e.Identity=function(){return new e(1,0,0,1,0,0)},e.TranslationToRef=function(e,t,n){n.fromValues(1,0,0,1,e,t)},e.ScalingToRef=function(e,t,n){n.fromValues(e,0,0,t,0,0)},e.RotationToRef=function(e,t){var n=Math.sin(e),r=Math.cos(e);t.fromValues(r,n,-n,r,0,0)},e.ComposeToRef=function(t,n,r,i,o,a,s){e.TranslationToRef(t,n,e._TempPreTranslationMatrix),e.ScalingToRef(i,o,e._TempScalingMatrix),e.RotationToRef(r,e._TempRotationMatrix),e.TranslationToRef(-t,-n,e._TempPostTranslationMatrix),e._TempPreTranslationMatrix.multiplyToRef(e._TempScalingMatrix,e._TempCompose0),e._TempCompose0.multiplyToRef(e._TempRotationMatrix,e._TempCompose1),a?(e._TempCompose1.multiplyToRef(e._TempPostTranslationMatrix,e._TempCompose2),e._TempCompose2.multiplyToRef(a,s)):e._TempCompose1.multiplyToRef(e._TempPostTranslationMatrix,s)},e._TempPreTranslationMatrix=e.Identity(),e._TempPostTranslationMatrix=e.Identity(),e._TempRotationMatrix=e.Identity(),e._TempScalingMatrix=e.Identity(),e._TempCompose0=e.Identity(),e._TempCompose1=e.Identity(),e._TempCompose2=e.Identity(),e}()},"./2D/measure.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"Measure",function(){return l});var r=n("babylonjs/Misc/perfCounter"),i=[new r.Vector2(0,0),new r.Vector2(0,0),new r.Vector2(0,0),new r.Vector2(0,0)],o=[new r.Vector2(0,0),new r.Vector2(0,0),new r.Vector2(0,0),new r.Vector2(0,0)],a=new r.Vector2(0,0),s=new r.Vector2(0,0),l=function(){function e(e,t,n,r){this.left=e,this.top=t,this.width=n,this.height=r}return e.prototype.copyFrom=function(e){this.left=e.left,this.top=e.top,this.width=e.width,this.height=e.height},e.prototype.copyFromFloats=function(e,t,n,r){this.left=e,this.top=t,this.width=n,this.height=r},e.CombineToRef=function(e,t,n){var r=Math.min(e.left,t.left),i=Math.min(e.top,t.top),o=Math.max(e.left+e.width,t.left+t.width),a=Math.max(e.top+e.height,t.top+t.height);n.left=r,n.top=i,n.width=o-r,n.height=a-i},e.prototype.addAndTransformToRef=function(e,t,n,r,l,c){var u=this.left+t,_=this.top+n,h=this.width+r,f=this.height+l;i[0].copyFromFloats(u,_),i[1].copyFromFloats(u+h,_),i[2].copyFromFloats(u+h,_+f),i[3].copyFromFloats(u,_+f),a.copyFromFloats(Number.MAX_VALUE,Number.MAX_VALUE),s.copyFromFloats(0,0);for(var d=0;d<4;d++)e.transformCoordinates(i[d].x,i[d].y,o[d]),a.x=Math.floor(Math.min(a.x,o[d].x)),a.y=Math.floor(Math.min(a.y,o[d].y)),s.x=Math.ceil(Math.max(s.x,o[d].x)),s.y=Math.ceil(Math.max(s.y,o[d].y));c.left=a.x,c.top=a.y,c.width=s.x-a.x,c.height=s.y-a.y},e.prototype.transformToRef=function(e,t){this.addAndTransformToRef(e,0,0,0,0,t)},e.prototype.isEqualsTo=function(e){return this.left===e.left&&(this.top===e.top&&(this.width===e.width&&this.height===e.height))},e.Empty=function(){return new e(0,0,0,0)},e}()},"./2D/multiLinePoint.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"MultiLinePoint",function(){return o});var r=n("babylonjs/Misc/perfCounter"),i=n("./2D/valueAndUnit.ts"),o=function(){function e(e){this._multiLine=e,this._x=new i.ValueAndUnit(0),this._y=new i.ValueAndUnit(0),this._point=new r.Vector3(0,0,0)}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x.toString(this._multiLine._host)},set:function(e){this._x.toString(this._multiLine._host)!==e&&this._x.fromString(e)&&this._multiLine._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y.toString(this._multiLine._host)},set:function(e){this._y.toString(this._multiLine._host)!==e&&this._y.fromString(e)&&this._multiLine._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"control",{get:function(){return this._control},set:function(e){this._control!==e&&(this._control&&this._controlObserver&&(this._control.onDirtyObservable.remove(this._controlObserver),this._controlObserver=null),this._control=e,this._control&&(this._controlObserver=this._control.onDirtyObservable.add(this._multiLine.onPointUpdate)),this._multiLine._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mesh",{get:function(){return this._mesh},set:function(e){this._mesh!==e&&(this._mesh&&this._meshObserver&&this._mesh.getScene().onAfterCameraRenderObservable.remove(this._meshObserver),this._mesh=e,this._mesh&&(this._meshObserver=this._mesh.getScene().onAfterCameraRenderObservable.add(this._multiLine.onPointUpdate)),this._multiLine._markAsDirty())},enumerable:!1,configurable:!0}),e.prototype.resetLinks=function(){this.control=null,this.mesh=null},e.prototype.translate=function(){return this._point=this._translatePoint(),this._point},e.prototype._translatePoint=function(){if(null!=this._mesh)return this._multiLine._host.getProjectedPositionWithZ(this._mesh.getBoundingInfo().boundingSphere.center,this._mesh.getWorldMatrix());if(null!=this._control)return new r.Vector3(this._control.centerX,this._control.centerY,1-r.Epsilon);var e=this._multiLine._host,t=this._x.getValueInPixel(e,Number(e._canvas.width)),n=this._y.getValueInPixel(e,Number(e._canvas.height));return new r.Vector3(t,n,1-r.Epsilon)},e.prototype.dispose=function(){this.resetLinks()},e}()},"./2D/style.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"Style",function(){return o});var r=n("babylonjs/Misc/perfCounter"),i=n("./2D/valueAndUnit.ts"),o=function(){function e(e){this._fontFamily="Arial",this._fontStyle="",this._fontWeight="",this._fontSize=new i.ValueAndUnit(18,i.ValueAndUnit.UNITMODE_PIXEL,!1),this.onChangedObservable=new r.Observable,this._host=e}return Object.defineProperty(e.prototype,"fontSize",{get:function(){return this._fontSize.toString(this._host)},set:function(e){this._fontSize.toString(this._host)!==e&&this._fontSize.fromString(e)&&this.onChangedObservable.notifyObservers(this)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(e){this._fontFamily!==e&&(this._fontFamily=e,this.onChangedObservable.notifyObservers(this))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(e){this._fontStyle!==e&&(this._fontStyle=e,this.onChangedObservable.notifyObservers(this))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(e){this._fontWeight!==e&&(this._fontWeight=e,this.onChangedObservable.notifyObservers(this))},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this.onChangedObservable.clear()},e}()},"./2D/valueAndUnit.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"ValueAndUnit",function(){return r});var r=function(){function e(t,n,r){void 0===n&&(n=e.UNITMODE_PIXEL),void 0===r&&(r=!0),this.unit=n,this.negativeValueAllowed=r,this._value=1,this.ignoreAdaptiveScaling=!1,this._value=t,this._originalUnit=n}return Object.defineProperty(e.prototype,"isPercentage",{get:function(){return this.unit===e.UNITMODE_PERCENTAGE},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPixel",{get:function(){return this.unit===e.UNITMODE_PIXEL},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"internalValue",{get:function(){return this._value},enumerable:!1,configurable:!0}),e.prototype.getValueInPixel=function(e,t){return this.isPixel?this.getValue(e):this.getValue(e)*t},e.prototype.updateInPlace=function(t,n){return void 0===n&&(n=e.UNITMODE_PIXEL),this._value=t,this.unit=n,this},e.prototype.getValue=function(t){if(t&&!this.ignoreAdaptiveScaling&&this.unit!==e.UNITMODE_PERCENTAGE){var n=0,r=0;if(t.idealWidth&&(n=this._value*t.getSize().width/t.idealWidth),t.idealHeight&&(r=this._value*t.getSize().height/t.idealHeight),t.useSmallestIdeal&&t.idealWidth&&t.idealHeight)return window.innerWidth<window.innerHeight?n:r;if(t.idealWidth)return n;if(t.idealHeight)return r}return this._value},e.prototype.toString=function(t,n){switch(this.unit){case e.UNITMODE_PERCENTAGE:var r=100*this.getValue(t);return(n?r.toFixed(n):r)+"%";case e.UNITMODE_PIXEL:var i=this.getValue(t);return(n?i.toFixed(n):i)+"px"}return this.unit.toString()},e.prototype.fromString=function(t){var n=e._Regex.exec(t.toString());if(!n||0===n.length)return!1;var r=parseFloat(n[1]),i=this._originalUnit;if(this.negativeValueAllowed||r<0&&(r=0),4===n.length)switch(n[3]){case"px":i=e.UNITMODE_PIXEL;break;case"%":i=e.UNITMODE_PERCENTAGE,r/=100}return(r!==this._value||i!==this.unit)&&(this._value=r,this.unit=i,!0)},Object.defineProperty(e,"UNITMODE_PERCENTAGE",{get:function(){return e._UNITMODE_PERCENTAGE},enumerable:!1,configurable:!0}),Object.defineProperty(e,"UNITMODE_PIXEL",{get:function(){return e._UNITMODE_PIXEL},enumerable:!1,configurable:!0}),e._Regex=/(^-?\d*(\.\d+)?)(%|px)?/,e._UNITMODE_PERCENTAGE=0,e._UNITMODE_PIXEL=1,e}()},"./2D/xmlLoader.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"XmlLoader",function(){return o});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=function(){function e(e){void 0===e&&(e=null),this._nodes={},this._nodeTypes={element:1,attribute:2,text:3},this._isLoaded=!1,this._objectAttributes={textHorizontalAlignment:1,textVerticalAlignment:2,horizontalAlignment:3,verticalAlignment:4,stretch:5},e&&(this._parentClass=e)}return e.prototype._getChainElement=function(e){var t=window;this._parentClass&&(t=this._parentClass);var n=e;n=n.split(".");for(var r=0;r<n.length;r++)t=t[n[r]];return t},e.prototype._getClassAttribute=function(e){var t=e.split(".");return Object(i.GetClass)("BABYLON.GUI."+t[0])[t[1]]},e.prototype._createGuiElement=function(e,t,n){void 0===n&&(n=!0);try{var r=new(Object(i.GetClass)("BABYLON.GUI."+e.nodeName));t&&n&&t.addControl(r);for(var o=0;o<e.attributes.length;o++)if(!e.attributes[o].name.toLowerCase().includes("datasource"))if(e.attributes[o].name.toLowerCase().includes("observable")){var a=this._getChainElement(e.attributes[o].value);r[e.attributes[o].name].add(a)}else if("linkWithMesh"==e.attributes[o].name)this._parentClass?r.linkWithMesh(this._parentClass[e.attributes[o].value]):r.linkWithMesh(window[e.attributes[o].value]);else if(e.attributes[o].value.startsWith("{{")&&e.attributes[o].value.endsWith("}}")){a=this._getChainElement(e.attributes[o].value.substring(2,e.attributes[o].value.length-2));r[e.attributes[o].name]=a}else this._objectAttributes[e.attributes[o].name]?r[e.attributes[o].name]=this._getClassAttribute(e.attributes[o].value):"true"==e.attributes[o].value||"false"==e.attributes[o].value?r[e.attributes[o].name]="true"==e.attributes[o].value:r[e.attributes[o].name]=isNaN(Number(e.attributes[o].value))?e.attributes[o].value:Number(e.attributes[o].value);if(!e.attributes.getNamedItem("id"))return this._nodes[e.nodeName+Object.keys(this._nodes).length+"_gen"]=r,r;var s=e.attributes.getNamedItem("id").value;if(s.startsWith("{{")&&s.endsWith("}}")&&(s=this._getChainElement(s.substring(2,s.length-2))),this._nodes[s])throw"XmlLoader Exception : Duplicate ID, every element should have an unique ID attribute";return this._nodes[s]=r,r}catch(t){throw"XmlLoader Exception : Error parsing Control "+e.nodeName+","+t+"."}},e.prototype._parseGrid=function(e,t,n){for(var r,i,o,a,s,l=e.children,c=!1,u=-1,_=-1,h=0,f=0;f<l.length;f++)if(l[f].nodeType==this._nodeTypes.element){if("Row"!=l[f].nodeName)throw"XmlLoader Exception : Expecting Row node, received "+l[f].nodeName;if(u+=1,o=l[f].children,!l[f].attributes.getNamedItem("height"))throw"XmlLoader Exception : Height must be defined for grid rows";i=Number(l[f].attributes.getNamedItem("height").nodeValue),c=!!l[f].attributes.getNamedItem("isPixel")&&JSON.parse(l[f].attributes.getNamedItem("isPixel").nodeValue),t.addRowDefinition(i,c);for(var d=0;d<o.length;d++)if(o[d].nodeType==this._nodeTypes.element){if("Column"!=o[d].nodeName)throw"XmlLoader Exception : Expecting Column node, received "+o[d].nodeName;if(_+=1,u>0&&_>h)throw"XmlLoader Exception : In the Grid element, the number of columns is defined in the first row, do not add more columns in the subsequent rows.";if(0==u){if(!o[d].attributes.getNamedItem("width"))throw"XmlLoader Exception : Width must be defined for all the grid columns in the first row";r=Number(o[d].attributes.getNamedItem("width").nodeValue),c=!!o[d].attributes.getNamedItem("isPixel")&&JSON.parse(o[d].attributes.getNamedItem("isPixel").nodeValue),t.addColumnDefinition(r,c)}a=o[d].children;for(var p=0;p<a.length;p++)a[p].nodeType==this._nodeTypes.element&&(s=this._createGuiElement(a[p],t,!1),t.addControl(s,u,_),a[p].firstChild&&this._parseXml(a[p].firstChild,s))}0==u&&(h=_),_=-1}e.nextSibling&&this._parseXml(e.nextSibling,n)},e.prototype._parseElement=function(e,t,n){e.firstChild&&this._parseXml(e.firstChild,t),e.nextSibling&&this._parseXml(e.nextSibling,n)},e.prototype._prepareSourceElement=function(e,t,n,r,i){this._parentClass?this._parentClass[n]=r[i]:window[n]=r[i],e.firstChild&&this._parseXml(e.firstChild,t,!0)},e.prototype._parseElementsFromSource=function(e,t,n){var r=e.attributes.getNamedItem("dataSource").value;if(!r.includes(" in "))throw"XmlLoader Exception : Malformed XML, Data Source must include an in";var i=!0,o=r.split(" in ");if(o.length<2)throw"XmlLoader Exception : Malformed XML, Data Source must have an iterator and a source";var a=o[1];if(a.startsWith("{")&&a.endsWith("}")&&(i=!1),(!i||a.startsWith("[")&&a.endsWith("]"))&&(a=a.substring(1,a.length-1)),a=this._parentClass?this._parentClass[a]:window[a],i)for(var s=0;s<a.length;s++)this._prepareSourceElement(e,t,o[0],a,s);else for(var s in a)this._prepareSourceElement(e,t,o[0],a,s);e.nextSibling&&this._parseXml(e.nextSibling,n)},e.prototype._parseXml=function(e,t,n){if(void 0===n&&(n=!1),e.nodeType==this._nodeTypes.element){n&&e.setAttribute("id",t.id+(t._children.length+1));var r=this._createGuiElement(e,t);this._rootNode||(this._rootNode=r),"Grid"==e.nodeName?this._parseGrid(e,r,t):e.attributes.getNamedItem("dataSource")?this._parseElementsFromSource(e,r,t):this._parseElement(e,r,t)}else e.nextSibling&&this._parseXml(e.nextSibling,t,n)},e.prototype.isLoaded=function(){return this._isLoaded},e.prototype.getNodeById=function(e){return this._nodes[e]},e.prototype.getNodes=function(){return this._nodes},e.prototype.dispose=function(){this._rootNode&&(this._rootNode.dispose(),this._rootNode=null,this._nodes={})},e.prototype.loadLayout=function(e,t,n,r){var i=this;void 0===n&&(n=null),void 0===r&&(r=null);var o=new XMLHttpRequest;o.onload=function(){if(4===o.readyState&&200===o.status){if(!o.responseXML)throw"XmlLoader Exception : XML file is malformed or corrupted.";var e=o.responseXML.documentElement;i._parseXml(e.firstChild,t),i._isLoaded=!0,n&&n()}},o.onerror=function(){r&&r("an error occurred during loading the layout")},o.open("GET",e,!0),o.send()},e.prototype.loadLayoutAsync=function(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n=this;return Object(r.__generator)(this,function(r){return[2,new Promise(function(r,i){n.loadLayout(e,t,r,i)})]})})},e}()},"./3D/behaviors/defaultBehavior.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"DefaultBehavior",function(){return i});var r=n("babylonjs/Misc/perfCounter"),i=function(){function e(){this.followBehaviorEnabled=!1,this.sixDofDragBehaviorEnabled=!0,this.surfaceMagnetismBehaviorEnabled=!0,this._followBehavior=new r.FollowBehavior,this._sixDofDragBehavior=new r.SixDofDragBehavior,this._surfaceMagnetismBehavior=new r.SurfaceMagnetismBehavior}return Object.defineProperty(e.prototype,"name",{get:function(){return"Default"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"followBehavior",{get:function(){return this._followBehavior},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sixDofDragBehavior",{get:function(){return this._sixDofDragBehavior},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"surfaceMagnetismBehavior",{get:function(){return this._surfaceMagnetismBehavior},enumerable:!1,configurable:!0}),e.prototype.init=function(){},e.prototype.attach=function(e,t,n){this._scene=e.getScene(),this.attachedNode=e,this._addObservables(),this._followBehavior.attach(e),this._sixDofDragBehavior.attach(e),this._sixDofDragBehavior.draggableMeshes=t||null,this._sixDofDragBehavior.faceCameraOnDragStart=!0,this._surfaceMagnetismBehavior.attach(e,this._scene),n&&(this._surfaceMagnetismBehavior.meshes=n),this._surfaceMagnetismBehavior.enabled=!1},e.prototype.detach=function(){this.attachedNode=null,this._removeObservables(),this._followBehavior.detach(),this._sixDofDragBehavior.detach(),this._surfaceMagnetismBehavior.detach()},e.prototype._addObservables=function(){var e=this;this._onBeforeRenderObserver=this._scene.onBeforeRenderObservable.add(function(){e._followBehavior._enabled=!e._sixDofDragBehavior.isMoving&&e.followBehaviorEnabled}),this._onDragObserver=this._sixDofDragBehavior.onDragObservable.add(function(t){e._sixDofDragBehavior.disableMovement=e._surfaceMagnetismBehavior.findAndUpdateTarget(t.pickInfo)})},e.prototype._removeObservables=function(){this._scene.onBeforeRenderObservable.remove(this._onBeforeRenderObserver),this._sixDofDragBehavior.onDragObservable.remove(this._onDragObserver)},e}()},"./3D/controls/abstractButton3D.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"AbstractButton3D",function(){return o});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=function(e){function t(t){return e.call(this,t)||this}return Object(r.__extends)(t,e),t.prototype._getTypeName=function(){return"AbstractButton3D"},t.prototype._createNode=function(e){return new i.TransformNode("button"+this.name)},t}(n("./3D/controls/contentDisplay3D.ts").ContentDisplay3D)},"./3D/controls/button3D.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"Button3D",function(){return o});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=function(e){function t(t){var n=e.call(this,t)||this;return n.pointerEnterAnimation=function(){n.mesh&&(n._currentMaterial.emissiveColor=i.Color3.Red())},n.pointerOutAnimation=function(){n._currentMaterial.emissiveColor=i.Color3.Black()},n.pointerDownAnimation=function(){n.mesh&&n.mesh.scaling.scaleInPlace(.95)},n.pointerUpAnimation=function(){n.mesh&&n.mesh.scaling.scaleInPlace(1/.95)},n}return Object(r.__extends)(t,e),t.prototype._applyFacade=function(e){this._currentMaterial.emissiveTexture=e},t.prototype._getTypeName=function(){return"Button3D"},t.prototype._createNode=function(e){for(var t=new Array(6),n=0;n<6;n++)t[n]=new i.Vector4(0,0,0,0);return t[1]=new i.Vector4(0,0,1,1),Object(i.CreateBox)(this.name+"_rootMesh",{width:1,height:1,depth:.08,faceUV:t},e)},t.prototype._affectMaterial=function(e){var t=new i.StandardMaterial(this.name+"Material",e.getScene());t.specularColor=i.Color3.Black(),e.material=t,this._currentMaterial=t,this._resetContent()},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._disposeFacadeTexture(),this._currentMaterial&&this._currentMaterial.dispose()},t}(n("./3D/controls/abstractButton3D.ts").AbstractButton3D)},"./3D/controls/container3D.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"Container3D",function(){return o});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=function(e){function t(t){var n=e.call(this,t)||this;return n._blockLayout=!1,n._children=new Array,n}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"children",{get:function(){return this._children},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blockLayout",{get:function(){return this._blockLayout},set:function(e){this._blockLayout!==e&&(this._blockLayout=e,this._blockLayout||this._arrangeChildren())},enumerable:!1,configurable:!0}),t.prototype.updateLayout=function(){return this._arrangeChildren(),this},t.prototype.containsControl=function(e){return-1!==this._children.indexOf(e)},t.prototype.addControl=function(e){return-1!==this._children.indexOf(e)?this:(e.parent=this,e._host=this._host,this._children.push(e),this._host.utilityLayer&&(e._prepareNode(this._host.utilityLayer.utilityLayerScene),e.node&&(e.node.parent=this.node),this.blockLayout||this._arrangeChildren()),this)},t.prototype._arrangeChildren=function(){},t.prototype._createNode=function(e){return new i.TransformNode("ContainerNode",e)},t.prototype.removeControl=function(e){var t=this._children.indexOf(e);return-1!==t&&(this._children.splice(t,1),e.parent=null,e._disposeNode()),this},t.prototype._getTypeName=function(){return"Container3D"},t.prototype.dispose=function(){for(var t=0,n=this._children;t<n.length;t++){n[t].dispose()}this._children=[],e.prototype.dispose.call(this)},t.UNSET_ORIENTATION=0,t.FACEORIGIN_ORIENTATION=1,t.FACEORIGINREVERSED_ORIENTATION=2,t.FACEFORWARD_ORIENTATION=3,t.FACEFORWARDREVERSED_ORIENTATION=4,t}(n("./3D/controls/control3D.ts").Control3D)},"./3D/controls/contentDisplay3D.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"ContentDisplay3D",function(){return s});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("./2D/advancedDynamicTexture.ts"),o=n("./3D/controls/control3D.ts"),a=n("babylonjs/Misc/perfCounter"),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._contentResolution=512,t._contentScaleRatio=2,t}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"content",{get:function(){return this._content},set:function(e){this._content=e,this._host&&this._host.utilityLayer&&(this._facadeTexture?this._facadeTexture.rootContainer.clearControls():(this._facadeTexture=new i.AdvancedDynamicTexture("Facade",this._contentResolution,this._contentResolution,this._host.utilityLayer.utilityLayerScene,!0,a.Texture.TRILINEAR_SAMPLINGMODE),this._facadeTexture.rootContainer.scaleX=this._contentScaleRatio,this._facadeTexture.rootContainer.scaleY=this._contentScaleRatio,this._facadeTexture.premulAlpha=!0),this._facadeTexture.addControl(e),this._applyFacade(this._facadeTexture))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"contentResolution",{get:function(){return this._contentResolution},set:function(e){this._contentResolution!==e&&(this._contentResolution=e,this._resetContent())},enumerable:!1,configurable:!0}),t.prototype._disposeFacadeTexture=function(){this._facadeTexture&&(this._facadeTexture.dispose(),this._facadeTexture=null)},t.prototype._resetContent=function(){this._disposeFacadeTexture(),this.content=this._content},t.prototype._applyFacade=function(e){},t}(o.Control3D)},"./3D/controls/control3D.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"Control3D",function(){return o});var r=n("babylonjs/Misc/perfCounter"),i=n("./3D/vector3WithInfo.ts"),o=function(){function e(e){this.name=e,this._downCount=0,this._enterCount=-1,this._downPointerIds={},this._isVisible=!0,this.onPointerMoveObservable=new r.Observable,this.onPointerOutObservable=new r.Observable,this.onPointerDownObservable=new r.Observable,this.onPointerUpObservable=new r.Observable,this.onPointerClickObservable=new r.Observable,this.onPointerEnterObservable=new r.Observable,this._behaviors=new Array}return Object.defineProperty(e.prototype,"position",{get:function(){return this._node?this._node.position:r.Vector3.Zero()},set:function(e){this._node&&(this._node.position=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaling",{get:function(){return this._node?this._node.scaling:new r.Vector3(1,1,1)},set:function(e){this._node&&(this._node.scaling=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"behaviors",{get:function(){return this._behaviors},enumerable:!1,configurable:!0}),e.prototype.addBehavior=function(e){var t=this;if(-1!==this._behaviors.indexOf(e))return this;e.init();var n=this._host.scene;return n.isLoading?n.onDataLoadedObservable.addOnce(function(){e.attach(t)}):e.attach(this),this._behaviors.push(e),this},e.prototype.removeBehavior=function(e){var t=this._behaviors.indexOf(e);return-1===t?this:(this._behaviors[t].detach(),this._behaviors.splice(t,1),this)},e.prototype.getBehaviorByName=function(e){for(var t=0,n=this._behaviors;t<n.length;t++){var r=n[t];if(r.name===e)return r}return null},Object.defineProperty(e.prototype,"isVisible",{get:function(){return this._isVisible},set:function(e){if(this._isVisible!==e){this._isVisible=e;var t=this.mesh;t&&t.setEnabled(e)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"typeName",{get:function(){return this._getTypeName()},enumerable:!1,configurable:!0}),e.prototype.getClassName=function(){return this._getTypeName()},e.prototype._getTypeName=function(){return"Control3D"},Object.defineProperty(e.prototype,"node",{get:function(){return this._node},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mesh",{get:function(){return this._node instanceof r.AbstractMesh?this._node:null},enumerable:!1,configurable:!0}),e.prototype.linkToTransformNode=function(e){return this._node&&(this._node.parent=e),this},e.prototype._prepareNode=function(e){if(!this._node){if(this._node=this._createNode(e),!this.node)return;this._injectGUI3DReservedDataStore(this.node).control=this;var t=this.mesh;t&&(t.isPickable=!0,this._affectMaterial(t))}},e.prototype._injectGUI3DReservedDataStore=function(e){var t,n;return e.reservedDataStore=null!==(t=e.reservedDataStore)&&void 0!==t?t:{},e.reservedDataStore.GUI3D=null!==(n=e.reservedDataStore.GUI3D)&&void 0!==n?n:{},e.reservedDataStore.GUI3D},e.prototype._createNode=function(e){return null},e.prototype._affectMaterial=function(e){e.material=null},e.prototype._IsTouchButton3D=function(e){return void 0!==e._generatePointerEventType},e.prototype._onPointerMove=function(e,t){this.onPointerMoveObservable.notifyObservers(t,-1,e,this)},e.prototype._onPointerEnter=function(e){return-1===this._enterCount&&(this._enterCount=0),this._enterCount++,!(this._enterCount>1)&&(this.onPointerEnterObservable.notifyObservers(this,-1,e,this),this.pointerEnterAnimation&&this.pointerEnterAnimation(),!0)},e.prototype._onPointerOut=function(e){this._enterCount--,this._enterCount>0||(this._enterCount=0,this.onPointerOutObservable.notifyObservers(this,-1,e,this),this.pointerOutAnimation&&this.pointerOutAnimation())},e.prototype._onPointerDown=function(e,t,n,r){return this._downCount++,this._downPointerIds[n]=this._downPointerIds[n]+1||1,1===this._downCount&&(this.onPointerDownObservable.notifyObservers(new i.Vector3WithInfo(t,r),-1,e,this),this.pointerDownAnimation&&this.pointerDownAnimation(),!0)},e.prototype._onPointerUp=function(e,t,n,r,o){this._downCount--,this._downPointerIds[n]--,this._downPointerIds[n]<=0&&delete this._downPointerIds[n],this._downCount<0?this._downCount=0:0==this._downCount&&(o&&(this._enterCount>0||-1===this._enterCount)&&this.onPointerClickObservable.notifyObservers(new i.Vector3WithInfo(t,r),-1,e,this),this.onPointerUpObservable.notifyObservers(new i.Vector3WithInfo(t,r),-1,e,this),this.pointerUpAnimation&&this.pointerUpAnimation())},e.prototype.forcePointerUp=function(e){if(void 0===e&&(e=null),null!==e)this._onPointerUp(this,r.Vector3.Zero(),e,0,!0);else{for(var t in this._downPointerIds)this._onPointerUp(this,r.Vector3.Zero(),+t,0,!0);this._downCount>0&&(this._downCount=1,this._onPointerUp(this,r.Vector3.Zero(),0,0,!0))}},e.prototype._processObservables=function(e,t,n,i,o){if(this._IsTouchButton3D(this)&&n&&(e=this._generatePointerEventType(e,n,this._downCount)),e===r.PointerEventTypes.POINTERMOVE){this._onPointerMove(this,t);var a=this._host._lastControlOver[i];return a&&a!==this&&a._onPointerOut(this),a!==this&&this._onPointerEnter(this),this._host._lastControlOver[i]=this,!0}return e===r.PointerEventTypes.POINTERDOWN?(this._onPointerDown(this,t,i,o),this._host._lastControlDown[i]=this,this._host._lastPickedControl=this,!0):(e===r.PointerEventTypes.POINTERUP||e===r.PointerEventTypes.POINTERDOUBLETAP)&&(this._host._lastControlDown[i]&&this._host._lastControlDown[i]._onPointerUp(this,t,i,o,!0),delete this._host._lastControlDown[i],!0)},e.prototype._disposeNode=function(){this._node&&(this._node.dispose(),this._node=null)},e.prototype.dispose=function(){this.onPointerDownObservable.clear(),this.onPointerEnterObservable.clear(),this.onPointerMoveObservable.clear(),this.onPointerOutObservable.clear(),this.onPointerUpObservable.clear(),this.onPointerClickObservable.clear(),this._disposeNode();for(var e=0,t=this._behaviors;e<t.length;e++){t[e].detach()}},e}()},"./3D/controls/cylinderPanel.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"CylinderPanel",function(){return s});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=n("./3D/controls/volumeBasedPanel.ts"),a=n("./3D/controls/container3D.ts"),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._radius=5,t}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"radius",{get:function(){return this._radius},set:function(e){var t=this;this._radius!==e&&(this._radius=e,i.Tools.SetImmediate(function(){t._arrangeChildren()}))},enumerable:!1,configurable:!0}),t.prototype._mapGridNode=function(e,t){var n=e.mesh;if(n){var r=this._cylindricalMapping(t);switch(e.position=r,this.orientation){case a.Container3D.FACEORIGIN_ORIENTATION:n.lookAt(new i.Vector3(2*r.x,r.y,2*r.z));break;case a.Container3D.FACEORIGINREVERSED_ORIENTATION:n.lookAt(new i.Vector3(-r.x,r.y,-r.z));break;case a.Container3D.FACEFORWARD_ORIENTATION:break;case a.Container3D.FACEFORWARDREVERSED_ORIENTATION:n.rotate(i.Axis.Y,Math.PI,i.Space.LOCAL)}}},t.prototype._cylindricalMapping=function(e){var t=new i.Vector3(0,e.y,this._radius),n=e.x/this._radius;return i.Matrix.RotationYawPitchRollToRef(n,0,0,i.TmpVectors.Matrix[0]),i.Vector3.TransformNormal(t,i.TmpVectors.Matrix[0])},t}(o.VolumeBasedPanel)},"./3D/controls/handMenu.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"HandMenu",function(){return a});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("./3D/controls/touchHolographicMenu.ts"),o=n("babylonjs/Misc/perfCounter"),a=function(e){function t(t,n){var r=e.call(this,n)||this;return r._handConstraintBehavior=new o.HandConstraintBehavior,r._handConstraintBehavior.linkToXRExperience(t),r.backPlateMargin=.15,r.rows=3,r}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"handConstraintBehavior",{get:function(){return this._handConstraintBehavior},enumerable:!1,configurable:!0}),t.prototype._createNode=function(t){var n=e.prototype._createNode.call(this,t);return this._handConstraintBehavior.attach(n),n},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._handConstraintBehavior.detach()},t}(i.TouchHolographicMenu)},"./3D/controls/holographicBackplate.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"HolographicBackplate",function(){return a});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=n("./3D/materials/fluentBackplate/fluentBackplateMaterial.ts"),a=function(e){function t(t,n){void 0===n&&(n=!0);var r=e.call(this,t)||this;return r._shareMaterials=n,r}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"renderingGroupId",{get:function(){return this._model.renderingGroupId},set:function(e){this._model.renderingGroupId=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"material",{get:function(){return this._material},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shareMaterials",{get:function(){return this._shareMaterials},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"HolographicBackplate"},t.prototype._createNode=function(e){var n,r=this,o=Object(i.CreateBox)((null!==(n=this.name)&&void 0!==n?n:"HolographicBackplate")+"_CollisionMesh",{width:1,height:1,depth:1},e);return o.isPickable=!0,o.visibility=0,i.SceneLoader.ImportMeshAsync(void 0,t.MODEL_BASE_URL,t.MODEL_FILENAME,e).then(function(e){var t=e.meshes[1];t.name=r.name+"_frontPlate",t.isPickable=!1,t.parent=o,r._material&&(t.material=r._material),r._model=t}),o},t.prototype._createMaterial=function(e){this._material=new o.FluentBackplateMaterial(this.name+" Material",e.getScene())},t.prototype._affectMaterial=function(e){this._shareMaterials?this._host._touchSharedMaterials.fluentBackplateMaterial?this._material=this._host._touchSharedMaterials.fluentBackplateMaterial:(this._createMaterial(e),this._host._touchSharedMaterials.fluentBackplateMaterial=this._material):this._createMaterial(e)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.shareMaterials||this._material.dispose(),this._model.dispose()},t.MODEL_BASE_URL="https://assets.babylonjs.com/meshes/MRTK/",t.MODEL_FILENAME="mrtk-fluent-backplate.glb",t}(n("./3D/controls/control3D.ts").Control3D)},"./3D/controls/holographicButton.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"HolographicButton",function(){return _});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("./3D/controls/button3D.ts"),o=n("babylonjs/Misc/perfCounter"),a=n("./3D/materials/fluent/fluentMaterial.ts"),s=n("./2D/controls/stackPanel.ts"),l=n("./2D/controls/image.ts"),c=n("./2D/controls/textBlock.ts"),u=n("./2D/advancedDynamicTexture.ts"),_=function(e){function t(t,n){void 0===n&&(n=!0);var r=e.call(this,t)||this;return r._shareMaterials=!0,r._shareMaterials=n,r.pointerEnterAnimation=function(){r.mesh&&r._frontPlate.setEnabled(!0)},r.pointerOutAnimation=function(){r.mesh&&r._frontPlate.setEnabled(!1)},r}return Object(r.__extends)(t,e),t.prototype._disposeTooltip=function(){this._tooltipFade=null,this._tooltipTextBlock&&this._tooltipTextBlock.dispose(),this._tooltipTexture&&this._tooltipTexture.dispose(),this._tooltipMesh&&this._tooltipMesh.dispose(),this.onPointerEnterObservable.remove(this._tooltipHoverObserver),this.onPointerOutObservable.remove(this._tooltipOutObserver)},Object.defineProperty(t.prototype,"renderingGroupId",{get:function(){return this._backPlate.renderingGroupId},set:function(e){this._backPlate.renderingGroupId=e,this._textPlate.renderingGroupId=e,this._frontPlate.renderingGroupId=e,this._tooltipMesh&&(this._tooltipMesh.renderingGroupId=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tooltipText",{get:function(){return this._tooltipTextBlock?this._tooltipTextBlock.text:null},set:function(e){var t=this;if(e){if(!this._tooltipFade){this._tooltipMesh=Object(o.CreatePlane)("",{size:1},this._backPlate._scene);var n=Object(o.CreatePlane)("",{size:1,sideOrientation:o.Mesh.DOUBLESIDE},this._backPlate._scene),r=new o.StandardMaterial("",this._backPlate._scene);r.diffuseColor=o.Color3.FromHexString("#212121"),n.material=r,n.isPickable=!1,this._tooltipMesh.addChild(n),n.position.z=.05,this._tooltipMesh.scaling.y=1/3,this._tooltipMesh.position.y=.7,this._tooltipMesh.position.z=-.15,this._tooltipMesh.isPickable=!1,this._tooltipMesh.parent=this._backPlate,this._tooltipTexture=u.AdvancedDynamicTexture.CreateForMesh(this._tooltipMesh),this._tooltipTextBlock=new c.TextBlock,this._tooltipTextBlock.scaleY=3,this._tooltipTextBlock.color="white",this._tooltipTextBlock.fontSize=130,this._tooltipTexture.addControl(this._tooltipTextBlock),this._tooltipFade=new o.FadeInOutBehavior,this._tooltipFade.delay=500,this._tooltipMesh.addBehavior(this._tooltipFade),this._tooltipHoverObserver=this.onPointerEnterObservable.add(function(){t._tooltipFade&&t._tooltipFade.fadeIn(!0)}),this._tooltipOutObserver=this.onPointerOutObservable.add(function(){t._tooltipFade&&t._tooltipFade.fadeIn(!1)})}this._tooltipTextBlock&&(this._tooltipTextBlock.text=e)}else this._disposeTooltip()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){this._text!==e&&(this._text=e,this._rebuildContent())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"imageUrl",{get:function(){return this._imageUrl},set:function(e){this._imageUrl!==e&&(this._imageUrl=e,this._rebuildContent())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"backMaterial",{get:function(){return this._backMaterial},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"frontMaterial",{get:function(){return this._frontMaterial},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"plateMaterial",{get:function(){return this._plateMaterial},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shareMaterials",{get:function(){return this._shareMaterials},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"HolographicButton"},t.prototype._rebuildContent=function(){this._disposeFacadeTexture();var e=new s.StackPanel;if(e.isVertical=!0,o.DomManagement.IsDocumentAvailable()&&document.createElement&&this._imageUrl){var t=new l.Image;t.source=this._imageUrl,t.paddingTop="40px",t.height="180px",t.width="100px",t.paddingBottom="40px",e.addControl(t)}if(this._text){var n=new c.TextBlock;n.text=this._text,n.color="white",n.height="30px",n.fontSize=24,e.addControl(n)}this._frontPlate&&(this.content=e)},t.prototype._createNode=function(t){return this._backPlate=Object(o.CreateBox)(this.name+"BackMesh",{width:1,height:1,depth:.08},t),this._frontPlate=Object(o.CreateBox)(this.name+"FrontMesh",{width:1,height:1,depth:.08},t),this._frontPlate.parent=this._backPlate,this._frontPlate.position.z=-.08,this._frontPlate.isPickable=!1,this._frontPlate.setEnabled(!1),this._textPlate=e.prototype._createNode.call(this,t),this._textPlate.parent=this._backPlate,this._textPlate.position.z=-.08,this._textPlate.isPickable=!1,this._backPlate},t.prototype._applyFacade=function(e){this._plateMaterial.emissiveTexture=e,this._plateMaterial.opacityTexture=e},t.prototype._createBackMaterial=function(e){var t=this;this._backMaterial=new a.FluentMaterial(this.name+"Back Material",e.getScene()),this._backMaterial.renderHoverLight=!0,this._pickedPointObserver=this._host.onPickedPointChangedObservable.add(function(e){e?(t._backMaterial.hoverPosition=e,t._backMaterial.hoverColor.a=1):t._backMaterial.hoverColor.a=0})},t.prototype._createFrontMaterial=function(e){this._frontMaterial=new a.FluentMaterial(this.name+"Front Material",e.getScene()),this._frontMaterial.innerGlowColorIntensity=0,this._frontMaterial.alpha=.5,this._frontMaterial.renderBorders=!0},t.prototype._createPlateMaterial=function(e){this._plateMaterial=new o.StandardMaterial(this.name+"Plate Material",e.getScene()),this._plateMaterial.specularColor=o.Color3.Black()},t.prototype._affectMaterial=function(e){this._shareMaterials?(this._host._sharedMaterials.backFluentMaterial?this._backMaterial=this._host._sharedMaterials.backFluentMaterial:(this._createBackMaterial(e),this._host._sharedMaterials.backFluentMaterial=this._backMaterial),this._host._sharedMaterials.frontFluentMaterial?this._frontMaterial=this._host._sharedMaterials.frontFluentMaterial:(this._createFrontMaterial(e),this._host._sharedMaterials.frontFluentMaterial=this._frontMaterial)):(this._createBackMaterial(e),this._createFrontMaterial(e)),this._createPlateMaterial(e),this._backPlate.material=this._backMaterial,this._frontPlate.material=this._frontMaterial,this._textPlate.material=this._plateMaterial,this._rebuildContent()},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._disposeTooltip(),this.shareMaterials||(this._backMaterial.dispose(),this._frontMaterial.dispose(),this._plateMaterial.dispose(),this._pickedPointObserver&&(this._host.onPickedPointChangedObservable.remove(this._pickedPointObserver),this._pickedPointObserver=null))},t}(i.Button3D)},"./3D/controls/holographicSlate.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"HolographicSlate",function(){return h});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=n("./3D/materials/fluent/fluentMaterial.ts"),a=n("./3D/controls/touchHolographicButton.ts"),s=n("./3D/controls/contentDisplay3D.ts"),l=n("./2D/controls/image.ts"),c=n("./3D/gizmos/slateGizmo.ts"),u=n("./3D/behaviors/defaultBehavior.ts"),_=n("./3D/materials/fluentBackplate/fluentBackplateMaterial.ts"),h=function(e){function t(t){var n=e.call(this,t)||this;return n.dimensions=new i.Vector3(.7,.4,.001),n.minDimensions=new i.Vector3(.5,.2,.001),n.defaultDimensions=n.dimensions.clone(),n.backplateDimensions=new i.Vector3(.7,.02,.001),n.backPlateMargin=.005,n.origin=new i.Vector3(0,0,0),n._contentScaleRatio=1,n._followButton=new a.TouchHolographicButton("followButton"+n.name),n._closeButton=new a.TouchHolographicButton("closeButton"+n.name),n._contentViewport=new i.Viewport(0,0,1,1),n._contentDragBehavior=new i.PointerDragBehavior({dragPlaneNormal:new i.Vector3(0,0,-1)}),n}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"defaultBehavior",{get:function(){return this._defaultBehavior},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderingGroupId",{get:function(){return this._backPlate.renderingGroupId},set:function(e){this._backPlate.renderingGroupId=e,this._contentPlate.renderingGroupId=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"imageUrl",{get:function(){return this._imageUrl},set:function(e){this._imageUrl!==e&&(this._imageUrl=e,this._rebuildContent(),this._resetContentPositionAndZoom(),this._applyContentViewport())},enumerable:!1,configurable:!0}),t.prototype._applyFacade=function(e){this._contentMaterial.albedoTexture=e},t.prototype._rebuildContent=function(){if(this._disposeFacadeTexture(),i.DomManagement.IsDocumentAvailable()&&document.createElement&&this._imageUrl){var e=new l.Image;e.source=this._imageUrl,this._contentPlate&&(this.content=e)}},t.prototype._addControl=function(e){e._host=this._host,this._host.utilityLayer&&e._prepareNode(this._host.utilityLayer.utilityLayerScene)},t.prototype._getTypeName=function(){return"HolographicSlate"},t.prototype._positionElements=function(){var e=this._followButton.mesh,t=this._closeButton.mesh,n=this._backPlate,r=this._contentPlate;if(e&&t&&n){var i=this.backplateDimensions.y/1;t.scaling.setAll(i),e.scaling.setAll(i),t.position.copyFromFloats(this.backplateDimensions.x-i/2,-this.backplateDimensions.y/2,-this.backplateDimensions.z/2*(this._host.scene.useRightHandedSystem?-1:1)).addInPlace(this.origin),e.position.copyFromFloats(this.backplateDimensions.x-3*i/2,-this.backplateDimensions.y/2,-this.backplateDimensions.z/2*(this._host.scene.useRightHandedSystem?-1:1)).addInPlace(this.origin);var o=this.dimensions.y-this.backplateDimensions.y-this.backPlateMargin;n.scaling.copyFrom(this.backplateDimensions),r.scaling.copyFromFloats(this.dimensions.x,o,this.dimensions.z),n.position.copyFromFloats(this.backplateDimensions.x/2,-this.backplateDimensions.y/2,0).addInPlace(this.origin),r.position.copyFromFloats(this.dimensions.x/2,-(this.backplateDimensions.y+this.backPlateMargin+o/2),0).addInPlace(this.origin);var a=this.dimensions.x/o;this._contentViewport.width=this._contentScaleRatio,this._contentViewport.height=this._contentScaleRatio/a,this._applyContentViewport()}},t.prototype._applyContentViewport=function(){if(this._contentPlate.material&&this._contentPlate.material.albedoTexture){var e=this._contentPlate.material.albedoTexture;e.uScale=this._contentScaleRatio,e.vScale=this._contentScaleRatio/this._contentViewport.width*this._contentViewport.height,e.uOffset=this._contentViewport.x,e.vOffset=this._contentViewport.y}},t.prototype._resetContentPositionAndZoom=function(){this._contentViewport.x=0,this._contentViewport.y=1-this._contentViewport.height/this._contentViewport.width,this._contentScaleRatio=1},t.prototype._updatePivot=function(){if(this.mesh){var e=this.dimensions.scale(.5);e.y*=-1,e.addInPlace(this.origin),e.z=0;var t=new i.Vector3(0,0,0);i.Vector3.TransformCoordinatesToRef(t,this.mesh.computeWorldMatrix(!0),t),this.mesh.setPivotPoint(e);var n=new i.Vector3(0,0,0);i.Vector3.TransformCoordinatesToRef(n,this.mesh.computeWorldMatrix(!0),n),this.mesh.position.addInPlace(t).subtractInPlace(n)}},t.prototype._createNode=function(e){var n=this,r=new i.Mesh("slate"+this.name,e);this._backPlate=Object(i.CreateBox)("backPlate"+this.name,{size:1},e),this._contentPlate=Object(i.CreateBox)("contentPlate"+this.name,{size:1},e),this._backPlate.parent=r,this._backPlate.isNearGrabbable=!0,this._contentPlate.parent=r,this._attachContentPlateBehavior(),this._addControl(this._followButton),this._addControl(this._closeButton);var o=this._followButton.mesh,a=this._closeButton.mesh;return o.parent=r,a.parent=r,this._positionElements(),this._followButton.imageUrl=t.ASSETS_BASE_URL+t.FOLLOW_ICON_FILENAME,this._closeButton.imageUrl=t.ASSETS_BASE_URL+t.CLOSE_ICON_FILENAME,this._followButton.backMaterial.alpha=0,this._closeButton.backMaterial.alpha=0,this._followButton.onPointerClickObservable.add(function(){n._defaultBehavior.followBehaviorEnabled=!n._defaultBehavior.followBehaviorEnabled,n._defaultBehavior.followBehaviorEnabled&&n._defaultBehavior.followBehavior.recenter()}),this._closeButton.onPointerClickObservable.add(function(){n.dispose()}),r.rotationQuaternion=i.Quaternion.Identity(),r.isVisible=!1,r},t.prototype._attachContentPlateBehavior=function(){var e=this;this._contentDragBehavior.attach(this._contentPlate),this._contentDragBehavior.moveAttached=!1,this._contentDragBehavior.useObjectOrientationForDragging=!0,this._contentDragBehavior.updateDragPlane=!1;var t,n,r=new i.Vector3,o=new i.Vector3,a=new i.Vector3,s=new i.Vector3,l=new i.Vector2;this._contentDragBehavior.onDragStartObservable.add(function(l){e.node&&(t=e._contentViewport.clone(),n=e.node.computeWorldMatrix(!0),r.copyFrom(l.dragPlanePoint),o.copyFrom(e.dimensions),o.y-=e.backplateDimensions.y+e.backPlateMargin,i.Vector3.TransformNormalToRef(o,n,o),a.copyFromFloats(0,1,0),i.Vector3.TransformNormalToRef(a,n,a),s.copyFromFloats(1,0,0),i.Vector3.TransformNormalToRef(s,n,s),a.normalize(),a.scaleInPlace(1/i.Vector3.Dot(a,o)),s.normalize(),s.scaleInPlace(1/i.Vector3.Dot(s,o)))});var c=new i.Vector3;this._contentDragBehavior.onDragObservable.add(function(n){c.copyFrom(n.dragPlanePoint),c.subtractInPlace(r),l.copyFromFloats(i.Vector3.Dot(c,s),i.Vector3.Dot(c,a)),e._contentViewport.x=i.Scalar.Clamp(t.x-c.x,0,1-e._contentViewport.width*e._contentScaleRatio),e._contentViewport.y=i.Scalar.Clamp(t.y-c.y,0,1-e._contentViewport.height*e._contentScaleRatio),e._applyContentViewport()})},t.prototype._affectMaterial=function(e){this._backPlateMaterial=new _.FluentBackplateMaterial(this.name+" plateMaterial",e.getScene()),this._pickedPointObserver=this._host.onPickedPointChangedObservable.add(function(e){}),this._contentMaterial=new o.FluentMaterial(this.name+"contentMaterial",e.getScene()),this._contentMaterial.renderBorders=!0,this._backPlate.material=this._backPlateMaterial,this._contentPlate.material=this._contentMaterial,this._rebuildContent(),this._applyContentViewport()},t.prototype._prepareNode=function(t){var n=this;e.prototype._prepareNode.call(this,t),this._gizmo=new c.SlateGizmo(this._host.utilityLayer),this._gizmo.attachedSlate=this,this._defaultBehavior=new u.DefaultBehavior,this._defaultBehavior.attach(this.node,[this._backPlate]),this._positionChangedObserver=this._defaultBehavior.sixDofDragBehavior.onPositionChangedObservable.add(function(){n._gizmo.updateBoundingBox()}),this._updatePivot(),this.resetDefaultAspectAndPose()},t.prototype.resetDefaultAspectAndPose=function(){if(this._host&&this._host.utilityLayer&&this.node){var e=this._host.utilityLayer.utilityLayerScene,t=e.activeCamera;if(t){var n=t.getWorldMatrix(),r=i.Vector3.TransformNormal(i.Vector3.Backward(e.useRightHandedSystem),n);this.dimensions.copyFrom(this.defaultDimensions),this.origin.setAll(0),this._gizmo.updateBoundingBox();var o=this.node.getAbsolutePivotPoint();this.node.position.copyFrom(t.position).subtractInPlace(r).subtractInPlace(o),this.node.rotationQuaternion=i.Quaternion.FromLookDirectionLH(r,new i.Vector3(0,1,0))}}},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._backPlateMaterial.dispose(),this._contentMaterial.dispose(),this._backPlate.dispose(),this._contentPlate.dispose(),this._followButton.dispose(),this._closeButton.dispose(),this._host.onPickedPointChangedObservable.remove(this._pickedPointObserver),this._defaultBehavior.sixDofDragBehavior.onPositionChangedObservable.remove(this._positionChangedObserver),this._defaultBehavior.detach(),this._gizmo.dispose(),this._contentDragBehavior.detach()},t.ASSETS_BASE_URL="https://assets.babylonjs.com/meshes/MRTK/",t.CLOSE_ICON_FILENAME="IconClose.png",t.FOLLOW_ICON_FILENAME="IconFollowMe.png",t}(s.ContentDisplay3D)},"./3D/controls/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./3D/controls/abstractButton3D.ts");n.d(t,"AbstractButton3D",function(){return r.AbstractButton3D});var i=n("./3D/controls/button3D.ts");n.d(t,"Button3D",function(){return i.Button3D});var o=n("./3D/controls/container3D.ts");n.d(t,"Container3D",function(){return o.Container3D});var a=n("./3D/controls/control3D.ts");n.d(t,"Control3D",function(){return a.Control3D});var s=n("./3D/controls/cylinderPanel.ts");n.d(t,"CylinderPanel",function(){return s.CylinderPanel});var l=n("./3D/controls/holographicButton.ts");n.d(t,"HolographicButton",function(){return l.HolographicButton});var c=n("./3D/controls/holographicSlate.ts");n.d(t,"HolographicSlate",function(){return c.HolographicSlate});var u=n("./3D/controls/handMenu.ts");n.d(t,"HandMenu",function(){return u.HandMenu});var _=n("./3D/controls/meshButton3D.ts");n.d(t,"MeshButton3D",function(){return _.MeshButton3D});var h=n("./3D/controls/nearMenu.ts");n.d(t,"NearMenu",function(){return h.NearMenu});var f=n("./3D/controls/planePanel.ts");n.d(t,"PlanePanel",function(){return f.PlanePanel});var d=n("./3D/controls/scatterPanel.ts");n.d(t,"ScatterPanel",function(){return d.ScatterPanel});var p=n("./3D/controls/slider3D.ts");n.d(t,"Slider3D",function(){return p.Slider3D});var m=n("./3D/controls/spherePanel.ts");n.d(t,"SpherePanel",function(){return m.SpherePanel});var g=n("./3D/controls/stackPanel3D.ts");n.d(t,"StackPanel3D",function(){return g.StackPanel3D});var v=n("./3D/controls/touchButton3D.ts");n.d(t,"TouchButton3D",function(){return v.TouchButton3D});var b=n("./3D/controls/touchMeshButton3D.ts");n.d(t,"TouchMeshButton3D",function(){return b.TouchMeshButton3D});var y=n("./3D/controls/touchHolographicButton.ts");n.d(t,"TouchHolographicButton",function(){return y.TouchHolographicButton});var x=n("./3D/controls/touchHolographicMenu.ts");n.d(t,"TouchHolographicMenu",function(){return x.TouchHolographicMenu});var T=n("./3D/controls/touchToggleButton3D.ts");n.d(t,"TouchToggleButton3D",function(){return T.TouchToggleButton3D});var O=n("./3D/controls/volumeBasedPanel.ts");n.d(t,"VolumeBasedPanel",function(){return O.VolumeBasedPanel});var P=n("./3D/controls/holographicBackplate.ts");n.d(t,"HolographicBackplate",function(){return P.HolographicBackplate})},"./3D/controls/meshButton3D.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"MeshButton3D",function(){return i});var r=n("../../node_modules/tslib/tslib.es6.js"),i=function(e){function t(t,n){var r=e.call(this,n)||this;return r._currentMesh=t,r.pointerEnterAnimation=function(){r.mesh&&r.mesh.scaling.scaleInPlace(1.1)},r.pointerOutAnimation=function(){r.mesh&&r.mesh.scaling.scaleInPlace(1/1.1)},r.pointerDownAnimation=function(){r.mesh&&r.mesh.scaling.scaleInPlace(.95)},r.pointerUpAnimation=function(){r.mesh&&r.mesh.scaling.scaleInPlace(1/.95)},r}return Object(r.__extends)(t,e),t.prototype._getTypeName=function(){return"MeshButton3D"},t.prototype._createNode=function(e){var t=this;return this._currentMesh.getChildMeshes().forEach(function(e){t._injectGUI3DReservedDataStore(e).control=t}),this._currentMesh},t.prototype._affectMaterial=function(e){},t}(n("./3D/controls/button3D.ts").Button3D)},"./3D/controls/nearMenu.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"NearMenu",function(){return s});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("./3D/controls/touchHolographicButton.ts"),o=n("./3D/behaviors/defaultBehavior.ts"),a=n("./3D/controls/touchHolographicMenu.ts"),s=function(e){function t(t){var n=e.call(this,t)||this;return n._isPinned=!1,n._defaultBehavior=new o.DefaultBehavior,n._dragObserver=n._defaultBehavior.sixDofDragBehavior.onDragObservable.add(function(){n.isPinned=!0}),n.backPlateMargin=1,n}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"defaultBehavior",{get:function(){return this._defaultBehavior},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isPinned",{get:function(){return this._isPinned},set:function(e){this._isPinned=e,this._isPinned?(this._pinMaterial.emissiveColor.copyFromFloats(.25,.4,.95),this._defaultBehavior.followBehaviorEnabled=!1):(this._pinMaterial.emissiveColor.copyFromFloats(.08,.15,.55),this._defaultBehavior.followBehaviorEnabled=!0)},enumerable:!1,configurable:!0}),t.prototype._createPinButton=function(e){var n=this,r=new i.TouchHolographicButton("pin"+this.name,!1);return r.imageUrl=t.ASSETS_BASE_URL+t.PIN_ICON_FILENAME,r.parent=this,r._host=this._host,r.onPointerClickObservable.add(function(){return n.isPinned=!n.isPinned}),this._host.utilityLayer&&(r._prepareNode(this._host.utilityLayer.utilityLayerScene),r.scaling.scaleInPlace(a.TouchHolographicMenu.MENU_BUTTON_SCALE),this._pinMaterial=r.backMaterial,this._pinMaterial.diffuseColor.copyFromFloats(0,0,0),r.node&&(r.node.parent=e)),r},t.prototype._createNode=function(t){var n=e.prototype._createNode.call(this,t);return this._pinButton=this._createPinButton(n),this.isPinned=!1,this._defaultBehavior.attach(n,[this._backPlate]),this._defaultBehavior.followBehavior.ignoreCameraPitchAndRoll=!0,this._defaultBehavior.followBehavior.pitchOffset=-15,this._defaultBehavior.followBehavior.minimumDistance=.3,this._defaultBehavior.followBehavior.defaultDistance=.4,this._defaultBehavior.followBehavior.maximumDistance=.6,this._backPlate.isNearGrabbable=!0,n.isVisible=!1,n},t.prototype._finalProcessing=function(){e.prototype._finalProcessing.call(this),this._pinButton.position.copyFromFloats(this._backPlate.scaling.x/2+.2,this._backPlate.scaling.y/2,0)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._defaultBehavior.sixDofDragBehavior.onDragObservable.remove(this._dragObserver),this._defaultBehavior.detach()},t.ASSETS_BASE_URL="https://assets.babylonjs.com/meshes/MRTK/",t.PIN_ICON_FILENAME="IconPin.png",t}(a.TouchHolographicMenu)},"./3D/controls/planePanel.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"PlanePanel",function(){return a});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=n("./3D/controls/container3D.ts"),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype._mapGridNode=function(e,t){var n=e.mesh;if(n){e.position=t.clone();var r=i.TmpVectors.Vector3[0];switch(r.copyFrom(t),this.orientation){case o.Container3D.FACEORIGIN_ORIENTATION:case o.Container3D.FACEFORWARD_ORIENTATION:r.addInPlace(new i.Vector3(0,0,1)),n.lookAt(r);break;case o.Container3D.FACEFORWARDREVERSED_ORIENTATION:case o.Container3D.FACEORIGINREVERSED_ORIENTATION:r.addInPlace(new i.Vector3(0,0,-1)),n.lookAt(r)}}},t}(n("./3D/controls/volumeBasedPanel.ts").VolumeBasedPanel)},"./3D/controls/scatterPanel.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"ScatterPanel",function(){return s});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=n("./3D/controls/volumeBasedPanel.ts"),a=n("./3D/controls/container3D.ts"),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._iteration=100,t}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"iteration",{get:function(){return this._iteration},set:function(e){var t=this;this._iteration!==e&&(this._iteration=e,i.Tools.SetImmediate(function(){t._arrangeChildren()}))},enumerable:!1,configurable:!0}),t.prototype._mapGridNode=function(e,t){var n=e.mesh,r=this._scatterMapping(t);if(n){switch(this.orientation){case a.Container3D.FACEORIGIN_ORIENTATION:case a.Container3D.FACEFORWARD_ORIENTATION:n.lookAt(new i.Vector3(0,0,1));break;case a.Container3D.FACEFORWARDREVERSED_ORIENTATION:case a.Container3D.FACEORIGINREVERSED_ORIENTATION:n.lookAt(new i.Vector3(0,0,-1))}e.position=r}},t.prototype._scatterMapping=function(e){return e.x=(1-2*Math.random())*this._cellWidth,e.y=(1-2*Math.random())*this._cellHeight,e},t.prototype._finalProcessing=function(){for(var e=[],t=0,n=this._children;t<n.length;t++){var r=n[t];r.mesh&&e.push(r.mesh)}for(var o=0;o<this._iteration;o++){e.sort(function(e,t){var n=e.position.lengthSquared(),r=t.position.lengthSquared();return n<r?1:n>r?-1:0});for(var a=Math.pow(this.margin,2),s=Math.max(this._cellWidth,this._cellHeight),l=i.TmpVectors.Vector2[0],c=i.TmpVectors.Vector3[0],u=0;u<e.length-1;u++)for(var _=u+1;_<e.length;_++)if(u!=_){e[_].position.subtractToRef(e[u].position,c),l.x=c.x,l.y=c.y;var h=s,f=l.lengthSquared()-a;(f-=Math.min(f,a))<Math.pow(h,2)&&(l.normalize(),c.scaleInPlace(.5*(h-Math.sqrt(f))),e[_].position.addInPlace(c),e[u].position.subtractInPlace(c))}}},t}(o.VolumeBasedPanel)},"./3D/controls/slider3D.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"Slider3D",function(){return f});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=n("./3D/controls/control3D.ts"),a=n("./3D/materials/mrdl/mrdlSliderBarMaterial.ts"),s=n("./3D/materials/mrdl/mrdlSliderThumbMaterial.ts"),l=n("./3D/materials/mrdl/mrdlBackplateMaterial.ts"),c=0,u=100,_=50,h=0,f=function(e){function t(t,n){var r=e.call(this,t)||this;return r.onValueChangedObservable=new i.Observable,r._sliderBackplateVisible=n||!1,r._minimum=c,r._maximum=u,r._step=h,r._value=_,r}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"mesh",{get:function(){return this.node?this._sliderThumb:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minimum",{get:function(){return this._minimum},set:function(e){this._minimum!==e&&(this._minimum=Math.max(e,c),this._value=Math.max(Math.min(this._value,this._maximum),this._minimum))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maximum",{get:function(){return this._maximum},set:function(e){this._maximum!==e&&(this._maximum=Math.max(e,this._minimum),this._value=Math.max(Math.min(this._value,this._maximum),this._minimum))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"step",{get:function(){return this._step},set:function(e){this._step!==e&&(this._step=Math.max(Math.min(e,this._maximum-this._minimum),h))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){this._value!==e&&(this._value=Math.max(Math.min(e,this._maximum),this._minimum),this.onValueChangedObservable.notifyObservers(this._value))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"start",{get:function(){return this.node?this._sliderBar.position.x-this._sliderBar.scaling.x/2:-.5},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return this.node?this._sliderBar.position.x+this._sliderBar.scaling.x/2:.5},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sliderBarMaterial",{get:function(){return this._sliderBarMaterial},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sliderThumbMaterial",{get:function(){return this._sliderThumbMaterial},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sliderBackplateMaterial",{get:function(){return this._sliderBackplateMaterial},enumerable:!1,configurable:!0}),t.prototype._createNode=function(e){var n=this,r=Object(i.CreateBox)(this.name+"_sliderbackplate",{width:1,height:1,depth:1},e);return r.isPickable=!1,r.visibility=0,r.scaling=new i.Vector3(1,.5,.8),i.SceneLoader.ImportMeshAsync(void 0,t.MODEL_BASE_URL,t.MODEL_FILENAME,e).then(function(e){var t=e.meshes[1],o=e.meshes[1].clone(n.name+"_sliderbar",r),a=e.meshes[1].clone(n.name+"_sliderthumb",r);t.visibility=0,n._sliderBackplateVisible&&(t.visibility=1,t.name=n.name+"_sliderbackplate",t.isPickable=!1,t.scaling.x=1,t.scaling.z=.2,t.parent=r,n._sliderBackplateMaterial&&(t.material=n._sliderBackplateMaterial),n._sliderBackplate=t),o&&(o.parent=r,o.position.z=-.1,o.scaling=new i.Vector3(.8,.04,.3),o.isPickable=!1,n._sliderBarMaterial&&(o.material=n._sliderBarMaterial),n._sliderBar=o),a&&(a.parent=r,a.isPickable=!0,a.position.z=-.115,a.scaling=new i.Vector3(.025,.3,.6),a.position.x=n._convertToPosition(n.value),a.addBehavior(n._createBehavior()),n._sliderThumbMaterial&&(a.material=n._sliderThumbMaterial),n._sliderThumb=a)}),this._affectMaterial(r),r},t.prototype._affectMaterial=function(e){var t,n,r;this._sliderBackplateMaterial=null!==(t=this._sliderBackplateMaterial)&&void 0!==t?t:new l.MRDLBackplateMaterial(this.name+"_sliderbackplate_material",e.getScene()),this._sliderBarMaterial=null!==(n=this._sliderBarMaterial)&&void 0!==n?n:new a.MRDLSliderBarMaterial(this.name+"_sliderbar_material",e.getScene()),this._sliderThumbMaterial=null!==(r=this._sliderThumbMaterial)&&void 0!==r?r:new s.MRDLSliderThumbMaterial(this.name+"_sliderthumb_material",e.getScene())},t.prototype._createBehavior=function(){var e=this,t=new i.PointerDragBehavior({dragAxis:i.Vector3.Right()});return t.moveAttached=!1,t.onDragObservable.add(function(t){var n=e._sliderThumb.position.x+t.dragDistance/e.scaling.x;e._sliderThumb.position.x=Math.max(Math.min(n,e.end),e.start),e.value=e._convertToValue(e._sliderThumb.position.x)}),t.onDragEndObservable.add(function(t){e._sliderThumb.position.x=e._convertToPosition(e.value)}),t},t.prototype._convertToPosition=function(e){var t=(e-this.minimum)/(this.maximum-this.minimum)*(this.end-this.start)+this.start;return Math.min(Math.max(t,this.start),this.end)},t.prototype._convertToValue=function(e){var t=(e-this.start)/(this.end-this.start)*(this.maximum-this.minimum);return t=this.step?Math.round(t/this.step)*this.step:t,Math.max(Math.min(this.minimum+t,this._maximum),this._minimum)},t.prototype.dispose=function(){var t,n,r,i,o,a;e.prototype.dispose.call(this),null===(t=this._sliderBar)||void 0===t||t.dispose(),null===(n=this._sliderThumb)||void 0===n||n.dispose(),null===(r=this._sliderBarMaterial)||void 0===r||r.dispose(),null===(i=this._sliderThumbMaterial)||void 0===i||i.dispose(),null===(o=this._sliderBackplate)||void 0===o||o.dispose(),null===(a=this._sliderBackplateMaterial)||void 0===a||a.dispose()},t.MODEL_BASE_URL="https://assets.babylonjs.com/meshes/MRTK/",t.MODEL_FILENAME="mrtk-fluent-backplate.glb",t}(o.Control3D)},"./3D/controls/spherePanel.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"SpherePanel",function(){return s});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=n("./3D/controls/volumeBasedPanel.ts"),a=n("./3D/controls/container3D.ts"),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._radius=5,t}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"radius",{get:function(){return this._radius},set:function(e){var t=this;this._radius!==e&&(this._radius=e,i.Tools.SetImmediate(function(){t._arrangeChildren()}))},enumerable:!1,configurable:!0}),t.prototype._mapGridNode=function(e,t){var n=e.mesh;if(n){var r=this._sphericalMapping(t);switch(e.position=r,this.orientation){case a.Container3D.FACEORIGIN_ORIENTATION:n.lookAt(new i.Vector3(2*r.x,2*r.y,2*r.z));break;case a.Container3D.FACEORIGINREVERSED_ORIENTATION:n.lookAt(new i.Vector3(-r.x,-r.y,-r.z));break;case a.Container3D.FACEFORWARD_ORIENTATION:break;case a.Container3D.FACEFORWARDREVERSED_ORIENTATION:n.rotate(i.Axis.Y,Math.PI,i.Space.LOCAL)}}},t.prototype._sphericalMapping=function(e){var t=new i.Vector3(0,0,this._radius),n=e.y/this._radius,r=-e.x/this._radius;return i.Matrix.RotationYawPitchRollToRef(r,n,0,i.TmpVectors.Matrix[0]),i.Vector3.TransformNormal(t,i.TmpVectors.Matrix[0])},t}(o.VolumeBasedPanel)},"./3D/controls/stackPanel3D.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"StackPanel3D",function(){return o});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=function(e){function t(t){void 0===t&&(t=!1);var n=e.call(this)||this;return n._isVertical=!1,n.margin=.1,n._isVertical=t,n}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"isVertical",{get:function(){return this._isVertical},set:function(e){var t=this;this._isVertical!==e&&(this._isVertical=e,i.Tools.SetImmediate(function(){t._arrangeChildren()}))},enumerable:!1,configurable:!0}),t.prototype._arrangeChildren=function(){for(var e,t=0,n=0,r=0,o=[],a=i.Matrix.Invert(this.node.computeWorldMatrix(!0)),s=0,l=this._children;s<l.length;s++){if((d=l[s]).mesh){r++,d.mesh.computeWorldMatrix(!0),d.mesh.getWorldMatrix().multiplyToRef(a,i.TmpVectors.Matrix[0]);var c=d.mesh.getBoundingInfo().boundingBox,u=i.Vector3.TransformNormal(c.extendSize,i.TmpVectors.Matrix[0]);o.push(u),this._isVertical?n+=u.y:t+=u.x}}this._isVertical?n+=(r-1)*this.margin/2:t+=(r-1)*this.margin/2,e=this._isVertical?-n:-t;for(var _=0,h=0,f=this._children;h<f.length;h++){var d;if((d=f[h]).mesh){r--;u=o[_++];this._isVertical?(d.position.y=e+u.y,d.position.x=0,e+=2*u.y):(d.position.x=e+u.x,d.position.y=0,e+=2*u.x),e+=r>0?this.margin:0}}},t}(n("./3D/controls/container3D.ts").Container3D)},"./3D/controls/touchButton3D.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"TouchButton3D",function(){return o});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=function(e){function t(t,n){var r=e.call(this,t)||this;return r._isNearPressed=!1,r.collidableFrontDirection=i.Vector3.Zero(),n&&(r.collisionMesh=n),r}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"collidableFrontDirection",{get:function(){if(this._collisionMesh){var e=i.TmpVectors.Vector3[0];return i.Vector3.TransformNormalToRef(this._collidableFrontDirection,this._collisionMesh.getWorldMatrix(),e),e.normalize()}return this._collidableFrontDirection},set:function(e){if(this._collidableFrontDirection=e.normalize(),this._collisionMesh){var t=i.TmpVectors.Matrix[0];t.copyFrom(this._collisionMesh.getWorldMatrix()),t.invert(),i.Vector3.TransformNormalToRef(this._collidableFrontDirection,t,this._collidableFrontDirection),this._collidableFrontDirection.normalize()}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"collisionMesh",{set:function(e){this._collisionMesh&&this._collisionMesh.dispose(),!e.parent&&this.mesh&&e.setParent(this.mesh),this._collisionMesh=e,this._injectGUI3DReservedDataStore(this._collisionMesh).control=this,this._collisionMesh.isNearPickable=!0,this.collidableFrontDirection=e.forward},enumerable:!1,configurable:!0}),t.prototype._isInteractionInFrontOfButton=function(e){return this._getInteractionHeight(e,this._collisionMesh.getAbsolutePosition())>0},t.prototype._getInteractionHeight=function(e,t){var n=this.collidableFrontDirection;if(0===n.length())return i.Vector3.Distance(e,t);var r=i.Vector3.Dot(t,n);return i.Vector3.Dot(e,n)-r},t.prototype._generatePointerEventType=function(e,t,n){if(e===i.PointerEventTypes.POINTERDOWN){if(!this._isInteractionInFrontOfButton(t))return i.PointerEventTypes.POINTERMOVE;this._isNearPressed=!0}if(e===i.PointerEventTypes.POINTERUP){if(0==n)return i.PointerEventTypes.POINTERMOVE;this._isNearPressed=!1}return e},t.prototype._getTypeName=function(){return"TouchButton3D"},t.prototype._createNode=function(t){return e.prototype._createNode.call(this,t)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._collisionMesh&&this._collisionMesh.dispose()},t}(n("./3D/controls/button3D.ts").Button3D)},"./3D/controls/touchHolographicButton.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"TouchHolographicButton",function(){return u});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=n("./3D/materials/fluentButton/fluentButtonMaterial.ts"),a=n("./2D/controls/stackPanel.ts"),s=n("./2D/controls/image.ts"),l=n("./2D/controls/textBlock.ts"),c=n("./2D/advancedDynamicTexture.ts"),u=function(e){function t(t,n){void 0===n&&(n=!0);var r=e.call(this,t)||this;return r._shareMaterials=!0,r._isBackplateVisible=!0,r._frontPlateDepth=.5,r._backPlateDepth=.04,r._shareMaterials=n,r.pointerEnterAnimation=function(){r._frontMaterial.leftBlobEnable=!0,r._frontMaterial.rightBlobEnable=!0},r.pointerOutAnimation=function(){r._frontMaterial.leftBlobEnable=!1,r._frontMaterial.rightBlobEnable=!1},r.pointerDownAnimation=function(){r._frontPlate&&!r._isNearPressed&&(r._frontPlate.scaling.z=.2*r._frontPlateDepth,r._frontPlate.position.z=(r._frontPlateDepth-.2*r._frontPlateDepth)/2,r._textPlate.position.z=-(r._backPlateDepth+.2*r._frontPlateDepth)/2)},r.pointerUpAnimation=function(){r._frontPlate&&(r._frontPlate.scaling.z=r._frontPlateDepth,r._frontPlate.position.z=(r._frontPlateDepth-r._frontPlateDepth)/2,r._textPlate.position.z=-(r._backPlateDepth+r._frontPlateDepth)/2)},r.onPointerMoveObservable.add(function(e){if(r._frontPlate&&r._isNearPressed){var t=i.Vector3.Zero();if(r._backPlate.getWorldMatrix().decompose(t,void 0,void 0)){var n=r._getInteractionHeight(e,r._backPlate.position)/t.z;n=i.Scalar.Clamp(n-r._backPlateDepth/2,.2*r._frontPlateDepth,r._frontPlateDepth),r._frontPlate.scaling.z=n,r._frontPlate.position.z=(r._frontPlateDepth-n)/2,r._textPlate.position.z=-(r._backPlateDepth+n)/2}}}),r._pointerHoverObserver=r.onPointerMoveObservable.add(function(e){r._frontMaterial.globalLeftIndexTipPosition=e}),r}return Object(r.__extends)(t,e),t.prototype._disposeTooltip=function(){this._tooltipFade=null,this._tooltipTextBlock&&this._tooltipTextBlock.dispose(),this._tooltipTexture&&this._tooltipTexture.dispose(),this._tooltipMesh&&this._tooltipMesh.dispose(),this.onPointerEnterObservable.remove(this._tooltipHoverObserver),this.onPointerOutObservable.remove(this._tooltipOutObserver)},Object.defineProperty(t.prototype,"renderingGroupId",{get:function(){return this._backPlate.renderingGroupId},set:function(e){this._backPlate.renderingGroupId=e,this._textPlate.renderingGroupId=e,this._frontPlate.renderingGroupId=e,this._tooltipMesh&&(this._tooltipMesh.renderingGroupId=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tooltipText",{get:function(){return this._tooltipTextBlock?this._tooltipTextBlock.text:null},set:function(e){var t=this;if(e){if(!this._tooltipFade){this._tooltipMesh=Object(i.CreatePlane)("",{size:1},this._backPlate._scene);var n=Object(i.CreatePlane)("",{size:1,sideOrientation:i.Mesh.DOUBLESIDE},this._backPlate._scene),r=new i.StandardMaterial("",this._backPlate._scene);r.diffuseColor=i.Color3.FromHexString("#212121"),n.material=r,n.isPickable=!1,this._tooltipMesh.addChild(n),n.position.z=.05,this._tooltipMesh.scaling.y=1/3,this._tooltipMesh.position.y=.7,this._tooltipMesh.position.z=-.15,this._tooltipMesh.isPickable=!1,this._tooltipMesh.parent=this._backPlate,this._tooltipTexture=c.AdvancedDynamicTexture.CreateForMesh(this._tooltipMesh),this._tooltipTextBlock=new l.TextBlock,this._tooltipTextBlock.scaleY=3,this._tooltipTextBlock.color="white",this._tooltipTextBlock.fontSize=130,this._tooltipTexture.addControl(this._tooltipTextBlock),this._tooltipFade=new i.FadeInOutBehavior,this._tooltipFade.delay=500,this._tooltipMesh.addBehavior(this._tooltipFade),this._tooltipHoverObserver=this.onPointerEnterObservable.add(function(){t._tooltipFade&&t._tooltipFade.fadeIn(!0)}),this._tooltipOutObserver=this.onPointerOutObservable.add(function(){t._tooltipFade&&t._tooltipFade.fadeIn(!1)})}this._tooltipTextBlock&&(this._tooltipTextBlock.text=e)}else this._disposeTooltip()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){this._text!==e&&(this._text=e,this._rebuildContent())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"imageUrl",{get:function(){return this._imageUrl},set:function(e){this._imageUrl!==e&&(this._imageUrl=e,this._rebuildContent())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"backMaterial",{get:function(){return this._backMaterial},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"frontMaterial",{get:function(){return this._frontMaterial},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"plateMaterial",{get:function(){return this._plateMaterial},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shareMaterials",{get:function(){return this._shareMaterials},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isBackplateVisible",{set:function(e){this.mesh&&this._backMaterial&&(e&&!this._isBackplateVisible?this._backPlate.visibility=1:!e&&this._isBackplateVisible&&(this._backPlate.visibility=0)),this._isBackplateVisible=e},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"TouchHolographicButton"},t.prototype._rebuildContent=function(){this._disposeFacadeTexture();var e=new a.StackPanel;if(e.isVertical=!0,i.DomManagement.IsDocumentAvailable()&&document.createElement&&this._imageUrl){var t=new s.Image;t.source=this._imageUrl,t.paddingTop="40px",t.height="180px",t.width="100px",t.paddingBottom="40px",e.addControl(t)}if(this._text){var n=new l.TextBlock;n.text=this._text,n.color="white",n.height="30px",n.fontSize=24,e.addControl(n)}this.content=e},t.prototype._createNode=function(n){var r,o=this;this.name=null!==(r=this.name)&&void 0!==r?r:"TouchHolographicButton";var a=Object(i.CreateBox)(this.name+"_collisionMesh",{width:1,height:1,depth:this._frontPlateDepth},n);return a.isPickable=!0,a.isNearPickable=!0,a.visibility=0,a.position.z=-this._frontPlateDepth/2,i.SceneLoader.ImportMeshAsync(void 0,t.MODEL_BASE_URL,t.MODEL_FILENAME,n).then(function(e){var t=e.meshes[1];t.name=o.name+"_frontPlate",t.isPickable=!1,t.scaling.z=o._frontPlateDepth,t.parent=a,o._frontMaterial&&(t.material=o._frontMaterial),o._frontPlate=t}),this._backPlate=Object(i.CreateBox)(this.name+"_backPlate",{width:1,height:1,depth:this._backPlateDepth},n),this._backPlate.position.z=this._backPlateDepth/2,this._backPlate.isPickable=!1,this._textPlate=e.prototype._createNode.call(this,n),this._textPlate.name=this.name+"_textPlate",this._textPlate.isPickable=!1,this._textPlate.position.z=-this._frontPlateDepth/2,this._backPlate.addChild(a),this._backPlate.addChild(this._textPlate),this.collisionMesh=a,this.collidableFrontDirection=this._backPlate.forward.negate(),this._backPlate},t.prototype._applyFacade=function(e){this._plateMaterial.emissiveTexture=e,this._plateMaterial.opacityTexture=e,this._plateMaterial.diffuseColor=new i.Color3(.4,.4,.4)},t.prototype._createBackMaterial=function(e){this._backMaterial=new i.StandardMaterial(this.name+"Back Material",e.getScene()),this._backMaterial.diffuseColor=new i.Color3(.5,.5,.5)},t.prototype._createFrontMaterial=function(e){this._frontMaterial=new o.FluentButtonMaterial(this.name+"Front Material",e.getScene())},t.prototype._createPlateMaterial=function(e){this._plateMaterial=new i.StandardMaterial(this.name+"Plate Material",e.getScene()),this._plateMaterial.specularColor=i.Color3.Black()},t.prototype._affectMaterial=function(e){this._shareMaterials?(this._host._touchSharedMaterials.backFluentMaterial?this._backMaterial=this._host._touchSharedMaterials.backFluentMaterial:(this._createBackMaterial(e),this._host._touchSharedMaterials.backFluentMaterial=this._backMaterial),this._host._touchSharedMaterials.frontFluentMaterial?this._frontMaterial=this._host._touchSharedMaterials.frontFluentMaterial:(this._createFrontMaterial(e),this._host._touchSharedMaterials.frontFluentMaterial=this._frontMaterial)):(this._createBackMaterial(e),this._createFrontMaterial(e)),this._createPlateMaterial(e),this._backPlate.material=this._backMaterial,this._textPlate.material=this._plateMaterial,this._isBackplateVisible||(this._backPlate.visibility=0),this._frontPlate&&(this._frontPlate.material=this._frontMaterial),this._rebuildContent()},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._disposeTooltip(),this.onPointerMoveObservable.remove(this._pointerHoverObserver),this.shareMaterials||(this._backMaterial.dispose(),this._frontMaterial.dispose(),this._plateMaterial.dispose(),this._pickedPointObserver&&(this._host.onPickedPointChangedObservable.remove(this._pickedPointObserver),this._pickedPointObserver=null))},t.MODEL_BASE_URL="https://assets.babylonjs.com/meshes/MRTK/",t.MODEL_FILENAME="mrtk-fluent-button.glb",t}(n("./3D/controls/touchButton3D.ts").TouchButton3D)},"./3D/controls/touchHolographicMenu.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"TouchHolographicMenu",function(){return s});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("./3D/controls/volumeBasedPanel.ts"),o=n("babylonjs/Misc/perfCounter"),a=n("./3D/materials/fluent/fluentMaterial.ts"),s=function(e){function t(t){var n=e.call(this,t)||this;return n._backPlateMargin=1.25,n}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"backPlateMargin",{get:function(){return this._backPlateMargin},set:function(e){var t=this;this._backPlateMargin=e,this._children.length>=1&&(this.children.forEach(function(e){t._updateCurrentMinMax(e.position)}),this._updateMargins())},enumerable:!1,configurable:!0}),t.prototype._createNode=function(e){var t=new o.Mesh("menu_"+this.name,e);return this._backPlate=Object(o.CreateBox)("backPlate"+this.name,{size:1},e),this._backPlate.parent=t,t},t.prototype._affectMaterial=function(e){var t=this;this._backPlateMaterial=new a.FluentMaterial(this.name+"backPlateMaterial",e.getScene()),this._backPlateMaterial.albedoColor=new o.Color3(.08,.15,.55),this._backPlateMaterial.renderBorders=!0,this._backPlateMaterial.renderHoverLight=!0,this._pickedPointObserver=this._host.onPickedPointChangedObservable.add(function(e){e?(t._backPlateMaterial.hoverPosition=e,t._backPlateMaterial.hoverColor.a=1):t._backPlateMaterial.hoverColor.a=0}),this._backPlate.material=this._backPlateMaterial},t.prototype._mapGridNode=function(e,t){e.mesh&&(e.position=t.clone(),this._updateCurrentMinMax(t))},t.prototype._finalProcessing=function(){this._updateMargins()},t.prototype._updateCurrentMinMax=function(e){this._currentMin||(this._currentMin=e.clone(),this._currentMax=e.clone()),this._currentMin.minimizeInPlace(e),this._currentMax.maximizeInPlace(e)},t.prototype._updateMargins=function(){this._currentMin.addInPlaceFromFloats(-this._cellWidth/2,-this._cellHeight/2,0),this._currentMax.addInPlaceFromFloats(this._cellWidth/2,this._cellHeight/2,0);var e=this._currentMax.subtract(this._currentMin);this._backPlate.scaling.x=e.x+this._cellWidth*this.backPlateMargin,this._backPlate.scaling.y=e.y+this._cellHeight*this.backPlateMargin,this._backPlate.scaling.z=.001;for(var t=0;t<this._children.length;t++)this._children[t].position.subtractInPlace(this._currentMin).subtractInPlace(e.scale(.5)),this._children[t].position.z-=.01;this._currentMin=null,this._currentMax=null},t.prototype.addButton=function(n){var r=this.blockLayout;return r||(this.blockLayout=!0),e.prototype.addControl.call(this,n),n.isBackplateVisible=!1,n.scaling.scaleInPlace(t.MENU_BUTTON_SCALE),r||(this.blockLayout=!1),this},t.prototype.addControl=function(e){return o.Logger.Warn("TouchHolographicMenu can only contain buttons. Please use the method `addButton` instead."),this},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._host.onPickedPointChangedObservable.remove(this._pickedPointObserver)},t.MENU_BUTTON_SCALE=.32,t}(i.VolumeBasedPanel)},"./3D/controls/touchMeshButton3D.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"TouchMeshButton3D",function(){return i});var r=n("../../node_modules/tslib/tslib.es6.js"),i=function(e){function t(t,n){var r=e.call(this,n,t)||this;return r._currentMesh=t,r.pointerEnterAnimation=function(){r.mesh&&r.mesh.scaling.scaleInPlace(1.1)},r.pointerOutAnimation=function(){r.mesh&&r.mesh.scaling.scaleInPlace(1/1.1)},r.pointerDownAnimation=function(){r.mesh&&r.mesh.scaling.scaleInPlace(.95)},r.pointerUpAnimation=function(){r.mesh&&r.mesh.scaling.scaleInPlace(1/.95)},r}return Object(r.__extends)(t,e),t.prototype._getTypeName=function(){return"TouchMeshButton3D"},t.prototype._createNode=function(e){var t=this;return this._currentMesh.getChildMeshes().forEach(function(e){t._injectGUI3DReservedDataStore(e).control=t}),this._currentMesh},t.prototype._affectMaterial=function(e){},t}(n("./3D/controls/touchButton3D.ts").TouchButton3D)},"./3D/controls/touchToggleButton3D.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"TouchToggleButton3D",function(){return o});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r._isPressed=!1,r.onToggleOnObservable=new i.Observable,r.onToggleOffObservable=new i.Observable,r.onPointerUpObservable.add(function(e){r._onToggle(e)}),r}return Object(r.__extends)(t,e),t.prototype._onToggle=function(e){this._isPressed=!this._isPressed,this._isPressed?this.onToggleOnObservable.notifyObservers(e):this.onToggleOffObservable.notifyObservers(e)},t.prototype._getTypeName=function(){return"TouchToggleButton3D"},t.prototype._createNode=function(t){return e.prototype._createNode.call(this,t)},t.prototype._affectMaterial=function(t){e.prototype._affectMaterial.call(this,t)},t.prototype.dispose=function(){this.onToggleOnObservable.clear(),this.onToggleOffObservable.clear(),e.prototype.dispose.call(this)},t}(n("./3D/controls/touchButton3D.ts").TouchButton3D)},"./3D/controls/volumeBasedPanel.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"VolumeBasedPanel",function(){return a});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=n("./3D/controls/container3D.ts"),a=function(e){function t(t){var n=e.call(this,t)||this;return n._columns=10,n._rows=0,n._rowThenColum=!0,n._orientation=o.Container3D.FACEORIGIN_ORIENTATION,n.margin=0,n}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"orientation",{get:function(){return this._orientation},set:function(e){var t=this;this._orientation!==e&&(this._orientation=e,i.Tools.SetImmediate(function(){t._arrangeChildren()}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"columns",{get:function(){return this._columns},set:function(e){var t=this;this._columns!==e&&(this._columns=e,this._rowThenColum=!0,i.Tools.SetImmediate(function(){t._arrangeChildren()}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rows",{get:function(){return this._rows},set:function(e){var t=this;this._rows!==e&&(this._rows=e,this._rowThenColum=!1,i.Tools.SetImmediate(function(){t._arrangeChildren()}))},enumerable:!1,configurable:!0}),t.prototype._arrangeChildren=function(){this._cellWidth=0,this._cellHeight=0;for(var e=0,t=0,n=0,r=i.Matrix.Invert(this.node.computeWorldMatrix(!0)),o=0,a=this._children;o<a.length;o++){if((v=a[o]).mesh){n++,v.mesh.computeWorldMatrix(!0);var s=v.mesh.getHierarchyBoundingVectors(),l=i.TmpVectors.Vector3[0],c=i.TmpVectors.Vector3[1];s.max.subtractToRef(s.min,c),c.scaleInPlace(.5),i.Vector3.TransformNormalToRef(c,r,l),this._cellWidth=Math.max(this._cellWidth,2*l.x),this._cellHeight=Math.max(this._cellHeight,2*l.y)}}this._cellWidth+=2*this.margin,this._cellHeight+=2*this.margin,this._rowThenColum?(t=this._columns,e=Math.ceil(n/this._columns)):(e=this._rows,t=Math.ceil(n/this._rows));var u=.5*t*this._cellWidth,_=.5*e*this._cellHeight,h=[],f=0;if(this._rowThenColum)for(var d=0;d<e;d++)for(var p=0;p<t&&(h.push(new i.Vector3(p*this._cellWidth-u+this._cellWidth/2,d*this._cellHeight-_+this._cellHeight/2,0)),!(++f>n));p++);else for(p=0;p<t;p++)for(d=0;d<e&&(h.push(new i.Vector3(p*this._cellWidth-u+this._cellWidth/2,d*this._cellHeight-_+this._cellHeight/2,0)),!(++f>n));d++);f=0;for(var m=0,g=this._children;m<g.length;m++){var v;(v=g[m]).mesh&&(this._mapGridNode(v,h[f]),f++)}this._finalProcessing()},t.prototype._finalProcessing=function(){},t}(o.Container3D)},"./3D/gizmos/gizmoHandle.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"HandleState",function(){return r}),n.d(t,"GizmoHandle",function(){return s}),n.d(t,"SideHandle",function(){return l}),n.d(t,"CornerHandle",function(){return c});var r,i=n("../../node_modules/tslib/tslib.es6.js"),o=n("babylonjs/Misc/perfCounter"),a=n("./3D/materials/handle/handleMaterial.ts");!function(e){e[e.IDLE=0]="IDLE",e[e.HOVER=1]="HOVER",e[e.DRAG=2]="DRAG"}(r||(r={}));var s=function(){function e(e,t){this._state=r.IDLE,this._materials=[],this._scene=t,this._gizmo=e,this.node=this.createNode(),this.node.reservedDataStore={handle:this}}return Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gizmo",{get:function(){return this._gizmo},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hover",{set:function(e){e?this._state|=r.HOVER:this._state&=~r.HOVER,this._updateMaterial()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"drag",{set:function(e){e?this._state|=r.DRAG:this._state&=~r.DRAG,this._updateMaterial()},enumerable:!1,configurable:!0}),e.prototype._createMaterial=function(e){var t=new a.HandleMaterial("handle",this._scene);return e&&(t._positionOffset=e),t},e.prototype._updateMaterial=function(){for(var e=this._state,t=0,n=this._materials;t<n.length;t++){(l=n[t]).hover=!1,l.drag=!1}if(e&r.DRAG)for(var i=0,o=this._materials;i<o.length;i++){(l=o[i]).drag=!0}else if(e&r.HOVER)for(var a=0,s=this._materials;a<s.length;a++){var l;(l=s[a]).hover=!0}},e.prototype.setDragBehavior=function(e,t,n){var r=new o.BaseSixDofDragBehavior;this._dragBehavior=r,this._dragStartObserver=r.onDragStartObservable.add(e),this._draggingObserver=r.onDragObservable.add(t),this._dragEndObserver=r.onDragEndObservable.add(n),this._dragBehavior.attach(this.node)},e.prototype.dispose=function(){this._dragBehavior.onDragStartObservable.remove(this._dragStartObserver),this._dragBehavior.onDragObservable.remove(this._draggingObserver),this._dragBehavior.onDragEndObservable.remove(this._dragEndObserver),this._dragBehavior.detach();for(var e=0,t=this._materials;e<t.length;e++){t[e].dispose()}this.node.dispose()},e}(),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t.prototype.createNode=function(){var e=Object(o.CreateBox)("sideVert",{width:1,height:10,depth:.1},this._scene),t=new o.TransformNode("side",this._scene);e.parent=t;var n=this._createMaterial();return e.material=n,e.isNearGrabbable=!0,this._materials.push(n),t},t}(s),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t.prototype.createNode=function(){var e=Object(o.CreateBox)("angleHor",{width:3,height:1,depth:.1},this._scene),t=Object(o.CreateBox)("angleVert",{width:1,height:3,depth:.1},this._scene),n=new o.TransformNode("angle",this._scene);return e.parent=n,t.parent=n,e.material=this._createMaterial(new o.Vector3(1,0,0)),t.material=this._createMaterial(new o.Vector3(0,1,0)),t.isNearGrabbable=!0,e.isNearGrabbable=!0,this._materials.push(e.material),this._materials.push(t.material),n},t}(s)},"./3D/gizmos/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./3D/gizmos/slateGizmo.ts");n.d(t,"SlateGizmo",function(){return r.SlateGizmo});var i=n("./3D/gizmos/gizmoHandle.ts");n.d(t,"HandleState",function(){return i.HandleState}),n.d(t,"GizmoHandle",function(){return i.GizmoHandle}),n.d(t,"SideHandle",function(){return i.SideHandle}),n.d(t,"CornerHandle",function(){return i.CornerHandle})},"./3D/gizmos/slateGizmo.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"SlateGizmo",function(){return a});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=n("./3D/gizmos/gizmoHandle.ts"),a=function(e){function t(t){var n=e.call(this,t)||this;return n._boundingDimensions=new i.Vector3(0,0,0),n._renderObserver=null,n._tmpQuaternion=new i.Quaternion,n._tmpVector=new i.Vector3(0,0,0),n._corners=[],n._sides=[],n._boundingBoxGizmo={min:new i.Vector3,max:new i.Vector3},n._margin=.35,n._attachedSlate=null,n._existingSlateScale=new i.Vector3,n.fixedScreenSize=!1,n.fixedScreenSizeDistanceFactor=10,n.handleSize=.01,n._createNode(),n.updateScale=!1,n._renderObserver=n.gizmoLayer.originalScene.onBeforeRenderObservable.add(function(){n.attachedMesh&&!n._existingSlateScale.equals(n.attachedMesh.scaling)&&n.updateBoundingBox()}),n}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"attachedSlate",{get:function(){return this._attachedSlate},set:function(e){var t=this;e?(this.attachedMesh=e.mesh,this.updateBoundingBox(),this._pickedPointObserver=e._host.onPickingObservable.add(function(e){if(!t._handleHovered||e&&e.parent===t._handleHovered.node||(t._handleHovered.hover=!1,t._handleHovered=null),e&&e.parent&&e.parent.reservedDataStore&&e.parent.reservedDataStore.handle){var n=e.parent.reservedDataStore.handle;n.gizmo===t&&(t._handleHovered=n,t._handleHovered.hover=!0)}})):this._attachedSlate&&this._attachedSlate._host.onPickingObservable.remove(this._pickedPointObserver),this._attachedSlate=e},enumerable:!1,configurable:!0}),t.prototype._createNode=function(){var e=this;this._handlesParent=new i.TransformNode("handlesParent",this.gizmoLayer.utilityLayerScene),this._handlesParent.rotationQuaternion=i.Quaternion.Identity();for(var t=[{dimensions:new i.Vector3(-1,-1,0),origin:new i.Vector3(1,0,0)},{dimensions:new i.Vector3(1,-1,0),origin:new i.Vector3(0,0,0)},{dimensions:new i.Vector3(1,1,0),origin:new i.Vector3(0,1,0)},{dimensions:new i.Vector3(-1,1,0),origin:new i.Vector3(1,1,0)}],n=0;n<4;n++){var r=new o.CornerHandle(this,this.gizmoLayer.utilityLayerScene);this._corners.push(r),r.node.rotation.z=Math.PI/2*n,r.node.scaling.setAll(this.handleSize),r.node.parent=this._handlesParent,this._assignDragBehaviorCorners(r,function(t,n,r,i){return e._moveHandle(t,n,r,i,!0)},t[n])}for(n=0;n<4;n++){var a=new o.SideHandle(this,this.gizmoLayer.utilityLayerScene);this._sides.push(a),a.node.rotation.z=Math.PI/2*n,a.node.scaling.copyFromFloats(this.handleSize,this.handleSize,this.handleSize),a.node.parent=this._handlesParent,this._assignDragBehaviorSides(a,n%2==0?new i.Vector3(0,1,0):new i.Vector3(1,0,0))}this._handlesParent.parent=this._rootMesh},t.prototype._keepAspectRatio=function(e,t,n){void 0===n&&(n=!1);var r=i.TmpVectors.Vector3[0];r.copyFromFloats(t,1,0).normalize(),n&&(r.y*=-1);var o=i.Vector3.Dot(e,r);e.copyFrom(r).scaleInPlace(o)},t.prototype._clampDimensions=function(e,t,n,r){void 0===r&&(r=!1);var o=i.TmpVectors.Vector3[0];o.copyFrom(e).multiplyInPlace(n);var a=i.TmpVectors.Vector3[1];if(a.copyFromFloats(Math.max(this._attachedSlate.minDimensions.x,o.x+t.x),Math.max(this._attachedSlate.minDimensions.y,o.y+t.y),0),r){var s=t.x/t.y;a.x=Math.max(a.x,a.y*s),a.y=Math.max(a.y,a.x/s)}o.copyFrom(a).subtractInPlace(t),e.x=Math.sign(e.x)*Math.abs(o.x),e.y=Math.sign(e.y)*Math.abs(o.y)},t.prototype._moveHandle=function(e,t,n,r,o){if(this._attachedSlate){if(o){var a=t.x/t.y;this._keepAspectRatio(n,a,r.dimensions.x*r.dimensions.y<0)}this._clampDimensions(n,t,r.dimensions,o);var s=i.TmpVectors.Vector3[0],l=i.TmpVectors.Vector3[1];s.copyFrom(n).multiplyInPlace(r.origin),l.copyFrom(n).multiplyInPlace(r.dimensions),this._attachedSlate.origin.copyFrom(e).addInPlace(s),this._attachedSlate.dimensions.copyFrom(t).addInPlace(l),this._attachedSlate.backplateDimensions.x=this._attachedSlate.dimensions.x}},t.prototype._assignDragBehaviorCorners=function(e,t,n){var r=this,o=new i.Vector3,a=new i.Vector3,s=new i.Vector3,l=new i.Matrix,c=new i.Vector3,u=!1;e.setDragBehavior(function(e){r.attachedSlate&&r.attachedMesh&&(o.copyFrom(r.attachedSlate.dimensions),a.copyFrom(r.attachedSlate.origin),s.copyFrom(e.position),l.copyFrom(r.attachedMesh.computeWorldMatrix(!0)),l.invert(),u=r.attachedSlate.defaultBehavior.followBehaviorEnabled,r.attachedSlate.defaultBehavior.followBehaviorEnabled=!1,i.Vector3.TransformNormalToRef(i.Vector3.Forward(),r.attachedMesh.getWorldMatrix(),c),c.normalize(),r._handleHovered&&(r._handleDragged=r._handleHovered,r._handleDragged.drag=!0))},function(e){r.attachedSlate&&r.attachedMesh&&(function(e,t,n,r){e.subtractToRef(n,i.TmpVectors.Vector3[0]);var o=i.Vector3.Dot(i.TmpVectors.Vector3[0],t);i.TmpVectors.Vector3[1].copyFrom(t).scaleInPlace(o),i.TmpVectors.Vector3[0].subtractInPlace(i.TmpVectors.Vector3[1]),i.TmpVectors.Vector3[0].addToRef(n,r)}(e.position,c,s,r._tmpVector),r._tmpVector.subtractInPlace(s),i.Vector3.TransformNormalToRef(r._tmpVector,l,r._tmpVector),t(a,o,r._tmpVector,n),r.attachedSlate._positionElements(),r.updateBoundingBox())},function(){r.attachedSlate&&r.attachedNode&&(r.attachedSlate._updatePivot(),r.attachedSlate.defaultBehavior.followBehaviorEnabled=u,r._handleDragged&&(r._handleDragged.drag=!1,r._handleDragged=null))})},t.prototype._assignDragBehaviorSides=function(e,t){var n,r=this,o=new i.Quaternion,a=new i.Vector3,s=new i.Vector3,l=new i.Vector3,c=new i.Vector3;e.setDragBehavior(function(e){r.attachedSlate&&r.attachedMesh&&(o.copyFrom(r.attachedMesh.rotationQuaternion),a.copyFrom(e.position),n=r.attachedSlate.defaultBehavior.followBehaviorEnabled,r.attachedSlate.defaultBehavior.followBehaviorEnabled=!1,l.copyFrom(r.attachedMesh.getAbsolutePivotPoint()),s.copyFrom(a).subtractInPlace(l).normalize(),i.Vector3.TransformNormalToRef(t,r.attachedMesh.getWorldMatrix(),c),c.normalize(),r._handleHovered&&(r._handleDragged=r._handleHovered,r._handleDragged.drag=!0))},function(e){if(r.attachedSlate&&r.attachedMesh){r._tmpVector.copyFrom(e.position),r._tmpVector.subtractInPlace(l),r._tmpVector.normalize();var n=-i.Vector3.GetAngleBetweenVectorsOnPlane(r._tmpVector,s,c);i.Quaternion.RotationAxisToRef(t,n,r._tmpQuaternion),o.multiplyToRef(r._tmpQuaternion,r.attachedMesh.rotationQuaternion)}},function(){r.attachedSlate&&r.attachedNode&&(r.attachedSlate._updatePivot(),r.attachedSlate.defaultBehavior.followBehaviorEnabled=n,r._handleDragged&&(r._handleDragged.drag=!1,r._handleDragged=null))})},t.prototype._attachedNodeChanged=function(e){e&&this.updateBoundingBox()},t.prototype.updateBoundingBox=function(){if(this.attachedMesh){i.PivotTools._RemoveAndStorePivotPoint(this.attachedMesh);var e=this.attachedMesh.parent;this.attachedMesh.setParent(null),this._update(),this.attachedMesh.rotationQuaternion||(this.attachedMesh.rotationQuaternion=i.Quaternion.RotationYawPitchRoll(this.attachedMesh.rotation.y,this.attachedMesh.rotation.x,this.attachedMesh.rotation.z)),this._tmpQuaternion.copyFrom(this.attachedMesh.rotationQuaternion),this._tmpVector.copyFrom(this.attachedMesh.position),this.attachedMesh.rotationQuaternion.set(0,0,0,1),this.attachedMesh.position.set(0,0,0);var t=this.attachedMesh.getHierarchyBoundingVectors();t.max.subtractToRef(t.min,this._boundingDimensions),this._boundingBoxGizmo.min=t.min,this._boundingBoxGizmo.max=t.max,this._updateHandlesPosition(),this.attachedMesh.rotationQuaternion.copyFrom(this._tmpQuaternion),this.attachedMesh.position.copyFrom(this._tmpVector),i.PivotTools._RestorePivotPoint(this.attachedMesh),this.attachedMesh.setParent(e),this.attachedMesh.computeWorldMatrix(!0),this._existingSlateScale.copyFrom(this.attachedMesh.scaling)}},t.prototype._updateHandlesPosition=function(){var e=this._boundingBoxGizmo.min.clone(),t=this._boundingBoxGizmo.max.clone(),n=this._corners[0].node.scaling.length();e.x-=this._margin*n,e.y-=this._margin*n,t.x+=this._margin*n,t.y+=this._margin*n;var r=e.add(t).scaleInPlace(.5);this._corners[0].node.position.copyFromFloats(e.x,e.y,0),this._corners[1].node.position.copyFromFloats(t.x,e.y,0),this._corners[2].node.position.copyFromFloats(t.x,t.y,0),this._corners[3].node.position.copyFromFloats(e.x,t.y,0),this._sides[0].node.position.copyFromFloats(e.x,r.y,0),this._sides[1].node.position.copyFromFloats(r.x,e.y,0),this._sides[2].node.position.copyFromFloats(t.x,r.y,0),this._sides[3].node.position.copyFromFloats(r.x,t.y,0)},t.prototype._update=function(){if(e.prototype._update.call(this),this.gizmoLayer.utilityLayerScene.activeCamera&&this._attachedSlate&&this._attachedSlate.mesh){if(this.fixedScreenSize){this._attachedSlate.mesh.absolutePosition.subtractToRef(this.gizmoLayer.utilityLayerScene.activeCamera.position,this._tmpVector);for(var t=this.handleSize*this._tmpVector.length()/this.fixedScreenSizeDistanceFactor,n=0;n<this._corners.length;n++)this._corners[n].node.scaling.set(t,t,t)}this._updateHandlesPosition()}},t.prototype.dispose=function(){this.gizmoLayer.originalScene.onBeforeRenderObservable.remove(this._renderObserver),e.prototype.dispose.call(this);for(var t=0,n=this._corners;t<n.length;t++){n[t].dispose()}for(var r=0,i=this._sides;r<i.length;r++){i[r].dispose()}},t}(i.Gizmo)},"./3D/gui3DManager.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"GUI3DManager",function(){return o});var r=n("babylonjs/Misc/perfCounter"),i=n("./3D/controls/container3D.ts"),o=function(){function e(e){var t=this;this._lastControlOver={},this._lastControlDown={},this.onPickedPointChangedObservable=new r.Observable,this.onPickingObservable=new r.Observable,this._sharedMaterials={},this._touchSharedMaterials={},this._scene=e||r.EngineStore.LastCreatedScene,this._sceneDisposeObserver=this._scene.onDisposeObservable.add(function(){t._sceneDisposeObserver=null,t._utilityLayer=null,t.dispose()}),this._utilityLayer=r.UtilityLayerRenderer._CreateDefaultUtilityLayerFromScene(this._scene),this._utilityLayer.onlyCheckPointerDownEvents=!1,this._utilityLayer.pickUtilitySceneFirst=!1,this._utilityLayer.mainSceneTrackerPredicate=function(e){var t,n,r;return e&&(null===(r=null===(n=null===(t=e.reservedDataStore)||void 0===t?void 0:t.GUI3D)||void 0===n?void 0:n.control)||void 0===r?void 0:r._node)},this._rootContainer=new i.Container3D("RootContainer"),this._rootContainer._host=this;var n=this._utilityLayer.utilityLayerScene;this._pointerOutObserver=this._utilityLayer.onPointerOutObservable.add(function(e){t._handlePointerOut(e,!0)}),this._pointerObserver=n.onPointerObservable.add(function(e,n){t._doPicking(e)}),this._utilityLayer.utilityLayerScene.autoClear=!1,this._utilityLayer.utilityLayerScene.autoClearDepthAndStencil=!1,new r.HemisphericLight("hemi",r.Vector3.Up(),this._utilityLayer.utilityLayerScene)}return Object.defineProperty(e.prototype,"scene",{get:function(){return this._scene},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"utilityLayer",{get:function(){return this._utilityLayer},enumerable:!1,configurable:!0}),e.prototype._handlePointerOut=function(e,t){var n=this._lastControlOver[e];n&&(n._onPointerOut(n),delete this._lastControlOver[e]),t&&this._lastControlDown[e]&&(this._lastControlDown[e].forcePointerUp(),delete this._lastControlDown[e]),this.onPickedPointChangedObservable.notifyObservers(null)},e.prototype._doPicking=function(e){var t,n,i;if(!this._utilityLayer||!this._utilityLayer.shouldRender||!this._utilityLayer.utilityLayerScene.activeCamera)return!1;var o=e.event,a=o.pointerId||0,s=o.button,l=e.pickInfo;if(l&&this.onPickingObservable.notifyObservers(l.pickedMesh),!l||!l.hit)return this._handlePointerOut(a,e.type===r.PointerEventTypes.POINTERUP),!1;l.pickedPoint&&this.onPickedPointChangedObservable.notifyObservers(l.pickedPoint);var c=null===(n=null===(t=l.pickedMesh.reservedDataStore)||void 0===t?void 0:t.GUI3D)||void 0===n?void 0:n.control;return c&&!c._processObservables(e.type,l.pickedPoint,(null===(i=l.originMesh)||void 0===i?void 0:i.position)||null,a,s)&&e.type===r.PointerEventTypes.POINTERMOVE&&(this._lastControlOver[a]&&this._lastControlOver[a]._onPointerOut(this._lastControlOver[a]),delete this._lastControlOver[a]),e.type===r.PointerEventTypes.POINTERUP&&(this._lastControlDown[o.pointerId]&&(this._lastControlDown[o.pointerId].forcePointerUp(),delete this._lastControlDown[o.pointerId]),"touch"===o.pointerType&&this._handlePointerOut(a,!1)),!0},Object.defineProperty(e.prototype,"rootContainer",{get:function(){return this._rootContainer},enumerable:!1,configurable:!0}),e.prototype.containsControl=function(e){return this._rootContainer.containsControl(e)},e.prototype.addControl=function(e){return this._rootContainer.addControl(e),this},e.prototype.removeControl=function(e){return this._rootContainer.removeControl(e),this},e.prototype.dispose=function(){for(var e in this._rootContainer.dispose(),this._sharedMaterials)this._sharedMaterials.hasOwnProperty(e)&&this._sharedMaterials[e].dispose();for(var e in this._sharedMaterials={},this._touchSharedMaterials)this._touchSharedMaterials.hasOwnProperty(e)&&this._touchSharedMaterials[e].dispose();this._touchSharedMaterials={},this._pointerOutObserver&&this._utilityLayer&&(this._utilityLayer.onPointerOutObservable.remove(this._pointerOutObserver),this._pointerOutObserver=null),this.onPickedPointChangedObservable.clear(),this.onPickingObservable.clear();var t=this._utilityLayer?this._utilityLayer.utilityLayerScene:null;t&&this._pointerObserver&&(t.onPointerObservable.remove(this._pointerObserver),this._pointerObserver=null),this._scene&&this._sceneDisposeObserver&&(this._scene.onDisposeObservable.remove(this._sceneDisposeObserver),this._sceneDisposeObserver=null),this._utilityLayer&&this._utilityLayer.dispose()},e}()},"./3D/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./3D/controls/index.ts");n.d(t,"AbstractButton3D",function(){return r.AbstractButton3D}),n.d(t,"Button3D",function(){return r.Button3D}),n.d(t,"Container3D",function(){return r.Container3D}),n.d(t,"Control3D",function(){return r.Control3D}),n.d(t,"CylinderPanel",function(){return r.CylinderPanel}),n.d(t,"HolographicButton",function(){return r.HolographicButton}),n.d(t,"HolographicSlate",function(){return r.HolographicSlate}),n.d(t,"HandMenu",function(){return r.HandMenu}),n.d(t,"MeshButton3D",function(){return r.MeshButton3D}),n.d(t,"NearMenu",function(){return r.NearMenu}),n.d(t,"PlanePanel",function(){return r.PlanePanel}),n.d(t,"ScatterPanel",function(){return r.ScatterPanel}),n.d(t,"Slider3D",function(){return r.Slider3D}),n.d(t,"SpherePanel",function(){return r.SpherePanel}),n.d(t,"StackPanel3D",function(){return r.StackPanel3D}),n.d(t,"TouchButton3D",function(){return r.TouchButton3D}),n.d(t,"TouchMeshButton3D",function(){return r.TouchMeshButton3D}),n.d(t,"TouchHolographicButton",function(){return r.TouchHolographicButton}),n.d(t,"TouchHolographicMenu",function(){return r.TouchHolographicMenu}),n.d(t,"TouchToggleButton3D",function(){return r.TouchToggleButton3D}),n.d(t,"VolumeBasedPanel",function(){return r.VolumeBasedPanel}),n.d(t,"HolographicBackplate",function(){return r.HolographicBackplate});var i=n("./3D/materials/index.ts");n.d(t,"FluentMaterialDefines",function(){return i.FluentMaterialDefines}),n.d(t,"FluentMaterial",function(){return i.FluentMaterial}),n.d(t,"FluentButtonMaterial",function(){return i.FluentButtonMaterial}),n.d(t,"FluentBackplateMaterial",function(){return i.FluentBackplateMaterial}),n.d(t,"HandleMaterial",function(){return i.HandleMaterial}),n.d(t,"MRDLSliderBarMaterial",function(){return i.MRDLSliderBarMaterial}),n.d(t,"MRDLSliderThumbMaterial",function(){return i.MRDLSliderThumbMaterial}),n.d(t,"MRDLBackplateMaterial",function(){return i.MRDLBackplateMaterial});var o=n("./3D/gizmos/index.ts");n.d(t,"SlateGizmo",function(){return o.SlateGizmo}),n.d(t,"HandleState",function(){return o.HandleState}),n.d(t,"GizmoHandle",function(){return o.GizmoHandle}),n.d(t,"SideHandle",function(){return o.SideHandle}),n.d(t,"CornerHandle",function(){return o.CornerHandle});var a=n("./3D/gui3DManager.ts");n.d(t,"GUI3DManager",function(){return a.GUI3DManager});var s=n("./3D/vector3WithInfo.ts");n.d(t,"Vector3WithInfo",function(){return s.Vector3WithInfo})},"./3D/materials/fluent/fluentMaterial.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"FluentMaterialDefines",function(){return o}),n.d(t,"FluentMaterial",function(){return a});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=(n("./3D/materials/fluent/shaders/fluent.vertex.ts"),n("./3D/materials/fluent/shaders/fluent.fragment.ts"),function(e){function t(){var t=e.call(this)||this;return t.INNERGLOW=!1,t.BORDER=!1,t.HOVERLIGHT=!1,t.TEXTURE=!1,t.rebuild(),t}return Object(r.__extends)(t,e),t}(i.MaterialDefines)),a=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.innerGlowColorIntensity=.5,r.innerGlowColor=new i.Color3(1,1,1),r.albedoColor=new i.Color3(.3,.35,.4),r.renderBorders=!1,r.borderWidth=.5,r.edgeSmoothingValue=.02,r.borderMinValue=.1,r.renderHoverLight=!1,r.hoverRadius=1,r.hoverColor=new i.Color4(.3,.3,.3,1),r.hoverPosition=i.Vector3.Zero(),r}return Object(r.__extends)(t,e),t.prototype.needAlphaBlending=function(){return 1!==this.alpha},t.prototype.needAlphaTesting=function(){return!1},t.prototype.getAlphaTestTexture=function(){return null},t.prototype.isReadyForSubMesh=function(e,t,n){if(this.isFrozen&&t.effect&&t.effect._wasPreviouslyReady)return!0;t._materialDefines||(t.materialDefines=new o);var r=this.getScene(),a=t._materialDefines;if(!this.checkReadyOnEveryCall&&t.effect&&a._renderId===r.getRenderId())return!0;if(a._areTexturesDirty)if(a.INNERGLOW=this.innerGlowColorIntensity>0,a.BORDER=this.renderBorders,a.HOVERLIGHT=this.renderHoverLight,this._albedoTexture){if(!this._albedoTexture.isReadyOrNotBlocking())return!1;a.TEXTURE=!0}else a.TEXTURE=!1;var s=r.getEngine();if(a.isDirty){a.markAsProcessed(),r.resetCachedMaterial();var l=[i.VertexBuffer.PositionKind];l.push(i.VertexBuffer.NormalKind),l.push(i.VertexBuffer.UVKind);var c=["world","viewProjection","innerGlowColor","albedoColor","borderWidth","edgeSmoothingValue","scaleFactor","borderMinValue","hoverColor","hoverPosition","hoverRadius","textureMatrix"],u=["albedoSampler"],_=new Array;i.MaterialHelper.PrepareUniformsAndSamplersList({uniformsNames:c,uniformBuffersNames:_,samplers:u,defines:a,maxSimultaneousLights:4});var h=a.toString();t.setEffect(r.getEngine().createEffect("fluent",{attributes:l,uniformsNames:c,uniformBuffersNames:_,samplers:u,defines:h,fallbacks:null,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousLights:4}},s),a,this._materialContext)}return!(!t.effect||!t.effect.isReady())&&(a._renderId=r.getRenderId(),t.effect._wasPreviouslyReady=!0,!0)},t.prototype.bindForSubMesh=function(e,t,n){var r=this.getScene(),o=n._materialDefines;if(o){var a=n.effect;if(a){if(this._activeEffect=a,this.bindOnlyWorldMatrix(e),this._activeEffect.setMatrix("viewProjection",r.getTransformMatrix()),this._mustRebind(r,a)&&(this._activeEffect.setColor4("albedoColor",this.albedoColor,this.alpha),o.INNERGLOW&&this._activeEffect.setColor4("innerGlowColor",this.innerGlowColor,this.innerGlowColorIntensity),o.BORDER&&(this._activeEffect.setFloat("borderWidth",this.borderWidth),this._activeEffect.setFloat("edgeSmoothingValue",this.edgeSmoothingValue),this._activeEffect.setFloat("borderMinValue",this.borderMinValue),t.getBoundingInfo().boundingBox.extendSize.multiplyToRef(t.scaling,i.TmpVectors.Vector3[0]),this._activeEffect.setVector3("scaleFactor",i.TmpVectors.Vector3[0])),o.HOVERLIGHT&&(this._activeEffect.setDirectColor4("hoverColor",this.hoverColor),this._activeEffect.setFloat("hoverRadius",this.hoverRadius),this._activeEffect.setVector3("hoverPosition",this.hoverPosition)),o.TEXTURE&&this._albedoTexture)){this._activeEffect.setTexture("albedoSampler",this._albedoTexture);var s=this._albedoTexture.getTextureMatrix();this._activeEffect.setMatrix("textureMatrix",s)}this._afterBind(t,this._activeEffect)}}},t.prototype.getActiveTextures=function(){return e.prototype.getActiveTextures.call(this)},t.prototype.hasTexture=function(t){return!!e.prototype.hasTexture.call(this,t)},t.prototype.dispose=function(t){e.prototype.dispose.call(this,t)},t.prototype.clone=function(e){var n=this;return i.SerializationHelper.Clone(function(){return new t(e,n.getScene())},this)},t.prototype.serialize=function(){var e=i.SerializationHelper.Serialize(this);return e.customType="BABYLON.GUI.FluentMaterial",e},t.prototype.getClassName=function(){return"FluentMaterial"},t.Parse=function(e,n,r){return i.SerializationHelper.Parse(function(){return new t(e.name,n)},e,n,r)},Object(r.__decorate)([Object(i.serialize)(),Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"innerGlowColorIntensity",void 0),Object(r.__decorate)([Object(i.serializeAsColor3)()],t.prototype,"innerGlowColor",void 0),Object(r.__decorate)([Object(i.serializeAsColor3)()],t.prototype,"albedoColor",void 0),Object(r.__decorate)([Object(i.serialize)(),Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"renderBorders",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"borderWidth",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"edgeSmoothingValue",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"borderMinValue",void 0),Object(r.__decorate)([Object(i.serialize)(),Object(i.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"renderHoverLight",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"hoverRadius",void 0),Object(r.__decorate)([Object(i.serializeAsColor4)()],t.prototype,"hoverColor",void 0),Object(r.__decorate)([Object(i.serializeAsVector3)()],t.prototype,"hoverPosition",void 0),Object(r.__decorate)([Object(i.serializeAsTexture)("albedoTexture")],t.prototype,"_albedoTexture",void 0),Object(r.__decorate)([Object(i.expandToProperty)("_markAllSubMeshesAsTexturesAndMiscDirty")],t.prototype,"albedoTexture",void 0),t}(i.PushMaterial);Object(i.RegisterClass)("BABYLON.GUI.FluentMaterial",a)},"./3D/materials/fluent/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./3D/materials/fluent/fluentMaterial.ts");n.d(t,"FluentMaterialDefines",function(){return r.FluentMaterialDefines}),n.d(t,"FluentMaterial",function(){return r.FluentMaterial})},"./3D/materials/fluent/shaders/fluent.fragment.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"fluentPixelShader",function(){return a});var r=n("babylonjs/Misc/perfCounter"),i="fluentPixelShader",o="precision highp float;\nvarying vec2 vUV;\nuniform vec4 albedoColor;\n#ifdef INNERGLOW\nuniform vec4 innerGlowColor;\n#endif\n#ifdef BORDER\nvarying vec2 scaleInfo;\nuniform float edgeSmoothingValue;\nuniform float borderMinValue;\n#endif\n#ifdef HOVERLIGHT\nvarying vec3 worldPosition;\nuniform vec3 hoverPosition;\nuniform vec4 hoverColor;\nuniform float hoverRadius;\n#endif\n#ifdef TEXTURE\nuniform sampler2D albedoSampler;\nuniform mat4 textureMatrix;\nvec2 finalUV;\n#endif\nvoid main(void) {\nvec3 albedo=albedoColor.rgb;\nfloat alpha=albedoColor.a;\n#ifdef TEXTURE\nfinalUV=vec2(textureMatrix*vec4(vUV,1.0,0.0));\nalbedo=texture2D(albedoSampler,finalUV).rgb;\n#endif\n#ifdef HOVERLIGHT\nfloat pointToHover=(1.0-clamp(length(hoverPosition-worldPosition)/hoverRadius,0.,1.))*hoverColor.a;\nalbedo=clamp(albedo+hoverColor.rgb*pointToHover,0.,1.);\n#else\nfloat pointToHover=1.0;\n#endif\n#ifdef BORDER\nfloat borderPower=10.0;\nfloat inverseBorderPower=1.0/borderPower;\nvec3 borderColor=albedo*borderPower;\nvec2 distanceToEdge;\ndistanceToEdge.x=abs(vUV.x-0.5)*2.0;\ndistanceToEdge.y=abs(vUV.y-0.5)*2.0;\nfloat borderValue=max(smoothstep(scaleInfo.x-edgeSmoothingValue,scaleInfo.x+edgeSmoothingValue,distanceToEdge.x),\nsmoothstep(scaleInfo.y-edgeSmoothingValue,scaleInfo.y+edgeSmoothingValue,distanceToEdge.y));\nborderColor=borderColor*borderValue*max(borderMinValue*inverseBorderPower,pointToHover);\nalbedo+=borderColor;\nalpha=max(alpha,borderValue);\n#endif\n#ifdef INNERGLOW\n\nvec2 uvGlow=(vUV-vec2(0.5,0.5))*(innerGlowColor.a*2.0);\nuvGlow=uvGlow*uvGlow;\nuvGlow=uvGlow*uvGlow;\nalbedo+=mix(vec3(0.0,0.0,0.0),innerGlowColor.rgb,uvGlow.x+uvGlow.y);\n#endif\ngl_FragColor=vec4(albedo,alpha);\n}";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./3D/materials/fluent/shaders/fluent.vertex.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"fluentVertexShader",function(){return a});var r=n("babylonjs/Misc/perfCounter"),i="fluentVertexShader",o="precision highp float;\n\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\n\nuniform mat4 world;\nuniform mat4 viewProjection;\nvarying vec2 vUV;\n#ifdef BORDER\nvarying vec2 scaleInfo;\nuniform float borderWidth;\nuniform vec3 scaleFactor;\n#endif\n#ifdef HOVERLIGHT\nvarying vec3 worldPosition;\n#endif\nvoid main(void) {\nvUV=uv;\n#ifdef BORDER\nvec3 scale=scaleFactor;\nfloat minScale=min(min(scale.x,scale.y),scale.z);\nfloat maxScale=max(max(scale.x,scale.y),scale.z);\nfloat minOverMiddleScale=minScale/(scale.x+scale.y+scale.z-minScale-maxScale);\nfloat areaYZ=scale.y*scale.z;\nfloat areaXZ=scale.x*scale.z;\nfloat areaXY=scale.x*scale.y;\nfloat scaledBorderWidth=borderWidth;\nif (abs(normal.x) == 1.0)\n{\nscale.x=scale.y;\nscale.y=scale.z;\nif (areaYZ>areaXZ && areaYZ>areaXY)\n{\nscaledBorderWidth*=minOverMiddleScale;\n}\n}\nelse if (abs(normal.y) == 1.0)\n{\nscale.x=scale.z;\nif (areaXZ>areaXY && areaXZ>areaYZ)\n{\nscaledBorderWidth*=minOverMiddleScale;\n}\n}\nelse\n{\nif (areaXY>areaYZ && areaXY>areaXZ)\n{\nscaledBorderWidth*=minOverMiddleScale;\n}\n}\nfloat scaleRatio=min(scale.x,scale.y)/max(scale.x,scale.y);\nif (scale.x>scale.y)\n{\nscaleInfo.x=1.0-(scaledBorderWidth*scaleRatio);\nscaleInfo.y=1.0-scaledBorderWidth;\n}\nelse\n{\nscaleInfo.x=1.0-scaledBorderWidth;\nscaleInfo.y=1.0-(scaledBorderWidth*scaleRatio);\n}\n#endif\nvec4 worldPos=world*vec4(position,1.0);\n#ifdef HOVERLIGHT\nworldPosition=worldPos.xyz;\n#endif\ngl_Position=viewProjection*worldPos;\n}\n";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./3D/materials/fluentBackplate/fluentBackplateMaterial.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"FluentBackplateMaterial",function(){return a});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=(n("./3D/materials/fluentBackplate/shaders/fluentBackplate.fragment.ts"),n("./3D/materials/fluentBackplate/shaders/fluentBackplate.vertex.ts"),function(e){function t(){var t=e.call(this)||this;return t.BLOB_ENABLE=!0,t.BLOB_ENABLE_2=!0,t.SMOOTH_EDGES=!0,t.IRIDESCENT_MAP_ENABLE=!0,t._needNormals=!0,t.rebuild(),t}return Object(r.__extends)(t,e),t}(i.MaterialDefines)),a=function(e){function t(n,r){var o=e.call(this,n,r)||this;return o.radius=.03,o.lineWidth=.01,o.absoluteSizes=!1,o._filterWidth=1,o.baseColor=new i.Color4(.0392157,.0666667,.207843,1),o.lineColor=new i.Color4(.14902,.133333,.384314,1),o.blobIntensity=.98,o.blobFarSize=.04,o.blobNearDistance=0,o.blobFarDistance=.08,o.blobFadeLength=.08,o.blobNearSize=.22,o.blobPulse=0,o.blobFade=0,o.blobNearSize2=.22,o.blobPulse2=0,o.blobFade2=0,o._rate=.135,o.highlightColor=new i.Color4(.98,.98,.98,1),o.highlightWidth=.25,o._highlightTransform=new i.Vector4(1,1,0,0),o._highlight=1,o.iridescenceIntensity=0,o.iridescenceEdgeIntensity=1,o._angle=-45,o.fadeOut=1,o._reflected=!0,o._frequency=1,o._verticalOffset=0,o.globalLeftIndexTipPosition=i.Vector3.Zero(),o._globalLeftIndexTipPosition4=i.Vector4.Zero(),o.globalRightIndexTipPosition=i.Vector3.Zero(),o._globalRightIndexTipPosition4=i.Vector4.Zero(),o.alphaMode=i.Constants.ALPHA_DISABLE,o.backFaceCulling=!1,o._blobTexture=new i.Texture(t.BLOB_TEXTURE_URL,r,!0,!1,i.Texture.NEAREST_SAMPLINGMODE),o._iridescentMap=new i.Texture(t.IM_TEXTURE_URL,r,!0,!1,i.Texture.NEAREST_SAMPLINGMODE),o}return Object(r.__extends)(t,e),t.prototype.needAlphaBlending=function(){return!1},t.prototype.needAlphaTesting=function(){return!1},t.prototype.getAlphaTestTexture=function(){return null},t.prototype.isReadyForSubMesh=function(e,t,n){if(this.isFrozen&&t.effect&&t.effect._wasPreviouslyReady)return!0;t._materialDefines||(t.materialDefines=new o);var r=t._materialDefines,a=this.getScene();if(this._isReadyForSubMesh(t))return!0;var s=a.getEngine();if(i.MaterialHelper.PrepareDefinesForAttributes(e,r,!1,!1),r.isDirty){r.markAsProcessed(),a.resetCachedMaterial();var l=new i.EffectFallbacks;r.FOG&&l.addFallback(1,"FOG"),i.MaterialHelper.HandleFallbacksForShadows(r,l),r.IMAGEPROCESSINGPOSTPROCESS=a.imageProcessingConfiguration.applyByPostProcess;var c=[i.VertexBuffer.PositionKind];r.NORMAL&&c.push(i.VertexBuffer.NormalKind),r.UV1&&c.push(i.VertexBuffer.UVKind),r.UV2&&c.push(i.VertexBuffer.UV2Kind),r.VERTEXCOLOR&&c.push(i.VertexBuffer.ColorKind),r.TANGENT&&c.push(i.VertexBuffer.TangentKind),i.MaterialHelper.PrepareAttributesForInstances(c,r);var u=r.toString(),_=["world","viewProjection","cameraPosition","_Radius_","_Line_Width_","_Absolute_Sizes_","_Filter_Width_","_Base_Color_","_Line_Color_","_Radius_Top_Left_","_Radius_Top_Right_","_Radius_Bottom_Left_","_Radius_Bottom_Right_","_Blob_Position_","_Blob_Intensity_","_Blob_Near_Size_","_Blob_Far_Size_","_Blob_Near_Distance_","_Blob_Far_Distance_","_Blob_Fade_Length_","_Blob_Pulse_","_Blob_Fade_","_Blob_Texture_","_Blob_Position_2_","_Blob_Near_Size_2_","_Blob_Pulse_2_","_Blob_Fade_2_","_Rate_","_Highlight_Color_","_Highlight_Width_","_Highlight_Transform_","_Highlight_","_Iridescence_Intensity_","_Iridescence_Edge_Intensity_","_Angle_","_Fade_Out_","_Reflected_","_Frequency_","_Vertical_Offset_","_Iridescent_Map_","_Use_Global_Left_Index_","_Use_Global_Right_Index_","Global_Left_Index_Tip_Position","Global_Right_Index_Tip_Position"],h=["_Blob_Texture_","_Iridescent_Map_"],f=new Array;i.MaterialHelper.PrepareUniformsAndSamplersList({uniformsNames:_,uniformBuffersNames:f,samplers:h,defines:r,maxSimultaneousLights:4}),t.setEffect(a.getEngine().createEffect("fluentBackplate",{attributes:c,uniformsNames:_,uniformBuffersNames:f,samplers:h,defines:u,fallbacks:l,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousLights:4}},s),r,this._materialContext)}return!(!t.effect||!t.effect.isReady())&&(r._renderId=a.getRenderId(),t.effect._wasPreviouslyReady=!0,!0)},t.prototype.bindForSubMesh=function(e,t,n){var r,o;if(n._materialDefines){var a=n.effect;a&&(this._activeEffect=a,this.bindOnlyWorldMatrix(e),this._activeEffect.setMatrix("viewProjection",this.getScene().getTransformMatrix()),this._activeEffect.setVector3("cameraPosition",null!==(o=null===(r=this.getScene().activeCamera)||void 0===r?void 0:r.position)&&void 0!==o?o:i.Vector3.ZeroReadOnly),this._activeEffect.setFloat("_Radius_",this.radius),this._activeEffect.setFloat("_Line_Width_",this.lineWidth),this._activeEffect.setFloat("_Absolute_Sizes_",this.absoluteSizes?1:0),this._activeEffect.setFloat("_Filter_Width_",this._filterWidth),this._activeEffect.setDirectColor4("_Base_Color_",this.baseColor),this._activeEffect.setDirectColor4("_Line_Color_",this.lineColor),this._activeEffect.setFloat("_Radius_Top_Left_",1),this._activeEffect.setFloat("_Radius_Top_Right_",1),this._activeEffect.setFloat("_Radius_Bottom_Left_",1),this._activeEffect.setFloat("_Radius_Bottom_Right_",1),this._activeEffect.setFloat("_Blob_Intensity_",this.blobIntensity),this._activeEffect.setFloat("_Blob_Near_Size_",this.blobNearSize),this._activeEffect.setFloat("_Blob_Far_Size_",this.blobFarSize),this._activeEffect.setFloat("_Blob_Near_Distance_",this.blobNearDistance),this._activeEffect.setFloat("_Blob_Far_Distance_",this.blobFarDistance),this._activeEffect.setFloat("_Blob_Fade_Length_",this.blobFadeLength),this._activeEffect.setFloat("_Blob_Pulse_",this.blobPulse),this._activeEffect.setFloat("_Blob_Fade_",this.blobFade),this._activeEffect.setTexture("_Blob_Texture_",this._blobTexture),this._activeEffect.setFloat("_Blob_Near_Size_2_",this.blobNearSize2),this._activeEffect.setFloat("_Blob_Pulse_2_",this.blobPulse2),this._activeEffect.setFloat("_Blob_Fade_2_",this.blobFade2),this._activeEffect.setFloat("_Rate_",this._rate),this._activeEffect.setDirectColor4("_Highlight_Color_",this.highlightColor),this._activeEffect.setFloat("_Highlight_Width_",this.highlightWidth),this._activeEffect.setVector4("_Highlight_Transform_",this._highlightTransform),this._activeEffect.setFloat("_Highlight_",this._highlight),this._activeEffect.setFloat("_Iridescence_Intensity_",this.iridescenceIntensity),this._activeEffect.setFloat("_Iridescence_Edge_Intensity_",this.iridescenceEdgeIntensity),this._activeEffect.setFloat("_Angle_",this._angle),this._activeEffect.setFloat("_Fade_Out_",this.fadeOut),this._activeEffect.setFloat("_Reflected_",this._reflected?1:0),this._activeEffect.setFloat("_Frequency_",this._frequency),this._activeEffect.setFloat("_Vertical_Offset_",this._verticalOffset),this._activeEffect.setTexture("_Iridescent_Map_",this._iridescentMap),this._activeEffect.setFloat("_Use_Global_Left_Index_",1),this._activeEffect.setFloat("_Use_Global_Right_Index_",1),this._globalLeftIndexTipPosition4.set(this.globalLeftIndexTipPosition.x,this.globalLeftIndexTipPosition.y,this.globalLeftIndexTipPosition.z,1),this._activeEffect.setVector4("Global_Left_Index_Tip_Position",this._globalLeftIndexTipPosition4),this._globalRightIndexTipPosition4.set(this.globalRightIndexTipPosition.x,this.globalRightIndexTipPosition.y,this.globalRightIndexTipPosition.z,1),this._activeEffect.setVector4("Global_Right_Index_Tip_Position",this._globalRightIndexTipPosition4),this._afterBind(t,this._activeEffect))}},t.prototype.getAnimatables=function(){return[]},t.prototype.dispose=function(t){e.prototype.dispose.call(this,t),this._blobTexture.dispose(),this._iridescentMap.dispose()},t.prototype.clone=function(e){var n=this;return i.SerializationHelper.Clone(function(){return new t(e,n.getScene())},this)},t.prototype.serialize=function(){var e=i.SerializationHelper.Serialize(this);return e.customType="BABYLON.FluentBackplateMaterial",e},t.prototype.getClassName=function(){return"FluentBackplateMaterial"},t.Parse=function(e,n,r){return i.SerializationHelper.Parse(function(){return new t(e.name,n)},e,n,r)},t.BLOB_TEXTURE_URL="https://assets.babylonjs.com/meshes/MRTK/mrtk-fluent-backplate-blob.png",t.IM_TEXTURE_URL="https://assets.babylonjs.com/meshes/MRTK/mrtk-fluent-backplate-iridescence.png",Object(r.__decorate)([Object(i.serialize)()],t.prototype,"radius",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"lineWidth",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"absoluteSizes",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"baseColor",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"lineColor",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobIntensity",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobFarSize",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobNearDistance",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobFarDistance",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobFadeLength",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobNearSize",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobPulse",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobFade",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobNearSize2",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobPulse2",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobFade2",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"highlightColor",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"highlightWidth",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"iridescenceIntensity",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"iridescenceEdgeIntensity",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"fadeOut",void 0),Object(r.__decorate)([Object(i.serializeAsVector3)()],t.prototype,"globalLeftIndexTipPosition",void 0),Object(r.__decorate)([Object(i.serializeAsVector3)()],t.prototype,"globalRightIndexTipPosition",void 0),t}(i.PushMaterial);Object(i.RegisterClass)("BABYLON.GUI.FluentBackplateMaterial",a)},"./3D/materials/fluentBackplate/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./3D/materials/fluentBackplate/fluentBackplateMaterial.ts");n.d(t,"FluentBackplateMaterial",function(){return r.FluentBackplateMaterial})},"./3D/materials/fluentBackplate/shaders/fluentBackplate.fragment.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"fluentBackplatePixelShader",function(){return a});var r=n("babylonjs/Misc/perfCounter"),i="fluentBackplatePixelShader",o="uniform vec3 cameraPosition;\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec2 vUV;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec4 vColor;\nvarying vec4 vExtra1;\nvarying vec4 vExtra2;\nvarying vec4 vExtra3;\nuniform float _Radius_;\nuniform float _Line_Width_;\nuniform bool _Absolute_Sizes_;\nuniform float _Filter_Width_;\nuniform vec4 _Base_Color_;\nuniform vec4 _Line_Color_;\nuniform float _Radius_Top_Left_;\nuniform float _Radius_Top_Right_;\nuniform float _Radius_Bottom_Left_;\nuniform float _Radius_Bottom_Right_;\n\nuniform vec3 _Blob_Position_;\nuniform float _Blob_Intensity_;\nuniform float _Blob_Near_Size_;\nuniform float _Blob_Far_Size_;\nuniform float _Blob_Near_Distance_;\nuniform float _Blob_Far_Distance_;\nuniform float _Blob_Fade_Length_;\nuniform float _Blob_Pulse_;\nuniform float _Blob_Fade_;\nuniform sampler2D _Blob_Texture_;\n\nuniform vec3 _Blob_Position_2_;\nuniform float _Blob_Near_Size_2_;\nuniform float _Blob_Pulse_2_;\nuniform float _Blob_Fade_2_;\nuniform float _Rate_;\nuniform vec4 _Highlight_Color_;\nuniform float _Highlight_Width_;\nuniform vec4 _Highlight_Transform_;\nuniform float _Highlight_;\nuniform float _Iridescence_Intensity_;\nuniform float _Iridescence_Edge_Intensity_;\nuniform float _Angle_;\nuniform float _Fade_Out_;\n\nuniform bool _Reflected_;\nuniform float _Frequency_;\nuniform float _Vertical_Offset_;\n\nuniform sampler2D _Iridescent_Map_;\nuniform bool _Use_Global_Left_Index_;\nuniform bool _Use_Global_Right_Index_;\nuniform vec4 Global_Left_Index_Tip_Position;\nuniform vec4 Global_Right_Index_Tip_Position;\n\nvoid Round_Rect_Fragment_B31(\nfloat Radius,\nfloat Line_Width,\nvec4 Line_Color,\nfloat Filter_Width,\nvec2 UV,\nfloat Line_Visibility,\nvec4 Rect_Parms,\nvec4 Fill_Color,\nout vec4 Color)\n{\nfloat d=length(max(abs(UV)-Rect_Parms.xy,0.0));\nfloat dx=max(fwidth(d)*Filter_Width,0.00001);\n\nfloat g=min(Rect_Parms.z,Rect_Parms.w);\nfloat dgrad=max(fwidth(g)*Filter_Width,0.00001);\nfloat Inside_Rect=clamp(g/dgrad,0.0,1.0);\n\n\nfloat inner=clamp((d+dx*0.5-max(Radius-Line_Width,d-dx*0.5))/dx,0.0,1.0);\nColor=clamp(mix(Fill_Color,Line_Color,inner),0.0,1.0)*Inside_Rect;\n\n\n\n}\n\n\nvoid Blob_Fragment_B71(\nsampler2D Blob_Texture,\nvec4 Blob_Info1,\nvec4 Blob_Info2,\nout vec4 Blob_Color)\n{\nfloat k1=dot(Blob_Info1.xy,Blob_Info1.xy);\nfloat k2=dot(Blob_Info2.xy,Blob_Info2.xy);\nvec3 closer=k1<k2 ? vec3(k1,Blob_Info1.z,Blob_Info1.w) : vec3(k2,Blob_Info2.z,Blob_Info2.w);\nBlob_Color=closer.z*texture(Blob_Texture,vec2(vec2(sqrt(closer.x),closer.y).x,1.0-vec2(sqrt(closer.x),closer.y).y))*clamp(1.0-closer.x,0.0,1.0);\n}\n\n\nvoid Line_Fragment_B48(\nvec4 Base_Color,\nvec4 Highlight_Color,\nfloat Highlight_Width,\nvec3 Line_Vertex,\nfloat Highlight,\nout vec4 Line_Color)\n{\nfloat k2=1.0-clamp(abs(Line_Vertex.y/Highlight_Width),0.0,1.0);\nLine_Color=mix(Base_Color,Highlight_Color,Highlight*k2);\n}\n\n\nvoid Scale_RGB_B54(\nvec4 Color,\nfloat Scalar,\nout vec4 Result)\n{\nResult=vec4(Scalar,Scalar,Scalar,1)*Color;\n}\n\n\nvoid Conditional_Float_B38(\nbool Which,\nfloat If_True,\nfloat If_False,\nout float Result)\n{\nResult=Which ? If_True : If_False;\n}\n\nvoid main()\n{\n\nfloat R_Q72;\nfloat G_Q72;\nfloat B_Q72;\nfloat A_Q72;\nR_Q72=vColor.r; G_Q72=vColor.g; B_Q72=vColor.b; A_Q72=vColor.a;\nvec4 Blob_Color_Q71;\n#if BLOB_ENABLE\n\nfloat k1=dot(vExtra2.xy,vExtra2.xy);\nfloat k2=dot(vExtra3.xy,vExtra3.xy);\nvec3 closer=k1<k2 ? vec3(k1,vExtra2.z,vExtra2.w) : vec3(k2,vExtra3.z,vExtra3.w);\nBlob_Color_Q71=closer.z*texture(_Blob_Texture_,vec2(vec2(sqrt(closer.x),closer.y).x,1.0-vec2(sqrt(closer.x),closer.y).y))*clamp(1.0-closer.x,0.0,1.0);\n#else\nBlob_Color_Q71=vec4(0,0,0,0);\n#endif\nvec4 Line_Color_Q48;\nLine_Fragment_B48(_Line_Color_,_Highlight_Color_,_Highlight_Width_,vTangent,_Highlight_,Line_Color_Q48);\n\nfloat X_Q67;\nfloat Y_Q67;\nX_Q67=vUV.x;\nY_Q67=vUV.y;\n\nvec3 Incident_Q66=normalize(vPosition-cameraPosition);\n\nvec3 Reflected_Q60=reflect(Incident_Q66,vBinormal);\n\nfloat Product_Q63=Y_Q67*_Vertical_Offset_;\n\nfloat Dot_Q68=dot(Incident_Q66,Reflected_Q60);\n\nfloat Dot_Q57=dot(vNormal,Incident_Q66);\nfloat Result_Q38;\nConditional_Float_B38(_Reflected_,Dot_Q68,Dot_Q57,Result_Q38);\n\nfloat Product_Q64=Result_Q38*_Frequency_;\n\nfloat Sum_Q69=Product_Q64+1.0;\n\nfloat Product_Q70=Sum_Q69*0.5;\n\nfloat Sum_Q62=Product_Q63+Product_Q70;\n\nfloat FractF_Q59=fract(Sum_Q62);\n\nvec2 Vec2_Q65=vec2(FractF_Q59,0.5);\n\nvec4 Color_Q58;\n#if IRIDESCENT_MAP_ENABLE\nColor_Q58=texture(_Iridescent_Map_,Vec2_Q65);\n#else\nColor_Q58=vec4(0,0,0,0);\n#endif\nvec4 Result_Q54;\nScale_RGB_B54(Color_Q58,_Iridescence_Edge_Intensity_,Result_Q54);\nvec4 Result_Q55;\nScale_RGB_B54(Color_Q58,_Iridescence_Intensity_,Result_Q55);\n\nvec4 Base_And_Iridescent_Q53;\nBase_And_Iridescent_Q53=Line_Color_Q48+vec4(Result_Q54.rgb,0.0);\n\nvec4 Base_And_Iridescent_Q56;\nBase_And_Iridescent_Q56=_Base_Color_+vec4(Result_Q55.rgb,0.0);\n\nvec4 Result_Q52=Base_And_Iridescent_Q53; Result_Q52.a=1.0;\n\nvec4 Result_Q35=Blob_Color_Q71+(1.0-Blob_Color_Q71.a)*Base_And_Iridescent_Q56;\nvec4 Color_Q31;\nRound_Rect_Fragment_B31(R_Q72,G_Q72,Result_Q52,_Filter_Width_,vUV,1.0,vExtra1,Result_Q35,Color_Q31);\n\nvec4 Result_Q47=_Fade_Out_*Color_Q31;\nvec4 Out_Color=Result_Q47;\nfloat Clip_Threshold=0.001;\nbool To_sRGB=false;\ngl_FragColor=Out_Color;\n}";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./3D/materials/fluentBackplate/shaders/fluentBackplate.vertex.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"fluentBackplateVertexShader",function(){return a});var r=n("babylonjs/Misc/perfCounter"),i="fluentBackplateVertexShader",o="uniform mat4 world;\nuniform mat4 viewProjection;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 normal;\n#ifdef TANGENT\nattribute vec3 tangent;\n#else\nconst vec3 tangent=vec3(0.);\n#endif\nuniform float _Radius_;\nuniform float _Line_Width_;\nuniform bool _Absolute_Sizes_;\nuniform float _Filter_Width_;\nuniform vec4 _Base_Color_;\nuniform vec4 _Line_Color_;\nuniform float _Radius_Top_Left_;\nuniform float _Radius_Top_Right_;\nuniform float _Radius_Bottom_Left_;\nuniform float _Radius_Bottom_Right_;\n\nuniform vec3 _Blob_Position_;\nuniform float _Blob_Intensity_;\nuniform float _Blob_Near_Size_;\nuniform float _Blob_Far_Size_;\nuniform float _Blob_Near_Distance_;\nuniform float _Blob_Far_Distance_;\nuniform float _Blob_Fade_Length_;\nuniform float _Blob_Pulse_;\nuniform float _Blob_Fade_;\nuniform sampler2D _Blob_Texture_;\n\nuniform vec3 _Blob_Position_2_;\nuniform float _Blob_Near_Size_2_;\nuniform float _Blob_Pulse_2_;\nuniform float _Blob_Fade_2_;\nuniform float _Rate_;\nuniform vec4 _Highlight_Color_;\nuniform float _Highlight_Width_;\nuniform vec4 _Highlight_Transform_;\nuniform float _Highlight_;\nuniform float _Iridescence_Intensity_;\nuniform float _Iridescence_Edge_Intensity_;\nuniform float _Angle_;\nuniform float _Fade_Out_;\n\nuniform bool _Reflected_;\nuniform float _Frequency_;\nuniform float _Vertical_Offset_;\n\nuniform sampler2D _Iridescent_Map_;\nuniform bool _Use_Global_Left_Index_;\nuniform bool _Use_Global_Right_Index_;\nuniform vec4 Global_Left_Index_Tip_Position;\nuniform vec4 Global_Right_Index_Tip_Position;\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec2 vUV;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec4 vColor;\nvarying vec4 vExtra1;\nvarying vec4 vExtra2;\nvarying vec4 vExtra3;\n\nvoid Object_To_World_Pos_B115(\nvec3 Pos_Object,\nout vec3 Pos_World)\n{\nPos_World=(world*vec4(Pos_Object,1.0)).xyz;\n}\n\n\nvoid PickDir_B140(\nfloat Degrees,\nvec3 DirX,\nvec3 DirY,\nout vec3 Dir)\n{\n\nfloat a=Degrees*3.14159/180.0;\nDir=cos(a)*DirX+sin(a)*DirY;\n}\n\n\nvoid Round_Rect_Vertex_B139(\nvec2 UV,\nfloat Radius,\nfloat Margin,\nfloat Anisotropy,\nfloat Gradient1,\nfloat Gradient2,\nout vec2 Rect_UV,\nout vec4 Rect_Parms,\nout vec2 Scale_XY,\nout vec2 Line_UV)\n{\nScale_XY=vec2(Anisotropy,1.0);\nLine_UV=(UV-vec2(0.5,0.5));\nRect_UV=Line_UV*Scale_XY;\nRect_Parms.xy=Scale_XY*0.5-vec2(Radius,Radius)-vec2(Margin,Margin);\nRect_Parms.z=Gradient1;\nRect_Parms.w=Gradient2;\n}\n\n\nvoid Line_Vertex_B135(\nvec2 Scale_XY,\nvec2 UV,\nfloat Time,\nfloat Rate,\nvec4 Highlight_Transform,\nout vec3 Line_Vertex)\n{\nfloat angle2=(Rate*Time)*2.0*3.1416;\nfloat sinAngle2=sin(angle2);\nfloat cosAngle2=cos(angle2);\nvec2 xformUV=UV*Highlight_Transform.xy+Highlight_Transform.zw;\nLine_Vertex.x=0.0;\nLine_Vertex.y=cosAngle2*xformUV.x-sinAngle2*xformUV.y;\nLine_Vertex.z=0.0;\n}\n\n\nvoid Blob_Vertex_B180(\nvec3 Position,\nvec3 Normal,\nvec3 Tangent,\nvec3 Bitangent,\nvec3 Blob_Position,\nfloat Intensity,\nfloat Blob_Near_Size,\nfloat Blob_Far_Size,\nfloat Blob_Near_Distance,\nfloat Blob_Far_Distance,\nfloat Blob_Fade_Length,\nfloat Blob_Pulse,\nfloat Blob_Fade,\nout vec4 Blob_Info)\n{\nvec3 blob=Blob_Position;\nvec3 delta=blob-Position;\nfloat dist=dot(Normal,delta);\nfloat lerpValue=clamp((abs(dist)-Blob_Near_Distance)/(Blob_Far_Distance-Blob_Near_Distance),0.0,1.0);\nfloat fadeValue=1.0-clamp((abs(dist)-Blob_Far_Distance)/Blob_Fade_Length,0.0,1.0);\nfloat size=Blob_Near_Size+(Blob_Far_Size-Blob_Near_Size)*lerpValue;\nvec2 blobXY=vec2(dot(delta,Tangent),dot(delta,Bitangent))/(0.0001+size);\nfloat Fade=fadeValue*Intensity*Blob_Fade;\nfloat Distance=(lerpValue*0.5+0.5)*(1.0-Blob_Pulse);\nBlob_Info=vec4(blobXY.x,blobXY.y,Distance,Fade);\n}\n\n\nvoid Move_Verts_B129(\nfloat Anisotropy,\nvec3 P,\nfloat Radius,\nout vec3 New_P,\nout vec2 New_UV,\nout float Radial_Gradient,\nout vec3 Radial_Dir)\n{\nvec2 UV=P.xy*2.0+0.5;\nvec2 center=clamp(UV,0.0,1.0);\nvec2 delta=UV-center;\nvec2 r2=2.0*vec2(Radius/Anisotropy,Radius);\nNew_UV=center+r2*(UV-2.0*center+0.5);\nNew_P=vec3(New_UV-0.5,P.z);\nRadial_Gradient=1.0-length(delta)*2.0;\nRadial_Dir=vec3(delta*r2,0.0);\n}\n\n\nvoid Object_To_World_Dir_B132(\nvec3 Dir_Object,\nout vec3 Binormal_World,\nout vec3 Binormal_World_N,\nout float Binormal_Length)\n{\nBinormal_World=(world*vec4(Dir_Object,0.0)).xyz;\nBinormal_Length=length(Binormal_World);\nBinormal_World_N=Binormal_World/Binormal_Length;\n}\n\n\nvoid RelativeOrAbsoluteDetail_B147(\nfloat Nominal_Radius,\nfloat Nominal_LineWidth,\nbool Absolute_Measurements,\nfloat Height,\nout float Radius,\nout float Line_Width)\n{\nfloat scale=Absolute_Measurements ? 1.0/Height : 1.0;\nRadius=Nominal_Radius*scale;\nLine_Width=Nominal_LineWidth*scale;\n}\n\n\nvoid Edge_AA_Vertex_B130(\nvec3 Position_World,\nvec3 Position_Object,\nvec3 Normal_Object,\nvec3 Eye,\nfloat Radial_Gradient,\nvec3 Radial_Dir,\nvec3 Tangent,\nout float Gradient1,\nout float Gradient2)\n{\n\nvec3 I=(Eye-Position_World);\nvec3 T=(world* vec4(Tangent,0.0)).xyz;\nfloat g=(dot(T,I)<0.0) ? 0.0 : 1.0;\nif (Normal_Object.z==0.0) {\n\nGradient1=Position_Object.z>0.0 ? g : 1.0;\nGradient2=Position_Object.z>0.0 ? 1.0 : g;\n} else {\n\n\n\n\nGradient1=g+(1.0-g)*(Radial_Gradient);\nGradient2=1.0;\n}\n}\n\n\nvoid Pick_Radius_B144(\nfloat Radius,\nfloat Radius_Top_Left,\nfloat Radius_Top_Right,\nfloat Radius_Bottom_Left,\nfloat Radius_Bottom_Right,\nvec3 Position,\nout float Result)\n{\nbool whichY=Position.y>0.0;\nResult=Position.x<0.0 ? (whichY ? Radius_Top_Left : Radius_Bottom_Left) : (whichY ? Radius_Top_Right : Radius_Bottom_Right);\nResult*=Radius;\n}\n\nvoid main()\n{\n\nvec3 Nrm_World_Q128;\nNrm_World_Q128=normalize((world*vec4(normal,0.0)).xyz);\n\nvec3 Tangent_World_Q131;\nvec3 Tangent_World_N_Q131;\nfloat Tangent_Length_Q131;\nTangent_World_Q131=(world*vec4(vec3(1,0,0),0.0)).xyz;\nTangent_Length_Q131=length(Tangent_World_Q131);\nTangent_World_N_Q131=Tangent_World_Q131/Tangent_Length_Q131;\nvec3 Binormal_World_Q132;\nvec3 Binormal_World_N_Q132;\nfloat Binormal_Length_Q132;\nObject_To_World_Dir_B132(vec3(0,1,0),Binormal_World_Q132,Binormal_World_N_Q132,Binormal_Length_Q132);\n\nfloat Anisotropy_Q133=Tangent_Length_Q131/Binormal_Length_Q132;\n\nvec3 Result_Q177;\nResult_Q177=mix(_Blob_Position_,Global_Left_Index_Tip_Position.xyz,float(_Use_Global_Left_Index_));\n\nvec3 Result_Q178;\nResult_Q178=mix(_Blob_Position_2_,Global_Right_Index_Tip_Position.xyz,float(_Use_Global_Right_Index_));\nfloat Result_Q144;\nPick_Radius_B144(_Radius_,_Radius_Top_Left_,_Radius_Top_Right_,_Radius_Bottom_Left_,_Radius_Bottom_Right_,position,Result_Q144);\nvec3 Dir_Q140;\nPickDir_B140(_Angle_,Tangent_World_N_Q131,Binormal_World_N_Q132,Dir_Q140);\nfloat Radius_Q147;\nfloat Line_Width_Q147;\nRelativeOrAbsoluteDetail_B147(Result_Q144,_Line_Width_,_Absolute_Sizes_,Binormal_Length_Q132,Radius_Q147,Line_Width_Q147);\n\nvec4 Out_Color_Q145=vec4(Radius_Q147,Line_Width_Q147,0,1);\nvec3 New_P_Q129;\nvec2 New_UV_Q129;\nfloat Radial_Gradient_Q129;\nvec3 Radial_Dir_Q129;\nMove_Verts_B129(Anisotropy_Q133,position,Radius_Q147,New_P_Q129,New_UV_Q129,Radial_Gradient_Q129,Radial_Dir_Q129);\nvec3 Pos_World_Q115;\nObject_To_World_Pos_B115(New_P_Q129,Pos_World_Q115);\nvec4 Blob_Info_Q180;\n#if BLOB_ENABLE\nBlob_Vertex_B180(Pos_World_Q115,Nrm_World_Q128,Tangent_World_N_Q131,Binormal_World_N_Q132,Result_Q177,_Blob_Intensity_,_Blob_Near_Size_,_Blob_Far_Size_,_Blob_Near_Distance_,_Blob_Far_Distance_,_Blob_Fade_Length_,_Blob_Pulse_,_Blob_Fade_,Blob_Info_Q180);\n#else\nBlob_Info_Q180=vec4(0,0,0,0);\n#endif\nvec4 Blob_Info_Q181;\n#if BLOB_ENABLE_2\nBlob_Vertex_B180(Pos_World_Q115,Nrm_World_Q128,Tangent_World_N_Q131,Binormal_World_N_Q132,Result_Q178,_Blob_Intensity_,_Blob_Near_Size_2_,_Blob_Far_Size_,_Blob_Near_Distance_,_Blob_Far_Distance_,_Blob_Fade_Length_,_Blob_Pulse_2_,_Blob_Fade_2_,Blob_Info_Q181);\n#else\nBlob_Info_Q181=vec4(0,0,0,0);\n#endif\nfloat Gradient1_Q130;\nfloat Gradient2_Q130;\n#if SMOOTH_EDGES\nEdge_AA_Vertex_B130(Pos_World_Q115,position,normal,cameraPosition,Radial_Gradient_Q129,Radial_Dir_Q129,tangent,Gradient1_Q130,Gradient2_Q130);\n#else\nGradient1_Q130=1.0;\nGradient2_Q130=1.0;\n#endif\nvec2 Rect_UV_Q139;\nvec4 Rect_Parms_Q139;\nvec2 Scale_XY_Q139;\nvec2 Line_UV_Q139;\nRound_Rect_Vertex_B139(New_UV_Q129,Radius_Q147,0.0,Anisotropy_Q133,Gradient1_Q130,Gradient2_Q130,Rect_UV_Q139,Rect_Parms_Q139,Scale_XY_Q139,Line_UV_Q139);\nvec3 Line_Vertex_Q135;\nLine_Vertex_B135(Scale_XY_Q139,Line_UV_Q139,0.0,_Rate_,_Highlight_Transform_,Line_Vertex_Q135);\nvec3 Position=Pos_World_Q115;\nvec3 Normal=Dir_Q140;\nvec2 UV=Rect_UV_Q139;\nvec3 Tangent=Line_Vertex_Q135;\nvec3 Binormal=Nrm_World_Q128;\nvec4 Color=Out_Color_Q145;\nvec4 Extra1=Rect_Parms_Q139;\nvec4 Extra2=Blob_Info_Q180;\nvec4 Extra3=Blob_Info_Q181;\ngl_Position=viewProjection*vec4(Position,1);\nvPosition=Position;\nvNormal=Normal;\nvUV=UV;\nvTangent=Tangent;\nvBinormal=Binormal;\nvColor=Color;\nvExtra1=Extra1;\nvExtra2=Extra2;\nvExtra3=Extra3;\n}";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./3D/materials/fluentButton/fluentButtonMaterial.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"FluentButtonMaterial",function(){return a});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=(n("./3D/materials/fluentButton/shaders/fluentButton.fragment.ts"),n("./3D/materials/fluentButton/shaders/fluentButton.vertex.ts"),function(e){function t(){var t=e.call(this)||this;return t.RELATIVE_WIDTH=!0,t.ENABLE_FADE=!0,t._needNormals=!0,t._needUVs=!0,t.rebuild(),t}return Object(r.__extends)(t,e),t}(i.MaterialDefines)),a=function(e){function t(n,r){var o=e.call(this,n,r)||this;return o.edgeWidth=.04,o.edgeColor=new i.Color4(.592157,.592157,.592157,1),o.proximityMaxIntensity=.45,o.proximityFarDistance=.16,o.proximityNearRadius=1.5,o.proximityAnisotropy=1,o.selectionFuzz=.5,o.selected=0,o.selectionFade=0,o.selectionFadeSize=.3,o.selectedDistance=.08,o.selectedFadeLength=.08,o.blobIntensity=.5,o.blobFarSize=.05,o.blobNearDistance=0,o.blobFarDistance=.08,o.blobFadeLength=.08,o.leftBlobEnable=!0,o.leftBlobNearSize=.025,o.leftBlobPulse=0,o.leftBlobFade=1,o.leftBlobInnerFade=.01,o.rightBlobEnable=!0,o.rightBlobNearSize=.025,o.rightBlobPulse=0,o.rightBlobFade=1,o.rightBlobInnerFade=.01,o.activeFaceDir=new i.Vector3(0,0,-1),o.activeFaceUp=new i.Vector3(0,1,0),o.enableFade=!0,o.fadeWidth=1.5,o.smoothActiveFace=!0,o.showFrame=!1,o.useBlobTexture=!0,o.globalLeftIndexTipPosition=i.Vector3.Zero(),o.globalRightIndexTipPosition=i.Vector3.Zero(),o.alphaMode=i.Constants.ALPHA_ADD,o.disableDepthWrite=!0,o.backFaceCulling=!1,o._blobTexture=new i.Texture(t.BLOB_TEXTURE_URL,r,!0,!1,i.Texture.NEAREST_SAMPLINGMODE),o}return Object(r.__extends)(t,e),t.prototype.needAlphaBlending=function(){return!0},t.prototype.needAlphaTesting=function(){return!0},t.prototype.getAlphaTestTexture=function(){return null},t.prototype.isReadyForSubMesh=function(e,t,n){if(this.isFrozen&&t.effect&&t.effect._wasPreviouslyReady)return!0;t._materialDefines||(t.materialDefines=new o);var r=t._materialDefines,a=this.getScene();if(this._isReadyForSubMesh(t))return!0;var s=a.getEngine();if(i.MaterialHelper.PrepareDefinesForAttributes(e,r,!0,!1),r.isDirty){r.markAsProcessed(),a.resetCachedMaterial();var l=new i.EffectFallbacks;r.FOG&&l.addFallback(1,"FOG"),i.MaterialHelper.HandleFallbacksForShadows(r,l),r.IMAGEPROCESSINGPOSTPROCESS=a.imageProcessingConfiguration.applyByPostProcess;var c=[i.VertexBuffer.PositionKind];r.NORMAL&&c.push(i.VertexBuffer.NormalKind),r.UV1&&c.push(i.VertexBuffer.UVKind),r.UV2&&c.push(i.VertexBuffer.UV2Kind),r.VERTEXCOLOR&&c.push(i.VertexBuffer.ColorKind),r.TANGENT&&c.push(i.VertexBuffer.TangentKind),i.MaterialHelper.PrepareAttributesForInstances(c,r);var u=r.toString(),_=["world","viewProjection","cameraPosition","_Edge_Width_","_Edge_Color_","_Relative_Width_","_Proximity_Max_Intensity_","_Proximity_Far_Distance_","_Proximity_Near_Radius_","_Proximity_Anisotropy_","_Selection_Fuzz_","_Selected_","_Selection_Fade_","_Selection_Fade_Size_","_Selected_Distance_","_Selected_Fade_Length_","_Blob_Enable_","_Blob_Position_","_Blob_Intensity_","_Blob_Near_Size_","_Blob_Far_Size_","_Blob_Near_Distance_","_Blob_Far_Distance_","_Blob_Fade_Length_","_Blob_Inner_Fade_","_Blob_Pulse_","_Blob_Fade_","_Blob_Texture_","_Blob_Enable_2_","_Blob_Position_2_","_Blob_Near_Size_2_","_Blob_Inner_Fade_2_","_Blob_Pulse_2_","_Blob_Fade_2_","_Active_Face_Dir_","_Active_Face_Up_","_Enable_Fade_","_Fade_Width_","_Smooth_Active_Face_","_Show_Frame_","_Use_Blob_Texture_","Use_Global_Left_Index","Use_Global_Right_Index","Global_Left_Index_Tip_Position","Global_Right_Index_Tip_Position","Global_Left_Thumb_Tip_Position","Global_Right_Thumb_Tip_Position","Global_Left_Index_Tip_Proximity","Global_Right_Index_Tip_Proximity"],h=["_Blob_Texture_"],f=new Array;i.MaterialHelper.PrepareUniformsAndSamplersList({uniformsNames:_,uniformBuffersNames:f,samplers:h,defines:r,maxSimultaneousLights:4}),t.setEffect(a.getEngine().createEffect("fluentButton",{attributes:c,uniformsNames:_,uniformBuffersNames:f,samplers:h,defines:u,fallbacks:l,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousLights:4}},s),r,this._materialContext)}return!(!t.effect||!t.effect.isReady())&&(r._renderId=a.getRenderId(),t.effect._wasPreviouslyReady=!0,!0)},t.prototype.bindForSubMesh=function(e,t,n){var r=this.getScene();if(n._materialDefines){var o=n.effect;o&&(this._activeEffect=o,this.bindOnlyWorldMatrix(e),this._activeEffect.setMatrix("viewProjection",r.getTransformMatrix()),this._activeEffect.setVector3("cameraPosition",r.activeCamera.position),this._activeEffect.setTexture("_Blob_Texture_",this._blobTexture),this._activeEffect.setFloat("_Edge_Width_",this.edgeWidth),this._activeEffect.setColor4("_Edge_Color_",new i.Color3(this.edgeColor.r,this.edgeColor.g,this.edgeColor.b),this.edgeColor.a),this._activeEffect.setFloat("_Proximity_Max_Intensity_",this.proximityMaxIntensity),this._activeEffect.setFloat("_Proximity_Far_Distance_",this.proximityFarDistance),this._activeEffect.setFloat("_Proximity_Near_Radius_",this.proximityNearRadius),this._activeEffect.setFloat("_Proximity_Anisotropy_",this.proximityAnisotropy),this._activeEffect.setFloat("_Selection_Fuzz_",this.selectionFuzz),this._activeEffect.setFloat("_Selected_",this.selected),this._activeEffect.setFloat("_Selection_Fade_",this.selectionFade),this._activeEffect.setFloat("_Selection_Fade_Size_",this.selectionFadeSize),this._activeEffect.setFloat("_Selected_Distance_",this.selectedDistance),this._activeEffect.setFloat("_Selected_Fade_Length_",this.selectedFadeLength),this._activeEffect.setFloat("_Blob_Enable_",this.leftBlobEnable?1:0),this._activeEffect.setFloat("_Blob_Intensity_",this.blobIntensity),this._activeEffect.setFloat("_Blob_Near_Size_",this.leftBlobNearSize),this._activeEffect.setFloat("_Blob_Far_Size_",this.blobFarSize),this._activeEffect.setFloat("_Blob_Near_Distance_",this.blobNearDistance),this._activeEffect.setFloat("_Blob_Far_Distance_",this.blobFarDistance),this._activeEffect.setFloat("_Blob_Fade_Length_",this.blobFadeLength),this._activeEffect.setFloat("_Blob_Inner_Fade_",this.leftBlobInnerFade),this._activeEffect.setFloat("_Blob_Pulse_",this.leftBlobPulse),this._activeEffect.setFloat("_Blob_Fade_",this.leftBlobFade),this._activeEffect.setFloat("_Blob_Enable_2_",this.rightBlobEnable?1:0),this._activeEffect.setFloat("_Blob_Near_Size_2_",this.rightBlobNearSize),this._activeEffect.setFloat("_Blob_Inner_Fade_2_",this.rightBlobInnerFade),this._activeEffect.setFloat("_Blob_Pulse_2_",this.rightBlobPulse),this._activeEffect.setFloat("_Blob_Fade_2_",this.rightBlobFade),this._activeEffect.setVector3("_Active_Face_Dir_",this.activeFaceDir),this._activeEffect.setVector3("_Active_Face_Up_",this.activeFaceUp),this._activeEffect.setFloat("_Fade_Width_",this.fadeWidth),this._activeEffect.setFloat("_Smooth_Active_Face_",this.smoothActiveFace?1:0),this._activeEffect.setFloat("_Show_Frame_",this.showFrame?1:0),this._activeEffect.setFloat("_Use_Blob_Texture_",this.useBlobTexture?1:0),this._activeEffect.setFloat("Use_Global_Left_Index",1),this._activeEffect.setFloat("Use_Global_Right_Index",1),this._activeEffect.setVector4("Global_Left_Index_Tip_Position",new i.Vector4(this.globalLeftIndexTipPosition.x,this.globalLeftIndexTipPosition.y,this.globalLeftIndexTipPosition.z,1)),this._activeEffect.setVector4("Global_Right_Index_Tip_Position",new i.Vector4(this.globalRightIndexTipPosition.x,this.globalRightIndexTipPosition.y,this.globalRightIndexTipPosition.z,1)),this._afterBind(t,this._activeEffect))}},t.prototype.getAnimatables=function(){return[]},t.prototype.dispose=function(t){e.prototype.dispose.call(this,t)},t.prototype.clone=function(e){var n=this;return i.SerializationHelper.Clone(function(){return new t(e,n.getScene())},this)},t.prototype.serialize=function(){var e=i.SerializationHelper.Serialize(this);return e.customType="BABYLON.FluentButtonMaterial",e},t.prototype.getClassName=function(){return"FluentButtonMaterial"},t.Parse=function(e,n,r){return i.SerializationHelper.Parse(function(){return new t(e.name,n)},e,n,r)},t.BLOB_TEXTURE_URL="https://assets.babylonjs.com/meshes/MRTK/mrtk-fluent-button-blob.png",Object(r.__decorate)([Object(i.serialize)()],t.prototype,"edgeWidth",void 0),Object(r.__decorate)([Object(i.serializeAsColor4)()],t.prototype,"edgeColor",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"proximityMaxIntensity",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"proximityFarDistance",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"proximityNearRadius",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"proximityAnisotropy",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"selectionFuzz",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"selected",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"selectionFade",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"selectionFadeSize",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"selectedDistance",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"selectedFadeLength",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobIntensity",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobFarSize",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobNearDistance",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobFarDistance",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobFadeLength",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"leftBlobEnable",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"leftBlobNearSize",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"leftBlobPulse",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"leftBlobFade",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"leftBlobInnerFade",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"rightBlobEnable",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"rightBlobNearSize",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"rightBlobPulse",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"rightBlobFade",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"rightBlobInnerFade",void 0),Object(r.__decorate)([Object(i.serializeAsVector3)()],t.prototype,"activeFaceDir",void 0),Object(r.__decorate)([Object(i.serializeAsVector3)()],t.prototype,"activeFaceUp",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"enableFade",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"fadeWidth",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"smoothActiveFace",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"showFrame",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"useBlobTexture",void 0),Object(r.__decorate)([Object(i.serializeAsVector3)()],t.prototype,"globalLeftIndexTipPosition",void 0),Object(r.__decorate)([Object(i.serializeAsVector3)()],t.prototype,"globalRightIndexTipPosition",void 0),t}(i.PushMaterial);Object(i.RegisterClass)("BABYLON.GUI.FluentButtonMaterial",a)},"./3D/materials/fluentButton/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./3D/materials/fluentButton/fluentButtonMaterial.ts");n.d(t,"FluentButtonMaterial",function(){return r.FluentButtonMaterial})},"./3D/materials/fluentButton/shaders/fluentButton.fragment.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"fluentButtonPixelShader",function(){return a});var r=n("babylonjs/Misc/perfCounter"),i="fluentButtonPixelShader",o="uniform vec3 cameraPosition;\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec2 vUV;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec4 vColor;\nvarying vec4 vExtra1;\nuniform float _Edge_Width_;\nuniform vec4 _Edge_Color_;\nuniform bool _Relative_Width_;\nuniform float _Proximity_Max_Intensity_;\nuniform float _Proximity_Far_Distance_;\nuniform float _Proximity_Near_Radius_;\nuniform float _Proximity_Anisotropy_;\nuniform float _Selection_Fuzz_;\nuniform float _Selected_;\nuniform float _Selection_Fade_;\nuniform float _Selection_Fade_Size_;\nuniform float _Selected_Distance_;\nuniform float _Selected_Fade_Length_;\nuniform bool _Blob_Enable_;\nuniform vec3 _Blob_Position_;\nuniform float _Blob_Intensity_;\nuniform float _Blob_Near_Size_;\nuniform float _Blob_Far_Size_;\nuniform float _Blob_Near_Distance_;\nuniform float _Blob_Far_Distance_;\nuniform float _Blob_Fade_Length_;\nuniform float _Blob_Inner_Fade_;\nuniform float _Blob_Pulse_;\nuniform float _Blob_Fade_;\nuniform sampler2D _Blob_Texture_;\nuniform bool _Blob_Enable_2_;\nuniform vec3 _Blob_Position_2_;\nuniform float _Blob_Near_Size_2_;\nuniform float _Blob_Inner_Fade_2_;\nuniform float _Blob_Pulse_2_;\nuniform float _Blob_Fade_2_;\nuniform vec3 _Active_Face_Dir_;\nuniform vec3 _Active_Face_Up_;\nuniform bool Enable_Fade;\nuniform float _Fade_Width_;\nuniform bool _Smooth_Active_Face_;\nuniform bool _Show_Frame_;\nuniform bool _Use_Blob_Texture_;\nuniform bool Use_Global_Left_Index;\nuniform bool Use_Global_Right_Index;\nuniform vec4 Global_Left_Index_Tip_Position;\nuniform vec4 Global_Right_Index_Tip_Position;\nuniform vec4 Global_Left_Thumb_Tip_Position;\nuniform vec4 Global_Right_Thumb_Tip_Position;\nuniform float Global_Left_Index_Tip_Proximity;\nuniform float Global_Right_Index_Tip_Proximity;\n\nvoid Holo_Edge_Fragment_B35(\nvec4 Edges,\nfloat Edge_Width,\nout float NotEdge)\n{\nvec2 c=vec2(min(Edges.r,Edges.g),min(Edges.b,Edges.a));\nvec2 df=fwidth(c)*Edge_Width;\nvec2 g=clamp(c/df,0.0,1.0);\nNotEdge=g.x*g.y;\n}\n\n\nvoid Blob_Fragment_B39(\nvec2 UV,\nvec3 Blob_Info,\nsampler2D Blob_Texture,\nout vec4 Blob_Color)\n{\nfloat k=dot(UV,UV);\nBlob_Color=Blob_Info.y*texture(Blob_Texture,vec2(vec2(sqrt(k),Blob_Info.x).x,1.0-vec2(sqrt(k),Blob_Info.x).y))*(1.0-clamp(k,0.0,1.0));\n}\n\n\nvec2 FilterStep(vec2 Edge,vec2 X)\n{\n\nvec2 dX=max(fwidth(X),vec2(0.00001,0.00001));\nreturn clamp( (X+dX-max(Edge,X-dX))/(dX*2.0),0.0,1.0);\n}\nvoid Wireframe_Fragment_B59(\nvec3 Widths,\nvec2 UV,\nfloat Proximity,\nvec4 Edge_Color,\nout vec4 Wireframe)\n{\nvec2 c=min(UV,vec2(1.0,1.0)-UV);\nvec2 g=FilterStep(Widths.xy*0.5,c);\nWireframe=(1.0-min(g.x,g.y))*Proximity*Edge_Color;\n}\n\n\nvoid Proximity_B53(\nvec3 Proximity_Center,\nvec3 Proximity_Center_2,\nfloat Proximity_Max_Intensity,\nfloat Proximity_Near_Radius,\nvec3 Position,\nvec3 Show_Selection,\nvec4 Extra1,\nfloat Dist_To_Face,\nfloat Intensity,\nout float Proximity)\n{\nvec2 delta1=Extra1.xy;\nvec2 delta2=Extra1.zw;\nfloat d2=sqrt(min(dot(delta1,delta1),dot(delta2,delta2))+Dist_To_Face*Dist_To_Face);\n\nProximity=Intensity*Proximity_Max_Intensity*(1.0-clamp(d2/Proximity_Near_Radius,0.0,1.0))*(1.0-Show_Selection.x)+Show_Selection.x;\n}\n\n\nvoid To_XYZ_B46(\nvec3 Vec3,\nout float X,\nout float Y,\nout float Z)\n{\nX=Vec3.x;\nY=Vec3.y;\nZ=Vec3.z;\n}\n\nvoid main()\n{\nfloat NotEdge_Q35;\n#if ENABLE_FADE\nHolo_Edge_Fragment_B35(vColor,_Fade_Width_,NotEdge_Q35);\n#else\nNotEdge_Q35=1.0;\n#endif\n\n\nvec4 Blob_Color_Q39;\nfloat k=dot(vUV,vUV);\nvec2 blobTextureCoord=vec2(vec2(sqrt(k),vTangent.x).x,1.0-vec2(sqrt(k),vTangent.x).y);\nvec4 blobColor=mix(vec4(1.0,1.0,1.0,1.0)*step(1.0-vTangent.x,clamp(sqrt(k)+0.1,0.0,1.0)),texture(_Blob_Texture_,blobTextureCoord),float(_Use_Blob_Texture_));\nBlob_Color_Q39=vTangent.y*blobColor*(1.0-clamp(k,0.0,1.0));\n\nfloat Is_Quad_Q24;\nIs_Quad_Q24=vNormal.z;\n\nvec3 Blob_Position_Q41=mix(_Blob_Position_,Global_Left_Index_Tip_Position.xyz,float(Use_Global_Left_Index));\n\nvec3 Blob_Position_Q42=mix(_Blob_Position_2_,Global_Right_Index_Tip_Position.xyz,float(Use_Global_Right_Index));\nfloat X_Q46;\nfloat Y_Q46;\nfloat Z_Q46;\nTo_XYZ_B46(vBinormal,X_Q46,Y_Q46,Z_Q46);\nfloat Proximity_Q53;\nProximity_B53(Blob_Position_Q41,Blob_Position_Q42,_Proximity_Max_Intensity_,_Proximity_Near_Radius_,vPosition,vBinormal,vExtra1,Y_Q46,Z_Q46,Proximity_Q53);\nvec4 Wireframe_Q59;\nWireframe_Fragment_B59(vNormal,vUV,Proximity_Q53,_Edge_Color_,Wireframe_Q59);\n\nvec4 Wire_Or_Blob_Q23=mix(Wireframe_Q59,Blob_Color_Q39,Is_Quad_Q24);\n\nvec4 Result_Q22;\nResult_Q22=mix(Wire_Or_Blob_Q23,vec4(0.3,0.3,0.3,0.3),float(_Show_Frame_));\n\nvec4 Final_Color_Q37=NotEdge_Q35*Result_Q22;\nvec4 Out_Color=Final_Color_Q37;\nfloat Clip_Threshold=0.0;\nbool To_sRGB=false;\ngl_FragColor=Out_Color;\n}";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./3D/materials/fluentButton/shaders/fluentButton.vertex.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"fluentButtonVertexShader",function(){return a});var r=n("babylonjs/Misc/perfCounter"),i="fluentButtonVertexShader",o="uniform mat4 world;\nuniform mat4 viewProjection;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\nattribute vec3 tangent;\nattribute vec4 color;\nuniform float _Edge_Width_;\nuniform vec4 _Edge_Color_;\nuniform float _Proximity_Max_Intensity_;\nuniform float _Proximity_Far_Distance_;\nuniform float _Proximity_Near_Radius_;\nuniform float _Proximity_Anisotropy_;\nuniform float _Selection_Fuzz_;\nuniform float _Selected_;\nuniform float _Selection_Fade_;\nuniform float _Selection_Fade_Size_;\nuniform float _Selected_Distance_;\nuniform float _Selected_Fade_Length_;\nuniform bool _Blob_Enable_;\nuniform vec3 _Blob_Position_;\nuniform float _Blob_Intensity_;\nuniform float _Blob_Near_Size_;\nuniform float _Blob_Far_Size_;\nuniform float _Blob_Near_Distance_;\nuniform float _Blob_Far_Distance_;\nuniform float _Blob_Fade_Length_;\nuniform float _Blob_Inner_Fade_;\nuniform float _Blob_Pulse_;\nuniform float _Blob_Fade_;\nuniform sampler2D _Blob_Texture_;\nuniform bool _Blob_Enable_2_;\nuniform vec3 _Blob_Position_2_;\nuniform float _Blob_Near_Size_2_;\nuniform float _Blob_Inner_Fade_2_;\nuniform float _Blob_Pulse_2_;\nuniform float _Blob_Fade_2_;\nuniform vec3 _Active_Face_Dir_;\nuniform vec3 _Active_Face_Up_;\nuniform bool _Enable_Fade_;\nuniform float _Fade_Width_;\nuniform bool _Smooth_Active_Face_;\nuniform bool _Show_Frame_;\nuniform bool Use_Global_Left_Index;\nuniform bool Use_Global_Right_Index;\nuniform vec4 Global_Left_Index_Tip_Position;\nuniform vec4 Global_Right_Index_Tip_Position;\nuniform vec4 Global_Left_Thumb_Tip_Position;\nuniform vec4 Global_Right_Thumb_Tip_Position;\nuniform float Global_Left_Index_Tip_Proximity;\nuniform float Global_Right_Index_Tip_Proximity;\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec2 vUV;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec4 vColor;\nvarying vec4 vExtra1;\n\nvoid Blob_Vertex_B47(\nvec3 Position,\nvec3 Normal,\nvec3 Tangent,\nvec3 Bitangent,\nvec3 Blob_Position,\nfloat Intensity,\nfloat Blob_Near_Size,\nfloat Blob_Far_Size,\nfloat Blob_Near_Distance,\nfloat Blob_Far_Distance,\nvec4 Vx_Color,\nvec2 UV,\nvec3 Face_Center,\nvec2 Face_Size,\nvec2 In_UV,\nfloat Blob_Fade_Length,\nfloat Selection_Fade,\nfloat Selection_Fade_Size,\nfloat Inner_Fade,\nvec3 Active_Face_Center,\nfloat Blob_Pulse,\nfloat Blob_Fade,\nfloat Blob_Enabled,\nout vec3 Out_Position,\nout vec2 Out_UV,\nout vec3 Blob_Info)\n{\nfloat blobSize,fadeIn;\nvec3 Hit_Position;\nBlob_Info=vec3(0.0,0.0,0.0);\nfloat Hit_Distance=dot(Blob_Position-Face_Center,Normal);\nHit_Position=Blob_Position-Hit_Distance*Normal;\nfloat absD=abs(Hit_Distance);\nfloat lerpVal=clamp((absD-Blob_Near_Distance)/(Blob_Far_Distance-Blob_Near_Distance),0.0,1.0);\nfadeIn=1.0-clamp((absD-Blob_Far_Distance)/Blob_Fade_Length,0.0,1.0);\nfloat innerFade=1.0-clamp(-Hit_Distance/Inner_Fade,0.0,1.0);\n\nfloat farClip=clamp(1.0-step(Blob_Far_Distance+Blob_Fade_Length,absD),0.0,1.0);\nfloat size=mix(Blob_Near_Size,Blob_Far_Size,lerpVal)*farClip;\nblobSize=mix(size,Selection_Fade_Size,Selection_Fade)*innerFade*Blob_Enabled;\nBlob_Info.x=lerpVal*0.5+0.5;\nBlob_Info.y=fadeIn*Intensity*(1.0-Selection_Fade)*Blob_Fade;\nBlob_Info.x*=(1.0-Blob_Pulse);\n\nvec3 delta=Hit_Position-Face_Center;\nvec2 blobCenterXY=vec2(dot(delta,Tangent),dot(delta,Bitangent));\nvec2 quadUVin=2.0*UV-1.0;\nvec2 blobXY=blobCenterXY+quadUVin*blobSize;\n\nvec2 blobClipped=clamp(blobXY,-Face_Size*0.5,Face_Size*0.5);\nvec2 blobUV=(blobClipped-blobCenterXY)/max(blobSize,0.0001)*2.0;\nvec3 blobCorner=Face_Center+blobClipped.x*Tangent+blobClipped.y*Bitangent;\n\nOut_Position=mix(Position,blobCorner,Vx_Color.rrr);\nOut_UV=mix(In_UV,blobUV,Vx_Color.rr);\n}\n\n\nvec2 ProjectProximity(\nvec3 blobPosition,\nvec3 position,\nvec3 center,\nvec3 dir,\nvec3 xdir,\nvec3 ydir,\nout float vdistance\n)\n{\nvec3 delta=blobPosition-position;\nvec2 xy=vec2(dot(delta,xdir),dot(delta,ydir));\nvdistance=abs(dot(delta,dir));\nreturn xy;\n}\nvoid Proximity_Vertex_B66(\nvec3 Blob_Position,\nvec3 Blob_Position_2,\nvec3 Active_Face_Center,\nvec3 Active_Face_Dir,\nvec3 Position,\nfloat Proximity_Far_Distance,\nfloat Relative_Scale,\nfloat Proximity_Anisotropy,\nvec3 Up,\nout vec4 Extra1,\nout float Distance_To_Face,\nout float Intensity)\n{\nvec3 Active_Face_Dir_X=normalize(cross(Active_Face_Dir,Up));\n\nvec3 Active_Face_Dir_Y=cross(Active_Face_Dir,Active_Face_Dir_X);\nfloat distz1,distz2;\nExtra1.xy=ProjectProximity(Blob_Position,Position,Active_Face_Center,Active_Face_Dir,Active_Face_Dir_X*Proximity_Anisotropy,Active_Face_Dir_Y,distz1)/Relative_Scale;\nExtra1.zw=ProjectProximity(Blob_Position_2,Position,Active_Face_Center,Active_Face_Dir,Active_Face_Dir_X*Proximity_Anisotropy,Active_Face_Dir_Y,distz2)/Relative_Scale;\nDistance_To_Face=dot(Active_Face_Dir,Position-Active_Face_Center);\nIntensity=1.0-clamp(min(distz1,distz2)/Proximity_Far_Distance,0.0,1.0);\n}\n\n\nvoid Holo_Edge_Vertex_B44(\nvec3 Incident,\nvec3 Normal,\nvec2 UV,\nvec3 Tangent,\nvec3 Bitangent,\nbool Smooth_Active_Face,\nfloat Active,\nout vec4 Holo_Edges)\n{\nfloat NdotI=dot(Incident,Normal);\nvec2 flip=(UV-vec2(0.5,0.5));\nfloat udot=dot(Incident,Tangent)*flip.x*NdotI;\nfloat uval=1.0-float(udot>0.0);\nfloat vdot=-dot(Incident,Bitangent)*flip.y*NdotI;\nfloat vval=1.0-float(vdot>0.0);\nfloat Smooth_And_Active=step(1.0,float(Smooth_Active_Face && Active>0.0));\nuval=mix(uval,max(1.0,uval),Smooth_And_Active);\nvval=mix(vval,max(1.0,vval),Smooth_And_Active);\nHolo_Edges=vec4(1.0,1.0,1.0,1.0)-vec4(uval*UV.x,uval*(1.0-UV.x),vval*UV.y,vval*(1.0-UV.y));\n}\n\n\nvoid Object_To_World_Pos_B13(\nvec3 Pos_Object,\nout vec3 Pos_World)\n{\nPos_World=(world*vec4(Pos_Object,1.0)).xyz;\n}\n\n\nvoid Choose_Blob_B38(\nvec4 Vx_Color,\nvec3 Position1,\nvec3 Position2,\nbool Blob_Enable_1,\nbool Blob_Enable_2,\nfloat Near_Size_1,\nfloat Near_Size_2,\nfloat Blob_Inner_Fade_1,\nfloat Blob_Inner_Fade_2,\nfloat Blob_Pulse_1,\nfloat Blob_Pulse_2,\nfloat Blob_Fade_1,\nfloat Blob_Fade_2,\nout vec3 Position,\nout float Near_Size,\nout float Inner_Fade,\nout float Blob_Enable,\nout float Fade,\nout float Pulse)\n{\nPosition=Position1*(1.0-Vx_Color.g)+Vx_Color.g*Position2;\nfloat b1=float(Blob_Enable_1);\nfloat b2=float(Blob_Enable_2);\nBlob_Enable=b1+(b2-b1)*Vx_Color.g;\nPulse=Blob_Pulse_1*(1.0-Vx_Color.g)+Vx_Color.g*Blob_Pulse_2;\nFade=Blob_Fade_1*(1.0-Vx_Color.g)+Vx_Color.g*Blob_Fade_2;\nNear_Size=Near_Size_1*(1.0-Vx_Color.g)+Vx_Color.g*Near_Size_2;\nInner_Fade=Blob_Inner_Fade_1*(1.0-Vx_Color.g)+Vx_Color.g*Blob_Inner_Fade_2;\n}\n\n\nvoid Wireframe_Vertex_B51(\nvec3 Position,\nvec3 Normal,\nvec3 Tangent,\nvec3 Bitangent,\nfloat Edge_Width,\nvec2 Face_Size,\nout vec3 Wire_Vx_Pos,\nout vec2 UV,\nout vec2 Widths)\n{\nWidths.xy=Edge_Width/Face_Size;\nfloat x=dot(Position,Tangent);\nfloat y=dot(Position,Bitangent);\nfloat dx=0.5-abs(x);\nfloat newx=(0.5-dx*Widths.x*2.0)*sign(x);\nfloat dy=0.5-abs(y);\nfloat newy=(0.5-dy*Widths.y*2.0)*sign(y);\nWire_Vx_Pos=Normal*0.5+newx*Tangent+newy*Bitangent;\nUV.x=dot(Wire_Vx_Pos,Tangent)+0.5;\nUV.y=dot(Wire_Vx_Pos,Bitangent)+0.5;\n}\n\n\nvec2 ramp2(vec2 start,vec2 end,vec2 x)\n{\nreturn clamp((x-start)/(end-start),vec2(0.0,0.0),vec2(1.0,1.0));\n}\nfloat computeSelection(\nvec3 blobPosition,\nvec3 normal,\nvec3 tangent,\nvec3 bitangent,\nvec3 faceCenter,\nvec2 faceSize,\nfloat selectionFuzz,\nfloat farDistance,\nfloat fadeLength\n)\n{\nvec3 delta=blobPosition-faceCenter;\nfloat absD=abs(dot(delta,normal));\nfloat fadeIn=1.0-clamp((absD-farDistance)/fadeLength,0.0,1.0);\nvec2 blobCenterXY=vec2(dot(delta,tangent),dot(delta,bitangent));\nvec2 innerFace=faceSize*(1.0-selectionFuzz)*0.5;\nvec2 selectPulse=ramp2(-faceSize*0.5,-innerFace,blobCenterXY)-ramp2(innerFace,faceSize*0.5,blobCenterXY);\nreturn selectPulse.x*selectPulse.y*fadeIn;\n}\nvoid Selection_Vertex_B48(\nvec3 Blob_Position,\nvec3 Blob_Position_2,\nvec3 Face_Center,\nvec2 Face_Size,\nvec3 Normal,\nvec3 Tangent,\nvec3 Bitangent,\nfloat Selection_Fuzz,\nfloat Selected,\nfloat Far_Distance,\nfloat Fade_Length,\nvec3 Active_Face_Dir,\nout float Show_Selection)\n{\nfloat select1=computeSelection(Blob_Position,Normal,Tangent,Bitangent,Face_Center,Face_Size,Selection_Fuzz,Far_Distance,Fade_Length);\nfloat select2=computeSelection(Blob_Position_2,Normal,Tangent,Bitangent,Face_Center,Face_Size,Selection_Fuzz,Far_Distance,Fade_Length);\nfloat Active=max(0.0,dot(Active_Face_Dir,Normal));\nShow_Selection=mix(max(select1,select2),1.0,Selected)*Active;\n}\n\n\nvoid Proximity_Visibility_B54(\nfloat Selection,\nvec3 Proximity_Center,\nvec3 Proximity_Center_2,\nfloat Input_Width,\nfloat Proximity_Far_Distance,\nfloat Proximity_Radius,\nvec3 Active_Face_Center,\nvec3 Active_Face_Dir,\nout float Width)\n{\n\nvec3 boxEdges=(world*vec4(vec3(0.5,0.5,0.5),0.0)).xyz;\nfloat boxMaxSize=length(boxEdges);\nfloat d1=dot(Proximity_Center-Active_Face_Center,Active_Face_Dir);\nvec3 blob1=Proximity_Center-d1*Active_Face_Dir;\nfloat d2=dot(Proximity_Center_2-Active_Face_Center,Active_Face_Dir);\nvec3 blob2=Proximity_Center_2-d2*Active_Face_Dir;\n\nvec3 delta1=blob1-Active_Face_Center;\nvec3 delta2=blob2-Active_Face_Center;\nfloat dist1=dot(delta1,delta1);\nfloat dist2=dot(delta2,delta2);\nfloat nearestProxDist=sqrt(min(dist1,dist2));\n\nWidth=Input_Width*(1.0-step(boxMaxSize+Proximity_Radius,nearestProxDist))*(1.0-step(Proximity_Far_Distance,min(d1,d2))*(1.0-step(0.0001,Selection)));\n}\n\n\nvoid Object_To_World_Dir_B67(\nvec3 Dir_Object,\nout vec3 Dir_World)\n{\nDir_World=(world*vec4(Dir_Object,0.0)).xyz;\n}\n\nvoid main()\n{\n\nvec3 Active_Face_Center_Q49;\nActive_Face_Center_Q49=(world*vec4(_Active_Face_Dir_*0.5,1.0)).xyz;\n\nvec3 Blob_Position_Q41=mix(_Blob_Position_,Global_Left_Index_Tip_Position.xyz,float(Use_Global_Left_Index));\n\nvec3 Blob_Position_Q42=mix(_Blob_Position_2_,Global_Right_Index_Tip_Position.xyz,float(Use_Global_Right_Index));\n\nvec3 Active_Face_Dir_Q64=normalize((world*vec4(_Active_Face_Dir_,0.0)).xyz);\n\nfloat Relative_Scale_Q57;\n#if RELATIVE_WIDTH\nRelative_Scale_Q57=length((world*vec4(vec3(0,1,0),0.0)).xyz);\n#else\nRelative_Scale_Q57=1.0;\n#endif\n\nvec3 Tangent_World_Q30;\nTangent_World_Q30=(world*vec4(tangent,0.0)).xyz;\n\nvec3 Binormal_World_Q31;\nBinormal_World_Q31=(world*vec4((cross(normal,tangent)),0.0)).xyz;\n\nvec3 Normal_World_Q60;\nNormal_World_Q60=(world*vec4(normal,0.0)).xyz;\n\nvec3 Result_Q18=0.5*normal;\nvec3 Dir_World_Q67;\nObject_To_World_Dir_B67(_Active_Face_Up_,Dir_World_Q67);\n\nfloat Product_Q56=_Edge_Width_*Relative_Scale_Q57;\n\nvec3 Normal_World_N_Q29=normalize(Normal_World_Q60);\n\nvec3 Tangent_World_N_Q28=normalize(Tangent_World_Q30);\n\nvec3 Binormal_World_N_Q32=normalize(Binormal_World_Q31);\nvec3 Position_Q38;\nfloat Near_Size_Q38;\nfloat Inner_Fade_Q38;\nfloat Blob_Enable_Q38;\nfloat Fade_Q38;\nfloat Pulse_Q38;\nChoose_Blob_B38(color,Blob_Position_Q41,Blob_Position_Q42,_Blob_Enable_,_Blob_Enable_2_,_Blob_Near_Size_,_Blob_Near_Size_2_,_Blob_Inner_Fade_,_Blob_Inner_Fade_2_,_Blob_Pulse_,_Blob_Pulse_2_,_Blob_Fade_,_Blob_Fade_2_,Position_Q38,Near_Size_Q38,Inner_Fade_Q38,Blob_Enable_Q38,Fade_Q38,Pulse_Q38);\n\nvec3 Face_Center_Q33;\nFace_Center_Q33=(world*vec4(Result_Q18,1.0)).xyz;\n\nvec2 Face_Size_Q50=vec2(length(Tangent_World_Q30),length(Binormal_World_Q31));\nfloat Show_Selection_Q48;\nSelection_Vertex_B48(Blob_Position_Q41,Blob_Position_Q42,Face_Center_Q33,Face_Size_Q50,Normal_World_N_Q29,Tangent_World_N_Q28,Binormal_World_N_Q32,_Selection_Fuzz_,_Selected_,_Selected_Distance_,_Selected_Fade_Length_,Active_Face_Dir_Q64,Show_Selection_Q48);\n\nvec3 Normalized_Q72=normalize(Dir_World_Q67);\n\nfloat Active_Q34=max(0.0,dot(Active_Face_Dir_Q64,Normal_World_N_Q29));\nfloat Width_Q54;\nProximity_Visibility_B54(Show_Selection_Q48,Blob_Position_Q41,Blob_Position_Q42,Product_Q56,_Proximity_Far_Distance_,_Proximity_Near_Radius_,Active_Face_Center_Q49,Active_Face_Dir_Q64,Width_Q54);\nvec3 Wire_Vx_Pos_Q51;\nvec2 UV_Q51;\nvec2 Widths_Q51;\nWireframe_Vertex_B51(position,normal,tangent,(cross(normal,tangent)),Width_Q54,Face_Size_Q50,Wire_Vx_Pos_Q51,UV_Q51,Widths_Q51);\n\nvec3 Vec3_Q27=vec3(Widths_Q51.x,Widths_Q51.y,color.r);\nvec3 Pos_World_Q13;\nObject_To_World_Pos_B13(Wire_Vx_Pos_Q51,Pos_World_Q13);\n\nvec3 Incident_Q36=normalize(Pos_World_Q13-cameraPosition);\nvec3 Out_Position_Q47;\nvec2 Out_UV_Q47;\nvec3 Blob_Info_Q47;\nBlob_Vertex_B47(Pos_World_Q13,Normal_World_N_Q29,Tangent_World_N_Q28,Binormal_World_N_Q32,Position_Q38,_Blob_Intensity_,Near_Size_Q38,_Blob_Far_Size_,_Blob_Near_Distance_,_Blob_Far_Distance_,color,uv,Face_Center_Q33,Face_Size_Q50,UV_Q51,_Blob_Fade_Length_,_Selection_Fade_,_Selection_Fade_Size_,Inner_Fade_Q38,Active_Face_Center_Q49,Pulse_Q38,Fade_Q38,Blob_Enable_Q38,Out_Position_Q47,Out_UV_Q47,Blob_Info_Q47);\nvec4 Extra1_Q66;\nfloat Distance_To_Face_Q66;\nfloat Intensity_Q66;\nProximity_Vertex_B66(Blob_Position_Q41,Blob_Position_Q42,Active_Face_Center_Q49,Active_Face_Dir_Q64,Pos_World_Q13,_Proximity_Far_Distance_,Relative_Scale_Q57,_Proximity_Anisotropy_,Normalized_Q72,Extra1_Q66,Distance_To_Face_Q66,Intensity_Q66);\nvec4 Holo_Edges_Q44;\nHolo_Edge_Vertex_B44(Incident_Q36,Normal_World_N_Q29,uv,Tangent_World_Q30,Binormal_World_Q31,_Smooth_Active_Face_,Active_Q34,Holo_Edges_Q44);\n\nvec3 Vec3_Q19=vec3(Show_Selection_Q48,Distance_To_Face_Q66,Intensity_Q66);\nvec3 Position=Out_Position_Q47;\nvec2 UV=Out_UV_Q47;\nvec3 Tangent=Blob_Info_Q47;\nvec3 Binormal=Vec3_Q19;\nvec3 Normal=Vec3_Q27;\nvec4 Extra1=Extra1_Q66;\nvec4 Color=Holo_Edges_Q44;\ngl_Position=viewProjection*vec4(Position,1);\nvPosition=Position;\nvNormal=Normal;\nvUV=UV;\nvTangent=Tangent;\nvBinormal=Binormal;\nvColor=Color;\nvExtra1=Extra1;\n}";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./3D/materials/handle/handleMaterial.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"HandleMaterial",function(){return o});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=(n("./3D/materials/handle/shaders/handle.vertex.ts"),n("./3D/materials/handle/shaders/handle.fragment.ts"),function(e){function t(t,n){var r=e.call(this,t,n,"handle",{attributes:["position"],uniforms:["worldViewProjection","color","scale","positionOffset"],needAlphaBlending:!1,needAlphaTesting:!1})||this;return r._hover=!1,r._drag=!1,r._color=new i.Color3,r._scale=1,r._lastTick=-1,r.animationLength=100,r.hoverColor=new i.Color3(0,.467,.84),r.baseColor=new i.Color3(1,1,1),r.hoverScale=.75,r.baseScale=.35,r.dragScale=.55,r._positionOffset=i.Vector3.Zero(),r._updateInterpolationTarget(),r._lastTick=Date.now(),r._onBeforeRender=r.getScene().onBeforeRenderObservable.add(function(){var e=Date.now(),t=e-r._lastTick,n=r._targetScale-r._scale,o=i.TmpColors.Color3[0].copyFrom(r._targetColor).subtractToRef(r._color,i.TmpColors.Color3[0]);r._scale=r._scale+n*t/r.animationLength,o.scaleToRef(t/r.animationLength,o),r._color.addToRef(o,r._color),r.setColor3("color",r._color),r.setFloat("scale",r._scale),r.setVector3("positionOffset",r._positionOffset),r._lastTick=e}),r}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"hover",{get:function(){return this._hover},set:function(e){this._hover=e,this._updateInterpolationTarget()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"drag",{get:function(){return this._drag},set:function(e){this._drag=e,this._updateInterpolationTarget()},enumerable:!1,configurable:!0}),t.prototype._updateInterpolationTarget=function(){this.drag?(this._targetColor=this.hoverColor,this._targetScale=this.dragScale):this.hover?(this._targetColor=this.hoverColor,this._targetScale=this.hoverScale):(this._targetColor=this.baseColor,this._targetScale=this.baseScale)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.getScene().onBeforeRenderObservable.remove(this._onBeforeRender)},t}(i.ShaderMaterial))},"./3D/materials/handle/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./3D/materials/handle/handleMaterial.ts");n.d(t,"HandleMaterial",function(){return r.HandleMaterial})},"./3D/materials/handle/shaders/handle.fragment.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"handlePixelShader",function(){return a});var r=n("babylonjs/Misc/perfCounter"),i="handlePixelShader",o="uniform vec3 color;\nvoid main(void) {\ngl_FragColor=vec4(color,1.0);\n}";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./3D/materials/handle/shaders/handle.vertex.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"handleVertexShader",function(){return a});var r=n("babylonjs/Misc/perfCounter"),i="handleVertexShader",o="precision highp float;\n\nattribute vec3 position;\n\nuniform vec3 positionOffset;\nuniform mat4 worldViewProjection;\nuniform float scale;\nvoid main(void) {\nvec4 vPos=vec4((vec3(position)+positionOffset)*scale,1.0);\ngl_Position=worldViewProjection*vPos;\n}";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./3D/materials/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./3D/materials/fluent/index.ts");n.d(t,"FluentMaterialDefines",function(){return r.FluentMaterialDefines}),n.d(t,"FluentMaterial",function(){return r.FluentMaterial});var i=n("./3D/materials/fluentButton/index.ts");n.d(t,"FluentButtonMaterial",function(){return i.FluentButtonMaterial});var o=n("./3D/materials/fluentBackplate/index.ts");n.d(t,"FluentBackplateMaterial",function(){return o.FluentBackplateMaterial});var a=n("./3D/materials/handle/index.ts");n.d(t,"HandleMaterial",function(){return a.HandleMaterial});var s=n("./3D/materials/mrdl/index.ts");n.d(t,"MRDLSliderBarMaterial",function(){return s.MRDLSliderBarMaterial}),n.d(t,"MRDLSliderThumbMaterial",function(){return s.MRDLSliderThumbMaterial}),n.d(t,"MRDLBackplateMaterial",function(){return s.MRDLBackplateMaterial})},"./3D/materials/mrdl/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./3D/materials/mrdl/mrdlSliderBarMaterial.ts");n.d(t,"MRDLSliderBarMaterial",function(){return r.MRDLSliderBarMaterial});var i=n("./3D/materials/mrdl/mrdlSliderThumbMaterial.ts");n.d(t,"MRDLSliderThumbMaterial",function(){return i.MRDLSliderThumbMaterial});var o=n("./3D/materials/mrdl/mrdlBackplateMaterial.ts");n.d(t,"MRDLBackplateMaterial",function(){return o.MRDLBackplateMaterial})},"./3D/materials/mrdl/mrdlBackplateMaterial.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"MRDLBackplateMaterial",function(){return a});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=(n("./3D/materials/mrdl/shaders/mrdlBackplate.fragment.ts"),n("./3D/materials/mrdl/shaders/mrdlBackplate.vertex.ts"),function(e){function t(){var t=e.call(this)||this;return t.IRIDESCENCE_ENABLED=!0,t.SMOOTH_EDGES=!0,t._needNormals=!0,t.rebuild(),t}return Object(r.__extends)(t,e),t}(i.MaterialDefines)),a=function(e){function t(n,r){var o=e.call(this,n,r)||this;return o.radius=.3,o.lineWidth=.003,o.absoluteSizes=!1,o._filterWidth=1,o.baseColor=new i.Color4(0,0,0,1),o.lineColor=new i.Color4(.2,.262745,.4,1),o.radiusTopLeft=1,o.radiusTopRight=1,o.radiusBottomLeft=1,o.radiusBottomRight=1,o._rate=0,o.highlightColor=new i.Color4(.239216,.435294,.827451,1),o.highlightWidth=0,o._highlightTransform=new i.Vector4(1,1,0,0),o._highlight=1,o.iridescenceIntensity=.45,o.iridescenceEdgeIntensity=1,o.iridescenceTint=new i.Color4(1,1,1,1),o._angle=-45,o.fadeOut=1,o._reflected=!0,o._frequency=1,o._verticalOffset=0,o.gradientColor=new i.Color4(.74902,.74902,.74902,1),o.topLeftGradientColor=new i.Color4(.00784314,.294118,.580392,1),o.topRightGradientColor=new i.Color4(.305882,0,1,1),o.bottomLeftGradientColor=new i.Color4(.133333,.258824,.992157,1),o.bottomRightGradientColor=new i.Color4(.176471,.176471,.619608,1),o.edgeWidth=.5,o.edgePower=1,o.edgeLineGradientBlend=.5,o.alphaMode=i.Constants.ALPHA_DISABLE,o.backFaceCulling=!1,o._iridescentMapTexture=new i.Texture(t.IRIDESCENT_MAP_TEXTURE_URL,r,!0,!1,i.Texture.NEAREST_SAMPLINGMODE),o}return Object(r.__extends)(t,e),t.prototype.needAlphaBlending=function(){return!1},t.prototype.needAlphaTesting=function(){return!1},t.prototype.getAlphaTestTexture=function(){return null},t.prototype.isReadyForSubMesh=function(e,t,n){if(this.isFrozen&&t.effect&&t.effect._wasPreviouslyReady)return!0;t._materialDefines||(t.materialDefines=new o);var r=t._materialDefines,a=this.getScene();if(this._isReadyForSubMesh(t))return!0;var s=a.getEngine();if(i.MaterialHelper.PrepareDefinesForAttributes(e,r,!1,!1),r.isDirty){r.markAsProcessed(),a.resetCachedMaterial();var l=new i.EffectFallbacks;r.FOG&&l.addFallback(1,"FOG"),i.MaterialHelper.HandleFallbacksForShadows(r,l),r.IMAGEPROCESSINGPOSTPROCESS=a.imageProcessingConfiguration.applyByPostProcess;var c=[i.VertexBuffer.PositionKind];r.NORMAL&&c.push(i.VertexBuffer.NormalKind),r.UV1&&c.push(i.VertexBuffer.UVKind),r.UV2&&c.push(i.VertexBuffer.UV2Kind),r.VERTEXCOLOR&&c.push(i.VertexBuffer.ColorKind),r.TANGENT&&c.push(i.VertexBuffer.TangentKind),i.MaterialHelper.PrepareAttributesForInstances(c,r);var u=r.toString(),_=["world","viewProjection","cameraPosition","_Radius_","_Line_Width_","_Absolute_Sizes_","_Filter_Width_","_Base_Color_","_Line_Color_","_Radius_Top_Left_","_Radius_Top_Right_","_Radius_Bottom_Left_","_Radius_Bottom_Right_","_Rate_","_Highlight_Color_","_Highlight_Width_","_Highlight_Transform_","_Highlight_","_Iridescence_Intensity_","_Iridescence_Edge_Intensity_","_Iridescence_Tint_","_Iridescent_Map_","_Angle_","_Reflected_","_Frequency_","_Vertical_Offset_","_Gradient_Color_","_Top_Left_","_Top_Right_","_Bottom_Left_","_Bottom_Right_","_Edge_Width_","_Edge_Power_","_Line_Gradient_Blend_","_Fade_Out_"],h=[],f=new Array;i.MaterialHelper.PrepareUniformsAndSamplersList({uniformsNames:_,uniformBuffersNames:f,samplers:h,defines:r,maxSimultaneousLights:4}),t.setEffect(a.getEngine().createEffect("mrdlBackplate",{attributes:c,uniformsNames:_,uniformBuffersNames:f,samplers:h,defines:u,fallbacks:l,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousLights:4}},s),r)}return!(!t.effect||!t.effect.isReady())&&(r._renderId=a.getRenderId(),t.effect._wasPreviouslyReady=!0,!0)},t.prototype.bindForSubMesh=function(e,t,n){if(n._materialDefines){var r=n.effect;r&&(this._activeEffect=r,this.bindOnlyWorldMatrix(e),this._activeEffect.setMatrix("viewProjection",this.getScene().getTransformMatrix()),this._activeEffect.setVector3("cameraPosition",this.getScene().activeCamera.position),this._activeEffect.setFloat("_Radius_",this.radius),this._activeEffect.setFloat("_Line_Width_",this.lineWidth),this._activeEffect.setFloat("_Absolute_Sizes_",this.absoluteSizes?1:0),this._activeEffect.setFloat("_Filter_Width_",this._filterWidth),this._activeEffect.setDirectColor4("_Base_Color_",this.baseColor),this._activeEffect.setDirectColor4("_Line_Color_",this.lineColor),this._activeEffect.setFloat("_Radius_Top_Left_",this.radiusTopLeft),this._activeEffect.setFloat("_Radius_Top_Right_",this.radiusTopRight),this._activeEffect.setFloat("_Radius_Bottom_Left_",this.radiusBottomLeft),this._activeEffect.setFloat("_Radius_Bottom_Right_",this.radiusBottomRight),this._activeEffect.setFloat("_Rate_",this._rate),this._activeEffect.setDirectColor4("_Highlight_Color_",this.highlightColor),this._activeEffect.setFloat("_Highlight_Width_",this.highlightWidth),this._activeEffect.setVector4("_Highlight_Transform_",this._highlightTransform),this._activeEffect.setFloat("_Highlight_",this._highlight),this._activeEffect.setFloat("_Iridescence_Intensity_",this.iridescenceIntensity),this._activeEffect.setFloat("_Iridescence_Edge_Intensity_",this.iridescenceEdgeIntensity),this._activeEffect.setDirectColor4("_Iridescence_Tint_",this.iridescenceTint),this._activeEffect.setTexture("_Iridescent_Map_",this._iridescentMapTexture),this._activeEffect.setFloat("_Angle_",this._angle),this._activeEffect.setFloat("_Reflected_",this._reflected?1:0),this._activeEffect.setFloat("_Frequency_",this._frequency),this._activeEffect.setFloat("_Vertical_Offset_",this._verticalOffset),this._activeEffect.setDirectColor4("_Gradient_Color_",this.gradientColor),this._activeEffect.setDirectColor4("_Top_Left_",this.topLeftGradientColor),this._activeEffect.setDirectColor4("_Top_Right_",this.topRightGradientColor),this._activeEffect.setDirectColor4("_Bottom_Left_",this.bottomLeftGradientColor),this._activeEffect.setDirectColor4("_Bottom_Right_",this.bottomRightGradientColor),this._activeEffect.setFloat("_Edge_Width_",this.edgeWidth),this._activeEffect.setFloat("_Edge_Power_",this.edgePower),this._activeEffect.setFloat("_Line_Gradient_Blend_",this.edgeLineGradientBlend),this._activeEffect.setFloat("_Fade_Out_",this.fadeOut),this._afterBind(t,this._activeEffect))}},t.prototype.getAnimatables=function(){return[]},t.prototype.dispose=function(t){e.prototype.dispose.call(this,t)},t.prototype.clone=function(e){var n=this;return i.SerializationHelper.Clone(function(){return new t(e,n.getScene())},this)},t.prototype.serialize=function(){var e=i.SerializationHelper.Serialize(this);return e.customType="BABYLON.MRDLBackplateMaterial",e},t.prototype.getClassName=function(){return"MRDLBackplateMaterial"},t.Parse=function(e,n,r){return i.SerializationHelper.Parse(function(){return new t(e.name,n)},e,n,r)},t.IRIDESCENT_MAP_TEXTURE_URL="https://assets.babylonjs.com/meshes/MRTK/MRDL/mrtk-mrdl-backplate-iridescence.png",Object(r.__decorate)([Object(i.serialize)()],t.prototype,"radius",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"lineWidth",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"absoluteSizes",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"baseColor",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"lineColor",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"radiusTopLeft",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"radiusTopRight",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"radiusBottomLeft",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"radiusBottomRight",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"highlightColor",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"highlightWidth",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"iridescenceIntensity",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"iridescenceEdgeIntensity",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"iridescenceTint",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"fadeOut",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"gradientColor",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"topLeftGradientColor",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"topRightGradientColor",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"bottomLeftGradientColor",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"bottomRightGradientColor",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"edgeWidth",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"edgePower",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"edgeLineGradientBlend",void 0),t}(i.PushMaterial);Object(i.RegisterClass)("BABYLON.GUI.MRDLBackplateMaterial",a)},"./3D/materials/mrdl/mrdlSliderBarMaterial.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"MRDLSliderBarMaterial",function(){return a});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=(n("./3D/materials/mrdl/shaders/mrdlSliderBar.fragment.ts"),n("./3D/materials/mrdl/shaders/mrdlSliderBar.vertex.ts"),function(e){function t(){var t=e.call(this)||this;return t.SKY_ENABLED=!0,t.BLOB_ENABLE_2=!0,t.IRIDESCENCE_ENABLED=!0,t._needNormals=!0,t._needUVs=!0,t.rebuild(),t}return Object(r.__extends)(t,e),t}(i.MaterialDefines)),a=function(e){function t(n,r){var o=e.call(this,n,r)||this;return o.radius=.6,o.bevelFront=.6,o.bevelFrontStretch=.077,o.bevelBack=0,o.bevelBackStretch=0,o.radiusTopLeft=1,o.radiusTopRight=1,o.radiusBottomLeft=1,o.radiusBottomRight=1,o.bulgeEnabled=!1,o.bulgeHeight=-.323,o.bulgeRadius=.73,o.sunIntensity=1.102,o.sunTheta=.76,o.sunPhi=.526,o.indirectDiffuse=.658,o.albedo=new i.Color4(.0117647,.505882,.996078,1),o.specular=0,o.shininess=10,o.sharpness=0,o.subsurface=0,o.leftGradientColor=new i.Color4(.0117647,.505882,.996078,1),o.rightGradientColor=new i.Color4(.0117647,.505882,.996078,1),o.reflection=.749,o.frontReflect=0,o.edgeReflect=.09,o.power=8.13,o.skyColor=new i.Color4(.0117647,.964706,.996078,1),o.horizonColor=new i.Color4(.0117647,.333333,.996078,1),o.groundColor=new i.Color4(0,.254902,.996078,1),o.horizonPower=1,o.width=.02,o.fuzz=.5,o.minFuzz=.001,o.clipFade=.01,o.hueShift=0,o.saturationShift=0,o.valueShift=0,o.blobPosition=new i.Vector3(0,0,.1),o.blobIntensity=.5,o.blobNearSize=.01,o.blobFarSize=.03,o.blobNearDistance=0,o.blobFarDistance=.08,o.blobFadeLength=.576,o.blobPulse=0,o.blobFade=1,o.blobPosition2=new i.Vector3(.2,0,.1),o.blobNearSize2=.01,o.blobPulse2=0,o.blobFade2=1,o.blobTexture=new i.Texture("",o.getScene()),o.leftIndexPosition=new i.Vector3(0,0,1),o.rightIndexPosition=new i.Vector3(-1,-1,-1),o.leftIndexMiddlePosition=new i.Vector3(0,0,0),o.rightIndexMiddlePosition=new i.Vector3(0,0,0),o.decalScaleXY=new i.Vector2(1.5,1.5),o.decalFrontOnly=!0,o.rimIntensity=.287,o.rimHueShift=0,o.rimSaturationShift=0,o.rimValueShift=-1,o.iridescenceIntensity=0,o.useGlobalLeftIndex=1,o.useGlobalRightIndex=1,o.globalLeftIndexTipProximity=0,o.globalRightIndexTipProximity=0,o.globalLeftIndexTipPosition=new i.Vector4(.5,0,-.55,1),o.globaRightIndexTipPosition=new i.Vector4(0,0,0,1),o.globalLeftThumbTipPosition=new i.Vector4(.5,0,-.55,1),o.globalRightThumbTipPosition=new i.Vector4(0,0,0,1),o.globalLeftIndexMiddlePosition=new i.Vector4(.5,0,-.55,1),o.globalRightIndexMiddlePosition=new i.Vector4(0,0,0,1),o.alphaMode=i.Constants.ALPHA_DISABLE,o.backFaceCulling=!1,o._blueGradientTexture=new i.Texture(t.BLUE_GRADIENT_TEXTURE_URL,r,!0,!1,i.Texture.NEAREST_SAMPLINGMODE),o}return Object(r.__extends)(t,e),t.prototype.needAlphaBlending=function(){return!1},t.prototype.needAlphaTesting=function(){return!1},t.prototype.getAlphaTestTexture=function(){return null},t.prototype.isReadyForSubMesh=function(e,t,n){if(this.isFrozen&&t.effect&&t.effect._wasPreviouslyReady)return!0;t._materialDefines||(t.materialDefines=new o);var r=t._materialDefines,a=this.getScene();if(this._isReadyForSubMesh(t))return!0;var s=a.getEngine();if(i.MaterialHelper.PrepareDefinesForAttributes(e,r,!1,!1),r.isDirty){r.markAsProcessed(),a.resetCachedMaterial();var l=new i.EffectFallbacks;r.FOG&&l.addFallback(1,"FOG"),i.MaterialHelper.HandleFallbacksForShadows(r,l),r.IMAGEPROCESSINGPOSTPROCESS=a.imageProcessingConfiguration.applyByPostProcess;var c=[i.VertexBuffer.PositionKind];r.NORMAL&&c.push(i.VertexBuffer.NormalKind),r.UV1&&c.push(i.VertexBuffer.UVKind),r.UV2&&c.push(i.VertexBuffer.UV2Kind),r.VERTEXCOLOR&&c.push(i.VertexBuffer.ColorKind),r.TANGENT&&c.push(i.VertexBuffer.TangentKind),i.MaterialHelper.PrepareAttributesForInstances(c,r);var u=r.toString(),_=["world","viewProjection","cameraPosition","_Radius_","_Bevel_Front_","_Bevel_Front_Stretch_","_Bevel_Back_","_Bevel_Back_Stretch_","_Radius_Top_Left_","_Radius_Top_Right_","_Radius_Bottom_Left_","_Radius_Bottom_Right_","_Bulge_Enabled_","_Bulge_Height_","_Bulge_Radius_","_Sun_Intensity_","_Sun_Theta_","_Sun_Phi_","_Indirect_Diffuse_","_Albedo_","_Specular_","_Shininess_","_Sharpness_","_Subsurface_","_Left_Color_","_Right_Color_","_Reflection_","_Front_Reflect_","_Edge_Reflect_","_Power_","_Sky_Color_","_Horizon_Color_","_Ground_Color_","_Horizon_Power_","_Reflection_Map_","_Indirect_Environment_","_Width_","_Fuzz_","_Min_Fuzz_","_Clip_Fade_","_Hue_Shift_","_Saturation_Shift_","_Value_Shift_","_Blob_Position_","_Blob_Intensity_","_Blob_Near_Size_","_Blob_Far_Size_","_Blob_Near_Distance_","_Blob_Far_Distance_","_Blob_Fade_Length_","_Blob_Pulse_","_Blob_Fade_","_Blob_Texture_","_Blob_Position_2_","_Blob_Near_Size_2_","_Blob_Pulse_2_","_Blob_Fade_2_","_Left_Index_Pos_","_Right_Index_Pos_","_Left_Index_Middle_Pos_","_Right_Index_Middle_Pos_","_Decal_","_Decal_Scale_XY_","_Decal_Front_Only_","_Rim_Intensity_","_Rim_Texture_","_Rim_Hue_Shift_","_Rim_Saturation_Shift_","_Rim_Value_Shift_","_Iridescence_Intensity_","_Iridescence_Texture_","Use_Global_Left_Index","Use_Global_Right_Index","Global_Left_Index_Tip_Position","Global_Right_Index_Tip_Position","Global_Left_Thumb_Tip_Position","Global_Right_Thumb_Tip_Position","Global_Left_Index_Middle_Position;","Global_Right_Index_Middle_Position","Global_Left_Index_Tip_Proximity","Global_Right_Index_Tip_Proximity"],h=["_Rim_Texture_","_Iridescence_Texture_"],f=new Array;i.MaterialHelper.PrepareUniformsAndSamplersList({uniformsNames:_,uniformBuffersNames:f,samplers:h,defines:r,maxSimultaneousLights:4}),t.setEffect(a.getEngine().createEffect("mrdlSliderBar",{attributes:c,uniformsNames:_,uniformBuffersNames:f,samplers:h,defines:u,fallbacks:l,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousLights:4}},s),r,this._materialContext)}return!(!t.effect||!t.effect.isReady())&&(r._renderId=a.getRenderId(),t.effect._wasPreviouslyReady=!0,!0)},t.prototype.bindForSubMesh=function(e,t,n){if(n._materialDefines){var r=n.effect;r&&(this._activeEffect=r,this.bindOnlyWorldMatrix(e),this._activeEffect.setMatrix("viewProjection",this.getScene().getTransformMatrix()),this._activeEffect.setVector3("cameraPosition",this.getScene().activeCamera.position),this._activeEffect.setFloat("_Radius_",this.radius),this._activeEffect.setFloat("_Bevel_Front_",this.bevelFront),this._activeEffect.setFloat("_Bevel_Front_Stretch_",this.bevelFrontStretch),this._activeEffect.setFloat("_Bevel_Back_",this.bevelBack),this._activeEffect.setFloat("_Bevel_Back_Stretch_",this.bevelBackStretch),this._activeEffect.setFloat("_Radius_Top_Left_",this.radiusTopLeft),this._activeEffect.setFloat("_Radius_Top_Right_",this.radiusTopRight),this._activeEffect.setFloat("_Radius_Bottom_Left_",this.radiusBottomLeft),this._activeEffect.setFloat("_Radius_Bottom_Right_",this.radiusBottomRight),this._activeEffect.setFloat("_Bulge_Enabled_",this.bulgeEnabled?1:0),this._activeEffect.setFloat("_Bulge_Height_",this.bulgeHeight),this._activeEffect.setFloat("_Bulge_Radius_",this.bulgeRadius),this._activeEffect.setFloat("_Sun_Intensity_",this.sunIntensity),this._activeEffect.setFloat("_Sun_Theta_",this.sunTheta),this._activeEffect.setFloat("_Sun_Phi_",this.sunPhi),this._activeEffect.setFloat("_Indirect_Diffuse_",this.indirectDiffuse),this._activeEffect.setDirectColor4("_Albedo_",this.albedo),this._activeEffect.setFloat("_Specular_",this.specular),this._activeEffect.setFloat("_Shininess_",this.shininess),this._activeEffect.setFloat("_Sharpness_",this.sharpness),this._activeEffect.setFloat("_Subsurface_",this.subsurface),this._activeEffect.setDirectColor4("_Left_Color_",this.leftGradientColor),this._activeEffect.setDirectColor4("_Right_Color_",this.rightGradientColor),this._activeEffect.setFloat("_Reflection_",this.reflection),this._activeEffect.setFloat("_Front_Reflect_",this.frontReflect),this._activeEffect.setFloat("_Edge_Reflect_",this.edgeReflect),this._activeEffect.setFloat("_Power_",this.power),this._activeEffect.setDirectColor4("_Sky_Color_",this.skyColor),this._activeEffect.setDirectColor4("_Horizon_Color_",this.horizonColor),this._activeEffect.setDirectColor4("_Ground_Color_",this.groundColor),this._activeEffect.setFloat("_Horizon_Power_",this.horizonPower),this._activeEffect.setTexture("_Reflection_Map_",new i.Texture("",this.getScene())),this._activeEffect.setTexture("_Indirect_Environment_",new i.Texture("",this.getScene())),this._activeEffect.setFloat("_Width_",this.width),this._activeEffect.setFloat("_Fuzz_",this.fuzz),this._activeEffect.setFloat("_Min_Fuzz_",this.minFuzz),this._activeEffect.setFloat("_Clip_Fade_",this.clipFade),this._activeEffect.setFloat("_Hue_Shift_",this.hueShift),this._activeEffect.setFloat("_Saturation_Shift_",this.saturationShift),this._activeEffect.setFloat("_Value_Shift_",this.valueShift),this._activeEffect.setVector3("_Blob_Position_",this.blobPosition),this._activeEffect.setFloat("_Blob_Intensity_",this.blobIntensity),this._activeEffect.setFloat("_Blob_Near_Size_",this.blobNearSize),this._activeEffect.setFloat("_Blob_Far_Size_",this.blobFarSize),this._activeEffect.setFloat("_Blob_Near_Distance_",this.blobNearDistance),this._activeEffect.setFloat("_Blob_Far_Distance_",this.blobFarDistance),this._activeEffect.setFloat("_Blob_Fade_Length_",this.blobFadeLength),this._activeEffect.setFloat("_Blob_Pulse_",this.blobPulse),this._activeEffect.setFloat("_Blob_Fade_",this.blobFade),this._activeEffect.setTexture("_Blob_Texture_",this.blobTexture),this._activeEffect.setVector3("_Blob_Position_2_",this.blobPosition2),this._activeEffect.setFloat("_Blob_Near_Size_2_",this.blobNearSize2),this._activeEffect.setFloat("_Blob_Pulse_2_",this.blobPulse2),this._activeEffect.setFloat("_Blob_Fade_2_",this.blobFade2),this._activeEffect.setVector3("_Left_Index_Pos_",this.leftIndexPosition),this._activeEffect.setVector3("_Right_Index_Pos_",this.rightIndexPosition),this._activeEffect.setVector3("_Left_Index_Middle_Pos_",this.leftIndexMiddlePosition),this._activeEffect.setVector3("_Right_Index_Middle_Pos_",this.rightIndexMiddlePosition),this._activeEffect.setTexture("_Decal_",new i.Texture("",this.getScene())),this._activeEffect.setVector2("_Decal_Scale_XY_",this.decalScaleXY),this._activeEffect.setFloat("_Decal_Front_Only_",this.decalFrontOnly?1:0),this._activeEffect.setFloat("_Rim_Intensity_",this.rimIntensity),this._activeEffect.setTexture("_Rim_Texture_",this._blueGradientTexture),this._activeEffect.setFloat("_Rim_Hue_Shift_",this.rimHueShift),this._activeEffect.setFloat("_Rim_Saturation_Shift_",this.rimSaturationShift),this._activeEffect.setFloat("_Rim_Value_Shift_",this.rimValueShift),this._activeEffect.setFloat("_Iridescence_Intensity_",this.iridescenceIntensity),this._activeEffect.setTexture("_Iridescence_Texture_",this._blueGradientTexture),this._activeEffect.setFloat("Use_Global_Left_Index",this.useGlobalLeftIndex),this._activeEffect.setFloat("Use_Global_Right_Index",this.useGlobalRightIndex),this._activeEffect.setVector4("Global_Left_Index_Tip_Position",this.globalLeftIndexTipPosition),this._activeEffect.setVector4("Global_Right_Index_Tip_Position",this.globaRightIndexTipPosition),this._activeEffect.setVector4("Global_Left_Thumb_Tip_Position",this.globalLeftThumbTipPosition),this._activeEffect.setVector4("Global_Right_Thumb_Tip_Position",this.globalRightThumbTipPosition),this._activeEffect.setVector4("Global_Left_Index_Middle_Position",this.globalLeftIndexMiddlePosition),this._activeEffect.setVector4("Global_Right_Index_Middle_Position",this.globalRightIndexMiddlePosition),this._activeEffect.setFloat("Global_Left_Index_Tip_Proximity",this.globalLeftIndexTipProximity),this._activeEffect.setFloat("Global_Right_Index_Tip_Proximity",this.globalRightIndexTipProximity),this._afterBind(t,this._activeEffect))}},t.prototype.getAnimatables=function(){return[]},t.prototype.dispose=function(t){e.prototype.dispose.call(this,t)},t.prototype.clone=function(e){var n=this;return i.SerializationHelper.Clone(function(){return new t(e,n.getScene())},this)},t.prototype.serialize=function(){var e=i.SerializationHelper.Serialize(this);return e.customType="BABYLON.MRDLSliderBarMaterial",e},t.prototype.getClassName=function(){return"MRDLSliderBarMaterial"},t.Parse=function(e,n,r){return i.SerializationHelper.Parse(function(){return new t(e.name,n)},e,n,r)},t.BLUE_GRADIENT_TEXTURE_URL="https://assets.babylonjs.com/meshes/MRTK/MRDL/mrtk-mrdl-blue-gradient.png",Object(r.__decorate)([Object(i.serialize)()],t.prototype,"radius",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"bevelFront",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"bevelFrontStretch",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"bevelBack",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"bevelBackStretch",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"radiusTopLeft",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"radiusTopRight",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"radiusBottomLeft",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"radiusBottomRight",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"bulgeEnabled",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"bulgeHeight",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"bulgeRadius",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"sunIntensity",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"sunTheta",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"sunPhi",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"indirectDiffuse",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"albedo",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"specular",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"shininess",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"sharpness",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"subsurface",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"leftGradientColor",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"rightGradientColor",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"reflection",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"frontReflect",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"edgeReflect",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"power",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"skyColor",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"horizonColor",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"groundColor",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"horizonPower",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"width",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"fuzz",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"minFuzz",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"clipFade",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"hueShift",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"saturationShift",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"valueShift",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobPosition",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobIntensity",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobNearSize",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobFarSize",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobNearDistance",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobFarDistance",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobFadeLength",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobPulse",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobFade",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobPosition2",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobNearSize2",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobPulse2",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobFade2",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobTexture",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"leftIndexPosition",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"rightIndexPosition",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"leftIndexMiddlePosition",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"rightIndexMiddlePosition",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"decalScaleXY",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"decalFrontOnly",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"rimIntensity",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"rimHueShift",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"rimSaturationShift",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"rimValueShift",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"iridescenceIntensity",void 0),t}(i.PushMaterial);Object(i.RegisterClass)("BABYLON.GUI.MRDLSliderBarMaterial",a)},"./3D/materials/mrdl/mrdlSliderThumbMaterial.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"MRDLSliderThumbMaterial",function(){return a});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=(n("./3D/materials/mrdl/shaders/mrdlSliderThumb.fragment.ts"),n("./3D/materials/mrdl/shaders/mrdlSliderThumb.vertex.ts"),function(e){function t(){var t=e.call(this)||this;return t.SKY_ENABLED=!0,t.BLOB_ENABLE_2=!0,t.IRIDESCENCE_ENABLED=!0,t._needNormals=!0,t._needUVs=!0,t.rebuild(),t}return Object(r.__extends)(t,e),t}(i.MaterialDefines)),a=function(e){function t(n,r){var o=e.call(this,n,r)||this;return o.radius=.157,o.bevelFront=.065,o.bevelFrontStretch=.077,o.bevelBack=.031,o.bevelBackStretch=0,o.radiusTopLeft=1,o.radiusTopRight=1,o.radiusBottomLeft=1,o.radiusBottomRight=1,o.bulgeEnabled=!1,o.bulgeHeight=-.323,o.bulgeRadius=.73,o.sunIntensity=2,o.sunTheta=.937,o.sunPhi=.555,o.indirectDiffuse=1,o.albedo=new i.Color4(.0117647,.505882,.996078,1),o.specular=0,o.shininess=10,o.sharpness=0,o.subsurface=.31,o.leftGradientColor=new i.Color4(.0117647,.505882,.996078,1),o.rightGradientColor=new i.Color4(.0117647,.505882,.996078,1),o.reflection=.749,o.frontReflect=0,o.edgeReflect=.09,o.power=8.1,o.skyColor=new i.Color4(.0117647,.960784,.996078,1),o.horizonColor=new i.Color4(.0117647,.333333,.996078,1),o.groundColor=new i.Color4(0,.254902,.996078,1),o.horizonPower=1,o.width=.02,o.fuzz=.5,o.minFuzz=.001,o.clipFade=.01,o.hueShift=0,o.saturationShift=0,o.valueShift=0,o.blobPosition=new i.Vector3(0,0,.1),o.blobIntensity=.5,o.blobNearSize=.01,o.blobFarSize=.03,o.blobNearDistance=0,o.blobFarDistance=.08,o.blobFadeLength=.576,o.blobPulse=0,o.blobFade=1,o.blobPosition2=new i.Vector3(.2,0,.1),o.blobNearSize2=.01,o.blobPulse2=0,o.blobFade2=1,o.blobTexture=new i.Texture("",o.getScene()),o.leftIndexPosition=new i.Vector3(0,0,1),o.rightIndexPosition=new i.Vector3(-1,-1,-1),o.leftIndexMiddlePosition=new i.Vector3(0,0,0),o.rightIndexMiddlePosition=new i.Vector3(0,0,0),o.decalScaleXY=new i.Vector2(1.5,1.5),o.decalFrontOnly=!0,o.rimIntensity=.287,o.rimHueShift=0,o.rimSaturationShift=0,o.rimValueShift=-1,o.iridescenceIntensity=0,o.useGlobalLeftIndex=1,o.useGlobalRightIndex=1,o.globalLeftIndexTipProximity=0,o.globalRightIndexTipProximity=0,o.globalLeftIndexTipPosition=new i.Vector4(.5,0,-.55,1),o.globaRightIndexTipPosition=new i.Vector4(0,0,0,1),o.globalLeftThumbTipPosition=new i.Vector4(.5,0,-.55,1),o.globalRightThumbTipPosition=new i.Vector4(0,0,0,1),o.globalLeftIndexMiddlePosition=new i.Vector4(.5,0,-.55,1),o.globalRightIndexMiddlePosition=new i.Vector4(0,0,0,1),o.alphaMode=i.Constants.ALPHA_DISABLE,o.backFaceCulling=!1,o._blueGradientTexture=new i.Texture(t.BLUE_GRADIENT_TEXTURE_URL,r,!0,!1,i.Texture.NEAREST_SAMPLINGMODE),o}return Object(r.__extends)(t,e),t.prototype.needAlphaBlending=function(){return!1},t.prototype.needAlphaTesting=function(){return!1},t.prototype.getAlphaTestTexture=function(){return null},t.prototype.isReadyForSubMesh=function(e,t,n){if(this.isFrozen&&t.effect&&t.effect._wasPreviouslyReady)return!0;t._materialDefines||(t.materialDefines=new o);var r=t._materialDefines,a=this.getScene();if(this._isReadyForSubMesh(t))return!0;var s=a.getEngine();if(i.MaterialHelper.PrepareDefinesForAttributes(e,r,!1,!1),r.isDirty){r.markAsProcessed(),a.resetCachedMaterial();var l=new i.EffectFallbacks;r.FOG&&l.addFallback(1,"FOG"),i.MaterialHelper.HandleFallbacksForShadows(r,l),r.IMAGEPROCESSINGPOSTPROCESS=a.imageProcessingConfiguration.applyByPostProcess;var c=[i.VertexBuffer.PositionKind];r.NORMAL&&c.push(i.VertexBuffer.NormalKind),r.UV1&&c.push(i.VertexBuffer.UVKind),r.UV2&&c.push(i.VertexBuffer.UV2Kind),r.VERTEXCOLOR&&c.push(i.VertexBuffer.ColorKind),r.TANGENT&&c.push(i.VertexBuffer.TangentKind),i.MaterialHelper.PrepareAttributesForInstances(c,r);var u=r.toString(),_=["world","viewProjection","cameraPosition","_Radius_","_Bevel_Front_","_Bevel_Front_Stretch_","_Bevel_Back_","_Bevel_Back_Stretch_","_Radius_Top_Left_","_Radius_Top_Right_","_Radius_Bottom_Left_","_Radius_Bottom_Right_","_Bulge_Enabled_","_Bulge_Height_","_Bulge_Radius_","_Sun_Intensity_","_Sun_Theta_","_Sun_Phi_","_Indirect_Diffuse_","_Albedo_","_Specular_","_Shininess_","_Sharpness_","_Subsurface_","_Left_Color_","_Right_Color_","_Reflection_","_Front_Reflect_","_Edge_Reflect_","_Power_","_Sky_Color_","_Horizon_Color_","_Ground_Color_","_Horizon_Power_","_Reflection_Map_","_Indirect_Environment_","_Width_","_Fuzz_","_Min_Fuzz_","_Clip_Fade_","_Hue_Shift_","_Saturation_Shift_","_Value_Shift_","_Blob_Position_","_Blob_Intensity_","_Blob_Near_Size_","_Blob_Far_Size_","_Blob_Near_Distance_","_Blob_Far_Distance_","_Blob_Fade_Length_","_Blob_Pulse_","_Blob_Fade_","_Blob_Texture_","_Blob_Position_2_","_Blob_Near_Size_2_","_Blob_Pulse_2_","_Blob_Fade_2_","_Left_Index_Pos_","_Right_Index_Pos_","_Left_Index_Middle_Pos_","_Right_Index_Middle_Pos_","_Decal_","_Decal_Scale_XY_","_Decal_Front_Only_","_Rim_Intensity_","_Rim_Texture_","_Rim_Hue_Shift_","_Rim_Saturation_Shift_","_Rim_Value_Shift_","_Iridescence_Intensity_","_Iridescence_Texture_","Use_Global_Left_Index","Use_Global_Right_Index","Global_Left_Index_Tip_Position","Global_Right_Index_Tip_Position","Global_Left_Thumb_Tip_Position","Global_Right_Thumb_Tip_Position","Global_Left_Index_Middle_Position;","Global_Right_Index_Middle_Position","Global_Left_Index_Tip_Proximity","Global_Right_Index_Tip_Proximity"],h=["_Rim_Texture_","_Iridescence_Texture_"],f=new Array;i.MaterialHelper.PrepareUniformsAndSamplersList({uniformsNames:_,uniformBuffersNames:f,samplers:h,defines:r,maxSimultaneousLights:4}),t.setEffect(a.getEngine().createEffect("mrdlSliderThumb",{attributes:c,uniformsNames:_,uniformBuffersNames:f,samplers:h,defines:u,fallbacks:l,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousLights:4}},s),r)}return!(!t.effect||!t.effect.isReady())&&(r._renderId=a.getRenderId(),t.effect._wasPreviouslyReady=!0,!0)},t.prototype.bindForSubMesh=function(e,t,n){if(n._materialDefines){var r=n.effect;r&&(this._activeEffect=r,this.bindOnlyWorldMatrix(e),this._activeEffect.setMatrix("viewProjection",this.getScene().getTransformMatrix()),this._activeEffect.setVector3("cameraPosition",this.getScene().activeCamera.position),this._activeEffect.setFloat("_Radius_",this.radius),this._activeEffect.setFloat("_Bevel_Front_",this.bevelFront),this._activeEffect.setFloat("_Bevel_Front_Stretch_",this.bevelFrontStretch),this._activeEffect.setFloat("_Bevel_Back_",this.bevelBack),this._activeEffect.setFloat("_Bevel_Back_Stretch_",this.bevelBackStretch),this._activeEffect.setFloat("_Radius_Top_Left_",this.radiusTopLeft),this._activeEffect.setFloat("_Radius_Top_Right_",this.radiusTopRight),this._activeEffect.setFloat("_Radius_Bottom_Left_",this.radiusBottomLeft),this._activeEffect.setFloat("_Radius_Bottom_Right_",this.radiusBottomRight),this._activeEffect.setFloat("_Bulge_Enabled_",this.bulgeEnabled?1:0),this._activeEffect.setFloat("_Bulge_Height_",this.bulgeHeight),this._activeEffect.setFloat("_Bulge_Radius_",this.bulgeRadius),this._activeEffect.setFloat("_Sun_Intensity_",this.sunIntensity),this._activeEffect.setFloat("_Sun_Theta_",this.sunTheta),this._activeEffect.setFloat("_Sun_Phi_",this.sunPhi),this._activeEffect.setFloat("_Indirect_Diffuse_",this.indirectDiffuse),this._activeEffect.setDirectColor4("_Albedo_",this.albedo),this._activeEffect.setFloat("_Specular_",this.specular),this._activeEffect.setFloat("_Shininess_",this.shininess),this._activeEffect.setFloat("_Sharpness_",this.sharpness),this._activeEffect.setFloat("_Subsurface_",this.subsurface),this._activeEffect.setDirectColor4("_Left_Color_",this.leftGradientColor),this._activeEffect.setDirectColor4("_Right_Color_",this.rightGradientColor),this._activeEffect.setFloat("_Reflection_",this.reflection),this._activeEffect.setFloat("_Front_Reflect_",this.frontReflect),this._activeEffect.setFloat("_Edge_Reflect_",this.edgeReflect),this._activeEffect.setFloat("_Power_",this.power),this._activeEffect.setDirectColor4("_Sky_Color_",this.skyColor),this._activeEffect.setDirectColor4("_Horizon_Color_",this.horizonColor),this._activeEffect.setDirectColor4("_Ground_Color_",this.groundColor),this._activeEffect.setFloat("_Horizon_Power_",this.horizonPower),this._activeEffect.setTexture("_Reflection_Map_",new i.Texture("",this.getScene())),this._activeEffect.setTexture("_Indirect_Environment_",new i.Texture("",this.getScene())),this._activeEffect.setFloat("_Width_",this.width),this._activeEffect.setFloat("_Fuzz_",this.fuzz),this._activeEffect.setFloat("_Min_Fuzz_",this.minFuzz),this._activeEffect.setFloat("_Clip_Fade_",this.clipFade),this._activeEffect.setFloat("_Hue_Shift_",this.hueShift),this._activeEffect.setFloat("_Saturation_Shift_",this.saturationShift),this._activeEffect.setFloat("_Value_Shift_",this.valueShift),this._activeEffect.setVector3("_Blob_Position_",this.blobPosition),this._activeEffect.setFloat("_Blob_Intensity_",this.blobIntensity),this._activeEffect.setFloat("_Blob_Near_Size_",this.blobNearSize),this._activeEffect.setFloat("_Blob_Far_Size_",this.blobFarSize),this._activeEffect.setFloat("_Blob_Near_Distance_",this.blobNearDistance),this._activeEffect.setFloat("_Blob_Far_Distance_",this.blobFarDistance),this._activeEffect.setFloat("_Blob_Fade_Length_",this.blobFadeLength),this._activeEffect.setFloat("_Blob_Pulse_",this.blobPulse),this._activeEffect.setFloat("_Blob_Fade_",this.blobFade),this._activeEffect.setTexture("_Blob_Texture_",this.blobTexture),this._activeEffect.setVector3("_Blob_Position_2_",this.blobPosition2),this._activeEffect.setFloat("_Blob_Near_Size_2_",this.blobNearSize2),this._activeEffect.setFloat("_Blob_Pulse_2_",this.blobPulse2),this._activeEffect.setFloat("_Blob_Fade_2_",this.blobFade2),this._activeEffect.setVector3("_Left_Index_Pos_",this.leftIndexPosition),this._activeEffect.setVector3("_Right_Index_Pos_",this.rightIndexPosition),this._activeEffect.setVector3("_Left_Index_Middle_Pos_",this.leftIndexMiddlePosition),this._activeEffect.setVector3("_Right_Index_Middle_Pos_",this.rightIndexMiddlePosition),this._activeEffect.setTexture("_Decal_",new i.Texture("",this.getScene())),this._activeEffect.setVector2("_Decal_Scale_XY_",this.decalScaleXY),this._activeEffect.setFloat("_Decal_Front_Only_",this.decalFrontOnly?1:0),this._activeEffect.setFloat("_Rim_Intensity_",this.rimIntensity),this._activeEffect.setTexture("_Rim_Texture_",this._blueGradientTexture),this._activeEffect.setFloat("_Rim_Hue_Shift_",this.rimHueShift),this._activeEffect.setFloat("_Rim_Saturation_Shift_",this.rimSaturationShift),this._activeEffect.setFloat("_Rim_Value_Shift_",this.rimValueShift),this._activeEffect.setFloat("_Iridescence_Intensity_",this.iridescenceIntensity),this._activeEffect.setTexture("_Iridescence_Texture_",this._blueGradientTexture),this._activeEffect.setFloat("Use_Global_Left_Index",this.useGlobalLeftIndex),this._activeEffect.setFloat("Use_Global_Right_Index",this.useGlobalRightIndex),this._activeEffect.setVector4("Global_Left_Index_Tip_Position",this.globalLeftIndexTipPosition),this._activeEffect.setVector4("Global_Right_Index_Tip_Position",this.globaRightIndexTipPosition),this._activeEffect.setVector4("Global_Left_Thumb_Tip_Position",this.globalLeftThumbTipPosition),this._activeEffect.setVector4("Global_Right_Thumb_Tip_Position",this.globalRightThumbTipPosition),this._activeEffect.setVector4("Global_Left_Index_Middle_Position",this.globalLeftIndexMiddlePosition),this._activeEffect.setVector4("Global_Right_Index_Middle_Position",this.globalRightIndexMiddlePosition),this._activeEffect.setFloat("Global_Left_Index_Tip_Proximity",this.globalLeftIndexTipProximity),this._activeEffect.setFloat("Global_Right_Index_Tip_Proximity",this.globalRightIndexTipProximity),this._afterBind(t,this._activeEffect))}},t.prototype.getAnimatables=function(){return[]},t.prototype.dispose=function(t){e.prototype.dispose.call(this,t)},t.prototype.clone=function(e){var n=this;return i.SerializationHelper.Clone(function(){return new t(e,n.getScene())},this)},t.prototype.serialize=function(){var e=i.SerializationHelper.Serialize(this);return e.customType="BABYLON.MRDLSliderThumbMaterial",e},t.prototype.getClassName=function(){return"MRDLSliderThumbMaterial"},t.Parse=function(e,n,r){return i.SerializationHelper.Parse(function(){return new t(e.name,n)},e,n,r)},t.BLUE_GRADIENT_TEXTURE_URL="https://assets.babylonjs.com/meshes/MRTK/MRDL/mrtk-mrdl-blue-gradient.png",Object(r.__decorate)([Object(i.serialize)()],t.prototype,"radius",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"bevelFront",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"bevelFrontStretch",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"bevelBack",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"bevelBackStretch",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"radiusTopLeft",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"radiusTopRight",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"radiusBottomLeft",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"radiusBottomRight",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"bulgeEnabled",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"bulgeHeight",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"bulgeRadius",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"sunIntensity",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"sunTheta",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"sunPhi",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"indirectDiffuse",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"albedo",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"specular",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"shininess",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"sharpness",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"subsurface",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"leftGradientColor",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"rightGradientColor",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"reflection",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"frontReflect",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"edgeReflect",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"power",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"skyColor",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"horizonColor",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"groundColor",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"horizonPower",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"width",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"fuzz",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"minFuzz",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"clipFade",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"hueShift",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"saturationShift",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"valueShift",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobPosition",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobIntensity",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobNearSize",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobFarSize",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobNearDistance",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobFarDistance",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobFadeLength",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobPulse",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobFade",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobPosition2",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobNearSize2",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobPulse2",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobFade2",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"blobTexture",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"leftIndexPosition",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"rightIndexPosition",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"leftIndexMiddlePosition",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"rightIndexMiddlePosition",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"decalScaleXY",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"decalFrontOnly",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"rimIntensity",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"rimHueShift",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"rimSaturationShift",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"rimValueShift",void 0),Object(r.__decorate)([Object(i.serialize)()],t.prototype,"iridescenceIntensity",void 0),t}(i.PushMaterial);Object(i.RegisterClass)("BABYLON.GUI.MRDLSliderThumbMaterial",a)},"./3D/materials/mrdl/shaders/mrdlBackplate.fragment.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"mrdlBackplatePixelShader",function(){return a});var r=n("babylonjs/Misc/perfCounter"),i="mrdlBackplatePixelShader",o="uniform vec3 cameraPosition;\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec2 vUV;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec4 vExtra1;\nvarying vec4 vExtra2;\nuniform float _Radius_;\nuniform float _Line_Width_;\nuniform bool _Absolute_Sizes_;\nuniform float _Filter_Width_;\nuniform vec4 _Base_Color_;\nuniform vec4 _Line_Color_;\nuniform float _Radius_Top_Left_;\nuniform float _Radius_Top_Right_;\nuniform float _Radius_Bottom_Left_;\nuniform float _Radius_Bottom_Right_;\nuniform float _Rate_;\nuniform vec4 _Highlight_Color_;\nuniform float _Highlight_Width_;\nuniform vec4 _Highlight_Transform_;\nuniform float _Highlight_;\n\nuniform float _Iridescence_Intensity_;\nuniform float _Iridescence_Edge_Intensity_;\nuniform vec4 _Iridescence_Tint_;\nuniform sampler2D _Iridescent_Map_;\nuniform float _Angle_;\nuniform bool _Reflected_;\nuniform float _Frequency_;\nuniform float _Vertical_Offset_;\nuniform vec4 _Gradient_Color_;\nuniform vec4 _Top_Left_;\nuniform vec4 _Top_Right_;\nuniform vec4 _Bottom_Left_;\nuniform vec4 _Bottom_Right_;\n\nuniform float _Edge_Width_;\nuniform float _Edge_Power_;\nuniform float _Line_Gradient_Blend_;\nuniform float _Fade_Out_;\n\n\nvoid FastLinearTosRGB_B353(\nvec4 Linear,\nout vec4 sRGB)\n{\nsRGB.rgb=sqrt(clamp(Linear.rgb,0.0,1.0));\nsRGB.a=Linear.a;\n}\n\n\nvoid Round_Rect_Fragment_B332(\nfloat Radius,\nfloat Line_Width,\nvec4 Line_Color,\nfloat Filter_Width,\nvec2 UV,\nfloat Line_Visibility,\nvec4 Rect_Parms,\nvec4 Fill_Color,\nout vec4 Color)\n{\nfloat d=length(max(abs(UV)-Rect_Parms.xy,0.0));\nfloat dx=max(fwidth(d)*Filter_Width,0.00001);\n\nfloat g=min(Rect_Parms.z,Rect_Parms.w);\nfloat dgrad=max(fwidth(g)*Filter_Width,0.00001);\nfloat Inside_Rect=clamp(g/dgrad,0.0,1.0);\n\n\nfloat inner=clamp((d+dx*0.5-max(Radius-Line_Width,d-dx*0.5))/dx,0.0,1.0);\nColor=clamp(mix(Fill_Color,Line_Color,inner),0.0,1.0)*Inside_Rect;\n\n\n\n}\n\n\nvoid Iridescence_B343(\nvec3 Position,\nvec3 Normal,\nvec2 UV,\nvec3 Axis,\nvec3 Eye,\nvec4 Tint,\nsampler2D Texture,\nbool Reflected,\nfloat Frequency,\nfloat Vertical_Offset,\nout vec4 Color)\n{\nvec3 i=normalize(Position-Eye);\nvec3 r=reflect(i,Normal);\nfloat idota=dot(i,Axis);\nfloat idotr=dot(i,r);\nfloat x=Reflected ? idotr : idota;\nvec2 xy;\nxy.x=fract((x*Frequency+1.0)*0.5+UV.y*Vertical_Offset);\nxy.y=0.5;\nColor=texture(Texture,xy);\nColor.rgb*=Tint.rgb;\n}\n\n\nvoid Scale_RGB_B346(\nvec4 Color,\nfloat Scalar,\nout vec4 Result)\n{\nResult=vec4(Scalar,Scalar,Scalar,1)*Color;\n}\n\n\nvoid Scale_RGB_B344(\nfloat Scalar,\nvec4 Color,\nout vec4 Result)\n{\nResult=vec4(Scalar,Scalar,Scalar,1)*Color;\n}\n\n\nvoid Line_Fragment_B362(\nvec4 Base_Color,\nvec4 Highlight_Color,\nfloat Highlight_Width,\nvec3 Line_Vertex,\nfloat Highlight,\nout vec4 Line_Color)\n{\nfloat k2=1.0-clamp(abs(Line_Vertex.y/Highlight_Width),0.0,1.0);\nLine_Color=mix(Base_Color,Highlight_Color,Highlight*k2);\n}\n\n\nvoid Edge_B356(\nvec4 RectParms,\nfloat Radius,\nfloat Line_Width,\nvec2 UV,\nfloat Edge_Width,\nfloat Edge_Power,\nout float Result)\n{\nfloat d=length(max(abs(UV)-RectParms.xy,0.0));\nfloat edge=1.0-clamp((1.0-d/(Radius-Line_Width))/Edge_Width,0.0,1.0);\nResult=pow(edge,Edge_Power);\n}\n\n\nvoid Gradient_B355(\nvec4 Gradient_Color,\nvec4 Top_Left,\nvec4 Top_Right,\nvec4 Bottom_Left,\nvec4 Bottom_Right,\nvec2 UV,\nout vec4 Result)\n{\nvec3 top=Top_Left.rgb+(Top_Right.rgb-Top_Left.rgb)*UV.x;\nvec3 bottom=Bottom_Left.rgb+(Bottom_Right.rgb-Bottom_Left.rgb)*UV.x;\nResult.rgb=Gradient_Color.rgb*(bottom+(top-bottom)*UV.y);\nResult.a=1.0;\n}\n\nvoid main()\n{\n\nfloat X_Q338;\nfloat Y_Q338;\nfloat Z_Q338;\nfloat W_Q338;\nX_Q338=vExtra2.x;\nY_Q338=vExtra2.y;\nZ_Q338=vExtra2.z;\nW_Q338=vExtra2.w;\nvec4 Color_Q343;\n#if IRIDESCENCE_ENABLE\nIridescence_B343(vPosition,vNormal,vUV,vBinormal,cameraPosition,_Iridescence_Tint_,_Iridescent_Map_,_Reflected_,_Frequency_,_Vertical_Offset_,Color_Q343);\n#else\nColor_Q343=vec4(0,0,0,0);\n#endif\nvec4 Result_Q344;\nScale_RGB_B344(_Iridescence_Intensity_,Color_Q343,Result_Q344);\nvec4 Line_Color_Q362;\nLine_Fragment_B362(_Line_Color_,_Highlight_Color_,_Highlight_Width_,vTangent,_Highlight_,Line_Color_Q362);\nfloat Result_Q356;\n#if EDGE_ONLY\nEdge_B356(vExtra1,Z_Q338,W_Q338,vUV,_Edge_Width_,_Edge_Power_,Result_Q356);\n#else\nResult_Q356=1.0;\n#endif\n\nvec2 Vec2_Q339=vec2(X_Q338,Y_Q338);\nvec4 Result_Q355;\nGradient_B355(_Gradient_Color_,_Top_Left_,_Top_Right_,_Bottom_Left_,_Bottom_Right_,Vec2_Q339,Result_Q355);\n\nvec4 Linear_Q348;\nLinear_Q348.rgb=clamp(Result_Q355.rgb*Result_Q355.rgb,0.0,1.0);\nLinear_Q348.a=Result_Q355.a;\nvec4 Result_Q346;\nScale_RGB_B346(Linear_Q348,Result_Q356,Result_Q346);\n\nvec4 Sum_Q345=Result_Q346+Result_Q344;\n\nvec4 Color_At_T_Q347=mix(Line_Color_Q362,Result_Q346,_Line_Gradient_Blend_);\n\nvec4 Base_And_Iridescent_Q350;\nBase_And_Iridescent_Q350=_Base_Color_+vec4(Sum_Q345.rgb,0.0);\n\nvec4 Sum_Q349=Color_At_T_Q347+_Iridescence_Edge_Intensity_*Color_Q343;\n\nvec4 Result_Q351=Sum_Q349; Result_Q351.a=1.0;\nvec4 Color_Q332;\nRound_Rect_Fragment_B332(Z_Q338,W_Q338,Result_Q351,_Filter_Width_,vUV,1.0,vExtra1,Base_And_Iridescent_Q350,Color_Q332);\n\nvec4 Result_Q354=_Fade_Out_*Color_Q332;\nvec4 sRGB_Q353;\nFastLinearTosRGB_B353(Result_Q354,sRGB_Q353);\nvec4 Out_Color=sRGB_Q353;\nfloat Clip_Threshold=0.001;\nbool To_sRGB=false;\ngl_FragColor=Out_Color;\n}";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./3D/materials/mrdl/shaders/mrdlBackplate.vertex.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"mrdlBackplateVertexShader",function(){return a});var r=n("babylonjs/Misc/perfCounter"),i="mrdlBackplateVertexShader",o="uniform mat4 world;\nuniform mat4 viewProjection;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec3 tangent;\nuniform float _Radius_;\nuniform float _Line_Width_;\nuniform bool _Absolute_Sizes_;\nuniform float _Filter_Width_;\nuniform vec4 _Base_Color_;\nuniform vec4 _Line_Color_;\nuniform float _Radius_Top_Left_;\nuniform float _Radius_Top_Right_;\nuniform float _Radius_Bottom_Left_;\nuniform float _Radius_Bottom_Right_;\nuniform float _Rate_;\nuniform vec4 _Highlight_Color_;\nuniform float _Highlight_Width_;\nuniform vec4 _Highlight_Transform_;\nuniform float _Highlight_;\n\nuniform float _Iridescence_Intensity_;\nuniform float _Iridescence_Edge_Intensity_;\nuniform vec4 _Iridescence_Tint_;\nuniform sampler2D _Iridescent_Map_;\nuniform float _Angle_;\nuniform bool _Reflected_;\nuniform float _Frequency_;\nuniform float _Vertical_Offset_;\nuniform vec4 _Gradient_Color_;\nuniform vec4 _Top_Left_;\nuniform vec4 _Top_Right_;\nuniform vec4 _Bottom_Left_;\nuniform vec4 _Bottom_Right_;\n\nuniform float _Edge_Width_;\nuniform float _Edge_Power_;\nuniform float _Line_Gradient_Blend_;\nuniform float _Fade_Out_;\n\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec2 vUV;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec4 vExtra1;\nvarying vec4 vExtra2;\n\nvoid Object_To_World_Pos_B314(\nvec3 Pos_Object,\nout vec3 Pos_World)\n{\nPos_World=(world*vec4(Pos_Object,1.0)).xyz;\n}\n\n\nvoid Round_Rect_Vertex_B357(\nvec2 UV,\nfloat Radius,\nfloat Margin,\nfloat Anisotropy,\nfloat Gradient1,\nfloat Gradient2,\nvec3 Normal,\nvec4 Color_Scale_Translate,\nout vec2 Rect_UV,\nout vec4 Rect_Parms,\nout vec2 Scale_XY,\nout vec2 Line_UV,\nout vec2 Color_UV_Info)\n{\nScale_XY=vec2(Anisotropy,1.0);\nLine_UV=(UV-vec2(0.5,0.5));\nRect_UV=Line_UV*Scale_XY;\nRect_Parms.xy=Scale_XY*0.5-vec2(Radius,Radius)-vec2(Margin,Margin);\nRect_Parms.z=Gradient1;\nRect_Parms.w=Gradient2;\nColor_UV_Info=(Line_UV+vec2(0.5,0.5))*Color_Scale_Translate.xy+Color_Scale_Translate.zw;\n}\n\n\nvoid Line_Vertex_B333(\nvec2 Scale_XY,\nvec2 UV,\nfloat Time,\nfloat Rate,\nvec4 Highlight_Transform,\nout vec3 Line_Vertex)\n{\nfloat angle2=(Rate*Time)*2.0*3.1416;\nfloat sinAngle2=sin(angle2);\nfloat cosAngle2=cos(angle2);\nvec2 xformUV=UV*Highlight_Transform.xy+Highlight_Transform.zw;\nLine_Vertex.x=0.0;\nLine_Vertex.y=cosAngle2*xformUV.x-sinAngle2*xformUV.y;\nLine_Vertex.z=0.0;\n}\n\n\nvoid PickDir_B334(\nfloat Degrees,\nvec3 DirX,\nvec3 DirY,\nout vec3 Dir)\n{\n\nfloat a=Degrees*3.14159/180.0;\nDir=cos(a)*DirX+sin(a)*DirY;\n}\n\n\nvoid Move_Verts_B327(\nfloat Anisotropy,\nvec3 P,\nfloat Radius,\nout vec3 New_P,\nout vec2 New_UV,\nout float Radial_Gradient,\nout vec3 Radial_Dir)\n{\nvec2 UV=P.xy*2.0+0.5;\nvec2 center=clamp(UV,0.0,1.0);\nvec2 delta=UV-center;\nvec2 r2=2.0*vec2(Radius/Anisotropy,Radius);\nNew_UV=center+r2*(UV-2.0*center+0.5);\nNew_P=vec3(New_UV-0.5,P.z);\nRadial_Gradient=1.0-length(delta)*2.0;\nRadial_Dir=vec3(delta*r2,0.0);\n}\n\n\nvoid Pick_Radius_B336(\nfloat Radius,\nfloat Radius_Top_Left,\nfloat Radius_Top_Right,\nfloat Radius_Bottom_Left,\nfloat Radius_Bottom_Right,\nvec3 Position,\nout float Result)\n{\nbool whichY=Position.y>0.0;\nResult=Position.x<0.0 ? (whichY ? Radius_Top_Left : Radius_Bottom_Left) : (whichY ? Radius_Top_Right : Radius_Bottom_Right);\nResult*=Radius;\n}\n\n\nvoid Edge_AA_Vertex_B328(\nvec3 Position_World,\nvec3 Position_Object,\nvec3 Normal_Object,\nvec3 Eye,\nfloat Radial_Gradient,\nvec3 Radial_Dir,\nvec3 Tangent,\nout float Gradient1,\nout float Gradient2)\n{\n\nvec3 I=(Eye-Position_World);\nvec3 T=(vec4(Tangent,0.0)).xyz;\nfloat g=(dot(T,I)<0.0) ? 0.0 : 1.0;\nif (Normal_Object.z==0.0) {\n\nGradient1=Position_Object.z>0.0 ? g : 1.0;\nGradient2=Position_Object.z>0.0 ? 1.0 : g;\n} else {\n\n\n\n\nGradient1=g+(1.0-g)*(Radial_Gradient);\nGradient2=1.0;\n}\n}\n\n\nvoid Object_To_World_Dir_B330(\nvec3 Dir_Object,\nout vec3 Binormal_World,\nout vec3 Binormal_World_N,\nout float Binormal_Length)\n{\nBinormal_World=(world*vec4(Dir_Object,0.0)).xyz;\nBinormal_Length=length(Binormal_World);\nBinormal_World_N=Binormal_World/Binormal_Length;\n}\n\n\nvoid RelativeOrAbsoluteDetail_B341(\nfloat Nominal_Radius,\nfloat Nominal_LineWidth,\nbool Absolute_Measurements,\nfloat Height,\nout float Radius,\nout float Line_Width)\n{\nfloat scale=Absolute_Measurements ? 1.0/Height : 1.0;\nRadius=Nominal_Radius*scale;\nLine_Width=Nominal_LineWidth*scale;\n}\n\nvoid main()\n{\n\nvec3 Nrm_World_Q326;\nNrm_World_Q326=normalize((world*vec4(normal,0.0)).xyz);\n\nvec3 Tangent_World_Q329;\nvec3 Tangent_World_N_Q329;\nfloat Tangent_Length_Q329;\nTangent_World_Q329=(world*vec4(vec3(1,0,0),0.0)).xyz;\nTangent_Length_Q329=length(Tangent_World_Q329);\nTangent_World_N_Q329=Tangent_World_Q329/Tangent_Length_Q329;\nvec3 Binormal_World_Q330;\nvec3 Binormal_World_N_Q330;\nfloat Binormal_Length_Q330;\nObject_To_World_Dir_B330(vec3(0,1,0),Binormal_World_Q330,Binormal_World_N_Q330,Binormal_Length_Q330);\nfloat Radius_Q341;\nfloat Line_Width_Q341;\nRelativeOrAbsoluteDetail_B341(_Radius_,_Line_Width_,_Absolute_Sizes_,Binormal_Length_Q330,Radius_Q341,Line_Width_Q341);\nvec3 Dir_Q334;\nPickDir_B334(_Angle_,Tangent_World_N_Q329,Binormal_World_N_Q330,Dir_Q334);\nfloat Result_Q336;\nPick_Radius_B336(Radius_Q341,_Radius_Top_Left_,_Radius_Top_Right_,_Radius_Bottom_Left_,_Radius_Bottom_Right_,position,Result_Q336);\n\nfloat Anisotropy_Q331=Tangent_Length_Q329/Binormal_Length_Q330;\n\nvec4 Out_Color_Q337=vec4(Result_Q336,Line_Width_Q341,0,1);\nvec3 New_P_Q327;\nvec2 New_UV_Q327;\nfloat Radial_Gradient_Q327;\nvec3 Radial_Dir_Q327;\nMove_Verts_B327(Anisotropy_Q331,position,Result_Q336,New_P_Q327,New_UV_Q327,Radial_Gradient_Q327,Radial_Dir_Q327);\nvec3 Pos_World_Q314;\nObject_To_World_Pos_B314(New_P_Q327,Pos_World_Q314);\nfloat Gradient1_Q328;\nfloat Gradient2_Q328;\n#if SMOOTH_EDGES\nEdge_AA_Vertex_B328(Pos_World_Q314,position,normal,cameraPosition,Radial_Gradient_Q327,Radial_Dir_Q327,tangent,Gradient1_Q328,Gradient2_Q328);\n#else\nGradient1_Q328=1.0;\nGradient2_Q328=1.0;\n#endif\nvec2 Rect_UV_Q357;\nvec4 Rect_Parms_Q357;\nvec2 Scale_XY_Q357;\nvec2 Line_UV_Q357;\nvec2 Color_UV_Info_Q357;\nRound_Rect_Vertex_B357(New_UV_Q327,Result_Q336,0.0,Anisotropy_Q331,Gradient1_Q328,Gradient2_Q328,normal,vec4(1,1,0,0),Rect_UV_Q357,Rect_Parms_Q357,Scale_XY_Q357,Line_UV_Q357,Color_UV_Info_Q357);\nvec3 Line_Vertex_Q333;\nLine_Vertex_B333(Scale_XY_Q357,Line_UV_Q357,(20.0),_Rate_,_Highlight_Transform_,Line_Vertex_Q333);\n\nfloat X_Q359;\nfloat Y_Q359;\nX_Q359=Color_UV_Info_Q357.x;\nY_Q359=Color_UV_Info_Q357.y;\n\nvec4 Vec4_Q358=vec4(X_Q359,Y_Q359,Result_Q336,Line_Width_Q341);\nvec3 Position=Pos_World_Q314;\nvec3 Normal=Nrm_World_Q326;\nvec2 UV=Rect_UV_Q357;\nvec3 Tangent=Line_Vertex_Q333;\nvec3 Binormal=Dir_Q334;\nvec4 Color=Out_Color_Q337;\nvec4 Extra1=Rect_Parms_Q357;\nvec4 Extra2=Vec4_Q358;\nvec4 Extra3=vec4(0,0,0,0);\ngl_Position=viewProjection*vec4(Position,1);\nvPosition=Position;\nvNormal=Normal;\nvUV=UV;\nvTangent=Tangent;\nvBinormal=Binormal;\nvExtra1=Extra1;\nvExtra2=Extra2;\n}";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./3D/materials/mrdl/shaders/mrdlSliderBar.fragment.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"mrdlSliderBarPixelShader",function(){return a});var r=n("babylonjs/Misc/perfCounter"),i="mrdlSliderBarPixelShader",o="uniform vec3 cameraPosition;\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec2 vUV;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec4 vColor;\nvarying vec4 vExtra1;\nvarying vec4 vExtra2;\nvarying vec4 vExtra3;\nuniform float _Radius_;\nuniform float _Bevel_Front_;\nuniform float _Bevel_Front_Stretch_;\nuniform float _Bevel_Back_;\nuniform float _Bevel_Back_Stretch_;\nuniform float _Radius_Top_Left_;\nuniform float _Radius_Top_Right_;\nuniform float _Radius_Bottom_Left_;\nuniform float _Radius_Bottom_Right_;\nuniform bool _Bulge_Enabled_;\nuniform float _Bulge_Height_;\nuniform float _Bulge_Radius_;\nuniform float _Sun_Intensity_;\nuniform float _Sun_Theta_;\nuniform float _Sun_Phi_;\nuniform float _Indirect_Diffuse_;\nuniform vec4 _Albedo_;\nuniform float _Specular_;\nuniform float _Shininess_;\nuniform float _Sharpness_;\nuniform float _Subsurface_;\nuniform vec4 _Left_Color_;\nuniform vec4 _Right_Color_;\nuniform float _Reflection_;\nuniform float _Front_Reflect_;\nuniform float _Edge_Reflect_;\nuniform float _Power_;\n\nuniform vec4 _Sky_Color_;\nuniform vec4 _Horizon_Color_;\nuniform vec4 _Ground_Color_;\nuniform float _Horizon_Power_;\n\nuniform sampler2D _Reflection_Map_;\nuniform sampler2D _Indirect_Environment_;\n\nuniform float _Width_;\nuniform float _Fuzz_;\nuniform float _Min_Fuzz_;\nuniform float _Clip_Fade_;\nuniform float _Hue_Shift_;\nuniform float _Saturation_Shift_;\nuniform float _Value_Shift_;\n\nuniform vec3 _Blob_Position_;\nuniform float _Blob_Intensity_;\nuniform float _Blob_Near_Size_;\nuniform float _Blob_Far_Size_;\nuniform float _Blob_Near_Distance_;\nuniform float _Blob_Far_Distance_;\nuniform float _Blob_Fade_Length_;\nuniform float _Blob_Pulse_;\nuniform float _Blob_Fade_;\nuniform sampler2D _Blob_Texture_;\n\nuniform vec3 _Blob_Position_2_;\nuniform float _Blob_Near_Size_2_;\nuniform float _Blob_Pulse_2_;\nuniform float _Blob_Fade_2_;\nuniform vec3 _Left_Index_Pos_;\nuniform vec3 _Right_Index_Pos_;\nuniform vec3 _Left_Index_Middle_Pos_;\nuniform vec3 _Right_Index_Middle_Pos_;\n\nuniform sampler2D _Decal_;\nuniform vec2 _Decal_Scale_XY_;\nuniform bool _Decal_Front_Only_;\nuniform float _Rim_Intensity_;\nuniform sampler2D _Rim_Texture_;\nuniform float _Rim_Hue_Shift_;\nuniform float _Rim_Saturation_Shift_;\nuniform float _Rim_Value_Shift_;\n\nuniform float _Iridescence_Intensity_;\nuniform sampler2D _Iridescence_Texture_;\nuniform bool Use_Global_Left_Index;\nuniform bool Use_Global_Right_Index;\nuniform vec4 Global_Left_Index_Tip_Position;\nuniform vec4 Global_Right_Index_Tip_Position;\nuniform vec4 Global_Left_Thumb_Tip_Position;\nuniform vec4 Global_Right_Thumb_Tip_Position;\nuniform vec4 Global_Left_Index_Middle_Position;\nuniform vec4 Global_Right_Index_Middle_Position;\nuniform float Global_Left_Index_Tip_Proximity;\nuniform float Global_Right_Index_Tip_Proximity;\n\nvoid Blob_Fragment_B30(\nsampler2D Blob_Texture,\nvec4 Blob_Info1,\nvec4 Blob_Info2,\nout vec4 Blob_Color)\n{\nfloat k1=dot(Blob_Info1.xy,Blob_Info1.xy);\nfloat k2=dot(Blob_Info2.xy,Blob_Info2.xy);\nvec3 closer=k1<k2 ? vec3(k1,Blob_Info1.z,Blob_Info1.w) : vec3(k2,Blob_Info2.z,Blob_Info2.w);\nBlob_Color=closer.z*texture(Blob_Texture,vec2(vec2(sqrt(closer.x),closer.y).x,1.0-vec2(sqrt(closer.x),closer.y).y))*clamp(1.0-closer.x,0.0,1.0);\n}\n\n\nvoid FastLinearTosRGB_B42(\nvec4 Linear,\nout vec4 sRGB)\n{\nsRGB.rgb=sqrt(clamp(Linear.rgb,0.0,1.0));\nsRGB.a=Linear.a;\n}\n\n\nvoid Scale_RGB_B59(\nvec4 Color,\nfloat Scalar,\nout vec4 Result)\n{\nResult=vec4(Scalar,Scalar,Scalar,1)*Color;\n}\n\n\nvoid Fragment_Main_B121(\nfloat Sun_Intensity,\nfloat Sun_Theta,\nfloat Sun_Phi,\nvec3 Normal,\nvec4 Albedo,\nfloat Fresnel_Reflect,\nfloat Shininess,\nvec3 Incident,\nvec4 Horizon_Color,\nvec4 Sky_Color,\nvec4 Ground_Color,\nfloat Indirect_Diffuse,\nfloat Specular,\nfloat Horizon_Power,\nfloat Reflection,\nvec4 Reflection_Sample,\nvec4 Indirect_Sample,\nfloat Sharpness,\nfloat SSS,\nfloat Subsurface,\nvec4 Translucence,\nvec4 Rim_Light,\nvec4 Iridescence,\nout vec4 Result)\n{\nfloat theta=Sun_Theta*2.0*3.14159;\nfloat phi=Sun_Phi*3.14159;\nvec3 lightDir=vec3(cos(phi)*cos(theta),sin(phi),cos(phi)*sin(theta));\nfloat NdotL=max(dot(lightDir,Normal),0.0);\n\nvec3 R=reflect(Incident,Normal);\nfloat RdotL=max(0.0,dot(R,lightDir));\nfloat specular=pow(RdotL,Shininess);\nspecular=mix(specular,smoothstep(0.495*Sharpness,1.0-0.495*Sharpness,specular),Sharpness);\nvec4 gi=mix(Ground_Color,Sky_Color,Normal.y*0.5+0.5);\n\nResult=((Sun_Intensity*NdotL+Indirect_Sample*Indirect_Diffuse+Translucence)*(1.0+SSS*Subsurface))*Albedo*(1.0-Fresnel_Reflect)+(Sun_Intensity*specular*Specular+Fresnel_Reflect*Reflection*Reflection_Sample)+Fresnel_Reflect*Rim_Light+Iridescence;\n}\n\n\nvoid Bulge_B79(\nbool Enabled,\nvec3 Normal,\nvec3 Tangent,\nfloat Bulge_Height,\nvec4 UV,\nfloat Bulge_Radius,\nvec3 ButtonN,\nout vec3 New_Normal)\n{\nvec2 xy=clamp(UV.xy*2.0,vec2(-1,-1),vec2(1,1));\nvec3 B=(cross(Normal,Tangent));\n\n\n\n\nfloat k=-clamp(1.0-length(xy)/Bulge_Radius,0.0,1.0)*Bulge_Height;\nk=sin(k*3.14159*0.5);\nk*=smoothstep(0.9998,0.9999,abs(dot(ButtonN,Normal)));\nNew_Normal=Normal*sqrt(1.0-k*k)+(xy.x*Tangent+xy.y*B)*k;\nNew_Normal=Enabled ? New_Normal : Normal;\n}\n\n\nvoid SSS_B77(\nvec3 ButtonN,\nvec3 Normal,\nvec3 Incident,\nout float Result)\n{\nfloat NdotI=abs(dot(Normal,Incident));\nfloat BdotI=abs(dot(ButtonN,Incident));\nResult=(abs(NdotI-BdotI));\n\n}\n\n\nvoid FingerOcclusion_B67(\nfloat Width,\nfloat DistToCenter,\nfloat Fuzz,\nfloat Min_Fuzz,\nvec3 Position,\nvec3 Forward,\nvec3 Nearest,\nfloat Fade_Out,\nout float NotInShadow)\n{\nfloat d=dot((Nearest-Position),Forward);\nfloat sh=smoothstep(Width*0.5,Width*0.5+Fuzz*max(d,0.0)+Min_Fuzz,DistToCenter);\nNotInShadow=1.0-(1.0-sh)*smoothstep(-Fade_Out,0.0,d);\n}\n\n\nvoid FingerOcclusion_B68(\nfloat Width,\nfloat DistToCenter,\nfloat Fuzz,\nfloat Min_Fuzz,\nvec3 Position,\nvec3 Forward,\nvec3 Nearest,\nfloat Fade_Out,\nout float NotInShadow)\n{\nfloat d=dot((Nearest-Position),Forward);\nfloat sh=smoothstep(Width*0.5,Width*0.5+Fuzz*max(d,0.0)+Min_Fuzz,DistToCenter);\nNotInShadow=1.0-(1.0-sh)*smoothstep(-Fade_Out,0.0,d);\n}\n\n\nvoid Scale_Color_B91(\nvec4 Color,\nfloat Scalar,\nout vec4 Result)\n{\nResult=Scalar*Color;\n}\n\n\nvoid From_HSV_B73(\nfloat Hue,\nfloat Saturation,\nfloat Value,\nfloat Alpha,\nout vec4 Color)\n{\n\nvec4 K=vec4(1.0,2.0/3.0,1.0/3.0,3.0);\nvec3 p=abs(fract(vec3(Hue,Hue,Hue)+K.xyz)*6.0-K.www);\nColor.rgb=Value*mix(K.xxx,clamp(p-K.xxx,0.0,1.0),Saturation);\nColor.a=Alpha;\n}\n\n\nvoid Fast_Fresnel_B122(\nfloat Front_Reflect,\nfloat Edge_Reflect,\nfloat Power,\nvec3 Normal,\nvec3 Incident,\nout float Transmit,\nout float Reflect)\n{\nfloat d=max(-dot(Incident,Normal),0.0);\nReflect=Front_Reflect+(Edge_Reflect-Front_Reflect)*pow(.01-d,Power);\nTransmit=1.0-Reflect;\n}\n\n\nvoid Mapped_Environment_B51(\nsampler2D Reflected_Environment,\nsampler2D Indirect_Environment,\nvec3 Dir,\nout vec4 Reflected_Color,\nout vec4 Indirect_Diffuse)\n{\n\nReflected_Color=texture(Reflected_Environment,vec2(atan(Dir.z,Dir.x)/3.14159*0.5,asin(Dir.y)/3.14159+0.5));\nIndirect_Diffuse=texture(Indirect_Environment,vec2(atan(Dir.z,Dir.x)/3.14159*0.5,asin(Dir.y)/3.14159+0.5));\n}\n\n\nvec4 SampleEnv_Bid50(vec3 D,vec4 S,vec4 H,vec4 G,float exponent)\n{\nfloat k=pow(abs(D.y),exponent);\nvec4 C;\nif (D.y>0.0) {\nC=mix(H,S,k);\n} else {\nC=mix(H,G,k);\n}\nreturn C;\n}\nvoid Sky_Environment_B50(\nvec3 Normal,\nvec3 Reflected,\nvec4 Sky_Color,\nvec4 Horizon_Color,\nvec4 Ground_Color,\nfloat Horizon_Power,\nout vec4 Reflected_Color,\nout vec4 Indirect_Color)\n{\n\nReflected_Color=SampleEnv_Bid50(Reflected,Sky_Color,Horizon_Color,Ground_Color,Horizon_Power);\nIndirect_Color=mix(Ground_Color,Sky_Color,Normal.y*0.5+0.5);\n}\n\n\nvoid Min_Segment_Distance_B65(\nvec3 P0,\nvec3 P1,\nvec3 Q0,\nvec3 Q1,\nout vec3 NearP,\nout vec3 NearQ,\nout float Distance)\n{\nvec3 u=P1-P0;\nvec3 v=Q1-Q0;\nvec3 w=P0-Q0;\nfloat a=dot(u,u);\nfloat b=dot(u,v);\nfloat c=dot(v,v);\nfloat d=dot(u,w);\nfloat e=dot(v,w);\nfloat D=a*c-b*b;\nfloat sD=D;\nfloat tD=D;\nfloat sc,sN,tc,tN;\nif (D<0.00001) {\nsN=0.0;\nsD=1.0;\ntN=e;\ntD=c;\n} else {\nsN=(b*e-c*d);\ntN=(a*e-b*d);\nif (sN<0.0) {\nsN=0.0;\ntN=e;\ntD=c;\n} else if (sN>sD) {\nsN=sD;\ntN=e+b;\ntD=c;\n}\n}\nif (tN<0.0) {\ntN=0.0;\nif (-d<0.0) {\nsN=0.0;\n} else if (-d>a) {\nsN=sD;\n} else {\nsN=-d;\nsD=a;\n}\n} else if (tN>tD) {\ntN=tD;\nif ((-d+b)<0.0) {\nsN=0.0;\n} else if ((-d+b)>a) {\nsN=sD;\n} else {\nsN=(-d+b);\nsD=a;\n}\n}\nsc=abs(sN)<0.000001 ? 0.0 : sN/sD;\ntc=abs(tN)<0.000001 ? 0.0 : tN/tD;\nNearP=P0+sc*u;\nNearQ=Q0+tc*v;\nDistance=distance(NearP,NearQ);\n}\n\n\nvoid To_XYZ_B74(\nvec3 Vec3,\nout float X,\nout float Y,\nout float Z)\n{\nX=Vec3.x;\nY=Vec3.y;\nZ=Vec3.z;\n}\n\n\nvoid Finger_Positions_B64(\nvec3 Left_Index_Pos,\nvec3 Right_Index_Pos,\nvec3 Left_Index_Middle_Pos,\nvec3 Right_Index_Middle_Pos,\nout vec3 Left_Index,\nout vec3 Right_Index,\nout vec3 Left_Index_Middle,\nout vec3 Right_Index_Middle)\n{\nLeft_Index=(Use_Global_Left_Index ? Global_Left_Index_Tip_Position.xyz : Left_Index_Pos);\nRight_Index=(Use_Global_Right_Index ? Global_Right_Index_Tip_Position.xyz : Right_Index_Pos);\nLeft_Index_Middle=(Use_Global_Left_Index ? Global_Left_Index_Middle_Position.xyz : Left_Index_Middle_Pos);\nRight_Index_Middle=(Use_Global_Right_Index ? Global_Right_Index_Middle_Position.xyz : Right_Index_Middle_Pos);\n}\n\n\nvoid VaryHSV_B108(\nvec3 HSV_In,\nfloat Hue_Shift,\nfloat Saturation_Shift,\nfloat Value_Shift,\nout vec3 HSV_Out)\n{\nHSV_Out=vec3(fract(HSV_In.x+Hue_Shift),clamp(HSV_In.y+Saturation_Shift,0.0,1.0),clamp(HSV_In.z+Value_Shift,0.0,1.0));\n}\n\n\nvoid Remap_Range_B114(\nfloat In_Min,\nfloat In_Max,\nfloat Out_Min,\nfloat Out_Max,\nfloat In,\nout float Out)\n{\nOut=mix(Out_Min,Out_Max,clamp((In-In_Min)/(In_Max-In_Min),0.0,1.0));\n}\n\n\nvoid To_HSV_B75(\nvec4 Color,\nout float Hue,\nout float Saturation,\nout float Value,\nout float Alpha,\nout vec3 HSV)\n{\n\nvec4 K=vec4(0.0,-1.0/3.0,2.0/3.0,-1.0);\nvec4 p=Color.g<Color.b ? vec4(Color.bg,K.wz) : vec4(Color.gb,K.xy);\nvec4 q=Color.r<p.x ? vec4(p.xyw,Color.r) : vec4(Color.r,p.yzx);\nfloat d=q.x-min(q.w,q.y);\nfloat e=1.0e-10;\nHue=abs(q.z+(q.w-q.y)/(6.0*d+e));\nSaturation=d/(q.x+e);\nValue=q.x;\nAlpha=Color.a;\nHSV=vec3(Hue,Saturation,Value);\n}\n\n\nvoid Code_B110(\nfloat X,\nout float Result)\n{\nResult=(acos(X)/3.14159-0.5)*2.0;\n}\n\n\nvoid Rim_Light_B132(\nvec3 Front,\nvec3 Normal,\nvec3 Incident,\nfloat Rim_Intensity,\nsampler2D Texture,\nout vec4 Result)\n{\nvec3 R=reflect(Incident,Normal);\nfloat RdotF=dot(R,Front);\nfloat RdotL=sqrt(1.0-RdotF*RdotF);\nvec2 UV=vec2(R.y*0.5+0.5,0.5);\nvec4 Color=texture(Texture,UV);\nResult=Color;\n}\n\nvoid main()\n{\nvec4 Blob_Color_Q30;\n#if BLOB_ENABLE\nBlob_Fragment_B30(_Blob_Texture_,vExtra2,vExtra3,Blob_Color_Q30);\n#else\nBlob_Color_Q30=vec4(0,0,0,0);\n#endif\n\nvec3 Incident_Q39=normalize(vPosition-cameraPosition);\n\nvec3 Normalized_Q38=normalize(vNormal);\n\nvec3 Normalized_Q71=normalize(vTangent);\n\nvec4 Color_Q83;\n#if DECAL_ENABLE\nColor_Q83=texture(_Decal_,vUV);\n#else\nColor_Q83=vec4(0,0,0,0);\n#endif\n\nfloat X_Q90;\nfloat Y_Q90;\nfloat Z_Q90;\nfloat W_Q90;\nX_Q90=vExtra1.x;\nY_Q90=vExtra1.y;\nZ_Q90=vExtra1.z;\nW_Q90=vExtra1.w;\n\nvec4 Linear_Q43;\nLinear_Q43.rgb=clamp(_Sky_Color_.rgb*_Sky_Color_.rgb,0.0,1.0);\nLinear_Q43.a=_Sky_Color_.a;\n\nvec4 Linear_Q44;\nLinear_Q44.rgb=clamp(_Horizon_Color_.rgb*_Horizon_Color_.rgb,0.0,1.0);\nLinear_Q44.a=_Horizon_Color_.a;\n\nvec4 Linear_Q45;\nLinear_Q45.rgb=clamp(_Ground_Color_.rgb*_Ground_Color_.rgb,0.0,1.0);\nLinear_Q45.a=_Ground_Color_.a;\nvec3 Left_Index_Q64;\nvec3 Right_Index_Q64;\nvec3 Left_Index_Middle_Q64;\nvec3 Right_Index_Middle_Q64;\nFinger_Positions_B64(_Left_Index_Pos_,_Right_Index_Pos_,_Left_Index_Middle_Pos_,_Right_Index_Middle_Pos_,Left_Index_Q64,Right_Index_Q64,Left_Index_Middle_Q64,Right_Index_Middle_Q64);\n\nvec4 Linear_Q46;\nLinear_Q46.rgb=clamp(_Albedo_.rgb*_Albedo_.rgb,0.0,1.0);\nLinear_Q46.a=_Albedo_.a;\n\nvec3 Normalized_Q107=normalize(vBinormal);\n\nvec3 Incident_Q70=normalize(vPosition-cameraPosition);\nvec3 New_Normal_Q79;\nBulge_B79(_Bulge_Enabled_,Normalized_Q38,Normalized_Q71,_Bulge_Height_,vColor,_Bulge_Radius_,vBinormal,New_Normal_Q79);\nfloat Result_Q77;\nSSS_B77(vBinormal,New_Normal_Q79,Incident_Q39,Result_Q77);\nvec4 Result_Q91;\nScale_Color_B91(Color_Q83,X_Q90,Result_Q91);\nfloat Transmit_Q122;\nfloat Reflect_Q122;\nFast_Fresnel_B122(_Front_Reflect_,_Edge_Reflect_,_Power_,New_Normal_Q79,Incident_Q39,Transmit_Q122,Reflect_Q122);\n\nfloat Product_Q125=Y_Q90*Y_Q90;\nvec3 NearP_Q65;\nvec3 NearQ_Q65;\nfloat Distance_Q65;\nMin_Segment_Distance_B65(Left_Index_Q64,Left_Index_Middle_Q64,vPosition,cameraPosition,NearP_Q65,NearQ_Q65,Distance_Q65);\nvec3 NearP_Q63;\nvec3 NearQ_Q63;\nfloat Distance_Q63;\nMin_Segment_Distance_B65(Right_Index_Q64,Right_Index_Middle_Q64,vPosition,cameraPosition,NearP_Q63,NearQ_Q63,Distance_Q63);\n\nvec3 Reflected_Q47=reflect(Incident_Q39,New_Normal_Q79);\n\nvec4 Product_Q103=Linear_Q46*vec4(1,1,1,1);\nvec4 Result_Q132;\nRim_Light_B132(Normalized_Q107,Normalized_Q38,Incident_Q70,_Rim_Intensity_,_Rim_Texture_,Result_Q132);\n\nfloat Dot_Q72=dot(Incident_Q70,Normalized_Q71);\n\nfloat MaxAB_Q123=max(Reflect_Q122,Product_Q125);\nfloat NotInShadow_Q67;\n#if OCCLUSION_ENABLED\nFingerOcclusion_B67(_Width_,Distance_Q65,_Fuzz_,_Min_Fuzz_,vPosition,vBinormal,NearP_Q65,_Clip_Fade_,NotInShadow_Q67);\n#else\nNotInShadow_Q67=1.0;\n#endif\nfloat NotInShadow_Q68;\n#if OCCLUSION_ENABLED\nFingerOcclusion_B68(_Width_,Distance_Q63,_Fuzz_,_Min_Fuzz_,vPosition,vBinormal,NearP_Q63,_Clip_Fade_,NotInShadow_Q68);\n#else\nNotInShadow_Q68=1.0;\n#endif\nvec4 Reflected_Color_Q51;\nvec4 Indirect_Diffuse_Q51;\n#if ENV_ENABLE\nMapped_Environment_B51(_Reflection_Map_,_Indirect_Environment_,Reflected_Q47,Reflected_Color_Q51,Indirect_Diffuse_Q51);\n#else\nReflected_Color_Q51=vec4(0,0,0,1);\nIndirect_Diffuse_Q51=vec4(0,0,0,1);\n#endif\nvec4 Reflected_Color_Q50;\nvec4 Indirect_Color_Q50;\n#if SKY_ENABLED\nSky_Environment_B50(New_Normal_Q79,Reflected_Q47,Linear_Q43,Linear_Q44,Linear_Q45,_Horizon_Power_,Reflected_Color_Q50,Indirect_Color_Q50);\n#else\nReflected_Color_Q50=vec4(0,0,0,1);\nIndirect_Color_Q50=vec4(0,0,0,1);\n#endif\nfloat Hue_Q75;\nfloat Saturation_Q75;\nfloat Value_Q75;\nfloat Alpha_Q75;\nvec3 HSV_Q75;\nTo_HSV_B75(Product_Q103,Hue_Q75,Saturation_Q75,Value_Q75,Alpha_Q75,HSV_Q75);\nfloat Hue_Q127;\nfloat Saturation_Q127;\nfloat Value_Q127;\nfloat Alpha_Q127;\nvec3 HSV_Q127;\nTo_HSV_B75(Result_Q132,Hue_Q127,Saturation_Q127,Value_Q127,Alpha_Q127,HSV_Q127);\nfloat Result_Q110;\nCode_B110(Dot_Q72,Result_Q110);\n\nfloat AbsA_Q76=abs(Result_Q110);\n\nfloat MinAB_Q58=min(NotInShadow_Q67,NotInShadow_Q68);\n\nvec4 Sum_Q48=Reflected_Color_Q51+Reflected_Color_Q50;\n\nvec4 Sum_Q49=Indirect_Diffuse_Q51+Indirect_Color_Q50;\nvec3 HSV_Out_Q126;\nVaryHSV_B108(HSV_Q127,_Rim_Hue_Shift_,_Rim_Saturation_Shift_,_Rim_Value_Shift_,HSV_Out_Q126);\nfloat Out_Q114;\nRemap_Range_B114(-1.0,1.0,0.0,1.0,Result_Q110,Out_Q114);\n\nfloat Product_Q106;\nProduct_Q106=AbsA_Q76*_Hue_Shift_;\n\nfloat X_Q128;\nfloat Y_Q128;\nfloat Z_Q128;\nTo_XYZ_B74(HSV_Out_Q126,X_Q128,Y_Q128,Z_Q128);\n\nvec2 Vec2_Q112=vec2(Out_Q114,0.5);\nvec3 HSV_Out_Q108;\nVaryHSV_B108(HSV_Q75,Product_Q106,_Saturation_Shift_,_Value_Shift_,HSV_Out_Q108);\nvec4 Color_Q129;\nFrom_HSV_B73(X_Q128,Y_Q128,Z_Q128,0.0,Color_Q129);\n\nvec4 Color_Q111;\n#if IRIDESCENCE_ENABLED\nColor_Q111=texture(_Iridescence_Texture_,Vec2_Q112);\n#else\nColor_Q111=vec4(0,0,0,0);\n#endif\nfloat X_Q74;\nfloat Y_Q74;\nfloat Z_Q74;\nTo_XYZ_B74(HSV_Out_Q108,X_Q74,Y_Q74,Z_Q74);\n\nvec4 Result_Q131=_Rim_Intensity_*Color_Q129;\n\nvec4 Result_Q113=_Iridescence_Intensity_*Color_Q111;\nvec4 Color_Q73;\nFrom_HSV_B73(X_Q74,Y_Q74,Z_Q74,0.0,Color_Q73);\n\nvec4 Result_Q84=Result_Q91+(1.0-Result_Q91.a)*Color_Q73;\nvec4 Result_Q121;\nFragment_Main_B121(_Sun_Intensity_,_Sun_Theta_,_Sun_Phi_,New_Normal_Q79,Result_Q84,MaxAB_Q123,_Shininess_,Incident_Q39,_Horizon_Color_,_Sky_Color_,_Ground_Color_,_Indirect_Diffuse_,_Specular_,_Horizon_Power_,_Reflection_,Sum_Q48,Sum_Q49,_Sharpness_,Result_Q77,_Subsurface_,vec4(0,0,0,0),Result_Q131,Result_Q113,Result_Q121);\nvec4 Result_Q59;\nScale_RGB_B59(Result_Q121,MinAB_Q58,Result_Q59);\nvec4 sRGB_Q42;\nFastLinearTosRGB_B42(Result_Q59,sRGB_Q42);\n\nvec4 Result_Q31=Blob_Color_Q30+(1.0-Blob_Color_Q30.a)*sRGB_Q42;\n\nvec4 Result_Q40=Result_Q31; Result_Q40.a=1.0;\nvec4 Out_Color=Result_Q40;\nfloat Clip_Threshold=0.001;\nbool To_sRGB=false;\ngl_FragColor=Out_Color;\n}";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./3D/materials/mrdl/shaders/mrdlSliderBar.vertex.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"mrdlSliderBarVertexShader",function(){return a});var r=n("babylonjs/Misc/perfCounter"),i="mrdlSliderBarVertexShader",o="uniform mat4 world;\nuniform mat4 viewProjection;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\n#ifdef TANGENT\nattribute vec3 tangent;\n#else\nconst vec3 tangent=vec3(0.);\n#endif\nuniform float _Radius_;\nuniform float _Bevel_Front_;\nuniform float _Bevel_Front_Stretch_;\nuniform float _Bevel_Back_;\nuniform float _Bevel_Back_Stretch_;\nuniform float _Radius_Top_Left_;\nuniform float _Radius_Top_Right_;\nuniform float _Radius_Bottom_Left_;\nuniform float _Radius_Bottom_Right_;\nuniform bool _Bulge_Enabled_;\nuniform float _Bulge_Height_;\nuniform float _Bulge_Radius_;\nuniform float _Sun_Intensity_;\nuniform float _Sun_Theta_;\nuniform float _Sun_Phi_;\nuniform float _Indirect_Diffuse_;\nuniform vec4 _Albedo_;\nuniform float _Specular_;\nuniform float _Shininess_;\nuniform float _Sharpness_;\nuniform float _Subsurface_;\nuniform vec4 _Left_Color_;\nuniform vec4 _Right_Color_;\nuniform float _Reflection_;\nuniform float _Front_Reflect_;\nuniform float _Edge_Reflect_;\nuniform float _Power_;\n\nuniform vec4 _Sky_Color_;\nuniform vec4 _Horizon_Color_;\nuniform vec4 _Ground_Color_;\nuniform float _Horizon_Power_;\n\nuniform sampler2D _Reflection_Map_;\nuniform sampler2D _Indirect_Environment_;\n\nuniform float _Width_;\nuniform float _Fuzz_;\nuniform float _Min_Fuzz_;\nuniform float _Clip_Fade_;\nuniform float _Hue_Shift_;\nuniform float _Saturation_Shift_;\nuniform float _Value_Shift_;\n\nuniform vec3 _Blob_Position_;\nuniform float _Blob_Intensity_;\nuniform float _Blob_Near_Size_;\nuniform float _Blob_Far_Size_;\nuniform float _Blob_Near_Distance_;\nuniform float _Blob_Far_Distance_;\nuniform float _Blob_Fade_Length_;\nuniform float _Blob_Pulse_;\nuniform float _Blob_Fade_;\nuniform sampler2D _Blob_Texture_;\n\nuniform vec3 _Blob_Position_2_;\nuniform float _Blob_Near_Size_2_;\nuniform float _Blob_Pulse_2_;\nuniform float _Blob_Fade_2_;\nuniform vec3 _Left_Index_Pos_;\nuniform vec3 _Right_Index_Pos_;\nuniform vec3 _Left_Index_Middle_Pos_;\nuniform vec3 _Right_Index_Middle_Pos_;\n\nuniform sampler2D _Decal_;\nuniform vec2 _Decal_Scale_XY_;\nuniform bool _Decal_Front_Only_;\nuniform float _Rim_Intensity_;\nuniform sampler2D _Rim_Texture_;\nuniform float _Rim_Hue_Shift_;\nuniform float _Rim_Saturation_Shift_;\nuniform float _Rim_Value_Shift_;\n\nuniform float _Iridescence_Intensity_;\nuniform sampler2D _Iridescence_Texture_;\nuniform bool Use_Global_Left_Index;\nuniform bool Use_Global_Right_Index;\nuniform vec4 Global_Left_Index_Tip_Position;\nuniform vec4 Global_Right_Index_Tip_Position;\nuniform vec4 Global_Left_Thumb_Tip_Position;\nuniform vec4 Global_Right_Thumb_Tip_Position;\nuniform float Global_Left_Index_Tip_Proximity;\nuniform float Global_Right_Index_Tip_Proximity;\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec2 vUV;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec4 vColor;\nvarying vec4 vExtra1;\nvarying vec4 vExtra2;\nvarying vec4 vExtra3;\n\nvoid Object_To_World_Pos_B12(\nvec3 Pos_Object,\nout vec3 Pos_World)\n{\nPos_World=(world*vec4(Pos_Object,1.0)).xyz;\n}\n\n\nvoid Object_To_World_Normal_B32(\nvec3 Nrm_Object,\nout vec3 Nrm_World)\n{\nNrm_World=(vec4(Nrm_Object,0.0)).xyz;\n}\n\n\nvoid Blob_Vertex_B23(\nvec3 Position,\nvec3 Normal,\nvec3 Tangent,\nvec3 Bitangent,\nvec3 Blob_Position,\nfloat Intensity,\nfloat Blob_Near_Size,\nfloat Blob_Far_Size,\nfloat Blob_Near_Distance,\nfloat Blob_Far_Distance,\nfloat Blob_Fade_Length,\nfloat Blob_Pulse,\nfloat Blob_Fade,\nout vec4 Blob_Info)\n{\nvec3 blob=(Use_Global_Left_Index ? Global_Left_Index_Tip_Position.xyz : Blob_Position);\nvec3 delta=blob-Position;\nfloat dist=dot(Normal,delta);\nfloat lerpValue=clamp((abs(dist)-Blob_Near_Distance)/(Blob_Far_Distance-Blob_Near_Distance),0.0,1.0);\nfloat fadeValue=1.0-clamp((abs(dist)-Blob_Far_Distance)/Blob_Fade_Length,0.0,1.0);\nfloat size=Blob_Near_Size+(Blob_Far_Size-Blob_Near_Size)*lerpValue;\nvec2 blobXY=vec2(dot(delta,Tangent),dot(delta,Bitangent))/(0.0001+size);\nfloat Fade=fadeValue*Intensity*Blob_Fade;\nfloat Distance=(lerpValue*0.5+0.5)*(1.0-Blob_Pulse);\nBlob_Info=vec4(blobXY.x,blobXY.y,Distance,Fade);\n}\n\n\nvoid Blob_Vertex_B24(\nvec3 Position,\nvec3 Normal,\nvec3 Tangent,\nvec3 Bitangent,\nvec3 Blob_Position,\nfloat Intensity,\nfloat Blob_Near_Size,\nfloat Blob_Far_Size,\nfloat Blob_Near_Distance,\nfloat Blob_Far_Distance,\nfloat Blob_Fade_Length,\nfloat Blob_Pulse,\nfloat Blob_Fade,\nout vec4 Blob_Info)\n{\nvec3 blob=(Use_Global_Right_Index ? Global_Right_Index_Tip_Position.xyz : Blob_Position);\nvec3 delta=blob-Position;\nfloat dist=dot(Normal,delta);\nfloat lerpValue=clamp((abs(dist)-Blob_Near_Distance)/(Blob_Far_Distance-Blob_Near_Distance),0.0,1.0);\nfloat fadeValue=1.0-clamp((abs(dist)-Blob_Far_Distance)/Blob_Fade_Length,0.0,1.0);\nfloat size=Blob_Near_Size+(Blob_Far_Size-Blob_Near_Size)*lerpValue;\nvec2 blobXY=vec2(dot(delta,Tangent),dot(delta,Bitangent))/(0.0001+size);\nfloat Fade=fadeValue*Intensity*Blob_Fade;\nfloat Distance=(lerpValue*0.5+0.5)*(1.0-Blob_Pulse);\nBlob_Info=vec4(blobXY.x,blobXY.y,Distance,Fade);\n}\n\n\nvoid Move_Verts_B130(\nfloat Anisotropy,\nvec3 P,\nfloat Radius,\nfloat Bevel,\nvec3 Normal_Object,\nfloat ScaleZ,\nfloat Stretch,\nout vec3 New_P,\nout vec2 New_UV,\nout float Radial_Gradient,\nout vec3 Radial_Dir,\nout vec3 New_Normal)\n{\nvec2 UV=P.xy*2.0+0.5;\nvec2 center=clamp(UV,0.0,1.0);\nvec2 delta=UV-center;\nfloat deltad=(length(delta)*2.0);\nfloat f=(Bevel+(Radius-Bevel)*Stretch)/Radius;\n\nfloat innerd=clamp(deltad*2.0,0.0,1.0);\nfloat outerd=clamp(deltad*2.0-1.0,0.0,1.0);\nfloat bevelAngle=outerd*3.14159*0.5;\nfloat sinb=sin(bevelAngle);\nfloat cosb=cos(bevelAngle);\nfloat beveld=(1.0-f)*innerd+f*sinb;\nfloat br=outerd;\nvec2 r2=2.0*vec2(Radius/Anisotropy,Radius);\nfloat dir=P.z<0.0001 ? 1.0 : -1.0;\n\nNew_UV=center+r2*((0.5-center)+normalize(delta+vec2(0.0,0.000001))*beveld*0.5);\nNew_P=vec3(New_UV-0.5,P.z+dir*(1.0-cosb)*Bevel*ScaleZ);\nRadial_Gradient=clamp((deltad-0.5)*2.0,0.0,1.0);\nRadial_Dir=vec3(delta*r2,0.0);\nvec3 beveledNormal=cosb*Normal_Object+sinb*vec3(delta.x,delta.y,0.0);\nNew_Normal=Normal_Object.z==0.0 ? Normal_Object : beveledNormal;\n}\n\n\nvoid Object_To_World_Dir_B60(\nvec3 Dir_Object,\nout vec3 Normal_World,\nout vec3 Normal_World_N,\nout float Normal_Length)\n{\nNormal_World=(world*vec4(Dir_Object,0.0)).xyz;\nNormal_Length=length(Normal_World);\nNormal_World_N=Normal_World/Normal_Length;\n}\n\n\nvoid To_XYZ_B78(\nvec3 Vec3,\nout float X,\nout float Y,\nout float Z)\n{\nX=Vec3.x;\nY=Vec3.y;\nZ=Vec3.z;\n}\n\n\nvoid Conditional_Float_B93(\nbool Which,\nfloat If_True,\nfloat If_False,\nout float Result)\n{\nResult=Which ? If_True : If_False;\n}\n\n\nvoid Object_To_World_Dir_B28(\nvec3 Dir_Object,\nout vec3 Binormal_World,\nout vec3 Binormal_World_N,\nout float Binormal_Length)\n{\nBinormal_World=(world*vec4(Dir_Object,0.0)).xyz;\nBinormal_Length=length(Binormal_World);\nBinormal_World_N=Binormal_World/Binormal_Length;\n}\n\n\nvoid Pick_Radius_B69(\nfloat Radius,\nfloat Radius_Top_Left,\nfloat Radius_Top_Right,\nfloat Radius_Bottom_Left,\nfloat Radius_Bottom_Right,\nvec3 Position,\nout float Result)\n{\nbool whichY=Position.y>0.0;\nResult=Position.x<0.0 ? (whichY ? Radius_Top_Left : Radius_Bottom_Left) : (whichY ? Radius_Top_Right : Radius_Bottom_Right);\nResult*=Radius;\n}\n\n\nvoid Conditional_Float_B36(\nbool Which,\nfloat If_True,\nfloat If_False,\nout float Result)\n{\nResult=Which ? If_True : If_False;\n}\n\n\nvoid Greater_Than_B37(\nfloat Left,\nfloat Right,\nout bool Not_Greater_Than,\nout bool Greater_Than)\n{\nGreater_Than=Left>Right;\nNot_Greater_Than=!Greater_Than;\n}\n\n\nvoid Remap_Range_B105(\nfloat In_Min,\nfloat In_Max,\nfloat Out_Min,\nfloat Out_Max,\nfloat In,\nout float Out)\n{\nOut=mix(Out_Min,Out_Max,clamp((In-In_Min)/(In_Max-In_Min),0.0,1.0));\n}\n\nvoid main()\n{\n\nvec2 XY_Q85;\nXY_Q85=(uv-vec2(0.5,0.5))*_Decal_Scale_XY_+vec2(0.5,0.5);\n\nvec3 Tangent_World_Q27;\nvec3 Tangent_World_N_Q27;\nfloat Tangent_Length_Q27;\nTangent_World_Q27=(world*vec4(vec3(1,0,0),0.0)).xyz;\nTangent_Length_Q27=length(Tangent_World_Q27);\nTangent_World_N_Q27=Tangent_World_Q27/Tangent_Length_Q27;\nvec3 Normal_World_Q60;\nvec3 Normal_World_N_Q60;\nfloat Normal_Length_Q60;\nObject_To_World_Dir_B60(vec3(0,0,1),Normal_World_Q60,Normal_World_N_Q60,Normal_Length_Q60);\nfloat X_Q78;\nfloat Y_Q78;\nfloat Z_Q78;\nTo_XYZ_B78(position,X_Q78,Y_Q78,Z_Q78);\n\nvec3 Nrm_World_Q26;\nNrm_World_Q26=normalize((world*vec4(normal,0.0)).xyz);\nvec3 Binormal_World_Q28;\nvec3 Binormal_World_N_Q28;\nfloat Binormal_Length_Q28;\nObject_To_World_Dir_B28(vec3(0,1,0),Binormal_World_Q28,Binormal_World_N_Q28,Binormal_Length_Q28);\n\nfloat Anisotropy_Q29=Tangent_Length_Q27/Binormal_Length_Q28;\nfloat Result_Q69;\nPick_Radius_B69(_Radius_,_Radius_Top_Left_,_Radius_Top_Right_,_Radius_Bottom_Left_,_Radius_Bottom_Right_,position,Result_Q69);\n\nfloat Anisotropy_Q53=Binormal_Length_Q28/Normal_Length_Q60;\nbool Not_Greater_Than_Q37;\nbool Greater_Than_Q37;\nGreater_Than_B37(Z_Q78,0.0,Not_Greater_Than_Q37,Greater_Than_Q37);\n\nvec4 Linear_Q101;\nLinear_Q101.rgb=clamp(_Left_Color_.rgb*_Left_Color_.rgb,0.0,1.0);\nLinear_Q101.a=_Left_Color_.a;\n\nvec4 Linear_Q102;\nLinear_Q102.rgb=clamp(_Right_Color_.rgb*_Right_Color_.rgb,0.0,1.0);\nLinear_Q102.a=_Right_Color_.a;\n\nvec3 Difference_Q61=vec3(0,0,0)-Normal_World_N_Q60;\n\nvec4 Out_Color_Q34=vec4(X_Q78,Y_Q78,Z_Q78,1);\nfloat Result_Q36;\nConditional_Float_B36(Greater_Than_Q37,_Bevel_Back_,_Bevel_Front_,Result_Q36);\nfloat Result_Q94;\nConditional_Float_B36(Greater_Than_Q37,_Bevel_Back_Stretch_,_Bevel_Front_Stretch_,Result_Q94);\nvec3 New_P_Q130;\nvec2 New_UV_Q130;\nfloat Radial_Gradient_Q130;\nvec3 Radial_Dir_Q130;\nvec3 New_Normal_Q130;\nMove_Verts_B130(Anisotropy_Q29,position,Result_Q69,Result_Q36,normal,Anisotropy_Q53,Result_Q94,New_P_Q130,New_UV_Q130,Radial_Gradient_Q130,Radial_Dir_Q130,New_Normal_Q130);\n\nfloat X_Q98;\nfloat Y_Q98;\nX_Q98=New_UV_Q130.x;\nY_Q98=New_UV_Q130.y;\nvec3 Pos_World_Q12;\nObject_To_World_Pos_B12(New_P_Q130,Pos_World_Q12);\nvec3 Nrm_World_Q32;\nObject_To_World_Normal_B32(New_Normal_Q130,Nrm_World_Q32);\nvec4 Blob_Info_Q23;\n#if BLOB_ENABLE\nBlob_Vertex_B23(Pos_World_Q12,Nrm_World_Q26,Tangent_World_N_Q27,Binormal_World_N_Q28,_Blob_Position_,_Blob_Intensity_,_Blob_Near_Size_,_Blob_Far_Size_,_Blob_Near_Distance_,_Blob_Far_Distance_,_Blob_Fade_Length_,_Blob_Pulse_,_Blob_Fade_,Blob_Info_Q23);\n#else\nBlob_Info_Q23=vec4(0,0,0,0);\n#endif\nvec4 Blob_Info_Q24;\n#if BLOB_ENABLE_2\nBlob_Vertex_B24(Pos_World_Q12,Nrm_World_Q26,Tangent_World_N_Q27,Binormal_World_N_Q28,_Blob_Position_2_,_Blob_Intensity_,_Blob_Near_Size_2_,_Blob_Far_Size_,_Blob_Near_Distance_,_Blob_Far_Distance_,_Blob_Fade_Length_,_Blob_Pulse_2_,_Blob_Fade_2_,Blob_Info_Q24);\n#else\nBlob_Info_Q24=vec4(0,0,0,0);\n#endif\nfloat Out_Q105;\nRemap_Range_B105(0.0,1.0,0.0,1.0,X_Q98,Out_Q105);\nfloat X_Q86;\nfloat Y_Q86;\nfloat Z_Q86;\nTo_XYZ_B78(Nrm_World_Q32,X_Q86,Y_Q86,Z_Q86);\n\nvec4 Color_At_T_Q97=mix(Linear_Q101,Linear_Q102,Out_Q105);\n\nfloat Minus_F_Q87=-Z_Q86;\n\nfloat R_Q99;\nfloat G_Q99;\nfloat B_Q99;\nfloat A_Q99;\nR_Q99=Color_At_T_Q97.r; G_Q99=Color_At_T_Q97.g; B_Q99=Color_At_T_Q97.b; A_Q99=Color_At_T_Q97.a;\n\nfloat ClampF_Q88=clamp(0.0,Minus_F_Q87,1.0);\nfloat Result_Q93;\nConditional_Float_B93(_Decal_Front_Only_,ClampF_Q88,1.0,Result_Q93);\n\nvec4 Vec4_Q89=vec4(Result_Q93,Radial_Gradient_Q130,G_Q99,B_Q99);\nvec3 Position=Pos_World_Q12;\nvec3 Normal=Nrm_World_Q32;\nvec2 UV=XY_Q85;\nvec3 Tangent=Tangent_World_N_Q27;\nvec3 Binormal=Difference_Q61;\nvec4 Color=Out_Color_Q34;\nvec4 Extra1=Vec4_Q89;\nvec4 Extra2=Blob_Info_Q23;\nvec4 Extra3=Blob_Info_Q24;\ngl_Position=viewProjection*vec4(Position,1);\nvPosition=Position;\nvNormal=Normal;\nvUV=UV;\nvTangent=Tangent;\nvBinormal=Binormal;\nvColor=Color;\nvExtra1=Extra1;\nvExtra2=Extra2;\nvExtra3=Extra3;\n}";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./3D/materials/mrdl/shaders/mrdlSliderThumb.fragment.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"mrdlSliderThumbPixelShader",function(){return a});var r=n("babylonjs/Misc/perfCounter"),i="mrdlSliderThumbPixelShader",o="uniform vec3 cameraPosition;\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec2 vUV;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec4 vColor;\nvarying vec4 vExtra1;\nvarying vec4 vExtra2;\nvarying vec4 vExtra3;\nuniform float _Radius_;\nuniform float _Bevel_Front_;\nuniform float _Bevel_Front_Stretch_;\nuniform float _Bevel_Back_;\nuniform float _Bevel_Back_Stretch_;\nuniform float _Radius_Top_Left_;\nuniform float _Radius_Top_Right_;\nuniform float _Radius_Bottom_Left_;\nuniform float _Radius_Bottom_Right_;\nuniform bool _Bulge_Enabled_;\nuniform float _Bulge_Height_;\nuniform float _Bulge_Radius_;\nuniform float _Sun_Intensity_;\nuniform float _Sun_Theta_;\nuniform float _Sun_Phi_;\nuniform float _Indirect_Diffuse_;\nuniform vec4 _Albedo_;\nuniform float _Specular_;\nuniform float _Shininess_;\nuniform float _Sharpness_;\nuniform float _Subsurface_;\nuniform vec4 _Left_Color_;\nuniform vec4 _Right_Color_;\nuniform float _Reflection_;\nuniform float _Front_Reflect_;\nuniform float _Edge_Reflect_;\nuniform float _Power_;\n\nuniform vec4 _Sky_Color_;\nuniform vec4 _Horizon_Color_;\nuniform vec4 _Ground_Color_;\nuniform float _Horizon_Power_;\n\nuniform sampler2D _Reflection_Map_;\nuniform sampler2D _Indirect_Environment_;\n\nuniform float _Width_;\nuniform float _Fuzz_;\nuniform float _Min_Fuzz_;\nuniform float _Clip_Fade_;\nuniform float _Hue_Shift_;\nuniform float _Saturation_Shift_;\nuniform float _Value_Shift_;\n\nuniform vec3 _Blob_Position_;\nuniform float _Blob_Intensity_;\nuniform float _Blob_Near_Size_;\nuniform float _Blob_Far_Size_;\nuniform float _Blob_Near_Distance_;\nuniform float _Blob_Far_Distance_;\nuniform float _Blob_Fade_Length_;\nuniform float _Blob_Pulse_;\nuniform float _Blob_Fade_;\nuniform sampler2D _Blob_Texture_;\n\nuniform vec3 _Blob_Position_2_;\nuniform float _Blob_Near_Size_2_;\nuniform float _Blob_Pulse_2_;\nuniform float _Blob_Fade_2_;\nuniform vec3 _Left_Index_Pos_;\nuniform vec3 _Right_Index_Pos_;\nuniform vec3 _Left_Index_Middle_Pos_;\nuniform vec3 _Right_Index_Middle_Pos_;\n\nuniform sampler2D _Decal_;\nuniform vec2 _Decal_Scale_XY_;\nuniform bool _Decal_Front_Only_;\nuniform float _Rim_Intensity_;\nuniform sampler2D _Rim_Texture_;\nuniform float _Rim_Hue_Shift_;\nuniform float _Rim_Saturation_Shift_;\nuniform float _Rim_Value_Shift_;\n\nuniform float _Iridescence_Intensity_;\nuniform sampler2D _Iridescence_Texture_;\nuniform bool Use_Global_Left_Index;\nuniform bool Use_Global_Right_Index;\nuniform vec4 Global_Left_Index_Tip_Position;\nuniform vec4 Global_Right_Index_Tip_Position;\nuniform vec4 Global_Left_Thumb_Tip_Position;\nuniform vec4 Global_Right_Thumb_Tip_Position;\nuniform vec4 Global_Left_Index_Middle_Position;\nuniform vec4 Global_Right_Index_Middle_Position;\nuniform float Global_Left_Index_Tip_Proximity;\nuniform float Global_Right_Index_Tip_Proximity;\n\nvoid Blob_Fragment_B180(\nsampler2D Blob_Texture,\nvec4 Blob_Info1,\nvec4 Blob_Info2,\nout vec4 Blob_Color)\n{\nfloat k1=dot(Blob_Info1.xy,Blob_Info1.xy);\nfloat k2=dot(Blob_Info2.xy,Blob_Info2.xy);\nvec3 closer=k1<k2 ? vec3(k1,Blob_Info1.z,Blob_Info1.w) : vec3(k2,Blob_Info2.z,Blob_Info2.w);\nBlob_Color=closer.z*texture(Blob_Texture,vec2(vec2(sqrt(closer.x),closer.y).x,1.0-vec2(sqrt(closer.x),closer.y).y))*clamp(1.0-closer.x,0.0,1.0);\n}\n\n\nvoid FastLinearTosRGB_B192(\nvec4 Linear,\nout vec4 sRGB)\n{\nsRGB.rgb=sqrt(clamp(Linear.rgb,0.0,1.0));\nsRGB.a=Linear.a;\n}\n\n\nvoid Scale_RGB_B209(\nvec4 Color,\nfloat Scalar,\nout vec4 Result)\n{\nResult=vec4(Scalar,Scalar,Scalar,1)*Color;\n}\n\n\nvoid Fragment_Main_B271(\nfloat Sun_Intensity,\nfloat Sun_Theta,\nfloat Sun_Phi,\nvec3 Normal,\nvec4 Albedo,\nfloat Fresnel_Reflect,\nfloat Shininess,\nvec3 Incident,\nvec4 Horizon_Color,\nvec4 Sky_Color,\nvec4 Ground_Color,\nfloat Indirect_Diffuse,\nfloat Specular,\nfloat Horizon_Power,\nfloat Reflection,\nvec4 Reflection_Sample,\nvec4 Indirect_Sample,\nfloat Sharpness,\nfloat SSS,\nfloat Subsurface,\nvec4 Translucence,\nvec4 Rim_Light,\nvec4 Iridescence,\nout vec4 Result)\n{\nfloat theta=Sun_Theta*2.0*3.14159;\nfloat phi=Sun_Phi*3.14159;\nvec3 lightDir=vec3(cos(phi)*cos(theta),sin(phi),cos(phi)*sin(theta));\nfloat NdotL=max(dot(lightDir,Normal),0.0);\n\nvec3 R=reflect(Incident,Normal);\nfloat RdotL=max(0.0,dot(R,lightDir));\nfloat specular=pow(RdotL,Shininess);\nspecular=mix(specular,smoothstep(0.495*Sharpness,1.0-0.495*Sharpness,specular),Sharpness);\nvec4 gi=mix(Ground_Color,Sky_Color,Normal.y*0.5+0.5);\n\nResult=((Sun_Intensity*NdotL+Indirect_Sample*Indirect_Diffuse+Translucence)*(1.0+SSS*Subsurface))*Albedo*(1.0-Fresnel_Reflect)+(Sun_Intensity*specular*Specular+Fresnel_Reflect*Reflection*Reflection_Sample)+Fresnel_Reflect*Rim_Light+Iridescence;\n}\n\n\nvoid Bulge_B229(\nbool Enabled,\nvec3 Normal,\nvec3 Tangent,\nfloat Bulge_Height,\nvec4 UV,\nfloat Bulge_Radius,\nvec3 ButtonN,\nout vec3 New_Normal)\n{\nvec2 xy=clamp(UV.xy*2.0,vec2(-1,-1),vec2(1,1));\nvec3 B=(cross(Normal,Tangent));\n\n\n\n\nfloat k=-clamp(1.0-length(xy)/Bulge_Radius,0.0,1.0)*Bulge_Height;\nk=sin(k*3.14159*0.5);\nk*=smoothstep(0.9998,0.9999,abs(dot(ButtonN,Normal)));\nNew_Normal=Normal*sqrt(1.0-k*k)+(xy.x*Tangent+xy.y*B)*k;\nNew_Normal=Enabled ? New_Normal : Normal;\n}\n\n\nvoid SSS_B227(\nvec3 ButtonN,\nvec3 Normal,\nvec3 Incident,\nout float Result)\n{\nfloat NdotI=abs(dot(Normal,Incident));\nfloat BdotI=abs(dot(ButtonN,Incident));\nResult=(abs(NdotI-BdotI));\n\n}\n\n\nvoid FingerOcclusion_B217(\nfloat Width,\nfloat DistToCenter,\nfloat Fuzz,\nfloat Min_Fuzz,\nvec3 Position,\nvec3 Forward,\nvec3 Nearest,\nfloat Fade_Out,\nout float NotInShadow)\n{\nfloat d=dot((Nearest-Position),Forward);\nfloat sh=smoothstep(Width*0.5,Width*0.5+Fuzz*max(d,0.0)+Min_Fuzz,DistToCenter);\nNotInShadow=1.0-(1.0-sh)*smoothstep(-Fade_Out,0.0,d);\n}\n\n\nvoid FingerOcclusion_B218(\nfloat Width,\nfloat DistToCenter,\nfloat Fuzz,\nfloat Min_Fuzz,\nvec3 Position,\nvec3 Forward,\nvec3 Nearest,\nfloat Fade_Out,\nout float NotInShadow)\n{\nfloat d=dot((Nearest-Position),Forward);\nfloat sh=smoothstep(Width*0.5,Width*0.5+Fuzz*max(d,0.0)+Min_Fuzz,DistToCenter);\nNotInShadow=1.0-(1.0-sh)*smoothstep(-Fade_Out,0.0,d);\n}\n\n\nvoid Scale_Color_B241(\nvec4 Color,\nfloat Scalar,\nout vec4 Result)\n{\nResult=Scalar*Color;\n}\n\n\nvoid From_HSV_B223(\nfloat Hue,\nfloat Saturation,\nfloat Value,\nfloat Alpha,\nout vec4 Color)\n{\n\nvec4 K=vec4(1.0,2.0/3.0,1.0/3.0,3.0);\nvec3 p=abs(fract(vec3(Hue,Hue,Hue)+K.xyz)*6.0-K.www);\nColor.rgb=Value*mix(K.xxx,clamp(p-K.xxx,0.0,1.0),Saturation);\nColor.a=Alpha;\n}\n\n\nvoid Fast_Fresnel_B272(\nfloat Front_Reflect,\nfloat Edge_Reflect,\nfloat Power,\nvec3 Normal,\nvec3 Incident,\nout float Transmit,\nout float Reflect)\n{\nfloat d=max(-dot(Incident,Normal),0.0);\nReflect=Front_Reflect+(Edge_Reflect-Front_Reflect)*pow(1.0-d,Power);\nTransmit=1.0-Reflect;\n}\n\n\nvoid Mapped_Environment_B201(\nsampler2D Reflected_Environment,\nsampler2D Indirect_Environment,\nvec3 Dir,\nout vec4 Reflected_Color,\nout vec4 Indirect_Diffuse)\n{\n\nReflected_Color=texture(Reflected_Environment,vec2(atan(Dir.z,Dir.x)/3.14159*0.5,asin(Dir.y)/3.14159+0.5));\nIndirect_Diffuse=texture(Indirect_Environment,vec2(atan(Dir.z,Dir.x)/3.14159*0.5,asin(Dir.y)/3.14159+0.5));\n}\n\n\nvec4 SampleEnv_Bid200(vec3 D,vec4 S,vec4 H,vec4 G,float exponent)\n{\nfloat k=pow(abs(D.y),exponent);\nvec4 C;\nif (D.y>0.0) {\nC=mix(H,S,k);\n} else {\nC=mix(H,G,k);\n}\nreturn C;\n}\nvoid Sky_Environment_B200(\nvec3 Normal,\nvec3 Reflected,\nvec4 Sky_Color,\nvec4 Horizon_Color,\nvec4 Ground_Color,\nfloat Horizon_Power,\nout vec4 Reflected_Color,\nout vec4 Indirect_Color)\n{\n\nReflected_Color=SampleEnv_Bid200(Reflected,Sky_Color,Horizon_Color,Ground_Color,Horizon_Power);\nIndirect_Color=mix(Ground_Color,Sky_Color,Normal.y*0.5+0.5);\n}\n\n\nvoid Min_Segment_Distance_B215(\nvec3 P0,\nvec3 P1,\nvec3 Q0,\nvec3 Q1,\nout vec3 NearP,\nout vec3 NearQ,\nout float Distance)\n{\nvec3 u=P1-P0;\nvec3 v=Q1-Q0;\nvec3 w=P0-Q0;\nfloat a=dot(u,u);\nfloat b=dot(u,v);\nfloat c=dot(v,v);\nfloat d=dot(u,w);\nfloat e=dot(v,w);\nfloat D=a*c-b*b;\nfloat sD=D;\nfloat tD=D;\nfloat sc,sN,tc,tN;\nif (D<0.00001) {\nsN=0.0;\nsD=1.0;\ntN=e;\ntD=c;\n} else {\nsN=(b*e-c*d);\ntN=(a*e-b*d);\nif (sN<0.0) {\nsN=0.0;\ntN=e;\ntD=c;\n} else if (sN>sD) {\nsN=sD;\ntN=e+b;\ntD=c;\n}\n}\nif (tN<0.0) {\ntN=0.0;\nif (-d<0.0) {\nsN=0.0;\n} else if (-d>a) {\nsN=sD;\n} else {\nsN=-d;\nsD=a;\n}\n} else if (tN>tD) {\ntN=tD;\nif ((-d+b)<0.0) {\nsN=0.0;\n} else if ((-d+b)>a) {\nsN=sD;\n} else {\nsN=(-d+b);\nsD=a;\n}\n}\nsc=abs(sN)<0.000001 ? 0.0 : sN/sD;\ntc=abs(tN)<0.000001 ? 0.0 : tN/tD;\nNearP=P0+sc*u;\nNearQ=Q0+tc*v;\nDistance=distance(NearP,NearQ);\n}\n\n\nvoid To_XYZ_B224(\nvec3 Vec3,\nout float X,\nout float Y,\nout float Z)\n{\nX=Vec3.x;\nY=Vec3.y;\nZ=Vec3.z;\n}\n\n\nvoid Finger_Positions_B214(\nvec3 Left_Index_Pos,\nvec3 Right_Index_Pos,\nvec3 Left_Index_Middle_Pos,\nvec3 Right_Index_Middle_Pos,\nout vec3 Left_Index,\nout vec3 Right_Index,\nout vec3 Left_Index_Middle,\nout vec3 Right_Index_Middle)\n{\nLeft_Index=(Use_Global_Left_Index ? Global_Left_Index_Tip_Position.xyz : Left_Index_Pos);\nRight_Index=(Use_Global_Right_Index ? Global_Right_Index_Tip_Position.xyz : Right_Index_Pos);\nLeft_Index_Middle=(Use_Global_Left_Index ? Global_Left_Index_Middle_Position.xyz : Left_Index_Middle_Pos);\nRight_Index_Middle=(Use_Global_Right_Index ? Global_Right_Index_Middle_Position.xyz : Right_Index_Middle_Pos);\n}\n\n\nvoid VaryHSV_B258(\nvec3 HSV_In,\nfloat Hue_Shift,\nfloat Saturation_Shift,\nfloat Value_Shift,\nout vec3 HSV_Out)\n{\nHSV_Out=vec3(fract(HSV_In.x+Hue_Shift),clamp(HSV_In.y+Saturation_Shift,0.0,1.0),clamp(HSV_In.z+Value_Shift,0.0,1.0));\n}\n\n\nvoid Remap_Range_B264(\nfloat In_Min,\nfloat In_Max,\nfloat Out_Min,\nfloat Out_Max,\nfloat In,\nout float Out)\n{\nOut=mix(Out_Min,Out_Max,clamp((In-In_Min)/(In_Max-In_Min),0.0,1.0));\n}\n\n\nvoid To_HSV_B225(\nvec4 Color,\nout float Hue,\nout float Saturation,\nout float Value,\nout float Alpha,\nout vec3 HSV)\n{\n\nvec4 K=vec4(0.0,-1.0/3.0,2.0/3.0,-1.0);\nvec4 p=Color.g<Color.b ? vec4(Color.bg,K.wz) : vec4(Color.gb,K.xy);\nvec4 q=Color.r<p.x ? vec4(p.xyw,Color.r) : vec4(Color.r,p.yzx);\nfloat d=q.x-min(q.w,q.y);\nfloat e=1.0e-10;\nHue=abs(q.z+(q.w-q.y)/(6.0*d+e));\nSaturation=d/(q.x+e);\nValue=q.x;\nAlpha=Color.a;\nHSV=vec3(Hue,Saturation,Value);\n}\n\n\nvoid Code_B260(\nfloat X,\nout float Result)\n{\nResult=(acos(X)/3.14159-0.5)*2.0;\n}\n\n\nvoid Rim_Light_B282(\nvec3 Front,\nvec3 Normal,\nvec3 Incident,\nfloat Rim_Intensity,\nsampler2D Texture,\nout vec4 Result)\n{\nvec3 R=reflect(Incident,Normal);\nfloat RdotF=dot(R,Front);\nfloat RdotL=sqrt(1.0-RdotF*RdotF);\nvec2 UV=vec2(R.y*0.5+0.5,0.5);\nvec4 Color=texture(Texture,UV);\nResult=Color;\n}\n\nvoid main()\n{\nvec4 Blob_Color_Q180;\n#if BLOB_ENABLE\nBlob_Fragment_B180(_Blob_Texture_,vExtra2,vExtra3,Blob_Color_Q180);\n#else\nBlob_Color_Q180=vec4(0,0,0,0);\n#endif\n\nvec3 Incident_Q189=normalize(vPosition-cameraPosition);\n\nvec3 Normalized_Q188=normalize(vNormal);\n\nvec3 Normalized_Q221=normalize(vTangent);\n\nvec4 Color_Q233;\n#if DECAL_ENABLE\nColor_Q233=texture(_Decal_,vUV);\n#else\nColor_Q233=vec4(0,0,0,0);\n#endif\n\nfloat X_Q240;\nfloat Y_Q240;\nfloat Z_Q240;\nfloat W_Q240;\nX_Q240=vExtra1.x;\nY_Q240=vExtra1.y;\nZ_Q240=vExtra1.z;\nW_Q240=vExtra1.w;\n\nvec4 Linear_Q193;\nLinear_Q193.rgb=clamp(_Sky_Color_.rgb*_Sky_Color_.rgb,0.0,1.0);\nLinear_Q193.a=_Sky_Color_.a;\n\nvec4 Linear_Q194;\nLinear_Q194.rgb=clamp(_Horizon_Color_.rgb*_Horizon_Color_.rgb,0.0,1.0);\nLinear_Q194.a=_Horizon_Color_.a;\n\nvec4 Linear_Q195;\nLinear_Q195.rgb=clamp(_Ground_Color_.rgb*_Ground_Color_.rgb,0.0,1.0);\nLinear_Q195.a=_Ground_Color_.a;\nvec3 Left_Index_Q214;\nvec3 Right_Index_Q214;\nvec3 Left_Index_Middle_Q214;\nvec3 Right_Index_Middle_Q214;\nFinger_Positions_B214(_Left_Index_Pos_,_Right_Index_Pos_,_Left_Index_Middle_Pos_,_Right_Index_Middle_Pos_,Left_Index_Q214,Right_Index_Q214,Left_Index_Middle_Q214,Right_Index_Middle_Q214);\n\nvec4 Linear_Q196;\nLinear_Q196.rgb=clamp(_Albedo_.rgb*_Albedo_.rgb,0.0,1.0);\nLinear_Q196.a=_Albedo_.a;\n\nvec3 Normalized_Q257=normalize(vBinormal);\n\nvec3 Incident_Q220=normalize(vPosition-cameraPosition);\nvec3 New_Normal_Q229;\nBulge_B229(_Bulge_Enabled_,Normalized_Q188,Normalized_Q221,_Bulge_Height_,vColor,_Bulge_Radius_,vBinormal,New_Normal_Q229);\nfloat Result_Q227;\nSSS_B227(vBinormal,New_Normal_Q229,Incident_Q189,Result_Q227);\nvec4 Result_Q241;\nScale_Color_B241(Color_Q233,X_Q240,Result_Q241);\nfloat Transmit_Q272;\nfloat Reflect_Q272;\nFast_Fresnel_B272(_Front_Reflect_,_Edge_Reflect_,_Power_,New_Normal_Q229,Incident_Q189,Transmit_Q272,Reflect_Q272);\n\nfloat Product_Q275=Y_Q240*Y_Q240;\nvec3 NearP_Q215;\nvec3 NearQ_Q215;\nfloat Distance_Q215;\nMin_Segment_Distance_B215(Left_Index_Q214,Left_Index_Middle_Q214,vPosition,cameraPosition,NearP_Q215,NearQ_Q215,Distance_Q215);\nvec3 NearP_Q213;\nvec3 NearQ_Q213;\nfloat Distance_Q213;\nMin_Segment_Distance_B215(Right_Index_Q214,Right_Index_Middle_Q214,vPosition,cameraPosition,NearP_Q213,NearQ_Q213,Distance_Q213);\n\nvec3 Reflected_Q197=reflect(Incident_Q189,New_Normal_Q229);\n\nvec4 Product_Q253=Linear_Q196*vec4(1,1,1,1);\nvec4 Result_Q282;\nRim_Light_B282(Normalized_Q257,Normalized_Q188,Incident_Q220,_Rim_Intensity_,_Rim_Texture_,Result_Q282);\n\nfloat Dot_Q222=dot(Incident_Q220,Normalized_Q221);\n\nfloat MaxAB_Q273=max(Reflect_Q272,Product_Q275);\nfloat NotInShadow_Q217;\n#if OCCLUSION_ENABLED\nFingerOcclusion_B217(_Width_,Distance_Q215,_Fuzz_,_Min_Fuzz_,vPosition,vBinormal,NearP_Q215,_Clip_Fade_,NotInShadow_Q217);\n#else\nNotInShadow_Q217=1.0;\n#endif\nfloat NotInShadow_Q218;\n#if OCCLUSION_ENABLED\nFingerOcclusion_B218(_Width_,Distance_Q213,_Fuzz_,_Min_Fuzz_,vPosition,vBinormal,NearP_Q213,_Clip_Fade_,NotInShadow_Q218);\n#else\nNotInShadow_Q218=1.0;\n#endif\nvec4 Reflected_Color_Q201;\nvec4 Indirect_Diffuse_Q201;\n#if ENV_ENABLE\nMapped_Environment_B201(_Reflection_Map_,_Indirect_Environment_,Reflected_Q197,Reflected_Color_Q201,Indirect_Diffuse_Q201);\n#else\nReflected_Color_Q201=vec4(0,0,0,1);\nIndirect_Diffuse_Q201=vec4(0,0,0,1);\n#endif\nvec4 Reflected_Color_Q200;\nvec4 Indirect_Color_Q200;\n#if SKY_ENABLED\nSky_Environment_B200(New_Normal_Q229,Reflected_Q197,Linear_Q193,Linear_Q194,Linear_Q195,_Horizon_Power_,Reflected_Color_Q200,Indirect_Color_Q200);\n#else\nReflected_Color_Q200=vec4(0,0,0,1);\nIndirect_Color_Q200=vec4(0,0,0,1);\n#endif\nfloat Hue_Q225;\nfloat Saturation_Q225;\nfloat Value_Q225;\nfloat Alpha_Q225;\nvec3 HSV_Q225;\nTo_HSV_B225(Product_Q253,Hue_Q225,Saturation_Q225,Value_Q225,Alpha_Q225,HSV_Q225);\nfloat Hue_Q277;\nfloat Saturation_Q277;\nfloat Value_Q277;\nfloat Alpha_Q277;\nvec3 HSV_Q277;\nTo_HSV_B225(Result_Q282,Hue_Q277,Saturation_Q277,Value_Q277,Alpha_Q277,HSV_Q277);\nfloat Result_Q260;\nCode_B260(Dot_Q222,Result_Q260);\n\nfloat AbsA_Q226=abs(Result_Q260);\n\nfloat MinAB_Q208=min(NotInShadow_Q217,NotInShadow_Q218);\n\nvec4 Sum_Q198=Reflected_Color_Q201+Reflected_Color_Q200;\n\nvec4 Sum_Q199=Indirect_Diffuse_Q201+Indirect_Color_Q200;\nvec3 HSV_Out_Q276;\nVaryHSV_B258(HSV_Q277,_Rim_Hue_Shift_,_Rim_Saturation_Shift_,_Rim_Value_Shift_,HSV_Out_Q276);\nfloat Out_Q264;\nRemap_Range_B264(-1.0,1.0,0.0,1.0,Result_Q260,Out_Q264);\n\nfloat Product_Q256;\nProduct_Q256=AbsA_Q226*_Hue_Shift_;\n\nfloat X_Q278;\nfloat Y_Q278;\nfloat Z_Q278;\nTo_XYZ_B224(HSV_Out_Q276,X_Q278,Y_Q278,Z_Q278);\n\nvec2 Vec2_Q262=vec2(Out_Q264,0.5);\nvec3 HSV_Out_Q258;\nVaryHSV_B258(HSV_Q225,Product_Q256,_Saturation_Shift_,_Value_Shift_,HSV_Out_Q258);\nvec4 Color_Q279;\nFrom_HSV_B223(X_Q278,Y_Q278,Z_Q278,0.0,Color_Q279);\n\nvec4 Color_Q261;\n#if IRIDESCENCE_ENABLED\nColor_Q261=texture(_Iridescence_Texture_,Vec2_Q262);\n#else\nColor_Q261=vec4(0,0,0,0);\n#endif\nfloat X_Q224;\nfloat Y_Q224;\nfloat Z_Q224;\nTo_XYZ_B224(HSV_Out_Q258,X_Q224,Y_Q224,Z_Q224);\n\nvec4 Result_Q281=_Rim_Intensity_*Color_Q279;\n\nvec4 Result_Q263=_Iridescence_Intensity_*Color_Q261;\nvec4 Color_Q223;\nFrom_HSV_B223(X_Q224,Y_Q224,Z_Q224,0.0,Color_Q223);\n\nvec4 Result_Q234=Result_Q241+(1.0-Result_Q241.a)*Color_Q223;\nvec4 Result_Q271;\nFragment_Main_B271(_Sun_Intensity_,_Sun_Theta_,_Sun_Phi_,New_Normal_Q229,Result_Q234,MaxAB_Q273,_Shininess_,Incident_Q189,_Horizon_Color_,_Sky_Color_,_Ground_Color_,_Indirect_Diffuse_,_Specular_,_Horizon_Power_,_Reflection_,Sum_Q198,Sum_Q199,_Sharpness_,Result_Q227,_Subsurface_,vec4(0,0,0,0),Result_Q281,Result_Q263,Result_Q271);\nvec4 Result_Q209;\nScale_RGB_B209(Result_Q271,MinAB_Q208,Result_Q209);\nvec4 sRGB_Q192;\nFastLinearTosRGB_B192(Result_Q209,sRGB_Q192);\n\nvec4 Result_Q181=Blob_Color_Q180+(1.0-Blob_Color_Q180.a)*sRGB_Q192;\n\nvec4 Result_Q190=Result_Q181; Result_Q190.a=1.0;\nvec4 Out_Color=Result_Q190;\nfloat Clip_Threshold=0.001;\nbool To_sRGB=false;\ngl_FragColor=Out_Color;\n}";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./3D/materials/mrdl/shaders/mrdlSliderThumb.vertex.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"mrdlSliderThumbVertexShader",function(){return a});var r=n("babylonjs/Misc/perfCounter"),i="mrdlSliderThumbVertexShader",o="uniform mat4 world;\nuniform mat4 viewProjection;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\n#ifdef TANGENT\nattribute vec3 tangent;\n#else\nconst vec3 tangent=vec3(0.);\n#endif\nuniform float _Radius_;\nuniform float _Bevel_Front_;\nuniform float _Bevel_Front_Stretch_;\nuniform float _Bevel_Back_;\nuniform float _Bevel_Back_Stretch_;\nuniform float _Radius_Top_Left_;\nuniform float _Radius_Top_Right_;\nuniform float _Radius_Bottom_Left_;\nuniform float _Radius_Bottom_Right_;\nuniform bool _Bulge_Enabled_;\nuniform float _Bulge_Height_;\nuniform float _Bulge_Radius_;\nuniform float _Sun_Intensity_;\nuniform float _Sun_Theta_;\nuniform float _Sun_Phi_;\nuniform float _Indirect_Diffuse_;\nuniform vec4 _Albedo_;\nuniform float _Specular_;\nuniform float _Shininess_;\nuniform float _Sharpness_;\nuniform float _Subsurface_;\nuniform vec4 _Left_Color_;\nuniform vec4 _Right_Color_;\nuniform float _Reflection_;\nuniform float _Front_Reflect_;\nuniform float _Edge_Reflect_;\nuniform float _Power_;\n\nuniform vec4 _Sky_Color_;\nuniform vec4 _Horizon_Color_;\nuniform vec4 _Ground_Color_;\nuniform float _Horizon_Power_;\n\nuniform sampler2D _Reflection_Map_;\nuniform sampler2D _Indirect_Environment_;\n\nuniform float _Width_;\nuniform float _Fuzz_;\nuniform float _Min_Fuzz_;\nuniform float _Clip_Fade_;\nuniform float _Hue_Shift_;\nuniform float _Saturation_Shift_;\nuniform float _Value_Shift_;\n\nuniform vec3 _Blob_Position_;\nuniform float _Blob_Intensity_;\nuniform float _Blob_Near_Size_;\nuniform float _Blob_Far_Size_;\nuniform float _Blob_Near_Distance_;\nuniform float _Blob_Far_Distance_;\nuniform float _Blob_Fade_Length_;\nuniform float _Blob_Pulse_;\nuniform float _Blob_Fade_;\nuniform sampler2D _Blob_Texture_;\n\nuniform vec3 _Blob_Position_2_;\nuniform float _Blob_Near_Size_2_;\nuniform float _Blob_Pulse_2_;\nuniform float _Blob_Fade_2_;\nuniform vec3 _Left_Index_Pos_;\nuniform vec3 _Right_Index_Pos_;\nuniform vec3 _Left_Index_Middle_Pos_;\nuniform vec3 _Right_Index_Middle_Pos_;\n\nuniform sampler2D _Decal_;\nuniform vec2 _Decal_Scale_XY_;\nuniform bool _Decal_Front_Only_;\nuniform float _Rim_Intensity_;\nuniform sampler2D _Rim_Texture_;\nuniform float _Rim_Hue_Shift_;\nuniform float _Rim_Saturation_Shift_;\nuniform float _Rim_Value_Shift_;\n\nuniform float _Iridescence_Intensity_;\nuniform sampler2D _Iridescence_Texture_;\nuniform bool Use_Global_Left_Index;\nuniform bool Use_Global_Right_Index;\nuniform vec4 Global_Left_Index_Tip_Position;\nuniform vec4 Global_Right_Index_Tip_Position;\nuniform vec4 Global_Left_Thumb_Tip_Position;\nuniform vec4 Global_Right_Thumb_Tip_Position;\nuniform float Global_Left_Index_Tip_Proximity;\nuniform float Global_Right_Index_Tip_Proximity;\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec2 vUV;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec4 vColor;\nvarying vec4 vExtra1;\nvarying vec4 vExtra2;\nvarying vec4 vExtra3;\n\nvoid Object_To_World_Pos_B162(\nvec3 Pos_Object,\nout vec3 Pos_World)\n{\nPos_World=(world*vec4(Pos_Object,1.0)).xyz;\n}\n\n\nvoid Object_To_World_Normal_B182(\nvec3 Nrm_Object,\nout vec3 Nrm_World)\n{\nNrm_World=(vec4(Nrm_Object,0.0)).xyz;\n}\n\n\nvoid Blob_Vertex_B173(\nvec3 Position,\nvec3 Normal,\nvec3 Tangent,\nvec3 Bitangent,\nvec3 Blob_Position,\nfloat Intensity,\nfloat Blob_Near_Size,\nfloat Blob_Far_Size,\nfloat Blob_Near_Distance,\nfloat Blob_Far_Distance,\nfloat Blob_Fade_Length,\nfloat Blob_Pulse,\nfloat Blob_Fade,\nout vec4 Blob_Info)\n{\nvec3 blob=(Use_Global_Left_Index ? Global_Left_Index_Tip_Position.xyz : Blob_Position);\nvec3 delta=blob-Position;\nfloat dist=dot(Normal,delta);\nfloat lerpValue=clamp((abs(dist)-Blob_Near_Distance)/(Blob_Far_Distance-Blob_Near_Distance),0.0,1.0);\nfloat fadeValue=1.0-clamp((abs(dist)-Blob_Far_Distance)/Blob_Fade_Length,0.0,1.0);\nfloat size=Blob_Near_Size+(Blob_Far_Size-Blob_Near_Size)*lerpValue;\nvec2 blobXY=vec2(dot(delta,Tangent),dot(delta,Bitangent))/(0.0001+size);\nfloat Fade=fadeValue*Intensity*Blob_Fade;\nfloat Distance=(lerpValue*0.5+0.5)*(1.0-Blob_Pulse);\nBlob_Info=vec4(blobXY.x,blobXY.y,Distance,Fade);\n}\n\n\nvoid Blob_Vertex_B174(\nvec3 Position,\nvec3 Normal,\nvec3 Tangent,\nvec3 Bitangent,\nvec3 Blob_Position,\nfloat Intensity,\nfloat Blob_Near_Size,\nfloat Blob_Far_Size,\nfloat Blob_Near_Distance,\nfloat Blob_Far_Distance,\nfloat Blob_Fade_Length,\nfloat Blob_Pulse,\nfloat Blob_Fade,\nout vec4 Blob_Info)\n{\nvec3 blob=(Use_Global_Right_Index ? Global_Right_Index_Tip_Position.xyz : Blob_Position);\nvec3 delta=blob-Position;\nfloat dist=dot(Normal,delta);\nfloat lerpValue=clamp((abs(dist)-Blob_Near_Distance)/(Blob_Far_Distance-Blob_Near_Distance),0.0,1.0);\nfloat fadeValue=1.0-clamp((abs(dist)-Blob_Far_Distance)/Blob_Fade_Length,0.0,1.0);\nfloat size=Blob_Near_Size+(Blob_Far_Size-Blob_Near_Size)*lerpValue;\nvec2 blobXY=vec2(dot(delta,Tangent),dot(delta,Bitangent))/(0.0001+size);\nfloat Fade=fadeValue*Intensity*Blob_Fade;\nfloat Distance=(lerpValue*0.5+0.5)*(1.0-Blob_Pulse);\nBlob_Info=vec4(blobXY.x,blobXY.y,Distance,Fade);\n}\n\n\nvoid Move_Verts_B280(\nfloat Anisotropy,\nvec3 P,\nfloat Radius,\nfloat Bevel,\nvec3 Normal_Object,\nfloat ScaleZ,\nfloat Stretch,\nout vec3 New_P,\nout vec2 New_UV,\nout float Radial_Gradient,\nout vec3 Radial_Dir,\nout vec3 New_Normal)\n{\nvec2 UV=P.xy*2.0+0.5;\nvec2 center=clamp(UV,0.0,1.0);\nvec2 delta=UV-center;\nfloat deltad=(length(delta)*2.0);\nfloat f=(Bevel+(Radius-Bevel)*Stretch)/Radius;\n\nfloat innerd=clamp(deltad*2.0,0.0,1.0);\nfloat outerd=clamp(deltad*2.0-1.0,0.0,1.0);\nfloat bevelAngle=outerd*3.14159*0.5;\nfloat sinb=sin(bevelAngle);\nfloat cosb=cos(bevelAngle);\nfloat beveld=(1.0-f)*innerd+f*sinb;\nfloat br=outerd;\nvec2 r2=2.0*vec2(Radius/Anisotropy,Radius);\nfloat dir=P.z<0.0001 ? 1.0 : -1.0;\n\nNew_UV=center+r2*((0.5-center)+normalize(delta+vec2(0.0,0.000001))*beveld*0.5);\nNew_P=vec3(New_UV-0.5,P.z+dir*(1.0-cosb)*Bevel*ScaleZ);\nRadial_Gradient=clamp((deltad-0.5)*2.0,0.0,1.0);\nRadial_Dir=vec3(delta*r2,0.0);\nvec3 beveledNormal=cosb*Normal_Object+sinb*vec3(delta.x,delta.y,0.0);\nNew_Normal=Normal_Object.z==0.0 ? Normal_Object : beveledNormal;\n}\n\n\nvoid Object_To_World_Dir_B210(\nvec3 Dir_Object,\nout vec3 Normal_World,\nout vec3 Normal_World_N,\nout float Normal_Length)\n{\nNormal_World=(world*vec4(Dir_Object,0.0)).xyz;\nNormal_Length=length(Normal_World);\nNormal_World_N=Normal_World/Normal_Length;\n}\n\n\nvoid To_XYZ_B228(\nvec3 Vec3,\nout float X,\nout float Y,\nout float Z)\n{\nX=Vec3.x;\nY=Vec3.y;\nZ=Vec3.z;\n}\n\n\nvoid Conditional_Float_B243(\nbool Which,\nfloat If_True,\nfloat If_False,\nout float Result)\n{\nResult=Which ? If_True : If_False;\n}\n\n\nvoid Object_To_World_Dir_B178(\nvec3 Dir_Object,\nout vec3 Binormal_World,\nout vec3 Binormal_World_N,\nout float Binormal_Length)\n{\nBinormal_World=(world*vec4(Dir_Object,0.0)).xyz;\nBinormal_Length=length(Binormal_World);\nBinormal_World_N=Binormal_World/Binormal_Length;\n}\n\n\nvoid Pick_Radius_B219(\nfloat Radius,\nfloat Radius_Top_Left,\nfloat Radius_Top_Right,\nfloat Radius_Bottom_Left,\nfloat Radius_Bottom_Right,\nvec3 Position,\nout float Result)\n{\nbool whichY=Position.y>0.0;\nResult=Position.x<0.0 ? (whichY ? Radius_Top_Left : Radius_Bottom_Left) : (whichY ? Radius_Top_Right : Radius_Bottom_Right);\nResult*=Radius;\n}\n\n\nvoid Conditional_Float_B186(\nbool Which,\nfloat If_True,\nfloat If_False,\nout float Result)\n{\nResult=Which ? If_True : If_False;\n}\n\n\nvoid Greater_Than_B187(\nfloat Left,\nfloat Right,\nout bool Not_Greater_Than,\nout bool Greater_Than)\n{\nGreater_Than=Left>Right;\nNot_Greater_Than=!Greater_Than;\n}\n\n\nvoid Remap_Range_B255(\nfloat In_Min,\nfloat In_Max,\nfloat Out_Min,\nfloat Out_Max,\nfloat In,\nout float Out)\n{\nOut=mix(Out_Min,Out_Max,clamp((In-In_Min)/(In_Max-In_Min),0.0,1.0));\n}\n\nvoid main()\n{\n\nvec2 XY_Q235;\nXY_Q235=(uv-vec2(0.5,0.5))*_Decal_Scale_XY_+vec2(0.5,0.5);\n\nvec3 Tangent_World_Q177;\nvec3 Tangent_World_N_Q177;\nfloat Tangent_Length_Q177;\nTangent_World_Q177=(world*vec4(vec3(1,0,0),0.0)).xyz;\nTangent_Length_Q177=length(Tangent_World_Q177);\nTangent_World_N_Q177=Tangent_World_Q177/Tangent_Length_Q177;\nvec3 Normal_World_Q210;\nvec3 Normal_World_N_Q210;\nfloat Normal_Length_Q210;\nObject_To_World_Dir_B210(vec3(0,0,1),Normal_World_Q210,Normal_World_N_Q210,Normal_Length_Q210);\nfloat X_Q228;\nfloat Y_Q228;\nfloat Z_Q228;\nTo_XYZ_B228(position,X_Q228,Y_Q228,Z_Q228);\n\nvec3 Nrm_World_Q176;\nNrm_World_Q176=normalize((world*vec4(normal,0.0)).xyz);\nvec3 Binormal_World_Q178;\nvec3 Binormal_World_N_Q178;\nfloat Binormal_Length_Q178;\nObject_To_World_Dir_B178(vec3(0,1,0),Binormal_World_Q178,Binormal_World_N_Q178,Binormal_Length_Q178);\n\nfloat Anisotropy_Q179=Tangent_Length_Q177/Binormal_Length_Q178;\nfloat Result_Q219;\nPick_Radius_B219(_Radius_,_Radius_Top_Left_,_Radius_Top_Right_,_Radius_Bottom_Left_,_Radius_Bottom_Right_,position,Result_Q219);\n\nfloat Anisotropy_Q203=Binormal_Length_Q178/Normal_Length_Q210;\nbool Not_Greater_Than_Q187;\nbool Greater_Than_Q187;\nGreater_Than_B187(Z_Q228,0.0,Not_Greater_Than_Q187,Greater_Than_Q187);\n\nvec4 Linear_Q251;\nLinear_Q251.rgb=clamp(_Left_Color_.rgb*_Left_Color_.rgb,0.0,1.0);\nLinear_Q251.a=_Left_Color_.a;\n\nvec4 Linear_Q252;\nLinear_Q252.rgb=clamp(_Right_Color_.rgb*_Right_Color_.rgb,0.0,1.0);\nLinear_Q252.a=_Right_Color_.a;\n\nvec3 Difference_Q211=vec3(0,0,0)-Normal_World_N_Q210;\n\nvec4 Out_Color_Q184=vec4(X_Q228,Y_Q228,Z_Q228,1);\nfloat Result_Q186;\nConditional_Float_B186(Greater_Than_Q187,_Bevel_Back_,_Bevel_Front_,Result_Q186);\nfloat Result_Q244;\nConditional_Float_B186(Greater_Than_Q187,_Bevel_Back_Stretch_,_Bevel_Front_Stretch_,Result_Q244);\nvec3 New_P_Q280;\nvec2 New_UV_Q280;\nfloat Radial_Gradient_Q280;\nvec3 Radial_Dir_Q280;\nvec3 New_Normal_Q280;\nMove_Verts_B280(Anisotropy_Q179,position,Result_Q219,Result_Q186,normal,Anisotropy_Q203,Result_Q244,New_P_Q280,New_UV_Q280,Radial_Gradient_Q280,Radial_Dir_Q280,New_Normal_Q280);\n\nfloat X_Q248;\nfloat Y_Q248;\nX_Q248=New_UV_Q280.x;\nY_Q248=New_UV_Q280.y;\nvec3 Pos_World_Q162;\nObject_To_World_Pos_B162(New_P_Q280,Pos_World_Q162);\nvec3 Nrm_World_Q182;\nObject_To_World_Normal_B182(New_Normal_Q280,Nrm_World_Q182);\nvec4 Blob_Info_Q173;\n#if BLOB_ENABLE\nBlob_Vertex_B173(Pos_World_Q162,Nrm_World_Q176,Tangent_World_N_Q177,Binormal_World_N_Q178,_Blob_Position_,_Blob_Intensity_,_Blob_Near_Size_,_Blob_Far_Size_,_Blob_Near_Distance_,_Blob_Far_Distance_,_Blob_Fade_Length_,_Blob_Pulse_,_Blob_Fade_,Blob_Info_Q173);\n#else\nBlob_Info_Q173=vec4(0,0,0,0);\n#endif\nvec4 Blob_Info_Q174;\n#if BLOB_ENABLE_2\nBlob_Vertex_B174(Pos_World_Q162,Nrm_World_Q176,Tangent_World_N_Q177,Binormal_World_N_Q178,_Blob_Position_2_,_Blob_Intensity_,_Blob_Near_Size_2_,_Blob_Far_Size_,_Blob_Near_Distance_,_Blob_Far_Distance_,_Blob_Fade_Length_,_Blob_Pulse_2_,_Blob_Fade_2_,Blob_Info_Q174);\n#else\nBlob_Info_Q174=vec4(0,0,0,0);\n#endif\nfloat Out_Q255;\nRemap_Range_B255(0.0,1.0,0.0,1.0,X_Q248,Out_Q255);\nfloat X_Q236;\nfloat Y_Q236;\nfloat Z_Q236;\nTo_XYZ_B228(Nrm_World_Q182,X_Q236,Y_Q236,Z_Q236);\n\nvec4 Color_At_T_Q247=mix(Linear_Q251,Linear_Q252,Out_Q255);\n\nfloat Minus_F_Q237=-Z_Q236;\n\nfloat R_Q249;\nfloat G_Q249;\nfloat B_Q249;\nfloat A_Q249;\nR_Q249=Color_At_T_Q247.r; G_Q249=Color_At_T_Q247.g; B_Q249=Color_At_T_Q247.b; A_Q249=Color_At_T_Q247.a;\n\nfloat ClampF_Q238=clamp(0.0,Minus_F_Q237,1.0);\nfloat Result_Q243;\nConditional_Float_B243(_Decal_Front_Only_,ClampF_Q238,1.0,Result_Q243);\n\nvec4 Vec4_Q239=vec4(Result_Q243,Radial_Gradient_Q280,G_Q249,B_Q249);\nvec3 Position=Pos_World_Q162;\nvec3 Normal=Nrm_World_Q182;\nvec2 UV=XY_Q235;\nvec3 Tangent=Tangent_World_N_Q177;\nvec3 Binormal=Difference_Q211;\nvec4 Color=Out_Color_Q184;\nvec4 Extra1=Vec4_Q239;\nvec4 Extra2=Blob_Info_Q173;\nvec4 Extra3=Blob_Info_Q174;\ngl_Position=viewProjection*vec4(Position,1);\nvPosition=Position;\nvNormal=Normal;\nvUV=UV;\nvTangent=Tangent;\nvBinormal=Binormal;\nvColor=Color;\nvExtra1=Extra1;\nvExtra2=Extra2;\nvExtra3=Extra3;\n}";r.ShaderStore.ShadersStore[i]=o;var a={name:i,shader:o}},"./3D/vector3WithInfo.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"Vector3WithInfo",function(){return o});var r=n("../../node_modules/tslib/tslib.es6.js"),i=n("babylonjs/Misc/perfCounter"),o=function(e){function t(t,n){void 0===n&&(n=0);var r=e.call(this,t.x,t.y,t.z)||this;return r.buttonIndex=n,r}return Object(r.__extends)(t,e),t}(i.Vector3)},"./index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./2D/index.ts");n.d(t,"Button",function(){return r.Button}),n.d(t,"Checkbox",function(){return r.Checkbox}),n.d(t,"ColorPicker",function(){return r.ColorPicker}),n.d(t,"Container",function(){return r.Container}),n.d(t,"Control",function(){return r.Control}),n.d(t,"Ellipse",function(){return r.Ellipse}),n.d(t,"FocusableButton",function(){return r.FocusableButton}),n.d(t,"Grid",function(){return r.Grid}),n.d(t,"Image",function(){return r.Image}),n.d(t,"InputText",function(){return r.InputText}),n.d(t,"InputPassword",function(){return r.InputPassword}),n.d(t,"Line",function(){return r.Line}),n.d(t,"MultiLine",function(){return r.MultiLine}),n.d(t,"RadioButton",function(){return r.RadioButton}),n.d(t,"StackPanel",function(){return r.StackPanel}),n.d(t,"SelectorGroup",function(){return r.SelectorGroup}),n.d(t,"CheckboxGroup",function(){return r.CheckboxGroup}),n.d(t,"RadioGroup",function(){return r.RadioGroup}),n.d(t,"SliderGroup",function(){return r.SliderGroup}),n.d(t,"SelectionPanel",function(){return r.SelectionPanel}),n.d(t,"ScrollViewer",function(){return r.ScrollViewer}),n.d(t,"TextWrapping",function(){return r.TextWrapping}),n.d(t,"TextBlock",function(){return r.TextBlock}),n.d(t,"TextWrapper",function(){return r.TextWrapper}),n.d(t,"ToggleButton",function(){return r.ToggleButton}),n.d(t,"KeyPropertySet",function(){return r.KeyPropertySet}),n.d(t,"VirtualKeyboard",function(){return r.VirtualKeyboard}),n.d(t,"Rectangle",function(){return r.Rectangle}),n.d(t,"DisplayGrid",function(){return r.DisplayGrid}),n.d(t,"BaseSlider",function(){return r.BaseSlider}),n.d(t,"Slider",function(){return r.Slider}),n.d(t,"ImageBasedSlider",function(){return r.ImageBasedSlider}),n.d(t,"ScrollBar",function(){return r.ScrollBar}),n.d(t,"ImageScrollBar",function(){return r.ImageScrollBar}),n.d(t,"name",function(){return r.name}),n.d(t,"AdvancedDynamicTexture",function(){return r.AdvancedDynamicTexture}),n.d(t,"AdvancedDynamicTextureInstrumentation",function(){return r.AdvancedDynamicTextureInstrumentation}),n.d(t,"Vector2WithInfo",function(){return r.Vector2WithInfo}),n.d(t,"Matrix2D",function(){return r.Matrix2D}),n.d(t,"Measure",function(){return r.Measure}),n.d(t,"MultiLinePoint",function(){return r.MultiLinePoint}),n.d(t,"Style",function(){return r.Style}),n.d(t,"ValueAndUnit",function(){return r.ValueAndUnit}),n.d(t,"XmlLoader",function(){return r.XmlLoader});var i=n("./3D/index.ts");n.d(t,"AbstractButton3D",function(){return i.AbstractButton3D}),n.d(t,"Button3D",function(){return i.Button3D}),n.d(t,"Container3D",function(){return i.Container3D}),n.d(t,"Control3D",function(){return i.Control3D}),n.d(t,"CylinderPanel",function(){return i.CylinderPanel}),n.d(t,"HolographicButton",function(){return i.HolographicButton}),n.d(t,"HolographicSlate",function(){return i.HolographicSlate}),n.d(t,"HandMenu",function(){return i.HandMenu}),n.d(t,"MeshButton3D",function(){return i.MeshButton3D}),n.d(t,"NearMenu",function(){return i.NearMenu}),n.d(t,"PlanePanel",function(){return i.PlanePanel}),n.d(t,"ScatterPanel",function(){return i.ScatterPanel}),n.d(t,"Slider3D",function(){return i.Slider3D}),n.d(t,"SpherePanel",function(){return i.SpherePanel}),n.d(t,"StackPanel3D",function(){return i.StackPanel3D}),n.d(t,"TouchButton3D",function(){return i.TouchButton3D}),n.d(t,"TouchMeshButton3D",function(){return i.TouchMeshButton3D}),n.d(t,"TouchHolographicButton",function(){return i.TouchHolographicButton}),n.d(t,"TouchHolographicMenu",function(){return i.TouchHolographicMenu}),n.d(t,"TouchToggleButton3D",function(){return i.TouchToggleButton3D}),n.d(t,"VolumeBasedPanel",function(){return i.VolumeBasedPanel}),n.d(t,"HolographicBackplate",function(){return i.HolographicBackplate}),n.d(t,"FluentMaterialDefines",function(){return i.FluentMaterialDefines}),n.d(t,"FluentMaterial",function(){return i.FluentMaterial}),n.d(t,"FluentButtonMaterial",function(){return i.FluentButtonMaterial}),n.d(t,"FluentBackplateMaterial",function(){return i.FluentBackplateMaterial}),n.d(t,"HandleMaterial",function(){return i.HandleMaterial}),n.d(t,"MRDLSliderBarMaterial",function(){return i.MRDLSliderBarMaterial}),n.d(t,"MRDLSliderThumbMaterial",function(){return i.MRDLSliderThumbMaterial}),n.d(t,"MRDLBackplateMaterial",function(){return i.MRDLBackplateMaterial}),n.d(t,"SlateGizmo",function(){return i.SlateGizmo}),n.d(t,"HandleState",function(){return i.HandleState}),n.d(t,"GizmoHandle",function(){return i.GizmoHandle}),n.d(t,"SideHandle",function(){return i.SideHandle}),n.d(t,"CornerHandle",function(){return i.CornerHandle}),n.d(t,"GUI3DManager",function(){return i.GUI3DManager}),n.d(t,"Vector3WithInfo",function(){return i.Vector3WithInfo})},"./legacy/legacy.ts":function(e,t,n){"use strict";n.r(t),function(e){var r=n("./index.ts");n.d(t,"Button",function(){return r.Button}),n.d(t,"Checkbox",function(){return r.Checkbox}),n.d(t,"ColorPicker",function(){return r.ColorPicker}),n.d(t,"Container",function(){return r.Container}),n.d(t,"Control",function(){return r.Control}),n.d(t,"Ellipse",function(){return r.Ellipse}),n.d(t,"FocusableButton",function(){return r.FocusableButton}),n.d(t,"Grid",function(){return r.Grid}),n.d(t,"Image",function(){return r.Image}),n.d(t,"InputText",function(){return r.InputText}),n.d(t,"InputPassword",function(){return r.InputPassword}),n.d(t,"Line",function(){return r.Line}),n.d(t,"MultiLine",function(){return r.MultiLine}),n.d(t,"RadioButton",function(){return r.RadioButton}),n.d(t,"StackPanel",function(){return r.StackPanel}),n.d(t,"SelectorGroup",function(){return r.SelectorGroup}),n.d(t,"CheckboxGroup",function(){return r.CheckboxGroup}),n.d(t,"RadioGroup",function(){return r.RadioGroup}),n.d(t,"SliderGroup",function(){return r.SliderGroup}),n.d(t,"SelectionPanel",function(){return r.SelectionPanel}),n.d(t,"ScrollViewer",function(){return r.ScrollViewer}),n.d(t,"TextWrapping",function(){return r.TextWrapping}),n.d(t,"TextBlock",function(){return r.TextBlock}),n.d(t,"TextWrapper",function(){return r.TextWrapper}),n.d(t,"ToggleButton",function(){return r.ToggleButton}),n.d(t,"KeyPropertySet",function(){return r.KeyPropertySet}),n.d(t,"VirtualKeyboard",function(){return r.VirtualKeyboard}),n.d(t,"Rectangle",function(){return r.Rectangle}),n.d(t,"DisplayGrid",function(){return r.DisplayGrid}),n.d(t,"BaseSlider",function(){return r.BaseSlider}),n.d(t,"Slider",function(){return r.Slider}),n.d(t,"ImageBasedSlider",function(){return r.ImageBasedSlider}),n.d(t,"ScrollBar",function(){return r.ScrollBar}),n.d(t,"ImageScrollBar",function(){return r.ImageScrollBar}),n.d(t,"name",function(){return r.name}),n.d(t,"AdvancedDynamicTexture",function(){return r.AdvancedDynamicTexture}),n.d(t,"AdvancedDynamicTextureInstrumentation",function(){return r.AdvancedDynamicTextureInstrumentation}),n.d(t,"Vector2WithInfo",function(){return r.Vector2WithInfo}),n.d(t,"Matrix2D",function(){return r.Matrix2D}),n.d(t,"Measure",function(){return r.Measure}),n.d(t,"MultiLinePoint",function(){return r.MultiLinePoint}),n.d(t,"Style",function(){return r.Style}),n.d(t,"ValueAndUnit",function(){return r.ValueAndUnit}),n.d(t,"XmlLoader",function(){return r.XmlLoader}),n.d(t,"AbstractButton3D",function(){return r.AbstractButton3D}),n.d(t,"Button3D",function(){return r.Button3D}),n.d(t,"Container3D",function(){return r.Container3D}),n.d(t,"Control3D",function(){return r.Control3D}),n.d(t,"CylinderPanel",function(){return r.CylinderPanel}),n.d(t,"HolographicButton",function(){return r.HolographicButton}),n.d(t,"HolographicSlate",function(){return r.HolographicSlate}),n.d(t,"HandMenu",function(){return r.HandMenu}),n.d(t,"MeshButton3D",function(){return r.MeshButton3D}),n.d(t,"NearMenu",function(){return r.NearMenu}),n.d(t,"PlanePanel",function(){return r.PlanePanel}),n.d(t,"ScatterPanel",function(){return r.ScatterPanel}),n.d(t,"Slider3D",function(){return r.Slider3D}),n.d(t,"SpherePanel",function(){return r.SpherePanel}),n.d(t,"StackPanel3D",function(){return r.StackPanel3D}),n.d(t,"TouchButton3D",function(){return r.TouchButton3D}),n.d(t,"TouchMeshButton3D",function(){return r.TouchMeshButton3D}),n.d(t,"TouchHolographicButton",function(){return r.TouchHolographicButton}),n.d(t,"TouchHolographicMenu",function(){return r.TouchHolographicMenu}),n.d(t,"TouchToggleButton3D",function(){return r.TouchToggleButton3D}),n.d(t,"VolumeBasedPanel",function(){return r.VolumeBasedPanel}),n.d(t,"HolographicBackplate",function(){return r.HolographicBackplate}),n.d(t,"FluentMaterialDefines",function(){return r.FluentMaterialDefines}),n.d(t,"FluentMaterial",function(){return r.FluentMaterial}),n.d(t,"FluentButtonMaterial",function(){return r.FluentButtonMaterial}),n.d(t,"FluentBackplateMaterial",function(){return r.FluentBackplateMaterial}),n.d(t,"HandleMaterial",function(){return r.HandleMaterial}),n.d(t,"MRDLSliderBarMaterial",function(){return r.MRDLSliderBarMaterial}),n.d(t,"MRDLSliderThumbMaterial",function(){return r.MRDLSliderThumbMaterial}),n.d(t,"MRDLBackplateMaterial",function(){return r.MRDLBackplateMaterial}),n.d(t,"SlateGizmo",function(){return r.SlateGizmo}),n.d(t,"HandleState",function(){return r.HandleState}),n.d(t,"GizmoHandle",function(){return r.GizmoHandle}),n.d(t,"SideHandle",function(){return r.SideHandle}),n.d(t,"CornerHandle",function(){return r.CornerHandle}),n.d(t,"GUI3DManager",function(){return r.GUI3DManager}),n.d(t,"Vector3WithInfo",function(){return r.Vector3WithInfo});var i=void 0!==e?e:"undefined"!=typeof window?window:void 0;void 0!==i&&(i.BABYLON=i.BABYLON||{},i.BABYLON.GUI=r)}.call(this,n("../../node_modules/webpack/buildin/global.js"))},"babylonjs/Misc/perfCounter":function(t,n){t.exports=e}})});